var W$=Object.defineProperty;var G$=(t,e,r)=>e in t?W$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Nv=(t,e,r)=>G$(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var dp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function er(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ak={exports:{}},Py={},Ik={exports:{}},Ot={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jm=Symbol.for("react.element"),K$=Symbol.for("react.portal"),Q$=Symbol.for("react.fragment"),Y$=Symbol.for("react.strict_mode"),X$=Symbol.for("react.profiler"),J$=Symbol.for("react.provider"),Z$=Symbol.for("react.context"),eL=Symbol.for("react.forward_ref"),tL=Symbol.for("react.suspense"),rL=Symbol.for("react.memo"),nL=Symbol.for("react.lazy"),E2=Symbol.iterator;function aL(t){return t===null||typeof t!="object"?null:(t=E2&&t[E2]||t["@@iterator"],typeof t=="function"?t:null)}var kk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ok=Object.assign,Dk={};function xd(t,e,r){this.props=t,this.context=e,this.refs=Dk,this.updater=r||kk}xd.prototype.isReactComponent={};xd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};xd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Mk(){}Mk.prototype=xd.prototype;function aN(t,e,r){this.props=t,this.context=e,this.refs=Dk,this.updater=r||kk}var sN=aN.prototype=new Mk;sN.constructor=aN;Ok(sN,xd.prototype);sN.isPureReactComponent=!0;var P2=Array.isArray,Rk=Object.prototype.hasOwnProperty,iN={current:null},$k={key:!0,ref:!0,__self:!0,__source:!0};function Lk(t,e,r){var n,s={},i=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Rk.call(e,n)&&!$k.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:jm,type:t,key:i,ref:o,props:s,_owner:iN.current}}function sL(t,e){return{$$typeof:jm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function oN(t){return typeof t=="object"&&t!==null&&t.$$typeof===jm}function iL(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var T2=/\/+/g;function _v(t,e){return typeof t=="object"&&t!==null&&t.key!=null?iL(""+t.key):e.toString(36)}function rg(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case jm:case K$:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+_v(o,0):n,P2(s)?(r="",t!=null&&(r=t.replace(T2,"$&/")+"/"),rg(s,e,r,"",function(u){return u})):s!=null&&(oN(s)&&(s=sL(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(T2,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",P2(t))for(var l=0;l<t.length;l++){i=t[l];var c=n+_v(i,l);o+=rg(i,e,r,c,s)}else if(c=aL(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=n+_v(i,l++),o+=rg(i,e,r,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function hp(t,e,r){if(t==null)return t;var n=[],s=0;return rg(t,n,"","",function(i){return e.call(r,i,s++)}),n}function oL(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ha={current:null},ng={transition:null},lL={ReactCurrentDispatcher:ha,ReactCurrentBatchConfig:ng,ReactCurrentOwner:iN};function Vk(){throw Error("act(...) is not supported in production builds of React.")}Ot.Children={map:hp,forEach:function(t,e,r){hp(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return hp(t,function(){e++}),e},toArray:function(t){return hp(t,function(e){return e})||[]},only:function(t){if(!oN(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ot.Component=xd;Ot.Fragment=Q$;Ot.Profiler=X$;Ot.PureComponent=aN;Ot.StrictMode=Y$;Ot.Suspense=tL;Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lL;Ot.act=Vk;Ot.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Ok({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=iN.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Rk.call(e,c)&&!$k.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:jm,type:t.type,key:s,ref:i,props:n,_owner:o}};Ot.createContext=function(t){return t={$$typeof:Z$,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:J$,_context:t},t.Consumer=t};Ot.createElement=Lk;Ot.createFactory=function(t){var e=Lk.bind(null,t);return e.type=t,e};Ot.createRef=function(){return{current:null}};Ot.forwardRef=function(t){return{$$typeof:eL,render:t}};Ot.isValidElement=oN;Ot.lazy=function(t){return{$$typeof:nL,_payload:{_status:-1,_result:t},_init:oL}};Ot.memo=function(t,e){return{$$typeof:rL,type:t,compare:e===void 0?null:e}};Ot.startTransition=function(t){var e=ng.transition;ng.transition={};try{t()}finally{ng.transition=e}};Ot.unstable_act=Vk;Ot.useCallback=function(t,e){return ha.current.useCallback(t,e)};Ot.useContext=function(t){return ha.current.useContext(t)};Ot.useDebugValue=function(){};Ot.useDeferredValue=function(t){return ha.current.useDeferredValue(t)};Ot.useEffect=function(t,e){return ha.current.useEffect(t,e)};Ot.useId=function(){return ha.current.useId()};Ot.useImperativeHandle=function(t,e,r){return ha.current.useImperativeHandle(t,e,r)};Ot.useInsertionEffect=function(t,e){return ha.current.useInsertionEffect(t,e)};Ot.useLayoutEffect=function(t,e){return ha.current.useLayoutEffect(t,e)};Ot.useMemo=function(t,e){return ha.current.useMemo(t,e)};Ot.useReducer=function(t,e,r){return ha.current.useReducer(t,e,r)};Ot.useRef=function(t){return ha.current.useRef(t)};Ot.useState=function(t){return ha.current.useState(t)};Ot.useSyncExternalStore=function(t,e,r){return ha.current.useSyncExternalStore(t,e,r)};Ot.useTransition=function(){return ha.current.useTransition()};Ot.version="18.3.1";Ik.exports=Ot;var I=Ik.exports;const ee=er(I);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cL=I,uL=Symbol.for("react.element"),dL=Symbol.for("react.fragment"),hL=Object.prototype.hasOwnProperty,fL=cL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mL={key:!0,ref:!0,__self:!0,__source:!0};function Fk(t,e,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)hL.call(e,n)&&!mL.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:uL,type:t,key:i,ref:o,props:s,_owner:fL.current}}Py.Fragment=dL;Py.jsx=Fk;Py.jsxs=Fk;Ak.exports=Py;var a=Ak.exports,Bk={exports:{}},qa={},Uk={exports:{}},zk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,L){var X=W.length;W.push(L);e:for(;0<X;){var G=X-1>>>1,K=W[G];if(0<s(K,L))W[G]=L,W[X]=K,X=G;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var L=W[0],X=W.pop();if(X!==L){W[0]=X;e:for(var G=0,K=W.length,q=K>>>1;G<q;){var ie=2*(G+1)-1,ge=W[ie],be=ie+1,Ye=W[be];if(0>s(ge,X))be<K&&0>s(Ye,ge)?(W[G]=Ye,W[be]=X,G=be):(W[G]=ge,W[ie]=X,G=ie);else if(be<K&&0>s(Ye,X))W[G]=Ye,W[be]=X,G=be;else break e}}return L}function s(W,L){var X=W.sortIndex-L.sortIndex;return X!==0?X:W.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,y=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(W){for(var L=r(u);L!==null;){if(L.callback===null)n(u);else if(L.startTime<=W)n(u),L.sortIndex=L.expirationTime,e(c,L);else break;L=r(u)}}function S(W){if(g=!1,j(W),!y)if(r(c)!==null)y=!0,B(_);else{var L=r(u);L!==null&&Y(S,L.startTime-W)}}function _(W,L){y=!1,g&&(g=!1,b(w),w=-1),m=!0;var X=f;try{for(j(L),h=r(c);h!==null&&(!(h.expirationTime>L)||W&&!T());){var G=h.callback;if(typeof G=="function"){h.callback=null,f=h.priorityLevel;var K=G(h.expirationTime<=L);L=t.unstable_now(),typeof K=="function"?h.callback=K:h===r(c)&&n(c),j(L)}else n(c);h=r(c)}if(h!==null)var q=!0;else{var ie=r(u);ie!==null&&Y(S,ie.startTime-L),q=!1}return q}finally{h=null,f=X,m=!1}}var C=!1,N=null,w=-1,E=5,k=-1;function T(){return!(t.unstable_now()-k<E)}function P(){if(N!==null){var W=t.unstable_now();k=W;var L=!0;try{L=N(!0,W)}finally{L?O():(C=!1,N=null)}}else C=!1}var O;if(typeof v=="function")O=function(){v(P)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,R=D.port2;D.port1.onmessage=P,O=function(){R.postMessage(null)}}else O=function(){x(P,0)};function B(W){N=W,C||(C=!0,O())}function Y(W,L){w=x(function(){W(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,B(_))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(W){switch(f){case 1:case 2:case 3:var L=3;break;default:L=f}var X=f;f=L;try{return W()}finally{f=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,L){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var X=f;f=W;try{return L()}finally{f=X}},t.unstable_scheduleCallback=function(W,L,X){var G=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?G+X:G):X=G,W){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=X+K,W={id:d++,callback:L,priorityLevel:W,startTime:X,expirationTime:K,sortIndex:-1},X>G?(W.sortIndex=X,e(u,W),r(c)===null&&W===r(u)&&(g?(b(w),w=-1):g=!0,Y(S,X-G))):(W.sortIndex=K,e(c,W),y||m||(y=!0,B(_))),W},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(W){var L=f;return function(){var X=f;f=L;try{return W.apply(this,arguments)}finally{f=X}}}})(zk);Uk.exports=zk;var pL=Uk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gL=I,Ba=pL;function Re(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qk=new Set,cf={};function mc(t,e){Su(t,e),Su(t+"Capture",e)}function Su(t,e){for(cf[t]=e,t=0;t<e.length;t++)qk.add(e[t])}var Bi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gb=Object.prototype.hasOwnProperty,yL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A2={},I2={};function xL(t){return Gb.call(I2,t)?!0:Gb.call(A2,t)?!1:yL.test(t)?I2[t]=!0:(A2[t]=!0,!1)}function vL(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bL(t,e,r,n){if(e===null||typeof e>"u"||vL(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fa(t,e,r,n,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vn[t]=new fa(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vn[e]=new fa(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vn[t]=new fa(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vn[t]=new fa(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vn[t]=new fa(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vn[t]=new fa(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vn[t]=new fa(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vn[t]=new fa(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vn[t]=new fa(t,5,!1,t.toLowerCase(),null,!1,!1)});var lN=/[\-:]([a-z])/g;function cN(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(lN,cN);Vn[e]=new fa(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(lN,cN);Vn[e]=new fa(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(lN,cN);Vn[e]=new fa(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vn[t]=new fa(t,1,!1,t.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new fa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vn[t]=new fa(t,1,!1,t.toLowerCase(),null,!0,!0)});function uN(t,e,r,n){var s=Vn.hasOwnProperty(e)?Vn[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bL(e,r,s,n)&&(r=null),n||s===null?xL(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Zi=gL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fp=Symbol.for("react.element"),Fc=Symbol.for("react.portal"),Bc=Symbol.for("react.fragment"),dN=Symbol.for("react.strict_mode"),Kb=Symbol.for("react.profiler"),Hk=Symbol.for("react.provider"),Wk=Symbol.for("react.context"),hN=Symbol.for("react.forward_ref"),Qb=Symbol.for("react.suspense"),Yb=Symbol.for("react.suspense_list"),fN=Symbol.for("react.memo"),yo=Symbol.for("react.lazy"),Gk=Symbol.for("react.offscreen"),k2=Symbol.iterator;function eh(t){return t===null||typeof t!="object"?null:(t=k2&&t[k2]||t["@@iterator"],typeof t=="function"?t:null)}var Lr=Object.assign,Sv;function Nh(t){if(Sv===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Sv=e&&e[1]||""}return`
`+Sv+t}var Cv=!1;function Ev(t,e){if(!t||Cv)return"";Cv=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Cv=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Nh(t):""}function wL(t){switch(t.tag){case 5:return Nh(t.type);case 16:return Nh("Lazy");case 13:return Nh("Suspense");case 19:return Nh("SuspenseList");case 0:case 2:case 15:return t=Ev(t.type,!1),t;case 11:return t=Ev(t.type.render,!1),t;case 1:return t=Ev(t.type,!0),t;default:return""}}function Xb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bc:return"Fragment";case Fc:return"Portal";case Kb:return"Profiler";case dN:return"StrictMode";case Qb:return"Suspense";case Yb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Wk:return(t.displayName||"Context")+".Consumer";case Hk:return(t._context.displayName||"Context")+".Provider";case hN:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case fN:return e=t.displayName||null,e!==null?e:Xb(t.type)||"Memo";case yo:e=t._payload,t=t._init;try{return Xb(t(e))}catch{}}return null}function jL(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xb(e);case 8:return e===dN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ho(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Kk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function NL(t){var e=Kk(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function mp(t){t._valueTracker||(t._valueTracker=NL(t))}function Qk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Kk(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ig(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Jb(t,e){var r=e.checked;return Lr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function O2(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ho(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Yk(t,e){e=e.checked,e!=null&&uN(t,"checked",e,!1)}function Zb(t,e){Yk(t,e);var r=Ho(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ew(t,e.type,r):e.hasOwnProperty("defaultValue")&&ew(t,e.type,Ho(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function D2(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function ew(t,e,r){(e!=="number"||Ig(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var _h=Array.isArray;function lu(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ho(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function tw(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Re(91));return Lr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function M2(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Re(92));if(_h(r)){if(1<r.length)throw Error(Re(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ho(r)}}function Xk(t,e){var r=Ho(e.value),n=Ho(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function R2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Jk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rw(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Jk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var pp,Zk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(pp=pp||document.createElement("div"),pp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=pp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function uf(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Rh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_L=["Webkit","ms","Moz","O"];Object.keys(Rh).forEach(function(t){_L.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Rh[e]=Rh[t]})});function eO(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Rh.hasOwnProperty(t)&&Rh[t]?(""+e).trim():e+"px"}function tO(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=eO(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var SL=Lr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nw(t,e){if(e){if(SL[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Re(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Re(62))}}function aw(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sw=null;function mN(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var iw=null,cu=null,uu=null;function $2(t){if(t=Sm(t)){if(typeof iw!="function")throw Error(Re(280));var e=t.stateNode;e&&(e=Oy(e),iw(t.stateNode,t.type,e))}}function rO(t){cu?uu?uu.push(t):uu=[t]:cu=t}function nO(){if(cu){var t=cu,e=uu;if(uu=cu=null,$2(t),e)for(t=0;t<e.length;t++)$2(e[t])}}function aO(t,e){return t(e)}function sO(){}var Pv=!1;function iO(t,e,r){if(Pv)return t(e,r);Pv=!0;try{return aO(t,e,r)}finally{Pv=!1,(cu!==null||uu!==null)&&(sO(),nO())}}function df(t,e){var r=t.stateNode;if(r===null)return null;var n=Oy(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Re(231,e,typeof r));return r}var ow=!1;if(Bi)try{var th={};Object.defineProperty(th,"passive",{get:function(){ow=!0}}),window.addEventListener("test",th,th),window.removeEventListener("test",th,th)}catch{ow=!1}function CL(t,e,r,n,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var $h=!1,kg=null,Og=!1,lw=null,EL={onError:function(t){$h=!0,kg=t}};function PL(t,e,r,n,s,i,o,l,c){$h=!1,kg=null,CL.apply(EL,arguments)}function TL(t,e,r,n,s,i,o,l,c){if(PL.apply(this,arguments),$h){if($h){var u=kg;$h=!1,kg=null}else throw Error(Re(198));Og||(Og=!0,lw=u)}}function pc(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function oO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function L2(t){if(pc(t)!==t)throw Error(Re(188))}function AL(t){var e=t.alternate;if(!e){if(e=pc(t),e===null)throw Error(Re(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return L2(s),t;if(i===n)return L2(s),e;i=i.sibling}throw Error(Re(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(Re(189))}}if(r.alternate!==n)throw Error(Re(190))}if(r.tag!==3)throw Error(Re(188));return r.stateNode.current===r?t:e}function lO(t){return t=AL(t),t!==null?cO(t):null}function cO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=cO(t);if(e!==null)return e;t=t.sibling}return null}var uO=Ba.unstable_scheduleCallback,V2=Ba.unstable_cancelCallback,IL=Ba.unstable_shouldYield,kL=Ba.unstable_requestPaint,Kr=Ba.unstable_now,OL=Ba.unstable_getCurrentPriorityLevel,pN=Ba.unstable_ImmediatePriority,dO=Ba.unstable_UserBlockingPriority,Dg=Ba.unstable_NormalPriority,DL=Ba.unstable_LowPriority,hO=Ba.unstable_IdlePriority,Ty=null,Js=null;function ML(t){if(Js&&typeof Js.onCommitFiberRoot=="function")try{Js.onCommitFiberRoot(Ty,t,void 0,(t.current.flags&128)===128)}catch{}}var Rs=Math.clz32?Math.clz32:LL,RL=Math.log,$L=Math.LN2;function LL(t){return t>>>=0,t===0?32:31-(RL(t)/$L|0)|0}var gp=64,yp=4194304;function Sh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Mg(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=Sh(l):(i&=o,i!==0&&(n=Sh(i)))}else o=r&~s,o!==0?n=Sh(o):i!==0&&(n=Sh(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Rs(e),s=1<<r,n|=t[r],e&=~s;return n}function VL(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FL(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Rs(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=VL(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function cw(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fO(){var t=gp;return gp<<=1,!(gp&4194240)&&(gp=64),t}function Tv(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Nm(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rs(e),t[e]=r}function BL(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Rs(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function gN(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Rs(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Jt=0;function mO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pO,yN,gO,yO,xO,uw=!1,xp=[],Oo=null,Do=null,Mo=null,hf=new Map,ff=new Map,bo=[],UL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function F2(t,e){switch(t){case"focusin":case"focusout":Oo=null;break;case"dragenter":case"dragleave":Do=null;break;case"mouseover":case"mouseout":Mo=null;break;case"pointerover":case"pointerout":hf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ff.delete(e.pointerId)}}function rh(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Sm(e),e!==null&&yN(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function zL(t,e,r,n,s){switch(e){case"focusin":return Oo=rh(Oo,t,e,r,n,s),!0;case"dragenter":return Do=rh(Do,t,e,r,n,s),!0;case"mouseover":return Mo=rh(Mo,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return hf.set(i,rh(hf.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,ff.set(i,rh(ff.get(i)||null,t,e,r,n,s)),!0}return!1}function vO(t){var e=Al(t.target);if(e!==null){var r=pc(e);if(r!==null){if(e=r.tag,e===13){if(e=oO(r),e!==null){t.blockedOn=e,xO(t.priority,function(){gO(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ag(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=dw(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);sw=n,r.target.dispatchEvent(n),sw=null}else return e=Sm(r),e!==null&&yN(e),t.blockedOn=r,!1;e.shift()}return!0}function B2(t,e,r){ag(t)&&r.delete(e)}function qL(){uw=!1,Oo!==null&&ag(Oo)&&(Oo=null),Do!==null&&ag(Do)&&(Do=null),Mo!==null&&ag(Mo)&&(Mo=null),hf.forEach(B2),ff.forEach(B2)}function nh(t,e){t.blockedOn===e&&(t.blockedOn=null,uw||(uw=!0,Ba.unstable_scheduleCallback(Ba.unstable_NormalPriority,qL)))}function mf(t){function e(s){return nh(s,t)}if(0<xp.length){nh(xp[0],t);for(var r=1;r<xp.length;r++){var n=xp[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Oo!==null&&nh(Oo,t),Do!==null&&nh(Do,t),Mo!==null&&nh(Mo,t),hf.forEach(e),ff.forEach(e),r=0;r<bo.length;r++)n=bo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<bo.length&&(r=bo[0],r.blockedOn===null);)vO(r),r.blockedOn===null&&bo.shift()}var du=Zi.ReactCurrentBatchConfig,Rg=!0;function HL(t,e,r,n){var s=Jt,i=du.transition;du.transition=null;try{Jt=1,xN(t,e,r,n)}finally{Jt=s,du.transition=i}}function WL(t,e,r,n){var s=Jt,i=du.transition;du.transition=null;try{Jt=4,xN(t,e,r,n)}finally{Jt=s,du.transition=i}}function xN(t,e,r,n){if(Rg){var s=dw(t,e,r,n);if(s===null)Vv(t,e,n,$g,r),F2(t,n);else if(zL(s,t,e,r,n))n.stopPropagation();else if(F2(t,n),e&4&&-1<UL.indexOf(t)){for(;s!==null;){var i=Sm(s);if(i!==null&&pO(i),i=dw(t,e,r,n),i===null&&Vv(t,e,n,$g,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Vv(t,e,n,null,r)}}var $g=null;function dw(t,e,r,n){if($g=null,t=mN(n),t=Al(t),t!==null)if(e=pc(t),e===null)t=null;else if(r=e.tag,r===13){if(t=oO(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return $g=t,null}function bO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OL()){case pN:return 1;case dO:return 4;case Dg:case DL:return 16;case hO:return 536870912;default:return 16}default:return 16}}var Po=null,vN=null,sg=null;function wO(){if(sg)return sg;var t,e=vN,r=e.length,n,s="value"in Po?Po.value:Po.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[i-n];n++);return sg=s.slice(t,1<n?1-n:void 0)}function ig(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function vp(){return!0}function U2(){return!1}function Ha(t){function e(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?vp:U2,this.isPropagationStopped=U2,this}return Lr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=vp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=vp)},persist:function(){},isPersistent:vp}),e}var vd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bN=Ha(vd),_m=Lr({},vd,{view:0,detail:0}),GL=Ha(_m),Av,Iv,ah,Ay=Lr({},_m,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wN,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ah&&(ah&&t.type==="mousemove"?(Av=t.screenX-ah.screenX,Iv=t.screenY-ah.screenY):Iv=Av=0,ah=t),Av)},movementY:function(t){return"movementY"in t?t.movementY:Iv}}),z2=Ha(Ay),KL=Lr({},Ay,{dataTransfer:0}),QL=Ha(KL),YL=Lr({},_m,{relatedTarget:0}),kv=Ha(YL),XL=Lr({},vd,{animationName:0,elapsedTime:0,pseudoElement:0}),JL=Ha(XL),ZL=Lr({},vd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),e9=Ha(ZL),t9=Lr({},vd,{data:0}),q2=Ha(t9),r9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function s9(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=a9[t])?!!e[t]:!1}function wN(){return s9}var i9=Lr({},_m,{key:function(t){if(t.key){var e=r9[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ig(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?n9[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wN,charCode:function(t){return t.type==="keypress"?ig(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ig(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),o9=Ha(i9),l9=Lr({},Ay,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),H2=Ha(l9),c9=Lr({},_m,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wN}),u9=Ha(c9),d9=Lr({},vd,{propertyName:0,elapsedTime:0,pseudoElement:0}),h9=Ha(d9),f9=Lr({},Ay,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),m9=Ha(f9),p9=[9,13,27,32],jN=Bi&&"CompositionEvent"in window,Lh=null;Bi&&"documentMode"in document&&(Lh=document.documentMode);var g9=Bi&&"TextEvent"in window&&!Lh,jO=Bi&&(!jN||Lh&&8<Lh&&11>=Lh),W2=" ",G2=!1;function NO(t,e){switch(t){case"keyup":return p9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _O(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Uc=!1;function y9(t,e){switch(t){case"compositionend":return _O(e);case"keypress":return e.which!==32?null:(G2=!0,W2);case"textInput":return t=e.data,t===W2&&G2?null:t;default:return null}}function x9(t,e){if(Uc)return t==="compositionend"||!jN&&NO(t,e)?(t=wO(),sg=vN=Po=null,Uc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return jO&&e.locale!=="ko"?null:e.data;default:return null}}var v9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function K2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!v9[t.type]:e==="textarea"}function SO(t,e,r,n){rO(n),e=Lg(e,"onChange"),0<e.length&&(r=new bN("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Vh=null,pf=null;function b9(t){RO(t,0)}function Iy(t){var e=Hc(t);if(Qk(e))return t}function w9(t,e){if(t==="change")return e}var CO=!1;if(Bi){var Ov;if(Bi){var Dv="oninput"in document;if(!Dv){var Q2=document.createElement("div");Q2.setAttribute("oninput","return;"),Dv=typeof Q2.oninput=="function"}Ov=Dv}else Ov=!1;CO=Ov&&(!document.documentMode||9<document.documentMode)}function Y2(){Vh&&(Vh.detachEvent("onpropertychange",EO),pf=Vh=null)}function EO(t){if(t.propertyName==="value"&&Iy(pf)){var e=[];SO(e,pf,t,mN(t)),iO(b9,e)}}function j9(t,e,r){t==="focusin"?(Y2(),Vh=e,pf=r,Vh.attachEvent("onpropertychange",EO)):t==="focusout"&&Y2()}function N9(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Iy(pf)}function _9(t,e){if(t==="click")return Iy(e)}function S9(t,e){if(t==="input"||t==="change")return Iy(e)}function C9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Fs=typeof Object.is=="function"?Object.is:C9;function gf(t,e){if(Fs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Gb.call(e,s)||!Fs(t[s],e[s]))return!1}return!0}function X2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function J2(t,e){var r=X2(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=X2(r)}}function PO(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?PO(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function TO(){for(var t=window,e=Ig();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ig(t.document)}return e}function NN(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function E9(t){var e=TO(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&PO(r.ownerDocument.documentElement,r)){if(n!==null&&NN(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=J2(r,i);var o=J2(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var P9=Bi&&"documentMode"in document&&11>=document.documentMode,zc=null,hw=null,Fh=null,fw=!1;function Z2(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;fw||zc==null||zc!==Ig(n)||(n=zc,"selectionStart"in n&&NN(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Fh&&gf(Fh,n)||(Fh=n,n=Lg(hw,"onSelect"),0<n.length&&(e=new bN("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=zc)))}function bp(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var qc={animationend:bp("Animation","AnimationEnd"),animationiteration:bp("Animation","AnimationIteration"),animationstart:bp("Animation","AnimationStart"),transitionend:bp("Transition","TransitionEnd")},Mv={},AO={};Bi&&(AO=document.createElement("div").style,"AnimationEvent"in window||(delete qc.animationend.animation,delete qc.animationiteration.animation,delete qc.animationstart.animation),"TransitionEvent"in window||delete qc.transitionend.transition);function ky(t){if(Mv[t])return Mv[t];if(!qc[t])return t;var e=qc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in AO)return Mv[t]=e[r];return t}var IO=ky("animationend"),kO=ky("animationiteration"),OO=ky("animationstart"),DO=ky("transitionend"),MO=new Map,eC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zo(t,e){MO.set(t,e),mc(e,[t])}for(var Rv=0;Rv<eC.length;Rv++){var $v=eC[Rv],T9=$v.toLowerCase(),A9=$v[0].toUpperCase()+$v.slice(1);Zo(T9,"on"+A9)}Zo(IO,"onAnimationEnd");Zo(kO,"onAnimationIteration");Zo(OO,"onAnimationStart");Zo("dblclick","onDoubleClick");Zo("focusin","onFocus");Zo("focusout","onBlur");Zo(DO,"onTransitionEnd");Su("onMouseEnter",["mouseout","mouseover"]);Su("onMouseLeave",["mouseout","mouseover"]);Su("onPointerEnter",["pointerout","pointerover"]);Su("onPointerLeave",["pointerout","pointerover"]);mc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));mc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));mc("onBeforeInput",["compositionend","keypress","textInput","paste"]);mc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));mc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));mc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ch="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I9=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ch));function tC(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,TL(n,e,void 0,t),t.currentTarget=null}function RO(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;tC(s,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;tC(s,l,u),i=c}}}if(Og)throw t=lw,Og=!1,lw=null,t}function br(t,e){var r=e[xw];r===void 0&&(r=e[xw]=new Set);var n=t+"__bubble";r.has(n)||($O(e,t,2,!1),r.add(n))}function Lv(t,e,r){var n=0;e&&(n|=4),$O(r,t,n,e)}var wp="_reactListening"+Math.random().toString(36).slice(2);function yf(t){if(!t[wp]){t[wp]=!0,qk.forEach(function(r){r!=="selectionchange"&&(I9.has(r)||Lv(r,!1,t),Lv(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wp]||(e[wp]=!0,Lv("selectionchange",!1,e))}}function $O(t,e,r,n){switch(bO(e)){case 1:var s=HL;break;case 4:s=WL;break;default:s=xN}r=s.bind(null,e,r,t),s=void 0,!ow||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Vv(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Al(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}iO(function(){var u=i,d=mN(r),h=[];e:{var f=MO.get(t);if(f!==void 0){var m=bN,y=t;switch(t){case"keypress":if(ig(r)===0)break e;case"keydown":case"keyup":m=o9;break;case"focusin":y="focus",m=kv;break;case"focusout":y="blur",m=kv;break;case"beforeblur":case"afterblur":m=kv;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=z2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=QL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=u9;break;case IO:case kO:case OO:m=JL;break;case DO:m=h9;break;case"scroll":m=GL;break;case"wheel":m=m9;break;case"copy":case"cut":case"paste":m=e9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=H2}var g=(e&4)!==0,x=!g&&t==="scroll",b=g?f!==null?f+"Capture":null:f;g=[];for(var v=u,j;v!==null;){j=v;var S=j.stateNode;if(j.tag===5&&S!==null&&(j=S,b!==null&&(S=df(v,b),S!=null&&g.push(xf(v,S,j)))),x)break;v=v.return}0<g.length&&(f=new m(f,y,null,r,d),h.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&r!==sw&&(y=r.relatedTarget||r.fromElement)&&(Al(y)||y[Ui]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=u,y=y?Al(y):null,y!==null&&(x=pc(y),y!==x||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(g=z2,S="onMouseLeave",b="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=H2,S="onPointerLeave",b="onPointerEnter",v="pointer"),x=m==null?f:Hc(m),j=y==null?f:Hc(y),f=new g(S,v+"leave",m,r,d),f.target=x,f.relatedTarget=j,S=null,Al(d)===u&&(g=new g(b,v+"enter",y,r,d),g.target=j,g.relatedTarget=x,S=g),x=S,m&&y)t:{for(g=m,b=y,v=0,j=g;j;j=Ic(j))v++;for(j=0,S=b;S;S=Ic(S))j++;for(;0<v-j;)g=Ic(g),v--;for(;0<j-v;)b=Ic(b),j--;for(;v--;){if(g===b||b!==null&&g===b.alternate)break t;g=Ic(g),b=Ic(b)}g=null}else g=null;m!==null&&rC(h,f,m,g,!1),y!==null&&x!==null&&rC(h,x,y,g,!0)}}e:{if(f=u?Hc(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var _=w9;else if(K2(f))if(CO)_=S9;else{_=N9;var C=j9}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=_9);if(_&&(_=_(t,u))){SO(h,_,r,d);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&ew(f,"number",f.value)}switch(C=u?Hc(u):window,t){case"focusin":(K2(C)||C.contentEditable==="true")&&(zc=C,hw=u,Fh=null);break;case"focusout":Fh=hw=zc=null;break;case"mousedown":fw=!0;break;case"contextmenu":case"mouseup":case"dragend":fw=!1,Z2(h,r,d);break;case"selectionchange":if(P9)break;case"keydown":case"keyup":Z2(h,r,d)}var N;if(jN)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Uc?NO(t,r)&&(w="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(w="onCompositionStart");w&&(jO&&r.locale!=="ko"&&(Uc||w!=="onCompositionStart"?w==="onCompositionEnd"&&Uc&&(N=wO()):(Po=d,vN="value"in Po?Po.value:Po.textContent,Uc=!0)),C=Lg(u,w),0<C.length&&(w=new q2(w,t,null,r,d),h.push({event:w,listeners:C}),N?w.data=N:(N=_O(r),N!==null&&(w.data=N)))),(N=g9?y9(t,r):x9(t,r))&&(u=Lg(u,"onBeforeInput"),0<u.length&&(d=new q2("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=N))}RO(h,e)})}function xf(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Lg(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=df(t,r),i!=null&&n.unshift(xf(t,i,s)),i=df(t,e),i!=null&&n.push(xf(t,i,s))),t=t.return}return n}function Ic(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function rC(t,e,r,n,s){for(var i=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=df(r,i),c!=null&&o.unshift(xf(r,c,l))):s||(c=df(r,i),c!=null&&o.push(xf(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var k9=/\r\n?/g,O9=/\u0000|\uFFFD/g;function nC(t){return(typeof t=="string"?t:""+t).replace(k9,`
`).replace(O9,"")}function jp(t,e,r){if(e=nC(e),nC(t)!==e&&r)throw Error(Re(425))}function Vg(){}var mw=null,pw=null;function gw(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var yw=typeof setTimeout=="function"?setTimeout:void 0,D9=typeof clearTimeout=="function"?clearTimeout:void 0,aC=typeof Promise=="function"?Promise:void 0,M9=typeof queueMicrotask=="function"?queueMicrotask:typeof aC<"u"?function(t){return aC.resolve(null).then(t).catch(R9)}:yw;function R9(t){setTimeout(function(){throw t})}function Fv(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),mf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);mf(e)}function Ro(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sC(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var bd=Math.random().toString(36).slice(2),Ks="__reactFiber$"+bd,vf="__reactProps$"+bd,Ui="__reactContainer$"+bd,xw="__reactEvents$"+bd,$9="__reactListeners$"+bd,L9="__reactHandles$"+bd;function Al(t){var e=t[Ks];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ui]||r[Ks]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=sC(t);t!==null;){if(r=t[Ks])return r;t=sC(t)}return e}t=r,r=t.parentNode}return null}function Sm(t){return t=t[Ks]||t[Ui],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Re(33))}function Oy(t){return t[vf]||null}var vw=[],Wc=-1;function el(t){return{current:t}}function Nr(t){0>Wc||(t.current=vw[Wc],vw[Wc]=null,Wc--)}function yr(t,e){Wc++,vw[Wc]=t.current,t.current=e}var Wo={},Jn=el(Wo),_a=el(!1),Wl=Wo;function Cu(t,e){var r=t.type.contextTypes;if(!r)return Wo;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Sa(t){return t=t.childContextTypes,t!=null}function Fg(){Nr(_a),Nr(Jn)}function iC(t,e,r){if(Jn.current!==Wo)throw Error(Re(168));yr(Jn,e),yr(_a,r)}function LO(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(Re(108,jL(t)||"Unknown",s));return Lr({},r,n)}function Bg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Wo,Wl=Jn.current,yr(Jn,t),yr(_a,_a.current),!0}function oC(t,e,r){var n=t.stateNode;if(!n)throw Error(Re(169));r?(t=LO(t,e,Wl),n.__reactInternalMemoizedMergedChildContext=t,Nr(_a),Nr(Jn),yr(Jn,t)):Nr(_a),yr(_a,r)}var bi=null,Dy=!1,Bv=!1;function VO(t){bi===null?bi=[t]:bi.push(t)}function V9(t){Dy=!0,VO(t)}function tl(){if(!Bv&&bi!==null){Bv=!0;var t=0,e=Jt;try{var r=bi;for(Jt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}bi=null,Dy=!1}catch(s){throw bi!==null&&(bi=bi.slice(t+1)),uO(pN,tl),s}finally{Jt=e,Bv=!1}}return null}var Gc=[],Kc=0,Ug=null,zg=0,es=[],ts=0,Gl=null,Ni=1,_i="";function bl(t,e){Gc[Kc++]=zg,Gc[Kc++]=Ug,Ug=t,zg=e}function FO(t,e,r){es[ts++]=Ni,es[ts++]=_i,es[ts++]=Gl,Gl=t;var n=Ni;t=_i;var s=32-Rs(n)-1;n&=~(1<<s),r+=1;var i=32-Rs(e)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Ni=1<<32-Rs(e)+s|r<<s|n,_i=i+t}else Ni=1<<i|r<<s|n,_i=t}function _N(t){t.return!==null&&(bl(t,1),FO(t,1,0))}function SN(t){for(;t===Ug;)Ug=Gc[--Kc],Gc[Kc]=null,zg=Gc[--Kc],Gc[Kc]=null;for(;t===Gl;)Gl=es[--ts],es[ts]=null,_i=es[--ts],es[ts]=null,Ni=es[--ts],es[ts]=null}var Va=null,Ra=null,Er=!1,As=null;function BO(t,e){var r=as(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function lC(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Va=t,Ra=Ro(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Va=t,Ra=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Gl!==null?{id:Ni,overflow:_i}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=as(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Va=t,Ra=null,!0):!1;default:return!1}}function bw(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ww(t){if(Er){var e=Ra;if(e){var r=e;if(!lC(t,e)){if(bw(t))throw Error(Re(418));e=Ro(r.nextSibling);var n=Va;e&&lC(t,e)?BO(n,r):(t.flags=t.flags&-4097|2,Er=!1,Va=t)}}else{if(bw(t))throw Error(Re(418));t.flags=t.flags&-4097|2,Er=!1,Va=t}}}function cC(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Va=t}function Np(t){if(t!==Va)return!1;if(!Er)return cC(t),Er=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!gw(t.type,t.memoizedProps)),e&&(e=Ra)){if(bw(t))throw UO(),Error(Re(418));for(;e;)BO(t,e),e=Ro(e.nextSibling)}if(cC(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Re(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ra=Ro(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ra=null}}else Ra=Va?Ro(t.stateNode.nextSibling):null;return!0}function UO(){for(var t=Ra;t;)t=Ro(t.nextSibling)}function Eu(){Ra=Va=null,Er=!1}function CN(t){As===null?As=[t]:As.push(t)}var F9=Zi.ReactCurrentBatchConfig;function sh(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Re(309));var n=r.stateNode}if(!n)throw Error(Re(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Re(284));if(!r._owner)throw Error(Re(290,t))}return t}function _p(t,e){throw t=Object.prototype.toString.call(e),Error(Re(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function uC(t){var e=t._init;return e(t._payload)}function zO(t){function e(b,v){if(t){var j=b.deletions;j===null?(b.deletions=[v],b.flags|=16):j.push(v)}}function r(b,v){if(!t)return null;for(;v!==null;)e(b,v),v=v.sibling;return null}function n(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function s(b,v){return b=Fo(b,v),b.index=0,b.sibling=null,b}function i(b,v,j){return b.index=j,t?(j=b.alternate,j!==null?(j=j.index,j<v?(b.flags|=2,v):j):(b.flags|=2,v)):(b.flags|=1048576,v)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function l(b,v,j,S){return v===null||v.tag!==6?(v=Kv(j,b.mode,S),v.return=b,v):(v=s(v,j),v.return=b,v)}function c(b,v,j,S){var _=j.type;return _===Bc?d(b,v,j.props.children,S,j.key):v!==null&&(v.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===yo&&uC(_)===v.type)?(S=s(v,j.props),S.ref=sh(b,v,j),S.return=b,S):(S=fg(j.type,j.key,j.props,null,b.mode,S),S.ref=sh(b,v,j),S.return=b,S)}function u(b,v,j,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==j.containerInfo||v.stateNode.implementation!==j.implementation?(v=Qv(j,b.mode,S),v.return=b,v):(v=s(v,j.children||[]),v.return=b,v)}function d(b,v,j,S,_){return v===null||v.tag!==7?(v=Fl(j,b.mode,S,_),v.return=b,v):(v=s(v,j),v.return=b,v)}function h(b,v,j){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Kv(""+v,b.mode,j),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case fp:return j=fg(v.type,v.key,v.props,null,b.mode,j),j.ref=sh(b,null,v),j.return=b,j;case Fc:return v=Qv(v,b.mode,j),v.return=b,v;case yo:var S=v._init;return h(b,S(v._payload),j)}if(_h(v)||eh(v))return v=Fl(v,b.mode,j,null),v.return=b,v;_p(b,v)}return null}function f(b,v,j,S){var _=v!==null?v.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return _!==null?null:l(b,v,""+j,S);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case fp:return j.key===_?c(b,v,j,S):null;case Fc:return j.key===_?u(b,v,j,S):null;case yo:return _=j._init,f(b,v,_(j._payload),S)}if(_h(j)||eh(j))return _!==null?null:d(b,v,j,S,null);_p(b,j)}return null}function m(b,v,j,S,_){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(j)||null,l(v,b,""+S,_);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case fp:return b=b.get(S.key===null?j:S.key)||null,c(v,b,S,_);case Fc:return b=b.get(S.key===null?j:S.key)||null,u(v,b,S,_);case yo:var C=S._init;return m(b,v,j,C(S._payload),_)}if(_h(S)||eh(S))return b=b.get(j)||null,d(v,b,S,_,null);_p(v,S)}return null}function y(b,v,j,S){for(var _=null,C=null,N=v,w=v=0,E=null;N!==null&&w<j.length;w++){N.index>w?(E=N,N=null):E=N.sibling;var k=f(b,N,j[w],S);if(k===null){N===null&&(N=E);break}t&&N&&k.alternate===null&&e(b,N),v=i(k,v,w),C===null?_=k:C.sibling=k,C=k,N=E}if(w===j.length)return r(b,N),Er&&bl(b,w),_;if(N===null){for(;w<j.length;w++)N=h(b,j[w],S),N!==null&&(v=i(N,v,w),C===null?_=N:C.sibling=N,C=N);return Er&&bl(b,w),_}for(N=n(b,N);w<j.length;w++)E=m(N,b,w,j[w],S),E!==null&&(t&&E.alternate!==null&&N.delete(E.key===null?w:E.key),v=i(E,v,w),C===null?_=E:C.sibling=E,C=E);return t&&N.forEach(function(T){return e(b,T)}),Er&&bl(b,w),_}function g(b,v,j,S){var _=eh(j);if(typeof _!="function")throw Error(Re(150));if(j=_.call(j),j==null)throw Error(Re(151));for(var C=_=null,N=v,w=v=0,E=null,k=j.next();N!==null&&!k.done;w++,k=j.next()){N.index>w?(E=N,N=null):E=N.sibling;var T=f(b,N,k.value,S);if(T===null){N===null&&(N=E);break}t&&N&&T.alternate===null&&e(b,N),v=i(T,v,w),C===null?_=T:C.sibling=T,C=T,N=E}if(k.done)return r(b,N),Er&&bl(b,w),_;if(N===null){for(;!k.done;w++,k=j.next())k=h(b,k.value,S),k!==null&&(v=i(k,v,w),C===null?_=k:C.sibling=k,C=k);return Er&&bl(b,w),_}for(N=n(b,N);!k.done;w++,k=j.next())k=m(N,b,w,k.value,S),k!==null&&(t&&k.alternate!==null&&N.delete(k.key===null?w:k.key),v=i(k,v,w),C===null?_=k:C.sibling=k,C=k);return t&&N.forEach(function(P){return e(b,P)}),Er&&bl(b,w),_}function x(b,v,j,S){if(typeof j=="object"&&j!==null&&j.type===Bc&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case fp:e:{for(var _=j.key,C=v;C!==null;){if(C.key===_){if(_=j.type,_===Bc){if(C.tag===7){r(b,C.sibling),v=s(C,j.props.children),v.return=b,b=v;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===yo&&uC(_)===C.type){r(b,C.sibling),v=s(C,j.props),v.ref=sh(b,C,j),v.return=b,b=v;break e}r(b,C);break}else e(b,C);C=C.sibling}j.type===Bc?(v=Fl(j.props.children,b.mode,S,j.key),v.return=b,b=v):(S=fg(j.type,j.key,j.props,null,b.mode,S),S.ref=sh(b,v,j),S.return=b,b=S)}return o(b);case Fc:e:{for(C=j.key;v!==null;){if(v.key===C)if(v.tag===4&&v.stateNode.containerInfo===j.containerInfo&&v.stateNode.implementation===j.implementation){r(b,v.sibling),v=s(v,j.children||[]),v.return=b,b=v;break e}else{r(b,v);break}else e(b,v);v=v.sibling}v=Qv(j,b.mode,S),v.return=b,b=v}return o(b);case yo:return C=j._init,x(b,v,C(j._payload),S)}if(_h(j))return y(b,v,j,S);if(eh(j))return g(b,v,j,S);_p(b,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,v!==null&&v.tag===6?(r(b,v.sibling),v=s(v,j),v.return=b,b=v):(r(b,v),v=Kv(j,b.mode,S),v.return=b,b=v),o(b)):r(b,v)}return x}var Pu=zO(!0),qO=zO(!1),qg=el(null),Hg=null,Qc=null,EN=null;function PN(){EN=Qc=Hg=null}function TN(t){var e=qg.current;Nr(qg),t._currentValue=e}function jw(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function hu(t,e){Hg=t,EN=Qc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wa=!0),t.firstContext=null)}function fs(t){var e=t._currentValue;if(EN!==t)if(t={context:t,memoizedValue:e,next:null},Qc===null){if(Hg===null)throw Error(Re(308));Qc=t,Hg.dependencies={lanes:0,firstContext:t}}else Qc=Qc.next=t;return e}var Il=null;function AN(t){Il===null?Il=[t]:Il.push(t)}function HO(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,AN(e)):(r.next=s.next,s.next=r),e.interleaved=r,zi(t,n)}function zi(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var xo=!1;function IN(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function WO(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ki(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $o(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,zt&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,zi(t,r)}return s=n.interleaved,s===null?(e.next=e,AN(n)):(e.next=s.next,s.next=e),n.interleaved=e,zi(t,r)}function og(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,gN(t,r)}}function dC(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Wg(t,e,r,n){var s=t.updateQueue;xo=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=t,g=l;switch(f=e,m=r,g.tag){case 1:if(y=g.payload,typeof y=="function"){h=y.call(m,h,f);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,f=typeof y=="function"?y.call(m,h,f):y,f==null)break e;h=Lr({},h,f);break e;case 2:xo=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ql|=o,t.lanes=o,t.memoizedState=h}}function hC(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Re(191,s));s.call(n)}}}var Cm={},Zs=el(Cm),bf=el(Cm),wf=el(Cm);function kl(t){if(t===Cm)throw Error(Re(174));return t}function kN(t,e){switch(yr(wf,e),yr(bf,t),yr(Zs,Cm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rw(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=rw(e,t)}Nr(Zs),yr(Zs,e)}function Tu(){Nr(Zs),Nr(bf),Nr(wf)}function GO(t){kl(wf.current);var e=kl(Zs.current),r=rw(e,t.type);e!==r&&(yr(bf,t),yr(Zs,r))}function ON(t){bf.current===t&&(Nr(Zs),Nr(bf))}var Mr=el(0);function Gg(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Uv=[];function DN(){for(var t=0;t<Uv.length;t++)Uv[t]._workInProgressVersionPrimary=null;Uv.length=0}var lg=Zi.ReactCurrentDispatcher,zv=Zi.ReactCurrentBatchConfig,Kl=0,$r=null,sn=null,pn=null,Kg=!1,Bh=!1,jf=0,B9=0;function Un(){throw Error(Re(321))}function MN(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Fs(t[r],e[r]))return!1;return!0}function RN(t,e,r,n,s,i){if(Kl=i,$r=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,lg.current=t===null||t.memoizedState===null?H9:W9,t=r(n,s),Bh){i=0;do{if(Bh=!1,jf=0,25<=i)throw Error(Re(301));i+=1,pn=sn=null,e.updateQueue=null,lg.current=G9,t=r(n,s)}while(Bh)}if(lg.current=Qg,e=sn!==null&&sn.next!==null,Kl=0,pn=sn=$r=null,Kg=!1,e)throw Error(Re(300));return t}function $N(){var t=jf!==0;return jf=0,t}function Gs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?$r.memoizedState=pn=t:pn=pn.next=t,pn}function ms(){if(sn===null){var t=$r.alternate;t=t!==null?t.memoizedState:null}else t=sn.next;var e=pn===null?$r.memoizedState:pn.next;if(e!==null)pn=e,sn=t;else{if(t===null)throw Error(Re(310));sn=t,t={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},pn===null?$r.memoizedState=pn=t:pn=pn.next=t}return pn}function Nf(t,e){return typeof e=="function"?e(t):e}function qv(t){var e=ms(),r=e.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=t;var n=sn,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Kl&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=n):c=c.next=h,$r.lanes|=d,Ql|=d}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,Fs(n,e.memoizedState)||(wa=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,$r.lanes|=i,Ql|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Hv(t){var e=ms(),r=e.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Fs(i,e.memoizedState)||(wa=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function KO(){}function QO(t,e){var r=$r,n=ms(),s=e(),i=!Fs(n.memoizedState,s);if(i&&(n.memoizedState=s,wa=!0),n=n.queue,LN(JO.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||pn!==null&&pn.memoizedState.tag&1){if(r.flags|=2048,_f(9,XO.bind(null,r,n,s,e),void 0,null),vn===null)throw Error(Re(349));Kl&30||YO(r,e,s)}return s}function YO(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=$r.updateQueue,e===null?(e={lastEffect:null,stores:null},$r.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function XO(t,e,r,n){e.value=r,e.getSnapshot=n,ZO(e)&&eD(t)}function JO(t,e,r){return r(function(){ZO(e)&&eD(t)})}function ZO(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Fs(t,r)}catch{return!0}}function eD(t){var e=zi(t,1);e!==null&&$s(e,t,1,-1)}function fC(t){var e=Gs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nf,lastRenderedState:t},e.queue=t,t=t.dispatch=q9.bind(null,$r,t),[e.memoizedState,t]}function _f(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=$r.updateQueue,e===null?(e={lastEffect:null,stores:null},$r.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function tD(){return ms().memoizedState}function cg(t,e,r,n){var s=Gs();$r.flags|=t,s.memoizedState=_f(1|e,r,void 0,n===void 0?null:n)}function My(t,e,r,n){var s=ms();n=n===void 0?null:n;var i=void 0;if(sn!==null){var o=sn.memoizedState;if(i=o.destroy,n!==null&&MN(n,o.deps)){s.memoizedState=_f(e,r,i,n);return}}$r.flags|=t,s.memoizedState=_f(1|e,r,i,n)}function mC(t,e){return cg(8390656,8,t,e)}function LN(t,e){return My(2048,8,t,e)}function rD(t,e){return My(4,2,t,e)}function nD(t,e){return My(4,4,t,e)}function aD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sD(t,e,r){return r=r!=null?r.concat([t]):null,My(4,4,aD.bind(null,e,t),r)}function VN(){}function iD(t,e){var r=ms();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&MN(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function oD(t,e){var r=ms();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&MN(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function lD(t,e,r){return Kl&21?(Fs(r,e)||(r=fO(),$r.lanes|=r,Ql|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wa=!0),t.memoizedState=r)}function U9(t,e){var r=Jt;Jt=r!==0&&4>r?r:4,t(!0);var n=zv.transition;zv.transition={};try{t(!1),e()}finally{Jt=r,zv.transition=n}}function cD(){return ms().memoizedState}function z9(t,e,r){var n=Vo(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},uD(t))dD(e,r);else if(r=HO(t,e,r,n),r!==null){var s=la();$s(r,t,n,s),hD(r,e,n)}}function q9(t,e,r){var n=Vo(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(uD(t))dD(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,Fs(l,o)){var c=e.interleaved;c===null?(s.next=s,AN(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=HO(t,e,s,n),r!==null&&(s=la(),$s(r,t,n,s),hD(r,e,n))}}function uD(t){var e=t.alternate;return t===$r||e!==null&&e===$r}function dD(t,e){Bh=Kg=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function hD(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,gN(t,r)}}var Qg={readContext:fs,useCallback:Un,useContext:Un,useEffect:Un,useImperativeHandle:Un,useInsertionEffect:Un,useLayoutEffect:Un,useMemo:Un,useReducer:Un,useRef:Un,useState:Un,useDebugValue:Un,useDeferredValue:Un,useTransition:Un,useMutableSource:Un,useSyncExternalStore:Un,useId:Un,unstable_isNewReconciler:!1},H9={readContext:fs,useCallback:function(t,e){return Gs().memoizedState=[t,e===void 0?null:e],t},useContext:fs,useEffect:mC,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,cg(4194308,4,aD.bind(null,e,t),r)},useLayoutEffect:function(t,e){return cg(4194308,4,t,e)},useInsertionEffect:function(t,e){return cg(4,2,t,e)},useMemo:function(t,e){var r=Gs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Gs();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=z9.bind(null,$r,t),[n.memoizedState,t]},useRef:function(t){var e=Gs();return t={current:t},e.memoizedState=t},useState:fC,useDebugValue:VN,useDeferredValue:function(t){return Gs().memoizedState=t},useTransition:function(){var t=fC(!1),e=t[0];return t=U9.bind(null,t[1]),Gs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=$r,s=Gs();if(Er){if(r===void 0)throw Error(Re(407));r=r()}else{if(r=e(),vn===null)throw Error(Re(349));Kl&30||YO(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,mC(JO.bind(null,n,i,t),[t]),n.flags|=2048,_f(9,XO.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=Gs(),e=vn.identifierPrefix;if(Er){var r=_i,n=Ni;r=(n&~(1<<32-Rs(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=jf++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=B9++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},W9={readContext:fs,useCallback:iD,useContext:fs,useEffect:LN,useImperativeHandle:sD,useInsertionEffect:rD,useLayoutEffect:nD,useMemo:oD,useReducer:qv,useRef:tD,useState:function(){return qv(Nf)},useDebugValue:VN,useDeferredValue:function(t){var e=ms();return lD(e,sn.memoizedState,t)},useTransition:function(){var t=qv(Nf)[0],e=ms().memoizedState;return[t,e]},useMutableSource:KO,useSyncExternalStore:QO,useId:cD,unstable_isNewReconciler:!1},G9={readContext:fs,useCallback:iD,useContext:fs,useEffect:LN,useImperativeHandle:sD,useInsertionEffect:rD,useLayoutEffect:nD,useMemo:oD,useReducer:Hv,useRef:tD,useState:function(){return Hv(Nf)},useDebugValue:VN,useDeferredValue:function(t){var e=ms();return sn===null?e.memoizedState=t:lD(e,sn.memoizedState,t)},useTransition:function(){var t=Hv(Nf)[0],e=ms().memoizedState;return[t,e]},useMutableSource:KO,useSyncExternalStore:QO,useId:cD,unstable_isNewReconciler:!1};function Es(t,e){if(t&&t.defaultProps){e=Lr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Nw(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Lr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Ry={isMounted:function(t){return(t=t._reactInternals)?pc(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=la(),s=Vo(t),i=ki(n,s);i.payload=e,r!=null&&(i.callback=r),e=$o(t,i,s),e!==null&&($s(e,t,s,n),og(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=la(),s=Vo(t),i=ki(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=$o(t,i,s),e!==null&&($s(e,t,s,n),og(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=la(),n=Vo(t),s=ki(r,n);s.tag=2,e!=null&&(s.callback=e),e=$o(t,s,n),e!==null&&($s(e,t,n,r),og(e,t,n))}};function pC(t,e,r,n,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,o):e.prototype&&e.prototype.isPureReactComponent?!gf(r,n)||!gf(s,i):!0}function fD(t,e,r){var n=!1,s=Wo,i=e.contextType;return typeof i=="object"&&i!==null?i=fs(i):(s=Sa(e)?Wl:Jn.current,n=e.contextTypes,i=(n=n!=null)?Cu(t,s):Wo),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ry,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function gC(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Ry.enqueueReplaceState(e,e.state,null)}function _w(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},IN(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=fs(i):(i=Sa(e)?Wl:Jn.current,s.context=Cu(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Nw(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ry.enqueueReplaceState(s,s.state,null),Wg(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Au(t,e){try{var r="",n=e;do r+=wL(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Wv(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Sw(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var K9=typeof WeakMap=="function"?WeakMap:Map;function mD(t,e,r){r=ki(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Xg||(Xg=!0,Mw=n),Sw(t,e)},r}function pD(t,e,r){r=ki(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Sw(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Sw(t,e),typeof n!="function"&&(Lo===null?Lo=new Set([this]):Lo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function yC(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new K9;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=lV.bind(null,t,e,r),e.then(t,t))}function xC(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function vC(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ki(-1,1),e.tag=2,$o(r,e,1))),r.lanes|=1),t)}var Q9=Zi.ReactCurrentOwner,wa=!1;function aa(t,e,r,n){e.child=t===null?qO(e,null,r,n):Pu(e,t.child,r,n)}function bC(t,e,r,n,s){r=r.render;var i=e.ref;return hu(e,s),n=RN(t,e,r,n,i,s),r=$N(),t!==null&&!wa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qi(t,e,s)):(Er&&r&&_N(e),e.flags|=1,aa(t,e,n,s),e.child)}function wC(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!GN(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,gD(t,e,i,n,s)):(t=fg(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:gf,r(o,n)&&t.ref===e.ref)return qi(t,e,s)}return e.flags|=1,t=Fo(i,n),t.ref=e.ref,t.return=e,e.child=t}function gD(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(gf(i,n)&&t.ref===e.ref)if(wa=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(wa=!0);else return e.lanes=t.lanes,qi(t,e,s)}return Cw(t,e,r,n,s)}function yD(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},yr(Xc,Ia),Ia|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,yr(Xc,Ia),Ia|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,yr(Xc,Ia),Ia|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,yr(Xc,Ia),Ia|=n;return aa(t,e,s,r),e.child}function xD(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Cw(t,e,r,n,s){var i=Sa(r)?Wl:Jn.current;return i=Cu(e,i),hu(e,s),r=RN(t,e,r,n,i,s),n=$N(),t!==null&&!wa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qi(t,e,s)):(Er&&n&&_N(e),e.flags|=1,aa(t,e,r,s),e.child)}function jC(t,e,r,n,s){if(Sa(r)){var i=!0;Bg(e)}else i=!1;if(hu(e,s),e.stateNode===null)ug(t,e),fD(e,r,n),_w(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=fs(u):(u=Sa(r)?Wl:Jn.current,u=Cu(e,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&gC(e,o,n,u),xo=!1;var f=e.memoizedState;o.state=f,Wg(e,n,o,s),c=e.memoizedState,l!==n||f!==c||_a.current||xo?(typeof d=="function"&&(Nw(e,r,d,n),c=e.memoizedState),(l=xo||pC(e,r,l,n,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,WO(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Es(e.type,l),o.props=u,h=e.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=fs(c):(c=Sa(r)?Wl:Jn.current,c=Cu(e,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&gC(e,o,n,c),xo=!1,f=e.memoizedState,o.state=f,Wg(e,n,o,s);var y=e.memoizedState;l!==h||f!==y||_a.current||xo?(typeof m=="function"&&(Nw(e,r,m,n),y=e.memoizedState),(u=xo||pC(e,r,u,n,f,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),o.props=n,o.state=y,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return Ew(t,e,r,n,i,s)}function Ew(t,e,r,n,s,i){xD(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&oC(e,r,!1),qi(t,e,i);n=e.stateNode,Q9.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Pu(e,t.child,null,i),e.child=Pu(e,null,l,i)):aa(t,e,l,i),e.memoizedState=n.state,s&&oC(e,r,!0),e.child}function vD(t){var e=t.stateNode;e.pendingContext?iC(t,e.pendingContext,e.pendingContext!==e.context):e.context&&iC(t,e.context,!1),kN(t,e.containerInfo)}function NC(t,e,r,n,s){return Eu(),CN(s),e.flags|=256,aa(t,e,r,n),e.child}var Pw={dehydrated:null,treeContext:null,retryLane:0};function Tw(t){return{baseLanes:t,cachePool:null,transitions:null}}function bD(t,e,r){var n=e.pendingProps,s=Mr.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),yr(Mr,s&1),t===null)return ww(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,i?(n=e.mode,i=e.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Vy(o,n,0,null),t=Fl(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Tw(r),e.memoizedState=Pw,t):FN(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Y9(t,e,o,n,l,s,r);if(i){i=n.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Fo(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Fo(l,i):(i=Fl(i,o,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,o=t.child.memoizedState,o=o===null?Tw(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=Pw,n}return i=t.child,t=i.sibling,n=Fo(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function FN(t,e){return e=Vy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Sp(t,e,r,n){return n!==null&&CN(n),Pu(e,t.child,null,r),t=FN(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Y9(t,e,r,n,s,i,o){if(r)return e.flags&256?(e.flags&=-257,n=Wv(Error(Re(422))),Sp(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Vy({mode:"visible",children:n.children},s,0,null),i=Fl(i,s,o,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Pu(e,t.child,null,o),e.child.memoizedState=Tw(o),e.memoizedState=Pw,i);if(!(e.mode&1))return Sp(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Re(419)),n=Wv(i,n,void 0),Sp(t,e,o,n)}if(l=(o&t.childLanes)!==0,wa||l){if(n=vn,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,zi(t,s),$s(n,t,s,-1))}return WN(),n=Wv(Error(Re(421))),Sp(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=cV.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ra=Ro(s.nextSibling),Va=e,Er=!0,As=null,t!==null&&(es[ts++]=Ni,es[ts++]=_i,es[ts++]=Gl,Ni=t.id,_i=t.overflow,Gl=e),e=FN(e,n.children),e.flags|=4096,e)}function _C(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),jw(t.return,e,r)}function Gv(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function wD(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(aa(t,e,n.children,r),n=Mr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_C(t,r,e);else if(t.tag===19)_C(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(yr(Mr,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Gg(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Gv(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Gg(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Gv(e,!0,r,null,i);break;case"together":Gv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ug(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qi(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ql|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Re(153));if(e.child!==null){for(t=e.child,r=Fo(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Fo(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function X9(t,e,r){switch(e.tag){case 3:vD(e),Eu();break;case 5:GO(e);break;case 1:Sa(e.type)&&Bg(e);break;case 4:kN(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;yr(qg,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(yr(Mr,Mr.current&1),e.flags|=128,null):r&e.child.childLanes?bD(t,e,r):(yr(Mr,Mr.current&1),t=qi(t,e,r),t!==null?t.sibling:null);yr(Mr,Mr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return wD(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),yr(Mr,Mr.current),n)break;return null;case 22:case 23:return e.lanes=0,yD(t,e,r)}return qi(t,e,r)}var jD,Aw,ND,_D;jD=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Aw=function(){};ND=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,kl(Zs.current);var i=null;switch(r){case"input":s=Jb(t,s),n=Jb(t,n),i=[];break;case"select":s=Lr({},s,{value:void 0}),n=Lr({},n,{value:void 0}),i=[];break;case"textarea":s=tw(t,s),n=tw(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Vg)}nw(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(cf.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(cf.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&br("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};_D=function(t,e,r,n){r!==n&&(e.flags|=4)};function ih(t,e){if(!Er)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function zn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function J9(t,e,r){var n=e.pendingProps;switch(SN(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(e),null;case 1:return Sa(e.type)&&Fg(),zn(e),null;case 3:return n=e.stateNode,Tu(),Nr(_a),Nr(Jn),DN(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Np(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,As!==null&&(Lw(As),As=null))),Aw(t,e),zn(e),null;case 5:ON(e);var s=kl(wf.current);if(r=e.type,t!==null&&e.stateNode!=null)ND(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Re(166));return zn(e),null}if(t=kl(Zs.current),Np(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[Ks]=e,n[vf]=i,t=(e.mode&1)!==0,r){case"dialog":br("cancel",n),br("close",n);break;case"iframe":case"object":case"embed":br("load",n);break;case"video":case"audio":for(s=0;s<Ch.length;s++)br(Ch[s],n);break;case"source":br("error",n);break;case"img":case"image":case"link":br("error",n),br("load",n);break;case"details":br("toggle",n);break;case"input":O2(n,i),br("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},br("invalid",n);break;case"textarea":M2(n,i),br("invalid",n)}nw(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&jp(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&jp(n.textContent,l,t),s=["children",""+l]):cf.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&br("scroll",n)}switch(r){case"input":mp(n),D2(n,i,!0);break;case"textarea":mp(n),R2(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Vg)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Jk(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Ks]=e,t[vf]=n,jD(t,e,!1,!1),e.stateNode=t;e:{switch(o=aw(r,n),r){case"dialog":br("cancel",t),br("close",t),s=n;break;case"iframe":case"object":case"embed":br("load",t),s=n;break;case"video":case"audio":for(s=0;s<Ch.length;s++)br(Ch[s],t);s=n;break;case"source":br("error",t),s=n;break;case"img":case"image":case"link":br("error",t),br("load",t),s=n;break;case"details":br("toggle",t),s=n;break;case"input":O2(t,n),s=Jb(t,n),br("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Lr({},n,{value:void 0}),br("invalid",t);break;case"textarea":M2(t,n),s=tw(t,n),br("invalid",t);break;default:s=n}nw(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?tO(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Zk(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&uf(t,c):typeof c=="number"&&uf(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(cf.hasOwnProperty(i)?c!=null&&i==="onScroll"&&br("scroll",t):c!=null&&uN(t,i,c,o))}switch(r){case"input":mp(t),D2(t,n,!1);break;case"textarea":mp(t),R2(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ho(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?lu(t,!!n.multiple,i,!1):n.defaultValue!=null&&lu(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Vg)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zn(e),null;case 6:if(t&&e.stateNode!=null)_D(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Re(166));if(r=kl(wf.current),kl(Zs.current),Np(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ks]=e,(i=n.nodeValue!==r)&&(t=Va,t!==null))switch(t.tag){case 3:jp(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&jp(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ks]=e,e.stateNode=n}return zn(e),null;case 13:if(Nr(Mr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Er&&Ra!==null&&e.mode&1&&!(e.flags&128))UO(),Eu(),e.flags|=98560,i=!1;else if(i=Np(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(Re(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Re(317));i[Ks]=e}else Eu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zn(e),i=!1}else As!==null&&(Lw(As),As=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Mr.current&1?ln===0&&(ln=3):WN())),e.updateQueue!==null&&(e.flags|=4),zn(e),null);case 4:return Tu(),Aw(t,e),t===null&&yf(e.stateNode.containerInfo),zn(e),null;case 10:return TN(e.type._context),zn(e),null;case 17:return Sa(e.type)&&Fg(),zn(e),null;case 19:if(Nr(Mr),i=e.memoizedState,i===null)return zn(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)ih(i,!1);else{if(ln!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Gg(t),o!==null){for(e.flags|=128,ih(i,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return yr(Mr,Mr.current&1|2),e.child}t=t.sibling}i.tail!==null&&Kr()>Iu&&(e.flags|=128,n=!0,ih(i,!1),e.lanes=4194304)}else{if(!n)if(t=Gg(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ih(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Er)return zn(e),null}else 2*Kr()-i.renderingStartTime>Iu&&r!==1073741824&&(e.flags|=128,n=!0,ih(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Kr(),e.sibling=null,r=Mr.current,yr(Mr,n?r&1|2:r&1),e):(zn(e),null);case 22:case 23:return HN(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ia&1073741824&&(zn(e),e.subtreeFlags&6&&(e.flags|=8192)):zn(e),null;case 24:return null;case 25:return null}throw Error(Re(156,e.tag))}function Z9(t,e){switch(SN(e),e.tag){case 1:return Sa(e.type)&&Fg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Tu(),Nr(_a),Nr(Jn),DN(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ON(e),null;case 13:if(Nr(Mr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Re(340));Eu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Nr(Mr),null;case 4:return Tu(),null;case 10:return TN(e.type._context),null;case 22:case 23:return HN(),null;case 24:return null;default:return null}}var Cp=!1,Gn=!1,eV=typeof WeakSet=="function"?WeakSet:Set,tt=null;function Yc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Br(t,e,n)}else r.current=null}function Iw(t,e,r){try{r()}catch(n){Br(t,e,n)}}var SC=!1;function tV(t,e){if(mw=Rg,t=TO(),NN(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(l=o+s),h!==i||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===r&&++u===s&&(l=o),f===i&&++d===n&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(pw={focusedElem:t,selectionRange:r},Rg=!1,tt=e;tt!==null;)if(e=tt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,tt=t;else for(;tt!==null;){e=tt;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,x=y.memoizedState,b=e.stateNode,v=b.getSnapshotBeforeUpdate(e.elementType===e.type?g:Es(e.type,g),x);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var j=e.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Re(163))}}catch(S){Br(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,tt=t;break}tt=e.return}return y=SC,SC=!1,y}function Uh(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Iw(e,r,i)}s=s.next}while(s!==n)}}function $y(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function kw(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function SD(t){var e=t.alternate;e!==null&&(t.alternate=null,SD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ks],delete e[vf],delete e[xw],delete e[$9],delete e[L9])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function CD(t){return t.tag===5||t.tag===3||t.tag===4}function CC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||CD(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ow(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Vg));else if(n!==4&&(t=t.child,t!==null))for(Ow(t,e,r),t=t.sibling;t!==null;)Ow(t,e,r),t=t.sibling}function Dw(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Dw(t,e,r),t=t.sibling;t!==null;)Dw(t,e,r),t=t.sibling}var In=null,Ps=!1;function fo(t,e,r){for(r=r.child;r!==null;)ED(t,e,r),r=r.sibling}function ED(t,e,r){if(Js&&typeof Js.onCommitFiberUnmount=="function")try{Js.onCommitFiberUnmount(Ty,r)}catch{}switch(r.tag){case 5:Gn||Yc(r,e);case 6:var n=In,s=Ps;In=null,fo(t,e,r),In=n,Ps=s,In!==null&&(Ps?(t=In,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):In.removeChild(r.stateNode));break;case 18:In!==null&&(Ps?(t=In,r=r.stateNode,t.nodeType===8?Fv(t.parentNode,r):t.nodeType===1&&Fv(t,r),mf(t)):Fv(In,r.stateNode));break;case 4:n=In,s=Ps,In=r.stateNode.containerInfo,Ps=!0,fo(t,e,r),In=n,Ps=s;break;case 0:case 11:case 14:case 15:if(!Gn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Iw(r,e,o),s=s.next}while(s!==n)}fo(t,e,r);break;case 1:if(!Gn&&(Yc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Br(r,e,l)}fo(t,e,r);break;case 21:fo(t,e,r);break;case 22:r.mode&1?(Gn=(n=Gn)||r.memoizedState!==null,fo(t,e,r),Gn=n):fo(t,e,r);break;default:fo(t,e,r)}}function EC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new eV),e.forEach(function(n){var s=uV.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ns(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:In=l.stateNode,Ps=!1;break e;case 3:In=l.stateNode.containerInfo,Ps=!0;break e;case 4:In=l.stateNode.containerInfo,Ps=!0;break e}l=l.return}if(In===null)throw Error(Re(160));ED(i,o,s),In=null,Ps=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Br(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)PD(e,t),e=e.sibling}function PD(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ns(e,t),Ws(t),n&4){try{Uh(3,t,t.return),$y(3,t)}catch(g){Br(t,t.return,g)}try{Uh(5,t,t.return)}catch(g){Br(t,t.return,g)}}break;case 1:Ns(e,t),Ws(t),n&512&&r!==null&&Yc(r,r.return);break;case 5:if(Ns(e,t),Ws(t),n&512&&r!==null&&Yc(r,r.return),t.flags&32){var s=t.stateNode;try{uf(s,"")}catch(g){Br(t,t.return,g)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Yk(s,i),aw(l,o);var u=aw(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?tO(s,h):d==="dangerouslySetInnerHTML"?Zk(s,h):d==="children"?uf(s,h):uN(s,d,h,u)}switch(l){case"input":Zb(s,i);break;case"textarea":Xk(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?lu(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?lu(s,!!i.multiple,i.defaultValue,!0):lu(s,!!i.multiple,i.multiple?[]:"",!1))}s[vf]=i}catch(g){Br(t,t.return,g)}}break;case 6:if(Ns(e,t),Ws(t),n&4){if(t.stateNode===null)throw Error(Re(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){Br(t,t.return,g)}}break;case 3:if(Ns(e,t),Ws(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{mf(e.containerInfo)}catch(g){Br(t,t.return,g)}break;case 4:Ns(e,t),Ws(t);break;case 13:Ns(e,t),Ws(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(zN=Kr())),n&4&&EC(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Gn=(u=Gn)||d,Ns(e,t),Gn=u):Ns(e,t),Ws(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(tt=t,d=t.child;d!==null;){for(h=tt=d;tt!==null;){switch(f=tt,m=f.child,f.tag){case 0:case 11:case 14:case 15:Uh(4,f,f.return);break;case 1:Yc(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(g){Br(n,r,g)}}break;case 5:Yc(f,f.return);break;case 22:if(f.memoizedState!==null){TC(h);continue}}m!==null?(m.return=f,tt=m):TC(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=eO("display",o))}catch(g){Br(t,t.return,g)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Br(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ns(e,t),Ws(t),n&4&&EC(t);break;case 21:break;default:Ns(e,t),Ws(t)}}function Ws(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(CD(r)){var n=r;break e}r=r.return}throw Error(Re(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(uf(s,""),n.flags&=-33);var i=CC(t);Dw(t,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=CC(t);Ow(t,l,o);break;default:throw Error(Re(161))}}catch(c){Br(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function rV(t,e,r){tt=t,TD(t)}function TD(t,e,r){for(var n=(t.mode&1)!==0;tt!==null;){var s=tt,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Cp;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Gn;l=Cp;var u=Gn;if(Cp=o,(Gn=c)&&!u)for(tt=s;tt!==null;)o=tt,c=o.child,o.tag===22&&o.memoizedState!==null?AC(s):c!==null?(c.return=o,tt=c):AC(s);for(;i!==null;)tt=i,TD(i),i=i.sibling;tt=s,Cp=l,Gn=u}PC(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,tt=i):PC(t)}}function PC(t){for(;tt!==null;){var e=tt;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gn||$y(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Gn)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Es(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&hC(e,i,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}hC(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&mf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Re(163))}Gn||e.flags&512&&kw(e)}catch(f){Br(e,e.return,f)}}if(e===t){tt=null;break}if(r=e.sibling,r!==null){r.return=e.return,tt=r;break}tt=e.return}}function TC(t){for(;tt!==null;){var e=tt;if(e===t){tt=null;break}var r=e.sibling;if(r!==null){r.return=e.return,tt=r;break}tt=e.return}}function AC(t){for(;tt!==null;){var e=tt;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{$y(4,e)}catch(c){Br(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){Br(e,s,c)}}var i=e.return;try{kw(e)}catch(c){Br(e,i,c)}break;case 5:var o=e.return;try{kw(e)}catch(c){Br(e,o,c)}}}catch(c){Br(e,e.return,c)}if(e===t){tt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,tt=l;break}tt=e.return}}var nV=Math.ceil,Yg=Zi.ReactCurrentDispatcher,BN=Zi.ReactCurrentOwner,cs=Zi.ReactCurrentBatchConfig,zt=0,vn=null,Jr=null,Rn=0,Ia=0,Xc=el(0),ln=0,Sf=null,Ql=0,Ly=0,UN=0,zh=null,ya=null,zN=0,Iu=1/0,xi=null,Xg=!1,Mw=null,Lo=null,Ep=!1,To=null,Jg=0,qh=0,Rw=null,dg=-1,hg=0;function la(){return zt&6?Kr():dg!==-1?dg:dg=Kr()}function Vo(t){return t.mode&1?zt&2&&Rn!==0?Rn&-Rn:F9.transition!==null?(hg===0&&(hg=fO()),hg):(t=Jt,t!==0||(t=window.event,t=t===void 0?16:bO(t.type)),t):1}function $s(t,e,r,n){if(50<qh)throw qh=0,Rw=null,Error(Re(185));Nm(t,r,n),(!(zt&2)||t!==vn)&&(t===vn&&(!(zt&2)&&(Ly|=r),ln===4&&wo(t,Rn)),Ca(t,n),r===1&&zt===0&&!(e.mode&1)&&(Iu=Kr()+500,Dy&&tl()))}function Ca(t,e){var r=t.callbackNode;FL(t,e);var n=Mg(t,t===vn?Rn:0);if(n===0)r!==null&&V2(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&V2(r),e===1)t.tag===0?V9(IC.bind(null,t)):VO(IC.bind(null,t)),M9(function(){!(zt&6)&&tl()}),r=null;else{switch(mO(n)){case 1:r=pN;break;case 4:r=dO;break;case 16:r=Dg;break;case 536870912:r=hO;break;default:r=Dg}r=$D(r,AD.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function AD(t,e){if(dg=-1,hg=0,zt&6)throw Error(Re(327));var r=t.callbackNode;if(fu()&&t.callbackNode!==r)return null;var n=Mg(t,t===vn?Rn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Zg(t,n);else{e=n;var s=zt;zt|=2;var i=kD();(vn!==t||Rn!==e)&&(xi=null,Iu=Kr()+500,Vl(t,e));do try{iV();break}catch(l){ID(t,l)}while(!0);PN(),Yg.current=i,zt=s,Jr!==null?e=0:(vn=null,Rn=0,e=ln)}if(e!==0){if(e===2&&(s=cw(t),s!==0&&(n=s,e=$w(t,s))),e===1)throw r=Sf,Vl(t,0),wo(t,n),Ca(t,Kr()),r;if(e===6)wo(t,n);else{if(s=t.current.alternate,!(n&30)&&!aV(s)&&(e=Zg(t,n),e===2&&(i=cw(t),i!==0&&(n=i,e=$w(t,i))),e===1))throw r=Sf,Vl(t,0),wo(t,n),Ca(t,Kr()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(Re(345));case 2:wl(t,ya,xi);break;case 3:if(wo(t,n),(n&130023424)===n&&(e=zN+500-Kr(),10<e)){if(Mg(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){la(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=yw(wl.bind(null,t,ya,xi),e);break}wl(t,ya,xi);break;case 4:if(wo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-Rs(n);i=1<<o,o=e[o],o>s&&(s=o),n&=~i}if(n=s,n=Kr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*nV(n/1960))-n,10<n){t.timeoutHandle=yw(wl.bind(null,t,ya,xi),n);break}wl(t,ya,xi);break;case 5:wl(t,ya,xi);break;default:throw Error(Re(329))}}}return Ca(t,Kr()),t.callbackNode===r?AD.bind(null,t):null}function $w(t,e){var r=zh;return t.current.memoizedState.isDehydrated&&(Vl(t,e).flags|=256),t=Zg(t,e),t!==2&&(e=ya,ya=r,e!==null&&Lw(e)),t}function Lw(t){ya===null?ya=t:ya.push.apply(ya,t)}function aV(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Fs(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wo(t,e){for(e&=~UN,e&=~Ly,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Rs(e),n=1<<r;t[r]=-1,e&=~n}}function IC(t){if(zt&6)throw Error(Re(327));fu();var e=Mg(t,0);if(!(e&1))return Ca(t,Kr()),null;var r=Zg(t,e);if(t.tag!==0&&r===2){var n=cw(t);n!==0&&(e=n,r=$w(t,n))}if(r===1)throw r=Sf,Vl(t,0),wo(t,e),Ca(t,Kr()),r;if(r===6)throw Error(Re(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,wl(t,ya,xi),Ca(t,Kr()),null}function qN(t,e){var r=zt;zt|=1;try{return t(e)}finally{zt=r,zt===0&&(Iu=Kr()+500,Dy&&tl())}}function Yl(t){To!==null&&To.tag===0&&!(zt&6)&&fu();var e=zt;zt|=1;var r=cs.transition,n=Jt;try{if(cs.transition=null,Jt=1,t)return t()}finally{Jt=n,cs.transition=r,zt=e,!(zt&6)&&tl()}}function HN(){Ia=Xc.current,Nr(Xc)}function Vl(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,D9(r)),Jr!==null)for(r=Jr.return;r!==null;){var n=r;switch(SN(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Fg();break;case 3:Tu(),Nr(_a),Nr(Jn),DN();break;case 5:ON(n);break;case 4:Tu();break;case 13:Nr(Mr);break;case 19:Nr(Mr);break;case 10:TN(n.type._context);break;case 22:case 23:HN()}r=r.return}if(vn=t,Jr=t=Fo(t.current,null),Rn=Ia=e,ln=0,Sf=null,UN=Ly=Ql=0,ya=zh=null,Il!==null){for(e=0;e<Il.length;e++)if(r=Il[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}Il=null}return t}function ID(t,e){do{var r=Jr;try{if(PN(),lg.current=Qg,Kg){for(var n=$r.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Kg=!1}if(Kl=0,pn=sn=$r=null,Bh=!1,jf=0,BN.current=null,r===null||r.return===null){ln=1,Sf=e,Jr=null;break}e:{var i=t,o=r.return,l=r,c=e;if(e=Rn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=xC(o);if(m!==null){m.flags&=-257,vC(m,o,l,i,e),m.mode&1&&yC(i,u,e),e=m,c=u;var y=e.updateQueue;if(y===null){var g=new Set;g.add(c),e.updateQueue=g}else y.add(c);break e}else{if(!(e&1)){yC(i,u,e),WN();break e}c=Error(Re(426))}}else if(Er&&l.mode&1){var x=xC(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),vC(x,o,l,i,e),CN(Au(c,l));break e}}i=c=Au(c,l),ln!==4&&(ln=2),zh===null?zh=[i]:zh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=mD(i,c,e);dC(i,b);break e;case 1:l=c;var v=i.type,j=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Lo===null||!Lo.has(j)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=pD(i,l,e);dC(i,S);break e}}i=i.return}while(i!==null)}DD(r)}catch(_){e=_,Jr===r&&r!==null&&(Jr=r=r.return);continue}break}while(!0)}function kD(){var t=Yg.current;return Yg.current=Qg,t===null?Qg:t}function WN(){(ln===0||ln===3||ln===2)&&(ln=4),vn===null||!(Ql&268435455)&&!(Ly&268435455)||wo(vn,Rn)}function Zg(t,e){var r=zt;zt|=2;var n=kD();(vn!==t||Rn!==e)&&(xi=null,Vl(t,e));do try{sV();break}catch(s){ID(t,s)}while(!0);if(PN(),zt=r,Yg.current=n,Jr!==null)throw Error(Re(261));return vn=null,Rn=0,ln}function sV(){for(;Jr!==null;)OD(Jr)}function iV(){for(;Jr!==null&&!IL();)OD(Jr)}function OD(t){var e=RD(t.alternate,t,Ia);t.memoizedProps=t.pendingProps,e===null?DD(t):Jr=e,BN.current=null}function DD(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Z9(r,e),r!==null){r.flags&=32767,Jr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ln=6,Jr=null;return}}else if(r=J9(r,e,Ia),r!==null){Jr=r;return}if(e=e.sibling,e!==null){Jr=e;return}Jr=e=t}while(e!==null);ln===0&&(ln=5)}function wl(t,e,r){var n=Jt,s=cs.transition;try{cs.transition=null,Jt=1,oV(t,e,r,n)}finally{cs.transition=s,Jt=n}return null}function oV(t,e,r,n){do fu();while(To!==null);if(zt&6)throw Error(Re(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Re(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(BL(t,i),t===vn&&(Jr=vn=null,Rn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ep||(Ep=!0,$D(Dg,function(){return fu(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=cs.transition,cs.transition=null;var o=Jt;Jt=1;var l=zt;zt|=4,BN.current=null,tV(t,r),PD(r,t),E9(pw),Rg=!!mw,pw=mw=null,t.current=r,rV(r),kL(),zt=l,Jt=o,cs.transition=i}else t.current=r;if(Ep&&(Ep=!1,To=t,Jg=s),i=t.pendingLanes,i===0&&(Lo=null),ML(r.stateNode),Ca(t,Kr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Xg)throw Xg=!1,t=Mw,Mw=null,t;return Jg&1&&t.tag!==0&&fu(),i=t.pendingLanes,i&1?t===Rw?qh++:(qh=0,Rw=t):qh=0,tl(),null}function fu(){if(To!==null){var t=mO(Jg),e=cs.transition,r=Jt;try{if(cs.transition=null,Jt=16>t?16:t,To===null)var n=!1;else{if(t=To,To=null,Jg=0,zt&6)throw Error(Re(331));var s=zt;for(zt|=4,tt=t.current;tt!==null;){var i=tt,o=i.child;if(tt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(tt=u;tt!==null;){var d=tt;switch(d.tag){case 0:case 11:case 15:Uh(8,d,i)}var h=d.child;if(h!==null)h.return=d,tt=h;else for(;tt!==null;){d=tt;var f=d.sibling,m=d.return;if(SD(d),d===u){tt=null;break}if(f!==null){f.return=m,tt=f;break}tt=m}}}var y=i.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(g!==null)}}tt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,tt=o;else e:for(;tt!==null;){if(i=tt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Uh(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,tt=b;break e}tt=i.return}}var v=t.current;for(tt=v;tt!==null;){o=tt;var j=o.child;if(o.subtreeFlags&2064&&j!==null)j.return=o,tt=j;else e:for(o=v;tt!==null;){if(l=tt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:$y(9,l)}}catch(_){Br(l,l.return,_)}if(l===o){tt=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,tt=S;break e}tt=l.return}}if(zt=s,tl(),Js&&typeof Js.onPostCommitFiberRoot=="function")try{Js.onPostCommitFiberRoot(Ty,t)}catch{}n=!0}return n}finally{Jt=r,cs.transition=e}}return!1}function kC(t,e,r){e=Au(r,e),e=mD(t,e,1),t=$o(t,e,1),e=la(),t!==null&&(Nm(t,1,e),Ca(t,e))}function Br(t,e,r){if(t.tag===3)kC(t,t,r);else for(;e!==null;){if(e.tag===3){kC(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Lo===null||!Lo.has(n))){t=Au(r,t),t=pD(e,t,1),e=$o(e,t,1),t=la(),e!==null&&(Nm(e,1,t),Ca(e,t));break}}e=e.return}}function lV(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=la(),t.pingedLanes|=t.suspendedLanes&r,vn===t&&(Rn&r)===r&&(ln===4||ln===3&&(Rn&130023424)===Rn&&500>Kr()-zN?Vl(t,0):UN|=r),Ca(t,e)}function MD(t,e){e===0&&(t.mode&1?(e=yp,yp<<=1,!(yp&130023424)&&(yp=4194304)):e=1);var r=la();t=zi(t,e),t!==null&&(Nm(t,e,r),Ca(t,r))}function cV(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),MD(t,r)}function uV(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Re(314))}n!==null&&n.delete(e),MD(t,r)}var RD;RD=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||_a.current)wa=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return wa=!1,X9(t,e,r);wa=!!(t.flags&131072)}else wa=!1,Er&&e.flags&1048576&&FO(e,zg,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;ug(t,e),t=e.pendingProps;var s=Cu(e,Jn.current);hu(e,r),s=RN(null,e,n,t,s,r);var i=$N();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Sa(n)?(i=!0,Bg(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,IN(e),s.updater=Ry,e.stateNode=s,s._reactInternals=e,_w(e,n,t,r),e=Ew(null,e,n,!0,i,r)):(e.tag=0,Er&&i&&_N(e),aa(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(ug(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=hV(n),t=Es(n,t),s){case 0:e=Cw(null,e,n,t,r);break e;case 1:e=jC(null,e,n,t,r);break e;case 11:e=bC(null,e,n,t,r);break e;case 14:e=wC(null,e,n,Es(n.type,t),r);break e}throw Error(Re(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Es(n,s),Cw(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Es(n,s),jC(t,e,n,s,r);case 3:e:{if(vD(e),t===null)throw Error(Re(387));n=e.pendingProps,i=e.memoizedState,s=i.element,WO(t,e),Wg(e,n,null,r);var o=e.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Au(Error(Re(423)),e),e=NC(t,e,n,r,s);break e}else if(n!==s){s=Au(Error(Re(424)),e),e=NC(t,e,n,r,s);break e}else for(Ra=Ro(e.stateNode.containerInfo.firstChild),Va=e,Er=!0,As=null,r=qO(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Eu(),n===s){e=qi(t,e,r);break e}aa(t,e,n,r)}e=e.child}return e;case 5:return GO(e),t===null&&ww(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,gw(n,s)?o=null:i!==null&&gw(n,i)&&(e.flags|=32),xD(t,e),aa(t,e,o,r),e.child;case 6:return t===null&&ww(e),null;case 13:return bD(t,e,r);case 4:return kN(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Pu(e,null,n,r):aa(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Es(n,s),bC(t,e,n,s,r);case 7:return aa(t,e,e.pendingProps,r),e.child;case 8:return aa(t,e,e.pendingProps.children,r),e.child;case 12:return aa(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,yr(qg,n._currentValue),n._currentValue=o,i!==null)if(Fs(i.value,o)){if(i.children===s.children&&!_a.current){e=qi(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=ki(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),jw(i.return,r,e),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Re(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),jw(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}aa(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,hu(e,r),s=fs(s),n=n(s),e.flags|=1,aa(t,e,n,r),e.child;case 14:return n=e.type,s=Es(n,e.pendingProps),s=Es(n.type,s),wC(t,e,n,s,r);case 15:return gD(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Es(n,s),ug(t,e),e.tag=1,Sa(n)?(t=!0,Bg(e)):t=!1,hu(e,r),fD(e,n,s),_w(e,n,s,r),Ew(null,e,n,!0,t,r);case 19:return wD(t,e,r);case 22:return yD(t,e,r)}throw Error(Re(156,e.tag))};function $D(t,e){return uO(t,e)}function dV(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function as(t,e,r,n){return new dV(t,e,r,n)}function GN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function hV(t){if(typeof t=="function")return GN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===hN)return 11;if(t===fN)return 14}return 2}function Fo(t,e){var r=t.alternate;return r===null?(r=as(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function fg(t,e,r,n,s,i){var o=2;if(n=t,typeof t=="function")GN(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Bc:return Fl(r.children,s,i,e);case dN:o=8,s|=8;break;case Kb:return t=as(12,r,e,s|2),t.elementType=Kb,t.lanes=i,t;case Qb:return t=as(13,r,e,s),t.elementType=Qb,t.lanes=i,t;case Yb:return t=as(19,r,e,s),t.elementType=Yb,t.lanes=i,t;case Gk:return Vy(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Hk:o=10;break e;case Wk:o=9;break e;case hN:o=11;break e;case fN:o=14;break e;case yo:o=16,n=null;break e}throw Error(Re(130,t==null?t:typeof t,""))}return e=as(o,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function Fl(t,e,r,n){return t=as(7,t,n,e),t.lanes=r,t}function Vy(t,e,r,n){return t=as(22,t,n,e),t.elementType=Gk,t.lanes=r,t.stateNode={isHidden:!1},t}function Kv(t,e,r){return t=as(6,t,null,e),t.lanes=r,t}function Qv(t,e,r){return e=as(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function fV(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tv(0),this.expirationTimes=Tv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tv(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function KN(t,e,r,n,s,i,o,l,c){return t=new fV(t,e,r,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=as(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},IN(i),t}function mV(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function LD(t){if(!t)return Wo;t=t._reactInternals;e:{if(pc(t)!==t||t.tag!==1)throw Error(Re(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Sa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Re(171))}if(t.tag===1){var r=t.type;if(Sa(r))return LO(t,r,e)}return e}function VD(t,e,r,n,s,i,o,l,c){return t=KN(r,n,!0,t,s,i,o,l,c),t.context=LD(null),r=t.current,n=la(),s=Vo(r),i=ki(n,s),i.callback=e??null,$o(r,i,s),t.current.lanes=s,Nm(t,s,n),Ca(t,n),t}function Fy(t,e,r,n){var s=e.current,i=la(),o=Vo(s);return r=LD(r),e.context===null?e.context=r:e.pendingContext=r,e=ki(i,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=$o(s,e,o),t!==null&&($s(t,s,o,i),og(t,s,o)),o}function e0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function OC(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function QN(t,e){OC(t,e),(t=t.alternate)&&OC(t,e)}function pV(){return null}var FD=typeof reportError=="function"?reportError:function(t){console.error(t)};function YN(t){this._internalRoot=t}By.prototype.render=YN.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Re(409));Fy(t,e,null,null)};By.prototype.unmount=YN.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Yl(function(){Fy(null,t,null,null)}),e[Ui]=null}};function By(t){this._internalRoot=t}By.prototype.unstable_scheduleHydration=function(t){if(t){var e=yO();t={blockedOn:null,target:t,priority:e};for(var r=0;r<bo.length&&e!==0&&e<bo[r].priority;r++);bo.splice(r,0,t),r===0&&vO(t)}};function XN(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Uy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function DC(){}function gV(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=e0(o);i.call(u)}}var o=VD(e,n,t,0,null,!1,!1,"",DC);return t._reactRootContainer=o,t[Ui]=o.current,yf(t.nodeType===8?t.parentNode:t),Yl(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=e0(c);l.call(u)}}var c=KN(t,0,!1,null,null,!1,!1,"",DC);return t._reactRootContainer=c,t[Ui]=c.current,yf(t.nodeType===8?t.parentNode:t),Yl(function(){Fy(e,c,r,n)}),c}function zy(t,e,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=e0(o);l.call(c)}}Fy(e,o,t,s)}else o=gV(r,e,t,s,n);return e0(o)}pO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Sh(e.pendingLanes);r!==0&&(gN(e,r|1),Ca(e,Kr()),!(zt&6)&&(Iu=Kr()+500,tl()))}break;case 13:Yl(function(){var n=zi(t,1);if(n!==null){var s=la();$s(n,t,1,s)}}),QN(t,1)}};yN=function(t){if(t.tag===13){var e=zi(t,134217728);if(e!==null){var r=la();$s(e,t,134217728,r)}QN(t,134217728)}};gO=function(t){if(t.tag===13){var e=Vo(t),r=zi(t,e);if(r!==null){var n=la();$s(r,t,e,n)}QN(t,e)}};yO=function(){return Jt};xO=function(t,e){var r=Jt;try{return Jt=t,e()}finally{Jt=r}};iw=function(t,e,r){switch(e){case"input":if(Zb(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Oy(n);if(!s)throw Error(Re(90));Qk(n),Zb(n,s)}}}break;case"textarea":Xk(t,r);break;case"select":e=r.value,e!=null&&lu(t,!!r.multiple,e,!1)}};aO=qN;sO=Yl;var yV={usingClientEntryPoint:!1,Events:[Sm,Hc,Oy,rO,nO,qN]},oh={findFiberByHostInstance:Al,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xV={bundleType:oh.bundleType,version:oh.version,rendererPackageName:oh.rendererPackageName,rendererConfig:oh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=lO(t),t===null?null:t.stateNode},findFiberByHostInstance:oh.findFiberByHostInstance||pV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pp.isDisabled&&Pp.supportsFiber)try{Ty=Pp.inject(xV),Js=Pp}catch{}}qa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yV;qa.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!XN(e))throw Error(Re(200));return mV(t,e,null,r)};qa.createRoot=function(t,e){if(!XN(t))throw Error(Re(299));var r=!1,n="",s=FD;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=KN(t,1,!1,null,null,r,!1,n,s),t[Ui]=e.current,yf(t.nodeType===8?t.parentNode:t),new YN(e)};qa.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Re(188)):(t=Object.keys(t).join(","),Error(Re(268,t)));return t=lO(e),t=t===null?null:t.stateNode,t};qa.flushSync=function(t){return Yl(t)};qa.hydrate=function(t,e,r){if(!Uy(e))throw Error(Re(200));return zy(null,t,e,!0,r)};qa.hydrateRoot=function(t,e,r){if(!XN(t))throw Error(Re(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=FD;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=VD(e,null,t,1,r??null,s,!1,i,o),t[Ui]=e.current,yf(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new By(e)};qa.render=function(t,e,r){if(!Uy(e))throw Error(Re(200));return zy(null,t,e,!1,r)};qa.unmountComponentAtNode=function(t){if(!Uy(t))throw Error(Re(40));return t._reactRootContainer?(Yl(function(){zy(null,null,t,!1,function(){t._reactRootContainer=null,t[Ui]=null})}),!0):!1};qa.unstable_batchedUpdates=qN;qa.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Uy(r))throw Error(Re(200));if(t==null||t._reactInternals===void 0)throw Error(Re(38));return zy(t,e,r,!1,n)};qa.version="18.3.1-next-f1338f8080-20240426";function BD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(BD)}catch(t){console.error(t)}}BD(),Bk.exports=qa;var vV=Bk.exports,UD,MC=vV;UD=MC.createRoot,MC.hydrateRoot;var zD={exports:{}},qD={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Em=I;function bV(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wV=typeof Object.is=="function"?Object.is:bV,jV=Em.useSyncExternalStore,NV=Em.useRef,_V=Em.useEffect,SV=Em.useMemo,CV=Em.useDebugValue;qD.useSyncExternalStoreWithSelector=function(t,e,r,n,s){var i=NV(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=SV(function(){function c(m){if(!u){if(u=!0,d=m,m=n(m),s!==void 0&&o.hasValue){var y=o.value;if(s(y,m))return h=y}return h=m}if(y=h,wV(d,m))return y;var g=n(m);return s!==void 0&&s(y,g)?(d=m,y):(d=m,h=g)}var u=!1,d,h,f=r===void 0?null:r;return[function(){return c(e())},f===null?void 0:function(){return c(f())}]},[e,r,n,s]);var l=jV(t,i[0],i[1]);return _V(function(){o.hasValue=!0,o.value=l},[l]),CV(l),l};zD.exports=qD;var EV=zD.exports;function PV(t){t()}function TV(){let t=null,e=null;return{clear(){t=null,e=null},notify(){PV(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=e={callback:r,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!n||t===null||(n=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var RC={notify(){},get:()=>[]};function AV(t,e){let r,n=RC,s=0,i=!1;function o(g){d();const x=n.subscribe(g);let b=!1;return()=>{b||(b=!0,x(),h())}}function l(){n.notify()}function c(){y.onStateChange&&y.onStateChange()}function u(){return i}function d(){s++,r||(r=t.subscribe(c),n=TV())}function h(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=RC)}function f(){i||(i=!0,d())}function m(){i&&(i=!1,h())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:f,tryUnsubscribe:m,getListeners:()=>n};return y}var IV=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kV=IV(),OV=()=>typeof navigator<"u"&&navigator.product==="ReactNative",DV=OV(),MV=()=>kV||DV?I.useLayoutEffect:I.useEffect,RV=MV(),Yv=Symbol.for("react-redux-context"),Xv=typeof globalThis<"u"?globalThis:{};function $V(){if(!I.createContext)return{};const t=Xv[Yv]??(Xv[Yv]=new Map);let e=t.get(I.createContext);return e||(e=I.createContext(null),t.set(I.createContext,e)),e}var Go=$V();function LV(t){const{children:e,context:r,serverState:n,store:s}=t,i=I.useMemo(()=>{const c=AV(s);return{store:s,subscription:c,getServerState:n?()=>n:void 0}},[s,n]),o=I.useMemo(()=>s.getState(),[s]);RV(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=r||Go;return I.createElement(l.Provider,{value:i},e)}var VV=LV;function JN(t=Go){return function(){return I.useContext(t)}}var HD=JN();function WD(t=Go){const e=t===Go?HD:JN(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var FV=WD();function BV(t=Go){const e=t===Go?FV:WD(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var UV=BV(),zV=(t,e)=>t===e;function qV(t=Go){const e=t===Go?HD:JN(t),r=(n,s={})=>{const{equalityFn:i=zV}=typeof s=="function"?{equalityFn:s}:s,o=e(),{store:l,subscription:c,getServerState:u}=o;I.useRef(!0);const d=I.useCallback({[n.name](f){return n(f)}}[n.name],[n]),h=EV.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,u||l.getState,d,i);return I.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var HV=qV();function mg(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mg=function(r){return typeof r}:mg=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},mg(t)}function WV(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GV(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function KV(t,e,r){return e&&GV(t.prototype,e),t}function QV(t,e){return e&&(mg(e)==="object"||typeof e=="function")?e:pg(t)}function Vw(t){return Vw=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Vw(t)}function pg(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YV(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fw(t,e)}function Fw(t,e){return Fw=Object.setPrototypeOf||function(n,s){return n.__proto__=s,n},Fw(t,e)}function gg(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var GD=function(t){YV(e,t);function e(){var r,n;WV(this,e);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n=QV(this,(r=Vw(e)).call.apply(r,[this].concat(i))),gg(pg(n),"state",{bootstrapped:!1}),gg(pg(n),"_unsubscribe",void 0),gg(pg(n),"handlePersistorState",function(){var l=n.props.persistor,c=l.getState(),u=c.bootstrapped;u&&(n.props.onBeforeLift?Promise.resolve(n.props.onBeforeLift()).finally(function(){return n.setState({bootstrapped:!0})}):n.setState({bootstrapped:!0}),n._unsubscribe&&n._unsubscribe())}),n}return KV(e,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),e}(I.PureComponent);gg(GD,"defaultProps",{children:null,loading:null});function Tn(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var XV=typeof Symbol=="function"&&Symbol.observable||"@@observable",$C=XV,Jv=()=>Math.random().toString(36).substring(7).split("").join("."),JV={INIT:`@@redux/INIT${Jv()}`,REPLACE:`@@redux/REPLACE${Jv()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Jv()}`},t0=JV;function ZN(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function e_(t,e,r){if(typeof t!="function")throw new Error(Tn(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Tn(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Tn(1));return r(e_)(t,e)}let n=t,s=e,i=new Map,o=i,l=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((x,b)=>{o.set(b,x)}))}function d(){if(c)throw new Error(Tn(3));return s}function h(x){if(typeof x!="function")throw new Error(Tn(4));if(c)throw new Error(Tn(5));let b=!0;u();const v=l++;return o.set(v,x),function(){if(b){if(c)throw new Error(Tn(6));b=!1,u(),o.delete(v),i=null}}}function f(x){if(!ZN(x))throw new Error(Tn(7));if(typeof x.type>"u")throw new Error(Tn(8));if(typeof x.type!="string")throw new Error(Tn(17));if(c)throw new Error(Tn(9));try{c=!0,s=n(s,x)}finally{c=!1}return(i=o).forEach(v=>{v()}),x}function m(x){if(typeof x!="function")throw new Error(Tn(10));n=x,f({type:t0.REPLACE})}function y(){const x=h;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(Tn(11));function v(){const S=b;S.next&&S.next(d())}return v(),{unsubscribe:x(v)}},[$C](){return this}}}return f({type:t0.INIT}),{dispatch:f,subscribe:h,getState:d,replaceReducer:m,[$C]:y}}function ZV(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:t0.INIT})>"u")throw new Error(Tn(12));if(typeof r(void 0,{type:t0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Tn(13))})}function KD(t){const e=Object.keys(t),r={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let s;try{ZV(r)}catch(i){s=i}return function(o={},l){if(s)throw s;let c=!1;const u={};for(let d=0;d<n.length;d++){const h=n[d],f=r[h],m=o[h],y=f(m,l);if(typeof y>"u")throw l&&l.type,new Error(Tn(14));u[h]=y,c=c||y!==m}return c=c||n.length!==Object.keys(o).length,c?u:o}}function r0(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function eF(...t){return e=>(r,n)=>{const s=e(r,n);let i=()=>{throw new Error(Tn(15))};const o={getState:s.getState,dispatch:(c,...u)=>i(c,...u)},l=t.map(c=>c(o));return i=r0(...l)(s.dispatch),{...s,dispatch:i}}}function tF(t){return ZN(t)&&"type"in t&&typeof t.type=="string"}var QD=Symbol.for("immer-nothing"),LC=Symbol.for("immer-draftable"),Ua=Symbol.for("immer-state");function Os(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var ku=Object.getPrototypeOf;function Xl(t){return!!t&&!!t[Ua]}function Hi(t){var e;return t?YD(t)||Array.isArray(t)||!!t[LC]||!!((e=t.constructor)!=null&&e[LC])||Hy(t)||Wy(t):!1}var rF=Object.prototype.constructor.toString();function YD(t){if(!t||typeof t!="object")return!1;const e=ku(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===rF}function n0(t,e){qy(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function qy(t){const e=t[Ua];return e?e.type_:Array.isArray(t)?1:Hy(t)?2:Wy(t)?3:0}function Bw(t,e){return qy(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function XD(t,e,r){const n=qy(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function nF(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Hy(t){return t instanceof Map}function Wy(t){return t instanceof Set}function jl(t){return t.copy_||t.base_}function Uw(t,e){if(Hy(t))return new Map(t);if(Wy(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=YD(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Ua];let s=Reflect.ownKeys(n);for(let i=0;i<s.length;i++){const o=s[i],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(ku(t),n)}else{const n=ku(t);if(n!==null&&r)return{...t};const s=Object.create(n);return Object.assign(s,t)}}function t_(t,e=!1){return Gy(t)||Xl(t)||!Hi(t)||(qy(t)>1&&(t.set=t.add=t.clear=t.delete=aF),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>t_(n,!0))),t}function aF(){Os(2)}function Gy(t){return Object.isFrozen(t)}var sF={};function Jl(t){const e=sF[t];return e||Os(0,t),e}var Cf;function JD(){return Cf}function iF(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function VC(t,e){e&&(Jl("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function zw(t){qw(t),t.drafts_.forEach(oF),t.drafts_=null}function qw(t){t===Cf&&(Cf=t.parent_)}function FC(t){return Cf=iF(Cf,t)}function oF(t){const e=t[Ua];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function BC(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Ua].modified_&&(zw(e),Os(4)),Hi(t)&&(t=a0(e,t),e.parent_||s0(e,t)),e.patches_&&Jl("Patches").generateReplacementPatches_(r[Ua].base_,t,e.patches_,e.inversePatches_)):t=a0(e,r,[]),zw(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==QD?t:void 0}function a0(t,e,r){if(Gy(e))return e;const n=e[Ua];if(!n)return n0(e,(s,i)=>UC(t,n,e,s,i,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return s0(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let i=s,o=!1;n.type_===3&&(i=new Set(s),s.clear(),o=!0),n0(i,(l,c)=>UC(t,n,s,l,c,r,o)),s0(t,s,!1),r&&t.patches_&&Jl("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function UC(t,e,r,n,s,i,o){if(Xl(s)){const l=i&&e&&e.type_!==3&&!Bw(e.assigned_,n)?i.concat(n):void 0,c=a0(t,s,l);if(XD(r,n,c),Xl(c))t.canAutoFreeze_=!1;else return}else o&&r.add(s);if(Hi(s)&&!Gy(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;a0(t,s),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&s0(t,s)}}function s0(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&t_(e,r)}function lF(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:JD(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,i=r_;r&&(s=[n],i=Ef);const{revoke:o,proxy:l}=Proxy.revocable(s,i);return n.draft_=l,n.revoke_=o,l}var r_={get(t,e){if(e===Ua)return t;const r=jl(t);if(!Bw(r,e))return cF(t,r,e);const n=r[e];return t.finalized_||!Hi(n)?n:n===Zv(t.base_,e)?(eb(t),t.copy_[e]=Ww(n,t)):n},has(t,e){return e in jl(t)},ownKeys(t){return Reflect.ownKeys(jl(t))},set(t,e,r){const n=ZD(jl(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const s=Zv(jl(t),e),i=s==null?void 0:s[Ua];if(i&&i.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(nF(r,s)&&(r!==void 0||Bw(t.base_,e)))return!0;eb(t),Hw(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Zv(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,eb(t),Hw(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=jl(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Os(11)},getPrototypeOf(t){return ku(t.base_)},setPrototypeOf(){Os(12)}},Ef={};n0(r_,(t,e)=>{Ef[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ef.deleteProperty=function(t,e){return Ef.set.call(this,t,e,void 0)};Ef.set=function(t,e,r){return r_.set.call(this,t[0],e,r,t[0])};function Zv(t,e){const r=t[Ua];return(r?jl(r):t)[e]}function cF(t,e,r){var s;const n=ZD(e,r);return n?"value"in n?n.value:(s=n.get)==null?void 0:s.call(t.draft_):void 0}function ZD(t,e){if(!(e in t))return;let r=ku(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=ku(r)}}function Hw(t){t.modified_||(t.modified_=!0,t.parent_&&Hw(t.parent_))}function eb(t){t.copy_||(t.copy_=Uw(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var uF=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const i=r;r=e;const o=this;return function(c=i,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&Os(6),n!==void 0&&typeof n!="function"&&Os(7);let s;if(Hi(e)){const i=FC(this),o=Ww(e,void 0);let l=!0;try{s=r(o),l=!1}finally{l?zw(i):qw(i)}return VC(i,n),BC(s,i)}else if(!e||typeof e!="object"){if(s=r(e),s===void 0&&(s=e),s===QD&&(s=void 0),this.autoFreeze_&&t_(s,!0),n){const i=[],o=[];Jl("Patches").generateReplacementPatches_(e,s,i,o),n(i,o)}return s}else Os(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,s;return[this.produce(e,r,(o,l)=>{n=o,s=l}),n,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Hi(t)||Os(8),Xl(t)&&(t=dF(t));const e=FC(this),r=Ww(t,void 0);return r[Ua].isManual_=!0,qw(e),r}finishDraft(t,e){const r=t&&t[Ua];(!r||!r.isManual_)&&Os(9);const{scope_:n}=r;return VC(n,e),BC(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const s=e[r];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}r>-1&&(e=e.slice(r+1));const n=Jl("Patches").applyPatches_;return Xl(t)?n(t,e):this.produce(t,s=>n(s,e))}};function Ww(t,e){const r=Hy(t)?Jl("MapSet").proxyMap_(t,e):Wy(t)?Jl("MapSet").proxySet_(t,e):lF(t,e);return(e?e.scope_:JD()).drafts_.push(r),r}function dF(t){return Xl(t)||Os(10,t),e3(t)}function e3(t){if(!Hi(t)||Gy(t))return t;const e=t[Ua];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Uw(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Uw(t,!0);return n0(r,(n,s)=>{XD(r,n,e3(s))}),e&&(e.finalized_=!1),r}var za=new uF,t3=za.produce;za.produceWithPatches.bind(za);za.setAutoFreeze.bind(za);za.setUseStrictShallowCopy.bind(za);za.applyPatches.bind(za);za.createDraft.bind(za);za.finishDraft.bind(za);function hF(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function fF(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function mF(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var zC=t=>Array.isArray(t)?t:[t];function pF(t){const e=Array.isArray(t[0])?t[0]:t;return mF(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function gF(t,e){const r=[],{length:n}=t;for(let s=0;s<n;s++)r.push(t[s].apply(null,e));return r}var yF=class{constructor(t){this.value=t}deref(){return this.value}},xF=typeof WeakRef<"u"?WeakRef:yF,vF=0,qC=1;function Tp(){return{s:vF,v:void 0,o:null,p:null}}function r3(t,e={}){let r=Tp();const{resultEqualityCheck:n}=e;let s,i=0;function o(){var h;let l=r;const{length:c}=arguments;for(let f=0,m=c;f<m;f++){const y=arguments[f];if(typeof y=="function"||typeof y=="object"&&y!==null){let g=l.o;g===null&&(l.o=g=new WeakMap);const x=g.get(y);x===void 0?(l=Tp(),g.set(y,l)):l=x}else{let g=l.p;g===null&&(l.p=g=new Map);const x=g.get(y);x===void 0?(l=Tp(),g.set(y,l)):l=x}}const u=l;let d;if(l.s===qC)d=l.v;else if(d=t.apply(null,arguments),i++,n){const f=((h=s==null?void 0:s.deref)==null?void 0:h.call(s))??s;f!=null&&n(f,d)&&(d=f,i!==0&&i--),s=typeof d=="object"&&d!==null||typeof d=="function"?new xF(d):d}return u.s=qC,u.v=d,d}return o.clearCache=()=>{r=Tp(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function bF(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...s)=>{let i=0,o=0,l,c={},u=s.pop();typeof u=="object"&&(c=u,u=s.pop()),hF(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:h,memoizeOptions:f=[],argsMemoize:m=r3,argsMemoizeOptions:y=[],devModeChecks:g={}}=d,x=zC(f),b=zC(y),v=pF(s),j=h(function(){return i++,u.apply(null,arguments)},...x),S=m(function(){o++;const C=gF(v,arguments);return l=j.apply(null,C),l},...b);return Object.assign(S,{resultFunc:u,memoizedResultFunc:j,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var wd=bF(r3),wF=Object.assign((t,e=wd)=>{fF(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(i=>t[i]);return e(n,(...i)=>i.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>wF});function n3(t){return({dispatch:r,getState:n})=>s=>i=>typeof i=="function"?i(r,n,t):s(i)}var jF=n3(),NF=n3,_F=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?r0:r0.apply(null,arguments)},SF=t=>t&&typeof t.match=="function";function Hh(t,e){function r(...n){if(e){let s=e(...n);if(!s)throw new Error(Oi(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>tF(n)&&n.type===t,r}var a3=class Eh extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Eh.prototype)}static get[Symbol.species](){return Eh}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Eh(...e[0].concat(this)):new Eh(...e.concat(this))}};function HC(t){return Hi(t)?t3(t,()=>{}):t}function Ap(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function CF(t){return typeof t=="boolean"}var EF=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new a3;return r&&(CF(r)?o.push(jF):o.push(NF(r.extraArgument))),o},PF="RTK_autoBatch",WC=t=>e=>{setTimeout(e,t)},TF=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let s=!0,i=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:WC(10):t.type==="callback"?t.queueNotification:WC(t.timeout),u=()=>{o=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const h=()=>s&&d(),f=n.subscribe(h);return l.add(d),()=>{f(),l.delete(d)}},dispatch(d){var h;try{return s=!((h=d==null?void 0:d.meta)!=null&&h[PF]),i=!s,i&&(o||(o=!0,c(u))),n.dispatch(d)}finally{s=!0}}})},AF=t=>function(r){const{autoBatch:n=!0}=r??{};let s=new a3(t);return n&&s.push(TF(typeof n=="object"?n:void 0)),s};function IF(t){const e=EF(),{reducer:r=void 0,middleware:n,devTools:s=!0,duplicateMiddlewareCheck:i=!0,preloadedState:o=void 0,enhancers:l=void 0}=t||{};let c;if(typeof r=="function")c=r;else if(ZN(r))c=KD(r);else throw new Error(Oi(1));let u;typeof n=="function"?u=n(e):u=e();let d=r0;s&&(d=_F({trace:!1,...typeof s=="object"&&s}));const h=eF(...u),f=AF(h);let m=typeof l=="function"?l(f):f();const y=d(...m);return e_(c,o,y)}function s3(t){const e={},r=[];let n;const s={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Oi(28));if(l in e)throw new Error(Oi(29));return e[l]=o,s},addMatcher(i,o){return r.push({matcher:i,reducer:o}),s},addDefaultCase(i){return n=i,s}};return t(s),[e,r,n]}function kF(t){return typeof t=="function"}function OF(t,e){let[r,n,s]=s3(e),i;if(kF(t))i=()=>HC(t());else{const l=HC(t);i=()=>l}function o(l=i(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,h)=>{if(h)if(Xl(d)){const m=h(d,c);return m===void 0?d:m}else{if(Hi(d))return t3(d,f=>h(f,c));{const f=h(d,c);if(f===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return d},l)}return o.getInitialState=i,o}var DF=(t,e)=>SF(t)?t.match(e):t(e);function MF(...t){return e=>t.some(r=>DF(r,e))}var RF="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",$F=(t=21)=>{let e="",r=t;for(;r--;)e+=RF[Math.random()*64|0];return e},LF=["name","message","stack","code"],tb=class{constructor(t,e){Nv(this,"_type");this.payload=t,this.meta=e}},GC=class{constructor(t,e){Nv(this,"_type");this.payload=t,this.meta=e}},VF=t=>{if(typeof t=="object"&&t!==null){const e={};for(const r of LF)typeof t[r]=="string"&&(e[r]=t[r]);return e}return{message:String(t)}},KC="External signal was aborted",rl=(()=>{function t(e,r,n){const s=Hh(e+"/fulfilled",(c,u,d,h)=>({payload:c,meta:{...h||{},arg:d,requestId:u,requestStatus:"fulfilled"}})),i=Hh(e+"/pending",(c,u,d)=>({payload:void 0,meta:{...d||{},arg:u,requestId:c,requestStatus:"pending"}})),o=Hh(e+"/rejected",(c,u,d,h,f)=>({payload:h,error:(n&&n.serializeError||VF)(c||"Rejected"),meta:{...f||{},arg:d,requestId:u,rejectedWithValue:!!h,requestStatus:"rejected",aborted:(c==null?void 0:c.name)==="AbortError",condition:(c==null?void 0:c.name)==="ConditionError"}}));function l(c,{signal:u}={}){return(d,h,f)=>{const m=n!=null&&n.idGenerator?n.idGenerator(c):$F(),y=new AbortController;let g,x;function b(j){x=j,y.abort()}u&&(u.aborted?b(KC):u.addEventListener("abort",()=>b(KC),{once:!0}));const v=async function(){var _,C;let j;try{let N=(_=n==null?void 0:n.condition)==null?void 0:_.call(n,c,{getState:h,extra:f});if(BF(N)&&(N=await N),N===!1||y.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const w=new Promise((E,k)=>{g=()=>{k({name:"AbortError",message:x||"Aborted"})},y.signal.addEventListener("abort",g)});d(i(m,c,(C=n==null?void 0:n.getPendingMeta)==null?void 0:C.call(n,{requestId:m,arg:c},{getState:h,extra:f}))),j=await Promise.race([w,Promise.resolve(r(c,{dispatch:d,getState:h,extra:f,requestId:m,signal:y.signal,abort:b,rejectWithValue:(E,k)=>new tb(E,k),fulfillWithValue:(E,k)=>new GC(E,k)})).then(E=>{if(E instanceof tb)throw E;return E instanceof GC?s(E.payload,m,c,E.meta):s(E,m,c)})])}catch(N){j=N instanceof tb?o(null,m,c,N.payload,N.meta):o(N,m,c)}finally{g&&y.signal.removeEventListener("abort",g)}return n&&!n.dispatchConditionRejection&&o.match(j)&&j.meta.condition||d(j),j}();return Object.assign(v,{abort:b,requestId:m,arg:c,unwrap(){return v.then(FF)}})}}return Object.assign(l,{pending:i,rejected:o,fulfilled:s,settled:MF(o,s),typePrefix:e})}return t.withTypes=()=>t,t})();function FF(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function BF(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var UF=Symbol.for("rtk-slice-createasyncthunk");function zF(t,e){return`${t}/${e}`}function qF({creators:t}={}){var r;const e=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[UF];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(Oi(11));typeof process<"u";const l=(typeof s.reducers=="function"?s.reducers(WF()):s.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,_){const C=typeof S=="string"?S:S.type;if(!C)throw new Error(Oi(12));if(C in u.sliceCaseReducersByType)throw new Error(Oi(13));return u.sliceCaseReducersByType[C]=_,d},addMatcher(S,_){return u.sliceMatchers.push({matcher:S,reducer:_}),d},exposeAction(S,_){return u.actionCreators[S]=_,d},exposeCaseReducer(S,_){return u.sliceCaseReducersByName[S]=_,d}};c.forEach(S=>{const _=l[S],C={reducerName:S,type:zF(i,S),createNotation:typeof s.reducers=="function"};KF(_)?YF(C,_,d,e):GF(C,_,d)});function h(){const[S={},_=[],C=void 0]=typeof s.extraReducers=="function"?s3(s.extraReducers):[s.extraReducers],N={...S,...u.sliceCaseReducersByType};return OF(s.initialState,w=>{for(let E in N)w.addCase(E,N[E]);for(let E of u.sliceMatchers)w.addMatcher(E.matcher,E.reducer);for(let E of _)w.addMatcher(E.matcher,E.reducer);C&&w.addDefaultCase(C)})}const f=S=>S,m=new Map,y=new WeakMap;let g;function x(S,_){return g||(g=h()),g(S,_)}function b(){return g||(g=h()),g.getInitialState()}function v(S,_=!1){function C(w){let E=w[S];return typeof E>"u"&&_&&(E=Ap(y,C,b)),E}function N(w=f){const E=Ap(m,_,()=>new WeakMap);return Ap(E,w,()=>{const k={};for(const[T,P]of Object.entries(s.selectors??{}))k[T]=HF(P,w,()=>Ap(y,w,b),_);return k})}return{reducerPath:S,getSelectors:N,get selectors(){return N(C)},selectSlice:C}}const j={name:i,reducer:x,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...v(o),injectInto(S,{reducerPath:_,...C}={}){const N=_??o;return S.inject({reducerPath:N,reducer:x},C),{...j,...v(N,!0)}}};return j}}function HF(t,e,r,n){function s(i,...o){let l=e(i);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return s.unwrapped=t,s}var i3=qF();function WF(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function GF({type:t,reducerName:e,createNotation:r},n,s){let i,o;if("reducer"in n){if(r&&!QF(n))throw new Error(Oi(17));i=n.reducer,o=n.prepare}else i=n;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?Hh(t,o):Hh(t))}function KF(t){return t._reducerDefinitionType==="asyncThunk"}function QF(t){return t._reducerDefinitionType==="reducerWithPrepare"}function YF({type:t,reducerName:e},r,n,s){if(!s)throw new Error(Oi(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,h=s(t,i,d);n.exposeAction(e,h),o&&n.addCase(h.fulfilled,o),l&&n.addCase(h.pending,l),c&&n.addCase(h.rejected,c),u&&n.addMatcher(h.settled,u),n.exposeCaseReducer(e,{fulfilled:o||Ip,pending:l||Ip,rejected:c||Ip,settled:u||Ip})}function Ip(){}function Oi(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var n_="persist:",o3="persist/FLUSH",a_="persist/REHYDRATE",l3="persist/PAUSE",c3="persist/PERSIST",u3="persist/PURGE",d3="persist/REGISTER",XF=-1;function yg(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yg=function(r){return typeof r}:yg=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yg(t)}function QC(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function JF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QC(r,!0).forEach(function(n){ZF(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QC(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZF(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eB(t,e,r,n){n.debug;var s=JF({},r);return t&&yg(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===r[i]&&(s[i]=t[i])}),s}function tB(t){var e=t.blacklist||null,r=t.whitelist||null,n=t.transforms||[],s=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:n_).concat(t.key),o=t.storage,l;t.serialize===!1?l=function(_){return _}:typeof t.serialize=="function"?l=t.serialize:l=rB;var c=t.writeFailHandler||null,u={},d={},h=[],f=null,m=null,y=function(_){Object.keys(_).forEach(function(C){b(C)&&u[C]!==_[C]&&h.indexOf(C)===-1&&h.push(C)}),Object.keys(u).forEach(function(C){_[C]===void 0&&b(C)&&h.indexOf(C)===-1&&u[C]!==void 0&&h.push(C)}),f===null&&(f=setInterval(g,s)),u=_};function g(){if(h.length===0){f&&clearInterval(f),f=null;return}var S=h.shift(),_=n.reduce(function(C,N){return N.in(C,S,u)},u[S]);if(_!==void 0)try{d[S]=l(_)}catch(C){console.error("redux-persist/createPersistoid: error serializing state",C)}else delete d[S];h.length===0&&x()}function x(){Object.keys(d).forEach(function(S){u[S]===void 0&&delete d[S]}),m=o.setItem(i,l(d)).catch(v)}function b(S){return!(r&&r.indexOf(S)===-1&&S!=="_persist"||e&&e.indexOf(S)!==-1)}function v(S){c&&c(S)}var j=function(){for(;h.length!==0;)g();return m||Promise.resolve()};return{update:y,flush:j}}function rB(t){return JSON.stringify(t)}function nB(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:n_).concat(t.key),n=t.storage;t.debug;var s;return t.deserialize===!1?s=function(o){return o}:typeof t.deserialize=="function"?s=t.deserialize:s=aB,n.getItem(r).then(function(i){if(i)try{var o={},l=s(i);return Object.keys(l).forEach(function(c){o[c]=e.reduceRight(function(u,d){return d.out(u,c,l)},s(l[c]))}),o}catch(c){throw c}else return})}function aB(t){return JSON.parse(t)}function sB(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:n_).concat(t.key);return e.removeItem(r,iB)}function iB(t){}function YC(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function pi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YC(r,!0).forEach(function(n){oB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YC(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function oB(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lB(t,e){if(t==null)return{};var r=cB(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function cB(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}var uB=5e3;function dB(t,e){var r=t.version!==void 0?t.version:XF;t.debug;var n=t.stateReconciler===void 0?eB:t.stateReconciler,s=t.getStoredState||nB,i=t.timeout!==void 0?t.timeout:uB,o=null,l=!1,c=!0,u=function(h){return h._persist.rehydrated&&o&&!c&&o.update(h),h};return function(d,h){var f=d||{},m=f._persist,y=lB(f,["_persist"]),g=y;if(h.type===c3){var x=!1,b=function(w,E){x||(h.rehydrate(t.key,w,E),x=!0)};if(i&&setTimeout(function(){!x&&b(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),c=!1,o||(o=tB(t)),m)return pi({},e(g,h),{_persist:m});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),s(t).then(function(N){var w=t.migrate||function(E,k){return Promise.resolve(E)};w(N,r).then(function(E){b(E)},function(E){b(void 0,E)})},function(N){b(void 0,N)}),pi({},e(g,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===u3)return l=!0,h.result(sB(t)),pi({},e(g,h),{_persist:m});if(h.type===o3)return h.result(o&&o.flush()),pi({},e(g,h),{_persist:m});if(h.type===l3)c=!0;else if(h.type===a_){if(l)return pi({},g,{_persist:pi({},m,{rehydrated:!0})});if(h.key===t.key){var v=e(g,h),j=h.payload,S=n!==!1&&j!==void 0?n(j,d,v,t):v,_=pi({},S,{_persist:pi({},m,{rehydrated:!0})});return u(_)}}}if(!m)return e(d,h);var C=e(g,h);return C===g?d:u(pi({},C,{_persist:m}))}}function XC(t){return mB(t)||fB(t)||hB()}function hB(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function fB(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function mB(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function JC(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Gw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JC(r,!0).forEach(function(n){pB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JC(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pB(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h3={registry:[],bootstrapped:!1},gB=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h3,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case d3:return Gw({},e,{registry:[].concat(XC(e.registry),[r.key])});case a_:var n=e.registry.indexOf(r.key),s=XC(e.registry);return s.splice(n,1),Gw({},e,{registry:s,bootstrapped:s.length===0});default:return e}};function yB(t,e,r){var n=e_(gB,h3,void 0),s=function(c){n.dispatch({type:d3,key:c})},i=function(c,u,d){var h={type:a_,payload:u,err:d,key:c};t.dispatch(h),n.dispatch(h)},o=Gw({},n,{purge:function(){var c=[];return t.dispatch({type:u3,result:function(d){c.push(d)}}),Promise.all(c)},flush:function(){var c=[];return t.dispatch({type:o3,result:function(d){c.push(d)}}),Promise.all(c)},pause:function(){t.dispatch({type:l3})},persist:function(){t.dispatch({type:c3,register:s,rehydrate:i})}});return o.persist(),o}var s_={},i_={};i_.__esModule=!0;i_.default=bB;function xg(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xg=function(r){return typeof r}:xg=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},xg(t)}function rb(){}var xB={getItem:rb,setItem:rb,removeItem:rb};function vB(t){if((typeof self>"u"?"undefined":xg(self))!=="object"||!(t in self))return!1;try{var e=self[t],r="redux-persist ".concat(t," test");e.setItem(r,"test"),e.getItem(r),e.removeItem(r)}catch{return!1}return!0}function bB(t){var e="".concat(t,"Storage");return vB(e)?self[e]:xB}s_.__esModule=!0;s_.default=NB;var wB=jB(i_);function jB(t){return t&&t.__esModule?t:{default:t}}function NB(t){var e=(0,wB.default)(t);return{getItem:function(n){return new Promise(function(s,i){s(e.getItem(n))})},setItem:function(n,s){return new Promise(function(i,o){i(e.setItem(n,s))})},removeItem:function(n){return new Promise(function(s,i){s(e.removeItem(n))})}}}var f3=void 0,_B=SB(s_);function SB(t){return t&&t.__esModule?t:{default:t}}var CB=(0,_B.default)("local");f3=CB;const EB={products:{items:[],loading:!1,error:null},categories:{items:[],loading:!1,error:null},sales:{items:[],loading:!1,error:null},customers:{items:[],loading:!1,error:null},layaways:{items:[],loading:!1,error:null},technicalServices:{items:[],loading:!1,error:null},stats:{data:null,loading:!1,error:null}},m3=i3({name:"firebase",initialState:EB,reducers:{setProducts:(t,e)=>{t.products.items=e.payload,t.products.loading=!1,t.products.error=null},updateProductStock:(t,e)=>{const{productId:r,quantityChange:n}=e.payload,s=t.products.items.find(i=>i.id===r);s&&(s.stock=Math.max(0,s.stock+n),s.updatedAt=new Date().toISOString())},setProductsLoading:(t,e)=>{t.products.loading=e.payload},setProductsError:(t,e)=>{t.products.error=e.payload,t.products.loading=!1},setCategories:(t,e)=>{t.categories.items=e.payload,t.categories.loading=!1,t.categories.error=null},setCategoriesLoading:(t,e)=>{t.categories.loading=e.payload},setCategoriesError:(t,e)=>{t.categories.error=e.payload,t.categories.loading=!1},setSales:(t,e)=>{t.sales.items=e.payload,t.sales.loading=!1,t.sales.error=null},addSale:(t,e)=>{const r={...e.payload,id:crypto.randomUUID(),createdAt:new Date().toISOString()};t.sales.items.push(r)},updateSale:(t,e)=>{const{id:r,updates:n}=e.payload,s=t.sales.items.findIndex(i=>i.id===r);s!==-1&&(t.sales.items[s]={...t.sales.items[s],...n})},deleteSale:(t,e)=>{const r=e.payload;t.sales.items=t.sales.items.filter(n=>n.id!==r)},setSalesLoading:(t,e)=>{t.sales.loading=e.payload},setSalesError:(t,e)=>{t.sales.error=e.payload,t.sales.loading=!1},setCustomers:(t,e)=>{t.customers.items=e.payload,t.customers.loading=!1,t.customers.error=null},setCustomersLoading:(t,e)=>{t.customers.loading=e.payload},setCustomersError:(t,e)=>{t.customers.error=e.payload,t.customers.loading=!1},setLayaways:(t,e)=>{t.layaways.items=e.payload,t.layaways.loading=!1,t.layaways.error=null},setLayawaysLoading:(t,e)=>{t.layaways.loading=e.payload},setLayawaysError:(t,e)=>{t.layaways.error=e.payload,t.layaways.loading=!1},setTechnicalServices:(t,e)=>{t.technicalServices.items=e.payload,t.technicalServices.loading=!1,t.technicalServices.error=null},setTechnicalServicesLoading:(t,e)=>{t.technicalServices.loading=e.payload},setTechnicalServicesError:(t,e)=>{t.technicalServices.error=e.payload,t.technicalServices.loading=!1},setStats:(t,e)=>{t.stats.data=e.payload,t.stats.loading=!1,t.stats.error=null},setStatsLoading:(t,e)=>{t.stats.loading=e.payload},setStatsError:(t,e)=>{t.stats.error=e.payload,t.stats.loading=!1}}}),{setProducts:vg,updateProductStock:o_,setProductsLoading:Jc,setProductsError:Ph,setCategories:ZC,setCategoriesLoading:eE,setCategoriesError:tE,setSales:rE,addSale:PB,updateSale:TB,deleteSale:AB,setSalesLoading:nE,setSalesError:aE,setCustomers:Kw,setCustomersLoading:i0,setCustomersError:Qw,setLayaways:bg,setLayawaysLoading:o0,setLayawaysError:Yw,setTechnicalServices:Wh,setTechnicalServicesLoading:Ou,setTechnicalServicesError:l0,setStats:IB,setStatsLoading:sE,setStatsError:iE}=m3.actions,kB=m3.reducer,OB={user:null,isAuthenticated:!1,loading:!1,error:null},DB=i3({name:"auth",initialState:OB,reducers:{loginStart:t=>{t.loading=!0,t.error=null},loginSuccess:(t,e)=>{t.user=e.payload,t.isAuthenticated=!0,t.loading=!1,t.error=null},loginFailure:(t,e)=>{t.user=null,t.isAuthenticated=!1,t.loading=!1,t.error=e.payload},logout:t=>{t.user=null,t.isAuthenticated=!1,t.loading=!1,t.error=null},clearError:t=>{t.error=null}}}),MB=DB.reducer,RB={key:"root",storage:f3,whitelist:["auth"]},$B=KD({firebase:kB,auth:MB}),LB=dB(RB,$B),p3=IF({reducer:LB,middleware:t=>t({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE"]}})}),VB=yB(p3),FB="modulepreload",BB=function(t){return"/"+t},oE={},gn=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=BB(c),c in oE)return;oE[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":FB,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,m)=>{h.addEventListener("load",f),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};var lE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},UB=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],o=t[r++],l=t[r++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},y3={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),n.push(r[d],r[h],r[f],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(g3(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):UB(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const u=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new zB;const f=i<<2|l>>4;if(n.push(f),u!==64){const m=l<<4&240|u>>2;if(n.push(m),h!==64){const y=u<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class zB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qB=function(t){const e=g3(t);return y3.encodeByteArray(e,!0)},c0=function(t){return qB(t).replace(/\./g,"")},x3=function(t){try{return y3.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WB=()=>HB().__FIREBASE_DEFAULTS__,GB=()=>{if(typeof process>"u"||typeof lE>"u")return;const t=lE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},KB=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&x3(t[1]);return e&&JSON.parse(e)},Ky=()=>{try{return WB()||GB()||KB()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},v3=t=>{var e,r;return(r=(e=Ky())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},QB=t=>{const e=v3(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},b3=()=>{var t;return(t=Ky())===null||t===void 0?void 0:t.config},w3=t=>{var e;return(e=Ky())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YB{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XB(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[c0(JSON.stringify(r)),c0(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function JB(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Zn())}function ZB(){var t;const e=(t=Ky())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function e7(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function t7(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function r7(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function n7(){const t=Zn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function a7(){return!ZB()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function s7(){try{return typeof indexedDB=="object"}catch{return!1}}function i7(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o7="FirebaseError";class eo extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=o7,Object.setPrototypeOf(this,eo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pm.prototype.create)}}class Pm{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?l7(i,n):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new eo(s,l,n)}}function l7(t,e){return t.replace(c7,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const c7=/\{\$([^}]+)}/g;function u7(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Pf(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],o=e[s];if(cE(i)&&cE(o)){if(!Pf(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function cE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Th(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ah(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function d7(t,e){const r=new h7(t,e);return r.subscribe.bind(r)}class h7{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");f7(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=nb),s.error===void 0&&(s.error=nb),s.complete===void 0&&(s.complete=nb);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function f7(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function nb(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(t){return t&&t._delegate?t._delegate:t}class Zl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m7{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new YB;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(g7(e))try{this.getOrInitializeService({instanceIdentifier:Nl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Nl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Nl){return this.instances.has(e)}getOptions(e=Nl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);n===l&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:p7(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Nl){return this.component?this.component.multipleInstances?e:Nl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function p7(t){return t===Nl?void 0:t}function g7(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new m7(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $t;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})($t||($t={}));const x7={debug:$t.DEBUG,verbose:$t.VERBOSE,info:$t.INFO,warn:$t.WARN,error:$t.ERROR,silent:$t.SILENT},v7=$t.INFO,b7={[$t.DEBUG]:"log",[$t.VERBOSE]:"log",[$t.INFO]:"info",[$t.WARN]:"warn",[$t.ERROR]:"error"},w7=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=b7[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class l_{constructor(e){this.name=e,this._logLevel=v7,this._logHandler=w7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?x7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$t.DEBUG,...e),this._logHandler(this,$t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$t.VERBOSE,...e),this._logHandler(this,$t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$t.INFO,...e),this._logHandler(this,$t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$t.WARN,...e),this._logHandler(this,$t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$t.ERROR,...e),this._logHandler(this,$t.ERROR,...e)}}const j7=(t,e)=>e.some(r=>t instanceof r);let uE,dE;function N7(){return uE||(uE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _7(){return dE||(dE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const j3=new WeakMap,Xw=new WeakMap,N3=new WeakMap,ab=new WeakMap,c_=new WeakMap;function S7(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(Bo(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&j3.set(r,t)}).catch(()=>{}),c_.set(e,t),e}function C7(t){if(Xw.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Xw.set(t,e)}let Jw={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Xw.get(t);if(e==="objectStoreNames")return t.objectStoreNames||N3.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Bo(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function E7(t){Jw=t(Jw)}function P7(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(sb(this),e,...r);return N3.set(n,e.sort?e.sort():[e]),Bo(n)}:_7().includes(t)?function(...e){return t.apply(sb(this),e),Bo(j3.get(this))}:function(...e){return Bo(t.apply(sb(this),e))}}function T7(t){return typeof t=="function"?P7(t):(t instanceof IDBTransaction&&C7(t),j7(t,N7())?new Proxy(t,Jw):t)}function Bo(t){if(t instanceof IDBRequest)return S7(t);if(ab.has(t))return ab.get(t);const e=T7(t);return e!==t&&(ab.set(t,e),c_.set(e,t)),e}const sb=t=>c_.get(t);function A7(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Bo(o);return n&&o.addEventListener("upgradeneeded",c=>{n(Bo(o.result),c.oldVersion,c.newVersion,Bo(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const I7=["get","getKey","getAll","getAllKeys","count"],k7=["put","add","delete","clear"],ib=new Map;function hE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ib.get(e))return ib.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=k7.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||I7.includes(r)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),s&&c.done]))[0]};return ib.set(e,i),i}E7(t=>({...t,get:(e,r,n)=>hE(e,r)||t.get(e,r,n),has:(e,r)=>!!hE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(D7(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function D7(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Zw="@firebase/app",fE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi=new l_("@firebase/app"),M7="@firebase/app-compat",R7="@firebase/analytics-compat",$7="@firebase/analytics",L7="@firebase/app-check-compat",V7="@firebase/app-check",F7="@firebase/auth",B7="@firebase/auth-compat",U7="@firebase/database",z7="@firebase/data-connect",q7="@firebase/database-compat",H7="@firebase/functions",W7="@firebase/functions-compat",G7="@firebase/installations",K7="@firebase/installations-compat",Q7="@firebase/messaging",Y7="@firebase/messaging-compat",X7="@firebase/performance",J7="@firebase/performance-compat",Z7="@firebase/remote-config",eU="@firebase/remote-config-compat",tU="@firebase/storage",rU="@firebase/storage-compat",nU="@firebase/firestore",aU="@firebase/vertexai-preview",sU="@firebase/firestore-compat",iU="firebase",oU="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej="[DEFAULT]",lU={[Zw]:"fire-core",[M7]:"fire-core-compat",[$7]:"fire-analytics",[R7]:"fire-analytics-compat",[V7]:"fire-app-check",[L7]:"fire-app-check-compat",[F7]:"fire-auth",[B7]:"fire-auth-compat",[U7]:"fire-rtdb",[z7]:"fire-data-connect",[q7]:"fire-rtdb-compat",[H7]:"fire-fn",[W7]:"fire-fn-compat",[G7]:"fire-iid",[K7]:"fire-iid-compat",[Q7]:"fire-fcm",[Y7]:"fire-fcm-compat",[X7]:"fire-perf",[J7]:"fire-perf-compat",[Z7]:"fire-rc",[eU]:"fire-rc-compat",[tU]:"fire-gcs",[rU]:"fire-gcs-compat",[nU]:"fire-fst",[sU]:"fire-fst-compat",[aU]:"fire-vertex","fire-js":"fire-js",[iU]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Du=new Map,tj=new Map,rj=new Map;function mE(t,e){try{t.container.addComponent(e)}catch(r){Wi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Mu(t){const e=t.name;if(rj.has(e))return Wi.debug(`There were multiple attempts to register component ${e}.`),!1;rj.set(e,t);for(const r of Du.values())mE(r,t);for(const r of tj.values())mE(r,t);return!0}function u_(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Qs(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Uo=new Pm("app","Firebase",cU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Zl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Uo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd=oU;function d_(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ej,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Uo.create("bad-app-name",{appName:String(s)});if(r||(r=b3()),!r)throw Uo.create("no-options");const i=Du.get(s);if(i){if(Pf(r,i.options)&&Pf(n,i.config))return i;throw Uo.create("duplicate-app",{appName:s})}const o=new y7(s);for(const c of rj.values())o.addComponent(c);const l=new uU(r,n,o);return Du.set(s,l),l}function _3(t=ej){const e=Du.get(t);if(!e&&t===ej&&b3())return d_();if(!e)throw Uo.create("no-app",{appName:t});return e}async function dU(t){let e=!1;const r=t.name;Du.has(r)?(e=!0,Du.delete(r)):tj.has(r)&&t.decRefCount()<=0&&(tj.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function zo(t,e,r){var n;let s=(n=lU[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Wi.warn(l.join(" "));return}Mu(new Zl(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hU="firebase-heartbeat-database",fU=1,Tf="firebase-heartbeat-store";let ob=null;function S3(){return ob||(ob=A7(hU,fU,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Tf)}catch(r){console.warn(r)}}}}).catch(t=>{throw Uo.create("idb-open",{originalErrorMessage:t.message})})),ob}async function mU(t){try{const r=(await S3()).transaction(Tf),n=await r.objectStore(Tf).get(C3(t));return await r.done,n}catch(e){if(e instanceof eo)Wi.warn(e.message);else{const r=Uo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Wi.warn(r.message)}}}async function pE(t,e){try{const n=(await S3()).transaction(Tf,"readwrite");await n.objectStore(Tf).put(e,C3(t)),await n.done}catch(r){if(r instanceof eo)Wi.warn(r.message);else{const n=Uo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Wi.warn(n.message)}}}function C3(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU=1024,gU=30*24*60*60*1e3;class yU{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new vU(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=gE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=gU}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Wi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=gE(),{heartbeatsToSend:n,unsentEntries:s}=xU(this._heartbeatsCache.heartbeats),i=c0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Wi.warn(r),""}}}function gE(){return new Date().toISOString().substring(0,10)}function xU(t,e=pU){const r=[];let n=t.slice();for(const s of t){const i=r.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),yE(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),yE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class vU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return s7()?i7().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await mU(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return pE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return pE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function yE(t){return c0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bU(t){Mu(new Zl("platform-logger",e=>new O7(e),"PRIVATE")),Mu(new Zl("heartbeat",e=>new yU(e),"PRIVATE")),zo(Zw,fE,t),zo(Zw,fE,"esm2017"),zo("fire-js","")}bU("");function h_(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function E3(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const wU=E3,P3=new Pm("auth","Firebase",E3());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=new l_("@firebase/auth");function jU(t,...e){u0.logLevel<=$t.WARN&&u0.warn(`Auth (${jd}): ${t}`,...e)}function wg(t,...e){u0.logLevel<=$t.ERROR&&u0.error(`Auth (${jd}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bs(t,...e){throw f_(t,...e)}function ei(t,...e){return f_(t,...e)}function T3(t,e,r){const n=Object.assign(Object.assign({},wU()),{[e]:r});return new Pm("auth","Firebase",n).create(e,{appName:t.name})}function Di(t){return T3(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function f_(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return P3.create(t,...e)}function wt(t,e,...r){if(!t)throw f_(e,...r)}function Si(t){const e="INTERNAL ASSERTION FAILED: "+t;throw wg(e),new Error(e)}function Gi(t,e){t||Si(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nj(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function NU(){return xE()==="http:"||xE()==="https:"}function xE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _U(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(NU()||t7()||"connection"in navigator)?navigator.onLine:!0}function SU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,r){this.shortDelay=e,this.longDelay=r,Gi(r>e,"Short delay should be less than long delay!"),this.isMobile=JB()||r7()}get(){return _U()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(t,e){Gi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Si("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Si("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Si("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU=new Am(3e4,6e4);function nl(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function al(t,e,r,n,s={}){return I3(t,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const l=Tm(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return e7()||(u.referrerPolicy="no-referrer"),A3.fetch()(k3(t,t.config.apiHost,r,l),u)})}async function I3(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},CU),e);try{const s=new TU(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw kp(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw kp(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw kp(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw kp(t,"user-disabled",o);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw T3(t,d,u);Bs(t,d)}}catch(s){if(s instanceof eo)throw s;Bs(t,"network-request-failed",{message:String(s)})}}async function Im(t,e,r,n,s={}){const i=await al(t,e,r,n,s);return"mfaPendingCredential"in i&&Bs(t,"multi-factor-auth-required",{_serverResponse:i}),i}function k3(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?m_(t.config,s):`${t.config.apiScheme}://${s}`}function PU(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class TU{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ei(this.auth,"network-request-failed")),EU.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function kp(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ei(t,e,n);return s.customData._tokenResponse=r,s}function vE(t){return t!==void 0&&t.enterprise!==void 0}class AU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return PU(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function IU(t,e){return al(t,"GET","/v2/recaptchaConfig",nl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kU(t,e){return al(t,"POST","/v1/accounts:delete",e)}async function O3(t,e){return al(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function OU(t,e=!1){const r=zr(t),n=await r.getIdToken(e),s=p_(n);wt(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Gh(lb(s.auth_time)),issuedAtTime:Gh(lb(s.iat)),expirationTime:Gh(lb(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function lb(t){return Number(t)*1e3}function p_(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return wg("JWT malformed, contained fewer than 3 sections"),null;try{const s=x3(r);return s?JSON.parse(s):(wg("Failed to decode base64 JWT payload"),null)}catch(s){return wg("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function bE(t){const e=p_(t);return wt(e,"internal-error"),wt(typeof e.exp<"u","internal-error"),wt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Af(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof eo&&DU(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function DU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gh(this.lastLoginAt),this.creationTime=Gh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d0(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Af(t,O3(r,{idToken:n}));wt(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?D3(i.providerUserInfo):[],l=$U(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new aj(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function RU(t){const e=zr(t);await d0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $U(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function D3(t){return t.map(e=>{var{providerId:r}=e,n=h_(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LU(t,e){const r=await I3(t,{},async()=>{const n=Tm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=k3(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",A3.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function VU(t,e){return al(t,"POST","/v2/accounts:revokeToken",nl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){wt(e.idToken,"internal-error"),wt(typeof e.idToken<"u","internal-error"),wt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):bE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){wt(e.length!==0,"internal-error");const r=bE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(wt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await LU(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,o=new mu;return n&&(wt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(wt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(wt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new mu,this.toJSON())}_performRefresh(){return Si("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(t,e){wt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ci{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=h_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new MU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new aj(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Af(this,this.stsTokenManager.getToken(this.auth,e));return wt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return OU(this,e)}reload(){return RU(this)}_assign(e){this!==e&&(wt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ci(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){wt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await d0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qs(this.auth.app))return Promise.reject(Di(this.auth));const e=await this.getIdToken();return await Af(this,kU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,o,l,c,u,d;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,f=(s=r.email)!==null&&s!==void 0?s:void 0,m=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,y=(o=r.photoURL)!==null&&o!==void 0?o:void 0,g=(l=r.tenantId)!==null&&l!==void 0?l:void 0,x=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,b=(u=r.createdAt)!==null&&u!==void 0?u:void 0,v=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:j,emailVerified:S,isAnonymous:_,providerData:C,stsTokenManager:N}=r;wt(j&&N,e,"internal-error");const w=mu.fromJSON(this.name,N);wt(typeof j=="string",e,"internal-error"),mo(h,e.name),mo(f,e.name),wt(typeof S=="boolean",e,"internal-error"),wt(typeof _=="boolean",e,"internal-error"),mo(m,e.name),mo(y,e.name),mo(g,e.name),mo(x,e.name),mo(b,e.name),mo(v,e.name);const E=new Ci({uid:j,auth:e,email:f,emailVerified:S,displayName:h,isAnonymous:_,photoURL:y,phoneNumber:m,tenantId:g,stsTokenManager:w,createdAt:b,lastLoginAt:v});return C&&Array.isArray(C)&&(E.providerData=C.map(k=>Object.assign({},k))),x&&(E._redirectEventId=x),E}static async _fromIdTokenResponse(e,r,n=!1){const s=new mu;s.updateFromServerResponse(r);const i=new Ci({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await d0(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];wt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?D3(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new mu;l.updateFromIdToken(n);const c=new Ci({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new aj(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE=new Map;function Ei(t){Gi(t instanceof Function,"Expected a class definition");let e=wE.get(t);return e?(Gi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,wE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M3{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}M3.type="NONE";const jE=M3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jg(t,e,r){return`firebase:${t}:${e}:${r}`}class pu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=jg(this.userKey,s.apiKey,i),this.fullPersistenceKey=jg("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ci._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new pu(Ei(jE),e,n);const s=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Ei(jE);const o=jg(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const d=await u._get(o);if(d){const h=Ci._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new pu(i,e,n):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new pu(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(V3(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(R3(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(B3(e))return"Blackberry";if(U3(e))return"Webos";if($3(e))return"Safari";if((e.includes("chrome/")||L3(e))&&!e.includes("edge/"))return"Chrome";if(F3(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function R3(t=Zn()){return/firefox\//i.test(t)}function $3(t=Zn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function L3(t=Zn()){return/crios\//i.test(t)}function V3(t=Zn()){return/iemobile/i.test(t)}function F3(t=Zn()){return/android/i.test(t)}function B3(t=Zn()){return/blackberry/i.test(t)}function U3(t=Zn()){return/webos/i.test(t)}function g_(t=Zn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function FU(t=Zn()){var e;return g_(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function BU(){return n7()&&document.documentMode===10}function z3(t=Zn()){return g_(t)||F3(t)||U3(t)||B3(t)||/windows phone/i.test(t)||V3(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q3(t,e=[]){let r;switch(t){case"Browser":r=NE(Zn());break;case"Worker":r=`${NE(Zn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${jd}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zU(t,e={}){return al(t,"GET","/v2/passwordPolicy",nl(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qU=6;class HU{constructor(e){var r,n,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:qU,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _E(this),this.idTokenSubscription=new _E(this),this.beforeStateQueue=new UU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=P3,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ei(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await pu.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await O3(this,{idToken:e}),n=await Ci._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Qs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return wt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await d0(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=SU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qs(this.app))return Promise.reject(Di(this));const r=e?zr(e):null;return r&&wt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&wt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qs(this.app)?Promise.reject(Di(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qs(this.app)?Promise.reject(Di(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ei(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await zU(this),r=new HU(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pm("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await VU(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ei(e)||this._popupRedirectResolver;wt(r,this,"argument-error"),this.redirectPersistenceManager=await pu.create(this,[Ei(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(wt(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return wt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=q3(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&jU(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function gc(t){return zr(t)}class _E{constructor(e){this.auth=e,this.observer=null,this.addObserver=d7(r=>this.observer=r)}get next(){return wt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function GU(t){Qy=t}function H3(t){return Qy.loadJS(t)}function KU(){return Qy.recaptchaEnterpriseScript}function QU(){return Qy.gapiScript}function YU(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const XU="recaptcha-enterprise",JU="NO_RECAPTCHA";class ZU{constructor(e){this.type=XU,this.auth=gc(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{IU(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new AU(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;vE(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(JU)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{n(this.auth).then(l=>{if(!r&&vE(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=KU();c.length!==0&&(c+=l),H3(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function SE(t,e,r,n=!1){const s=new ZU(t);let i;try{i=await s.verify(r)}catch{i=await s.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function sj(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await SE(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await SE(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e8(t,e){const r=u_(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Pf(i,e??{}))return s;Bs(s,"already-initialized")}return r.initialize({options:e})}function t8(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ei);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function r8(t,e,r){const n=gc(t);wt(n._canInitEmulator,n,"emulator-config-failed"),wt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=W3(e),{host:o,port:l}=n8(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${i}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),a8()}function W3(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function n8(t){const e=W3(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:CE(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:CE(o)}}}function CE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function a8(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Si("not implemented")}_getIdTokenResponse(e){return Si("not implemented")}_linkToIdToken(e,r){return Si("not implemented")}_getReauthenticationResolver(e){return Si("not implemented")}}async function s8(t,e){return al(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i8(t,e){return Im(t,"POST","/v1/accounts:signInWithPassword",nl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o8(t,e){return Im(t,"POST","/v1/accounts:signInWithEmailLink",nl(t,e))}async function l8(t,e){return Im(t,"POST","/v1/accounts:signInWithEmailLink",nl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If extends y_{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new If(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new If(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sj(e,r,"signInWithPassword",i8);case"emailLink":return o8(e,{email:this._email,oobCode:this._password});default:Bs(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sj(e,n,"signUpPassword",s8);case"emailLink":return l8(e,{idToken:r,email:this._email,oobCode:this._password});default:Bs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gu(t,e){return Im(t,"POST","/v1/accounts:signInWithIdp",nl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c8="http://localhost";class ec extends y_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ec(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Bs("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=h_(r,["providerId","signInMethod"]);if(!n||!s)return null;const o=new ec(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return gu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,gu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,gu(e,r)}buildRequest(){const e={requestUri:c8,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Tm(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u8(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function d8(t){const e=Th(Ah(t)).link,r=e?Th(Ah(e)).deep_link_id:null,n=Th(Ah(t)).deep_link_id;return(n?Th(Ah(n)).link:null)||n||r||e||t}class x_{constructor(e){var r,n,s,i,o,l;const c=Th(Ah(e)),u=(r=c.apiKey)!==null&&r!==void 0?r:null,d=(n=c.oobCode)!==null&&n!==void 0?n:null,h=u8((s=c.mode)!==null&&s!==void 0?s:null);wt(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=d8(e);try{return new x_(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(){this.providerId=Nd.PROVIDER_ID}static credential(e,r){return If._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=x_.parseLink(r);return wt(n,"argument-error"),If._fromEmailAndCode(e,n.code,n.tenantId)}}Nd.PROVIDER_ID="password";Nd.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Nd.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km extends G3{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo extends km{constructor(){super("facebook.com")}static credential(e){return ec._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jo.credential(e.oauthAccessToken)}catch{return null}}}jo.FACEBOOK_SIGN_IN_METHOD="facebook.com";jo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No extends km{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ec._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return No.credentialFromTaggedObject(e)}static credentialFromError(e){return No.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return No.credential(r,n)}catch{return null}}}No.GOOGLE_SIGN_IN_METHOD="google.com";No.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o extends km{constructor(){super("github.com")}static credential(e){return ec._fromParams({providerId:_o.PROVIDER_ID,signInMethod:_o.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _o.credentialFromTaggedObject(e)}static credentialFromError(e){return _o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _o.credential(e.oauthAccessToken)}catch{return null}}}_o.GITHUB_SIGN_IN_METHOD="github.com";_o.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So extends km{constructor(){super("twitter.com")}static credential(e,r){return ec._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return So.credential(r,n)}catch{return null}}}So.TWITTER_SIGN_IN_METHOD="twitter.com";So.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h8(t,e){return Im(t,"POST","/v1/accounts:signUp",nl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await Ci._fromIdTokenResponse(e,n,s),o=EE(n);return new tc({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=EE(n);return new tc({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function EE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0 extends eo{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,h0.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new h0(e,r,n,s)}}function K3(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?h0._fromErrorAndOperation(t,i,e,n):i})}async function f8(t,e,r=!1){const n=await Af(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return tc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m8(t,e,r=!1){const{auth:n}=t;if(Qs(n.app))return Promise.reject(Di(n));const s="reauthenticate";try{const i=await Af(t,K3(n,s,e,t),r);wt(i.idToken,n,"internal-error");const o=p_(i.idToken);wt(o,n,"internal-error");const{sub:l}=o;return wt(t.uid===l,n,"user-mismatch"),tc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Bs(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q3(t,e,r=!1){if(Qs(t.app))return Promise.reject(Di(t));const n="signIn",s=await K3(t,n,e),i=await tc._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function p8(t,e){return Q3(gc(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y3(t){const e=gc(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function X3(t,e,r){if(Qs(t.app))return Promise.reject(Di(t));const n=gc(t),o=await sj(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",h8).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Y3(t),c}),l=await tc._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function g8(t,e,r){return Qs(t.app)?Promise.reject(Di(t)):p8(zr(t),Nd.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&Y3(t),n})}function y8(t,e,r,n){return zr(t).onIdTokenChanged(e,r,n)}function x8(t,e,r){return zr(t).beforeAuthStateChanged(e,r)}function v8(t,e,r,n){return zr(t).onAuthStateChanged(e,r,n)}function b8(t){return zr(t).signOut()}const f0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(f0,"1"),this.storage.removeItem(f0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w8=1e3,j8=10;class Z3 extends J3{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=z3(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);BU()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,j8):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},w8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Z3.type="LOCAL";const N8=Z3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5 extends J3{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}e5.type="SESSION";const t5=e5;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _8(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new Yy(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const l=Array.from(o).map(async u=>u(r.origin,i)),c=await _8(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yy.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S8{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=v_("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(){return window}function C8(t){ti().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(){return typeof ti().WorkerGlobalScope<"u"&&typeof ti().importScripts=="function"}async function E8(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function P8(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function T8(){return r5()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n5="firebaseLocalStorageDb",A8=1,m0="firebaseLocalStorage",a5="fbase_key";class Om{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Xy(t,e){return t.transaction([m0],e?"readwrite":"readonly").objectStore(m0)}function I8(){const t=indexedDB.deleteDatabase(n5);return new Om(t).toPromise()}function ij(){const t=indexedDB.open(n5,A8);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(m0,{keyPath:a5})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(m0)?e(n):(n.close(),await I8(),e(await ij()))})})}async function PE(t,e,r){const n=Xy(t,!0).put({[a5]:e,value:r});return new Om(n).toPromise()}async function k8(t,e){const r=Xy(t,!1).get(e),n=await new Om(r).toPromise();return n===void 0?null:n.value}function TE(t,e){const r=Xy(t,!0).delete(e);return new Om(r).toPromise()}const O8=800,D8=3;class s5{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ij(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>D8)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return r5()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yy._getInstance(T8()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await E8(),!this.activeServiceWorker)return;this.sender=new S8(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||P8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ij();return await PE(e,f0,"1"),await TE(e,f0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>PE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>k8(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>TE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Xy(s,!1).getAll();return new Om(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),O8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}s5.type="LOCAL";const M8=s5;new Am(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R8(t,e){return e?Ei(e):(wt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_ extends y_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return gu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return gu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return gu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function $8(t){return Q3(t.auth,new b_(t),t.bypassAuthState)}function L8(t){const{auth:e,user:r}=t;return wt(r,e,"internal-error"),m8(r,new b_(t),t.bypassAuthState)}async function V8(t){const{auth:e,user:r}=t;return wt(r,e,"internal-error"),f8(r,new b_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i5{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $8;case"linkViaPopup":case"linkViaRedirect":return V8;case"reauthViaPopup":case"reauthViaRedirect":return L8;default:Bs(this.auth,"internal-error")}}resolve(e){Gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F8=new Am(2e3,1e4);class Zc extends i5{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Zc.currentPopupAction&&Zc.currentPopupAction.cancel(),Zc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return wt(e,this.auth,"internal-error"),e}async onExecution(){Gi(this.filter.length===1,"Popup operations only handle one event");const e=v_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ei(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ei(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ei(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,F8.get())};e()}}Zc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B8="pendingRedirect",Ng=new Map;class U8 extends i5{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Ng.get(this.auth._key());if(!e){try{const n=await z8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Ng.set(this.auth._key(),e)}return this.bypassAuthState||Ng.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function z8(t,e){const r=W8(e),n=H8(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function q8(t,e){Ng.set(t._key(),e)}function H8(t){return Ei(t._redirectPersistence)}function W8(t){return jg(B8,t.config.apiKey,t.name)}async function G8(t,e,r=!1){if(Qs(t.app))return Promise.reject(Di(t));const n=gc(t),s=R8(n,e),o=await new U8(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K8=10*60*1e3;class Q8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Y8(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!o5(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ei(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=K8&&this.cachedEventUids.clear(),this.cachedEventUids.has(AE(e))}saveEventToCache(e){this.cachedEventUids.add(AE(e)),this.lastProcessedEventTime=Date.now()}}function AE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function o5({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Y8(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return o5(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X8(t,e={}){return al(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Z8=/^https?/;async function ez(t){if(t.config.emulator)return;const{authorizedDomains:e}=await X8(t);for(const r of e)try{if(tz(r))return}catch{}Bs(t,"unauthorized-domain")}function tz(t){const e=nj(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!Z8.test(r))return!1;if(J8.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rz=new Am(3e4,6e4);function IE(){const t=ti().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function nz(t){return new Promise((e,r)=>{var n,s,i;function o(){IE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{IE(),r(ei(t,"network-request-failed"))},timeout:rz.get()})}if(!((s=(n=ti().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=ti().gapi)===null||i===void 0)&&i.load)o();else{const l=YU("iframefcb");return ti()[l]=()=>{gapi.load?o():r(ei(t,"network-request-failed"))},H3(`${QU()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw _g=null,e})}let _g=null;function az(t){return _g=_g||nz(t),_g}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz=new Am(5e3,15e3),iz="__/auth/iframe",oz="emulator/auth/iframe",lz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uz(t){const e=t.config;wt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?m_(e,oz):`https://${t.config.authDomain}/${iz}`,n={apiKey:e.apiKey,appName:t.name,v:jd},s=cz.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Tm(n).slice(1)}`}async function dz(t){const e=await az(t),r=ti().gapi;return wt(r,t,"internal-error"),e.open({where:document.body,url:uz(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lz,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=ei(t,"network-request-failed"),l=ti().setTimeout(()=>{i(o)},sz.get());function c(){ti().clearTimeout(l),s(n)}n.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fz=500,mz=600,pz="_blank",gz="http://localhost";class kE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function yz(t,e,r,n=fz,s=mz){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},hz),{width:n.toString(),height:s.toString(),top:i,left:o}),u=Zn().toLowerCase();r&&(l=L3(u)?pz:r),R3(u)&&(e=e||gz,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[m,y])=>`${f}${m}=${y},`,"");if(FU(u)&&l!=="_self")return xz(e||"",l),new kE(null);const h=window.open(e||"",l,d);wt(h,t,"popup-blocked");try{h.focus()}catch{}return new kE(h)}function xz(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vz="__/auth/handler",bz="emulator/auth/handler",wz=encodeURIComponent("fac");async function OE(t,e,r,n,s,i){wt(t.config.authDomain,t,"auth-domain-config-required"),wt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:jd,eventId:s};if(e instanceof G3){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",u7(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))o[d]=h}if(e instanceof km){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${wz}=${encodeURIComponent(c)}`:"";return`${jz(t)}?${Tm(l).slice(1)}${u}`}function jz({config:t}){return t.emulator?m_(t,bz):`https://${t.authDomain}/${vz}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="webStorageSupport";class Nz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=t5,this._completeRedirectFn=G8,this._overrideRedirectResult=q8}async _openPopup(e,r,n,s){var i;Gi((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await OE(e,r,n,nj(),s);return yz(e,o,v_())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await OE(e,r,n,nj(),s);return C8(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Gi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await dz(e),n=new Q8(e);return r.register("authEvent",s=>(wt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(cb,{type:cb},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[cb];o!==void 0&&r(!!o),Bs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=ez(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return z3()||$3()||g_()}}const _z=Nz;var DE="@firebase/auth",ME="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){wt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cz(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ez(t){Mu(new Zl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;wt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:q3(t)},u=new WU(n,s,i,c);return t8(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Mu(new Zl("auth-internal",e=>{const r=gc(e.getProvider("auth").getImmediate());return(n=>new Sz(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),zo(DE,ME,Cz(t)),zo(DE,ME,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pz=5*60,Tz=w3("authIdTokenMaxAge")||Pz;let RE=null;const Az=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Tz)return;const s=r==null?void 0:r.token;RE!==s&&(RE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function l5(t=_3()){const e=u_(t,"auth");if(e.isInitialized())return e.getImmediate();const r=e8(t,{popupRedirectResolver:_z,persistence:[M8,N8,t5]}),n=w3("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=Az(i.toString());x8(r,o,()=>o(r.currentUser)),y8(r,l=>o(l))}}const s=v3("auth");return s&&r8(r,`http://${s}`),r}function Iz(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}GU({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=ei("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",Iz().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ez("Browser");var $E=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Bl,c5;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,w){function E(){}E.prototype=w.prototype,N.D=w.prototype,N.prototype=new E,N.prototype.constructor=N,N.C=function(k,T,P){for(var O=Array(arguments.length-2),D=2;D<arguments.length;D++)O[D-2]=arguments[D];return w.prototype[T].apply(k,O)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,w,E){E||(E=0);var k=Array(16);if(typeof w=="string")for(var T=0;16>T;++T)k[T]=w.charCodeAt(E++)|w.charCodeAt(E++)<<8|w.charCodeAt(E++)<<16|w.charCodeAt(E++)<<24;else for(T=0;16>T;++T)k[T]=w[E++]|w[E++]<<8|w[E++]<<16|w[E++]<<24;w=N.g[0],E=N.g[1],T=N.g[2];var P=N.g[3],O=w+(P^E&(T^P))+k[0]+3614090360&4294967295;w=E+(O<<7&4294967295|O>>>25),O=P+(T^w&(E^T))+k[1]+3905402710&4294967295,P=w+(O<<12&4294967295|O>>>20),O=T+(E^P&(w^E))+k[2]+606105819&4294967295,T=P+(O<<17&4294967295|O>>>15),O=E+(w^T&(P^w))+k[3]+3250441966&4294967295,E=T+(O<<22&4294967295|O>>>10),O=w+(P^E&(T^P))+k[4]+4118548399&4294967295,w=E+(O<<7&4294967295|O>>>25),O=P+(T^w&(E^T))+k[5]+1200080426&4294967295,P=w+(O<<12&4294967295|O>>>20),O=T+(E^P&(w^E))+k[6]+2821735955&4294967295,T=P+(O<<17&4294967295|O>>>15),O=E+(w^T&(P^w))+k[7]+4249261313&4294967295,E=T+(O<<22&4294967295|O>>>10),O=w+(P^E&(T^P))+k[8]+1770035416&4294967295,w=E+(O<<7&4294967295|O>>>25),O=P+(T^w&(E^T))+k[9]+2336552879&4294967295,P=w+(O<<12&4294967295|O>>>20),O=T+(E^P&(w^E))+k[10]+4294925233&4294967295,T=P+(O<<17&4294967295|O>>>15),O=E+(w^T&(P^w))+k[11]+2304563134&4294967295,E=T+(O<<22&4294967295|O>>>10),O=w+(P^E&(T^P))+k[12]+1804603682&4294967295,w=E+(O<<7&4294967295|O>>>25),O=P+(T^w&(E^T))+k[13]+4254626195&4294967295,P=w+(O<<12&4294967295|O>>>20),O=T+(E^P&(w^E))+k[14]+2792965006&4294967295,T=P+(O<<17&4294967295|O>>>15),O=E+(w^T&(P^w))+k[15]+1236535329&4294967295,E=T+(O<<22&4294967295|O>>>10),O=w+(T^P&(E^T))+k[1]+4129170786&4294967295,w=E+(O<<5&4294967295|O>>>27),O=P+(E^T&(w^E))+k[6]+3225465664&4294967295,P=w+(O<<9&4294967295|O>>>23),O=T+(w^E&(P^w))+k[11]+643717713&4294967295,T=P+(O<<14&4294967295|O>>>18),O=E+(P^w&(T^P))+k[0]+3921069994&4294967295,E=T+(O<<20&4294967295|O>>>12),O=w+(T^P&(E^T))+k[5]+3593408605&4294967295,w=E+(O<<5&4294967295|O>>>27),O=P+(E^T&(w^E))+k[10]+38016083&4294967295,P=w+(O<<9&4294967295|O>>>23),O=T+(w^E&(P^w))+k[15]+3634488961&4294967295,T=P+(O<<14&4294967295|O>>>18),O=E+(P^w&(T^P))+k[4]+3889429448&4294967295,E=T+(O<<20&4294967295|O>>>12),O=w+(T^P&(E^T))+k[9]+568446438&4294967295,w=E+(O<<5&4294967295|O>>>27),O=P+(E^T&(w^E))+k[14]+3275163606&4294967295,P=w+(O<<9&4294967295|O>>>23),O=T+(w^E&(P^w))+k[3]+4107603335&4294967295,T=P+(O<<14&4294967295|O>>>18),O=E+(P^w&(T^P))+k[8]+1163531501&4294967295,E=T+(O<<20&4294967295|O>>>12),O=w+(T^P&(E^T))+k[13]+2850285829&4294967295,w=E+(O<<5&4294967295|O>>>27),O=P+(E^T&(w^E))+k[2]+4243563512&4294967295,P=w+(O<<9&4294967295|O>>>23),O=T+(w^E&(P^w))+k[7]+1735328473&4294967295,T=P+(O<<14&4294967295|O>>>18),O=E+(P^w&(T^P))+k[12]+2368359562&4294967295,E=T+(O<<20&4294967295|O>>>12),O=w+(E^T^P)+k[5]+4294588738&4294967295,w=E+(O<<4&4294967295|O>>>28),O=P+(w^E^T)+k[8]+2272392833&4294967295,P=w+(O<<11&4294967295|O>>>21),O=T+(P^w^E)+k[11]+1839030562&4294967295,T=P+(O<<16&4294967295|O>>>16),O=E+(T^P^w)+k[14]+4259657740&4294967295,E=T+(O<<23&4294967295|O>>>9),O=w+(E^T^P)+k[1]+2763975236&4294967295,w=E+(O<<4&4294967295|O>>>28),O=P+(w^E^T)+k[4]+1272893353&4294967295,P=w+(O<<11&4294967295|O>>>21),O=T+(P^w^E)+k[7]+4139469664&4294967295,T=P+(O<<16&4294967295|O>>>16),O=E+(T^P^w)+k[10]+3200236656&4294967295,E=T+(O<<23&4294967295|O>>>9),O=w+(E^T^P)+k[13]+681279174&4294967295,w=E+(O<<4&4294967295|O>>>28),O=P+(w^E^T)+k[0]+3936430074&4294967295,P=w+(O<<11&4294967295|O>>>21),O=T+(P^w^E)+k[3]+3572445317&4294967295,T=P+(O<<16&4294967295|O>>>16),O=E+(T^P^w)+k[6]+76029189&4294967295,E=T+(O<<23&4294967295|O>>>9),O=w+(E^T^P)+k[9]+3654602809&4294967295,w=E+(O<<4&4294967295|O>>>28),O=P+(w^E^T)+k[12]+3873151461&4294967295,P=w+(O<<11&4294967295|O>>>21),O=T+(P^w^E)+k[15]+530742520&4294967295,T=P+(O<<16&4294967295|O>>>16),O=E+(T^P^w)+k[2]+3299628645&4294967295,E=T+(O<<23&4294967295|O>>>9),O=w+(T^(E|~P))+k[0]+4096336452&4294967295,w=E+(O<<6&4294967295|O>>>26),O=P+(E^(w|~T))+k[7]+1126891415&4294967295,P=w+(O<<10&4294967295|O>>>22),O=T+(w^(P|~E))+k[14]+2878612391&4294967295,T=P+(O<<15&4294967295|O>>>17),O=E+(P^(T|~w))+k[5]+4237533241&4294967295,E=T+(O<<21&4294967295|O>>>11),O=w+(T^(E|~P))+k[12]+1700485571&4294967295,w=E+(O<<6&4294967295|O>>>26),O=P+(E^(w|~T))+k[3]+2399980690&4294967295,P=w+(O<<10&4294967295|O>>>22),O=T+(w^(P|~E))+k[10]+4293915773&4294967295,T=P+(O<<15&4294967295|O>>>17),O=E+(P^(T|~w))+k[1]+2240044497&4294967295,E=T+(O<<21&4294967295|O>>>11),O=w+(T^(E|~P))+k[8]+1873313359&4294967295,w=E+(O<<6&4294967295|O>>>26),O=P+(E^(w|~T))+k[15]+4264355552&4294967295,P=w+(O<<10&4294967295|O>>>22),O=T+(w^(P|~E))+k[6]+2734768916&4294967295,T=P+(O<<15&4294967295|O>>>17),O=E+(P^(T|~w))+k[13]+1309151649&4294967295,E=T+(O<<21&4294967295|O>>>11),O=w+(T^(E|~P))+k[4]+4149444226&4294967295,w=E+(O<<6&4294967295|O>>>26),O=P+(E^(w|~T))+k[11]+3174756917&4294967295,P=w+(O<<10&4294967295|O>>>22),O=T+(w^(P|~E))+k[2]+718787259&4294967295,T=P+(O<<15&4294967295|O>>>17),O=E+(P^(T|~w))+k[9]+3951481745&4294967295,N.g[0]=N.g[0]+w&4294967295,N.g[1]=N.g[1]+(T+(O<<21&4294967295|O>>>11))&4294967295,N.g[2]=N.g[2]+T&4294967295,N.g[3]=N.g[3]+P&4294967295}n.prototype.u=function(N,w){w===void 0&&(w=N.length);for(var E=w-this.blockSize,k=this.B,T=this.h,P=0;P<w;){if(T==0)for(;P<=E;)s(this,N,P),P+=this.blockSize;if(typeof N=="string"){for(;P<w;)if(k[T++]=N.charCodeAt(P++),T==this.blockSize){s(this,k),T=0;break}}else for(;P<w;)if(k[T++]=N[P++],T==this.blockSize){s(this,k),T=0;break}}this.h=T,this.o+=w},n.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var w=1;w<N.length-8;++w)N[w]=0;var E=8*this.o;for(w=N.length-8;w<N.length;++w)N[w]=E&255,E/=256;for(this.u(N),N=Array(16),w=E=0;4>w;++w)for(var k=0;32>k;k+=8)N[E++]=this.g[w]>>>k&255;return N};function i(N,w){var E=l;return Object.prototype.hasOwnProperty.call(E,N)?E[N]:E[N]=w(N)}function o(N,w){this.h=w;for(var E=[],k=!0,T=N.length-1;0<=T;T--){var P=N[T]|0;k&&P==w||(E[T]=P,k=!1)}this.g=E}var l={};function c(N){return-128<=N&&128>N?i(N,function(w){return new o([w|0],0>w?-1:0)}):new o([N|0],0>N?-1:0)}function u(N){if(isNaN(N)||!isFinite(N))return h;if(0>N)return x(u(-N));for(var w=[],E=1,k=0;N>=E;k++)w[k]=N/E|0,E*=4294967296;return new o(w,0)}function d(N,w){if(N.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(N.charAt(0)=="-")return x(d(N.substring(1),w));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(w,8)),k=h,T=0;T<N.length;T+=8){var P=Math.min(8,N.length-T),O=parseInt(N.substring(T,T+P),w);8>P?(P=u(Math.pow(w,P)),k=k.j(P).add(u(O))):(k=k.j(E),k=k.add(u(O)))}return k}var h=c(0),f=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(g(this))return-x(this).m();for(var N=0,w=1,E=0;E<this.g.length;E++){var k=this.i(E);N+=(0<=k?k:4294967296+k)*w,w*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(y(this))return"0";if(g(this))return"-"+x(this).toString(N);for(var w=u(Math.pow(N,6)),E=this,k="";;){var T=S(E,w).g;E=b(E,T.j(w));var P=((0<E.g.length?E.g[0]:E.h)>>>0).toString(N);if(E=T,y(E))return P+k;for(;6>P.length;)P="0"+P;k=P+k}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function y(N){if(N.h!=0)return!1;for(var w=0;w<N.g.length;w++)if(N.g[w]!=0)return!1;return!0}function g(N){return N.h==-1}t.l=function(N){return N=b(this,N),g(N)?-1:y(N)?0:1};function x(N){for(var w=N.g.length,E=[],k=0;k<w;k++)E[k]=~N.g[k];return new o(E,~N.h).add(f)}t.abs=function(){return g(this)?x(this):this},t.add=function(N){for(var w=Math.max(this.g.length,N.g.length),E=[],k=0,T=0;T<=w;T++){var P=k+(this.i(T)&65535)+(N.i(T)&65535),O=(P>>>16)+(this.i(T)>>>16)+(N.i(T)>>>16);k=O>>>16,P&=65535,O&=65535,E[T]=O<<16|P}return new o(E,E[E.length-1]&-2147483648?-1:0)};function b(N,w){return N.add(x(w))}t.j=function(N){if(y(this)||y(N))return h;if(g(this))return g(N)?x(this).j(x(N)):x(x(this).j(N));if(g(N))return x(this.j(x(N)));if(0>this.l(m)&&0>N.l(m))return u(this.m()*N.m());for(var w=this.g.length+N.g.length,E=[],k=0;k<2*w;k++)E[k]=0;for(k=0;k<this.g.length;k++)for(var T=0;T<N.g.length;T++){var P=this.i(k)>>>16,O=this.i(k)&65535,D=N.i(T)>>>16,R=N.i(T)&65535;E[2*k+2*T]+=O*R,v(E,2*k+2*T),E[2*k+2*T+1]+=P*R,v(E,2*k+2*T+1),E[2*k+2*T+1]+=O*D,v(E,2*k+2*T+1),E[2*k+2*T+2]+=P*D,v(E,2*k+2*T+2)}for(k=0;k<w;k++)E[k]=E[2*k+1]<<16|E[2*k];for(k=w;k<2*w;k++)E[k]=0;return new o(E,0)};function v(N,w){for(;(N[w]&65535)!=N[w];)N[w+1]+=N[w]>>>16,N[w]&=65535,w++}function j(N,w){this.g=N,this.h=w}function S(N,w){if(y(w))throw Error("division by zero");if(y(N))return new j(h,h);if(g(N))return w=S(x(N),w),new j(x(w.g),x(w.h));if(g(w))return w=S(N,x(w)),new j(x(w.g),w.h);if(30<N.g.length){if(g(N)||g(w))throw Error("slowDivide_ only works with positive integers.");for(var E=f,k=w;0>=k.l(N);)E=_(E),k=_(k);var T=C(E,1),P=C(k,1);for(k=C(k,2),E=C(E,2);!y(k);){var O=P.add(k);0>=O.l(N)&&(T=T.add(E),P=O),k=C(k,1),E=C(E,1)}return w=b(N,T.j(w)),new j(T,w)}for(T=h;0<=N.l(w);){for(E=Math.max(1,Math.floor(N.m()/w.m())),k=Math.ceil(Math.log(E)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),P=u(E),O=P.j(w);g(O)||0<O.l(N);)E-=k,P=u(E),O=P.j(w);y(P)&&(P=f),T=T.add(P),N=b(N,O)}return new j(T,N)}t.A=function(N){return S(this,N).h},t.and=function(N){for(var w=Math.max(this.g.length,N.g.length),E=[],k=0;k<w;k++)E[k]=this.i(k)&N.i(k);return new o(E,this.h&N.h)},t.or=function(N){for(var w=Math.max(this.g.length,N.g.length),E=[],k=0;k<w;k++)E[k]=this.i(k)|N.i(k);return new o(E,this.h|N.h)},t.xor=function(N){for(var w=Math.max(this.g.length,N.g.length),E=[],k=0;k<w;k++)E[k]=this.i(k)^N.i(k);return new o(E,this.h^N.h)};function _(N){for(var w=N.g.length+1,E=[],k=0;k<w;k++)E[k]=N.i(k)<<1|N.i(k-1)>>>31;return new o(E,N.h)}function C(N,w){var E=w>>5;w%=32;for(var k=N.g.length-E,T=[],P=0;P<k;P++)T[P]=0<w?N.i(P+E)>>>w|N.i(P+E+1)<<32-w:N.i(P+E);return new o(T,N.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,c5=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Bl=o}).apply(typeof $E<"u"?$E:typeof self<"u"?self:typeof window<"u"?window:{});var Op=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var u5,Ih,d5,Sg,oj,h5,f5,m5;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,A,M){return p==Array.prototype||p==Object.prototype||(p[A]=M.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Op=="object"&&Op];for(var A=0;A<p.length;++A){var M=p[A];if(M&&M.Math==Math)return M}throw Error("Cannot find global object")}var n=r(this);function s(p,A){if(A)e:{var M=n;p=p.split(".");for(var z=0;z<p.length-1;z++){var de=p[z];if(!(de in M))break e;M=M[de]}p=p[p.length-1],z=M[p],A=A(z),A!=z&&A!=null&&e(M,p,{configurable:!0,writable:!0,value:A})}}function i(p,A){p instanceof String&&(p+="");var M=0,z=!1,de={next:function(){if(!z&&M<p.length){var ye=M++;return{value:A(ye,p[ye]),done:!1}}return z=!0,{done:!0,value:void 0}}};return de[Symbol.iterator]=function(){return de},de}s("Array.prototype.values",function(p){return p||function(){return i(this,function(A,M){return M})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(p){var A=typeof p;return A=A!="object"?A:p?Array.isArray(p)?"array":A:"null",A=="array"||A=="object"&&typeof p.length=="number"}function u(p){var A=typeof p;return A=="object"&&p!=null||A=="function"}function d(p,A,M){return p.call.apply(p.bind,arguments)}function h(p,A,M){if(!p)throw Error();if(2<arguments.length){var z=Array.prototype.slice.call(arguments,2);return function(){var de=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(de,z),p.apply(A,de)}}return function(){return p.apply(A,arguments)}}function f(p,A,M){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(p,A){var M=Array.prototype.slice.call(arguments,1);return function(){var z=M.slice();return z.push.apply(z,arguments),p.apply(this,z)}}function y(p,A){function M(){}M.prototype=A.prototype,p.aa=A.prototype,p.prototype=new M,p.prototype.constructor=p,p.Qb=function(z,de,ye){for(var Ue=Array(arguments.length-2),cr=2;cr<arguments.length;cr++)Ue[cr-2]=arguments[cr];return A.prototype[de].apply(z,Ue)}}function g(p){const A=p.length;if(0<A){const M=Array(A);for(let z=0;z<A;z++)M[z]=p[z];return M}return[]}function x(p,A){for(let M=1;M<arguments.length;M++){const z=arguments[M];if(c(z)){const de=p.length||0,ye=z.length||0;p.length=de+ye;for(let Ue=0;Ue<ye;Ue++)p[de+Ue]=z[Ue]}else p.push(z)}}class b{constructor(A,M){this.i=A,this.j=M,this.h=0,this.g=null}get(){let A;return 0<this.h?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function v(p){return/^[\s\xa0]*$/.test(p)}function j(){var p=l.navigator;return p&&(p=p.userAgent)?p:""}function S(p){return S[" "](p),p}S[" "]=function(){};var _=j().indexOf("Gecko")!=-1&&!(j().toLowerCase().indexOf("webkit")!=-1&&j().indexOf("Edge")==-1)&&!(j().indexOf("Trident")!=-1||j().indexOf("MSIE")!=-1)&&j().indexOf("Edge")==-1;function C(p,A,M){for(const z in p)A.call(M,p[z],z,p)}function N(p,A){for(const M in p)A.call(void 0,p[M],M,p)}function w(p){const A={};for(const M in p)A[M]=p[M];return A}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(p,A){let M,z;for(let de=1;de<arguments.length;de++){z=arguments[de];for(M in z)p[M]=z[M];for(let ye=0;ye<E.length;ye++)M=E[ye],Object.prototype.hasOwnProperty.call(z,M)&&(p[M]=z[M])}}function T(p){var A=1;p=p.split(":");const M=[];for(;0<A&&p.length;)M.push(p.shift()),A--;return p.length&&M.push(p.join(":")),M}function P(p){l.setTimeout(()=>{throw p},0)}function O(){var p=L;let A=null;return p.g&&(A=p.g,p.g=p.g.next,p.g||(p.h=null),A.next=null),A}class D{constructor(){this.h=this.g=null}add(A,M){const z=R.get();z.set(A,M),this.h?this.h.next=z:this.g=z,this.h=z}}var R=new b(()=>new B,p=>p.reset());class B{constructor(){this.next=this.g=this.h=null}set(A,M){this.h=A,this.g=M,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,W=!1,L=new D,X=()=>{const p=l.Promise.resolve(void 0);Y=()=>{p.then(G)}};var G=()=>{for(var p;p=O();){try{p.h.call(p.g)}catch(M){P(M)}var A=R;A.j(p),100>A.h&&(A.h++,p.next=A.g,A.g=p)}W=!1};function K(){this.s=this.s,this.C=this.C}K.prototype.s=!1,K.prototype.ma=function(){this.s||(this.s=!0,this.N())},K.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(p,A){this.type=p,this.g=this.target=A,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var ie=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var p=!1,A=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const M=()=>{};l.addEventListener("test",M,A),l.removeEventListener("test",M,A)}catch{}return p}();function ge(p,A){if(q.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var M=this.type=p.type,z=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=A,A=p.relatedTarget){if(_){e:{try{S(A.nodeName);var de=!0;break e}catch{}de=!1}de||(A=null)}}else M=="mouseover"?A=p.fromElement:M=="mouseout"&&(A=p.toElement);this.relatedTarget=A,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:be[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&ge.aa.h.call(this)}}y(ge,q);var be={2:"touch",3:"pen",4:"mouse"};ge.prototype.h=function(){ge.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Ye="closure_listenable_"+(1e6*Math.random()|0),ze=0;function U(p,A,M,z,de){this.listener=p,this.proxy=null,this.src=A,this.type=M,this.capture=!!z,this.ha=de,this.key=++ze,this.da=this.fa=!1}function Q(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function re(p){this.src=p,this.g={},this.h=0}re.prototype.add=function(p,A,M,z,de){var ye=p.toString();p=this.g[ye],p||(p=this.g[ye]=[],this.h++);var Ue=pe(p,A,z,de);return-1<Ue?(A=p[Ue],M||(A.fa=!1)):(A=new U(A,this.src,ye,!!z,de),A.fa=M,p.push(A)),A};function te(p,A){var M=A.type;if(M in p.g){var z=p.g[M],de=Array.prototype.indexOf.call(z,A,void 0),ye;(ye=0<=de)&&Array.prototype.splice.call(z,de,1),ye&&(Q(A),p.g[M].length==0&&(delete p.g[M],p.h--))}}function pe(p,A,M,z){for(var de=0;de<p.length;++de){var ye=p[de];if(!ye.da&&ye.listener==A&&ye.capture==!!M&&ye.ha==z)return de}return-1}var xe="closure_lm_"+(1e6*Math.random()|0),he={};function Le(p,A,M,z,de){if(Array.isArray(A)){for(var ye=0;ye<A.length;ye++)Le(p,A[ye],M,z,de);return null}return M=We(M),p&&p[Ye]?p.K(A,M,u(z)?!!z.capture:!!z,de):qe(p,A,M,!1,z,de)}function qe(p,A,M,z,de,ye){if(!A)throw Error("Invalid event type");var Ue=u(de)?!!de.capture:!!de,cr=ue(p);if(cr||(p[xe]=cr=new re(p)),M=cr.add(A,M,z,Ue,ye),M.proxy)return M;if(z=De(),M.proxy=z,z.src=p,z.listener=M,p.addEventListener)ie||(de=Ue),de===void 0&&(de=!1),p.addEventListener(A.toString(),z,de);else if(p.attachEvent)p.attachEvent(Ce(A.toString()),z);else if(p.addListener&&p.removeListener)p.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return M}function De(){function p(M){return A.call(p.src,p.listener,M)}const A=ke;return p}function ne(p,A,M,z,de){if(Array.isArray(A))for(var ye=0;ye<A.length;ye++)ne(p,A[ye],M,z,de);else z=u(z)?!!z.capture:!!z,M=We(M),p&&p[Ye]?(p=p.i,A=String(A).toString(),A in p.g&&(ye=p.g[A],M=pe(ye,M,z,de),-1<M&&(Q(ye[M]),Array.prototype.splice.call(ye,M,1),ye.length==0&&(delete p.g[A],p.h--)))):p&&(p=ue(p))&&(A=p.g[A.toString()],p=-1,A&&(p=pe(A,M,z,de)),(M=-1<p?A[p]:null)&&oe(M))}function oe(p){if(typeof p!="number"&&p&&!p.da){var A=p.src;if(A&&A[Ye])te(A.i,p);else{var M=p.type,z=p.proxy;A.removeEventListener?A.removeEventListener(M,z,p.capture):A.detachEvent?A.detachEvent(Ce(M),z):A.addListener&&A.removeListener&&A.removeListener(z),(M=ue(A))?(te(M,p),M.h==0&&(M.src=null,A[xe]=null)):Q(p)}}}function Ce(p){return p in he?he[p]:he[p]="on"+p}function ke(p,A){if(p.da)p=!0;else{A=new ge(A,this);var M=p.listener,z=p.ha||p.src;p.fa&&oe(p),p=M.call(z,A)}return p}function ue(p){return p=p[xe],p instanceof re?p:null}var se="__closure_events_fn_"+(1e9*Math.random()>>>0);function We(p){return typeof p=="function"?p:(p[se]||(p[se]=function(A){return p.handleEvent(A)}),p[se])}function Ae(){K.call(this),this.i=new re(this),this.M=this,this.F=null}y(Ae,K),Ae.prototype[Ye]=!0,Ae.prototype.removeEventListener=function(p,A,M,z){ne(this,p,A,M,z)};function it(p,A){var M,z=p.F;if(z)for(M=[];z;z=z.F)M.push(z);if(p=p.M,z=A.type||A,typeof A=="string")A=new q(A,p);else if(A instanceof q)A.target=A.target||p;else{var de=A;A=new q(z,p),k(A,de)}if(de=!0,M)for(var ye=M.length-1;0<=ye;ye--){var Ue=A.g=M[ye];de=ut(Ue,z,!0,A)&&de}if(Ue=A.g=p,de=ut(Ue,z,!0,A)&&de,de=ut(Ue,z,!1,A)&&de,M)for(ye=0;ye<M.length;ye++)Ue=A.g=M[ye],de=ut(Ue,z,!1,A)&&de}Ae.prototype.N=function(){if(Ae.aa.N.call(this),this.i){var p=this.i,A;for(A in p.g){for(var M=p.g[A],z=0;z<M.length;z++)Q(M[z]);delete p.g[A],p.h--}}this.F=null},Ae.prototype.K=function(p,A,M,z){return this.i.add(String(p),A,!1,M,z)},Ae.prototype.L=function(p,A,M,z){return this.i.add(String(p),A,!0,M,z)};function ut(p,A,M,z){if(A=p.i.g[String(A)],!A)return!0;A=A.concat();for(var de=!0,ye=0;ye<A.length;++ye){var Ue=A[ye];if(Ue&&!Ue.da&&Ue.capture==M){var cr=Ue.listener,En=Ue.ha||Ue.src;Ue.fa&&te(p.i,Ue),de=cr.call(En,z)!==!1&&de}}return de&&!z.defaultPrevented}function mt(p,A,M){if(typeof p=="function")M&&(p=f(p,M));else if(p&&typeof p.handleEvent=="function")p=f(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(A)?-1:l.setTimeout(p,A||0)}function pt(p){p.g=mt(()=>{p.g=null,p.i&&(p.i=!1,pt(p))},p.l);const A=p.h;p.h=null,p.m.apply(null,A)}class gt extends K{constructor(A,M){super(),this.m=A,this.l=M,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:pt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lr(p){K.call(this),this.h=p,this.g={}}y(lr,K);var dn=[];function qr(p){C(p.g,function(A,M){this.g.hasOwnProperty(M)&&oe(A)},p),p.g={}}lr.prototype.N=function(){lr.aa.N.call(this),qr(this)},lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Tr=l.JSON.stringify,Wa=l.JSON.parse,_n=class{stringify(p){return l.JSON.stringify(p,void 0)}parse(p){return l.JSON.parse(p,void 0)}};function Sn(){}Sn.prototype.h=null;function Ar(p){return p.h||(p.h=p.i())}function hn(){}var Ir={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Hr(){q.call(this,"d")}y(Hr,q);function kr(){q.call(this,"c")}y(kr,q);var F={},ae=null;function me(){return ae=ae||new Ae}F.La="serverreachability";function Se(p){q.call(this,F.La,p)}y(Se,q);function Oe(p){const A=me();it(A,new Se(A))}F.STAT_EVENT="statevent";function H(p,A){q.call(this,F.STAT_EVENT,p),this.stat=A}y(H,q);function Z(p){const A=me();it(A,new H(A,p))}F.Ma="timingevent";function ce(p,A){q.call(this,F.Ma,p),this.size=A}y(ce,q);function fe(p,A){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){p()},A)}function Ne(){this.g=!0}Ne.prototype.xa=function(){this.g=!1};function Ve(p,A,M,z,de,ye){p.info(function(){if(p.g)if(ye)for(var Ue="",cr=ye.split("&"),En=0;En<cr.length;En++){var qt=cr[En].split("=");if(1<qt.length){var Fn=qt[0];qt=qt[1];var Bn=Fn.split("_");Ue=2<=Bn.length&&Bn[1]=="type"?Ue+(Fn+"="+qt+"&"):Ue+(Fn+"=redacted&")}}else Ue=null;else Ue=ye;return"XMLHTTP REQ ("+z+") [attempt "+de+"]: "+A+`
`+M+`
`+Ue})}function _e(p,A,M,z,de,ye,Ue){p.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+de+"]: "+A+`
`+M+`
`+ye+" "+Ue})}function Xe(p,A,M,z){p.info(function(){return"XMLHTTP TEXT ("+A+"): "+Te(p,M)+(z?" "+z:"")})}function ot(p,A){p.info(function(){return"TIMEOUT: "+A})}Ne.prototype.info=function(){};function Te(p,A){if(!p.g)return A;if(!A)return null;try{var M=JSON.parse(A);if(M){for(p=0;p<M.length;p++)if(Array.isArray(M[p])){var z=M[p];if(!(2>z.length)){var de=z[1];if(Array.isArray(de)&&!(1>de.length)){var ye=de[0];if(ye!="noop"&&ye!="stop"&&ye!="close")for(var Ue=1;Ue<de.length;Ue++)de[Ue]=""}}}}return Tr(M)}catch{return A}}var Fe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},It={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xt;function Dt(){}y(Dt,Sn),Dt.prototype.g=function(){return new XMLHttpRequest},Dt.prototype.i=function(){return{}},xt=new Dt;function Ge(p,A,M,z){this.j=p,this.i=A,this.l=M,this.R=z||1,this.U=new lr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new nt}function nt(){this.i=null,this.g="",this.h=!1}var Lt={},Ut={};function Or(p,A,M){p.L=1,p.v=ml(Ga(A)),p.m=M,p.P=!0,io(p,null)}function io(p,A){p.F=Date.now(),lo(p),p.A=Ga(p.v);var M=p.A,z=p.R;Array.isArray(z)||(z=[String(z)]),Tt(M.i,"t",z),p.C=0,M=p.j.J,p.h=new nt,p.g=N2(p.j,M?A:null,!p.m),0<p.O&&(p.M=new gt(f(p.Y,p,p.g),p.O)),A=p.U,M=p.g,z=p.ca;var de="readystatechange";Array.isArray(de)||(de&&(dn[0]=de.toString()),de=dn);for(var ye=0;ye<de.length;ye++){var Ue=Le(M,de[ye],z||A.handleEvent,!1,A.h||A);if(!Ue)break;A.g[Ue.key]=Ue}A=p.H?w(p.H):{},p.m?(p.u||(p.u="POST"),A["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,A)):(p.u="GET",p.g.ea(p.A,p.u,null,A)),Oe(),Ve(p.i,p.u,p.A,p.l,p.R,p.m)}Ge.prototype.ca=function(p){p=p.target;const A=this.M;A&&Cn(p)==3?A.j():this.Y(p)},Ge.prototype.Y=function(p){try{if(p==this.g)e:{const Bn=Cn(this.g);var A=this.g.Ba();const Ac=this.g.Z();if(!(3>Bn)&&(Bn!=3||this.g&&(this.h.h||this.g.oa()||sp(this.g)))){this.J||Bn!=4||A==7||(A==8||0>=Ac?Oe(3):Oe(2)),hl(this);var M=this.g.Z();this.X=M;t:if(oo(this)){var z=sp(this.g);p="";var de=z.length,ye=Cn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){bs(this),fl(this);var Ue="";break t}this.h.i=new l.TextDecoder}for(A=0;A<de;A++)this.h.h=!0,p+=this.h.i.decode(z[A],{stream:!(ye&&A==de-1)});z.length=0,this.h.g+=p,this.C=0,Ue=this.h.g}else Ue=this.g.oa();if(this.o=M==200,_e(this.i,this.u,this.A,this.l,this.R,Bn,M),this.o){if(this.T&&!this.K){t:{if(this.g){var cr,En=this.g;if((cr=En.g?En.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(cr)){var qt=cr;break t}}qt=null}if(M=qt)Xe(this.i,this.l,M,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pa(this,M);else{this.o=!1,this.s=3,Z(12),bs(this),fl(this);break e}}if(this.P){M=!0;let js;for(;!this.J&&this.C<Ue.length;)if(js=ul(this,Ue),js==Ut){Bn==4&&(this.s=4,Z(14),M=!1),Xe(this.i,this.l,null,"[Incomplete Response]");break}else if(js==Lt){this.s=4,Z(15),Xe(this.i,this.l,Ue,"[Invalid Chunk]"),M=!1;break}else Xe(this.i,this.l,js,null),Pa(this,js);if(oo(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Bn!=4||Ue.length!=0||this.h.h||(this.s=1,Z(16),M=!1),this.o=this.o&&M,!M)Xe(this.i,this.l,Ue,"[Invalid Chunked Response]"),bs(this),fl(this);else if(0<Ue.length&&!this.W){this.W=!0;var Fn=this.j;Fn.g==this&&Fn.ba&&!Fn.M&&(Fn.j.info("Great, no buffering proxy detected. Bytes received: "+Ue.length),wv(Fn),Fn.M=!0,Z(11))}}else Xe(this.i,this.l,Ue,null),Pa(this,Ue);Bn==4&&bs(this),this.o&&!this.J&&(Bn==4?v2(this.j,this):(this.o=!1,lo(this)))}else q$(this.g),M==400&&0<Ue.indexOf("Unknown SID")?(this.s=3,Z(12)):(this.s=0,Z(13)),bs(this),fl(this)}}}catch{}finally{}};function oo(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function ul(p,A){var M=p.C,z=A.indexOf(`
`,M);return z==-1?Ut:(M=Number(A.substring(M,z)),isNaN(M)?Lt:(z+=1,z+M>A.length?Ut:(A=A.slice(z,z+M),p.C=z+M,A)))}Ge.prototype.cancel=function(){this.J=!0,bs(this)};function lo(p){p.S=Date.now()+p.I,dl(p,p.I)}function dl(p,A){if(p.B!=null)throw Error("WatchDog timer not null");p.B=fe(f(p.ba,p),A)}function hl(p){p.B&&(l.clearTimeout(p.B),p.B=null)}Ge.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(ot(this.i,this.A),this.L!=2&&(Oe(),Z(17)),bs(this),this.s=2,fl(this)):dl(this,this.S-p)};function fl(p){p.j.G==0||p.J||v2(p.j,p)}function bs(p){hl(p);var A=p.M;A&&typeof A.ma=="function"&&A.ma(),p.M=null,qr(p.U),p.g&&(A=p.g,p.g=null,A.abort(),A.ma())}function Pa(p,A){try{var M=p.j;if(M.G!=0&&(M.g==p||Ec(M.h,p))){if(!p.K&&Ec(M.h,p)&&M.G==3){try{var z=M.Da.g.parse(A)}catch{z=null}if(Array.isArray(z)&&z.length==3){var de=z;if(de[0]==0){e:if(!M.u){if(M.g)if(M.g.F+3e3<p.F)lp(M),ip(M);else break e;bv(M),Z(18)}}else M.za=de[1],0<M.za-M.T&&37500>de[2]&&M.F&&M.v==0&&!M.C&&(M.C=fe(f(M.Za,M),6e3));if(1>=qs(M.h)&&M.ca){try{M.ca()}catch{}M.ca=void 0}}else pl(M,11)}else if((p.K||M.g==p)&&lp(M),!v(A))for(de=M.Da.g.parse(A),A=0;A<de.length;A++){let qt=de[A];if(M.T=qt[0],qt=qt[1],M.G==2)if(qt[0]=="c"){M.K=qt[1],M.ia=qt[2];const Fn=qt[3];Fn!=null&&(M.la=Fn,M.j.info("VER="+M.la));const Bn=qt[4];Bn!=null&&(M.Aa=Bn,M.j.info("SVER="+M.Aa));const Ac=qt[5];Ac!=null&&typeof Ac=="number"&&0<Ac&&(z=1.5*Ac,M.L=z,M.j.info("backChannelRequestTimeoutMs_="+z)),z=M;const js=p.g;if(js){const up=js.g?js.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(up){var ye=z.h;ye.g||up.indexOf("spdy")==-1&&up.indexOf("quic")==-1&&up.indexOf("h2")==-1||(ye.j=ye.l,ye.g=new Set,ye.h&&(Kd(ye,ye.h),ye.h=null))}if(z.D){const jv=js.g?js.g.getResponseHeader("X-HTTP-Session-Id"):null;jv&&(z.ya=jv,rr(z.I,z.D,jv))}}M.G=3,M.l&&M.l.ua(),M.ba&&(M.R=Date.now()-p.F,M.j.info("Handshake RTT: "+M.R+"ms")),z=M;var Ue=p;if(z.qa=j2(z,z.J?z.ia:null,z.W),Ue.K){tp(z.h,Ue);var cr=Ue,En=z.L;En&&(cr.I=En),cr.B&&(hl(cr),lo(cr)),z.g=Ue}else y2(z);0<M.i.length&&op(M)}else qt[0]!="stop"&&qt[0]!="close"||pl(M,7);else M.G==3&&(qt[0]=="stop"||qt[0]=="close"?qt[0]=="stop"?pl(M,7):vv(M):qt[0]!="noop"&&M.l&&M.l.ta(qt),M.v=0)}}Oe(4)}catch{}}var Gd=class{constructor(p,A){this.g=p,this.map=A}};function ep(p){this.l=p||10,l.PerformanceNavigationTiming?(p=l.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Cc(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function qs(p){return p.h?1:p.g?p.g.size:0}function Ec(p,A){return p.h?p.h==A:p.g?p.g.has(A):!1}function Kd(p,A){p.g?p.g.add(A):p.h=A}function tp(p,A){p.h&&p.h==A?p.h=null:p.g&&p.g.has(A)&&p.g.delete(A)}ep.prototype.cancel=function(){if(this.i=rp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function rp(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let A=p.i;for(const M of p.g.values())A=A.concat(M.D);return A}return g(p.i)}function xv(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(c(p)){for(var A=[],M=p.length,z=0;z<M;z++)A.push(p[z]);return A}A=[],M=0;for(z in p)A[M++]=p[z];return A}function np(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(c(p)||typeof p=="string"){var A=[];p=p.length;for(var M=0;M<p;M++)A.push(M);return A}A=[],M=0;for(const z in p)A[M++]=z;return A}}}function Qd(p,A){if(p.forEach&&typeof p.forEach=="function")p.forEach(A,void 0);else if(c(p)||typeof p=="string")Array.prototype.forEach.call(p,A,void 0);else for(var M=np(p),z=xv(p),de=z.length,ye=0;ye<de;ye++)A.call(void 0,z[ye],M&&M[ye],p)}var Yd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ap(p,A){if(p){p=p.split("&");for(var M=0;M<p.length;M++){var z=p[M].indexOf("="),de=null;if(0<=z){var ye=p[M].substring(0,z);de=p[M].substring(z+1)}else ye=p[M];A(ye,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function Hs(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Hs){this.h=p.h,vr(this,p.j),this.o=p.o,this.g=p.g,co(this,p.s),this.l=p.l;var A=p.i,M=new $e;M.i=A.i,A.g&&(M.g=new Map(A.g),M.h=A.h),Ka(this,M),this.m=p.m}else p&&(A=String(p).match(Yd))?(this.h=!1,vr(this,A[1]||"",!0),this.o=uo(A[2]||""),this.g=uo(A[3]||"",!0),co(this,A[4]),this.l=uo(A[5]||"",!0),Ka(this,A[6]||"",!0),this.m=uo(A[7]||"")):(this.h=!1,this.i=new $e(null,this.h))}Hs.prototype.toString=function(){var p=[],A=this.j;A&&p.push(ho(A,J,!0),":");var M=this.g;return(M||A=="file")&&(p.push("//"),(A=this.o)&&p.push(ho(A,J,!0),"@"),p.push(encodeURIComponent(String(M)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),M=this.s,M!=null&&p.push(":",String(M))),(M=this.l)&&(this.g&&M.charAt(0)!="/"&&p.push("/"),p.push(ho(M,M.charAt(0)=="/"?we:le,!0))),(M=this.i.toString())&&p.push("?",M),(M=this.m)&&p.push("#",ho(M,Be)),p.join("")};function Ga(p){return new Hs(p)}function vr(p,A,M){p.j=M?uo(A,!0):A,p.j&&(p.j=p.j.replace(/:$/,""))}function co(p,A){if(A){if(A=Number(A),isNaN(A)||0>A)throw Error("Bad port number "+A);p.s=A}else p.s=null}function Ka(p,A,M){A instanceof $e?(p.i=A,Et(p.i,p.h)):(M||(A=ho(A,Ee)),p.i=new $e(A,p.h))}function rr(p,A,M){p.i.set(A,M)}function ml(p){return rr(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function uo(p,A){return p?A?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function ho(p,A,M){return typeof p=="string"?(p=encodeURI(p).replace(A,$),M&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function $(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var J=/[#\/\?@]/g,le=/[#\?:]/g,we=/[#\?]/g,Ee=/[#\?@]/g,Be=/#/g;function $e(p,A){this.h=this.g=null,this.i=p||null,this.j=!!A}function Je(p){p.g||(p.g=new Map,p.h=0,p.i&&ap(p.i,function(A,M){p.add(decodeURIComponent(A.replace(/\+/g," ")),M)}))}t=$e.prototype,t.add=function(p,A){Je(this),this.i=null,p=nr(this,p);var M=this.g.get(p);return M||this.g.set(p,M=[]),M.push(A),this.h+=1,this};function at(p,A){Je(p),A=nr(p,A),p.g.has(A)&&(p.i=null,p.h-=p.g.get(A).length,p.g.delete(A))}function st(p,A){return Je(p),A=nr(p,A),p.g.has(A)}t.forEach=function(p,A){Je(this),this.g.forEach(function(M,z){M.forEach(function(de){p.call(A,de,z,this)},this)},this)},t.na=function(){Je(this);const p=Array.from(this.g.values()),A=Array.from(this.g.keys()),M=[];for(let z=0;z<A.length;z++){const de=p[z];for(let ye=0;ye<de.length;ye++)M.push(A[z])}return M},t.V=function(p){Je(this);let A=[];if(typeof p=="string")st(this,p)&&(A=A.concat(this.g.get(nr(this,p))));else{p=Array.from(this.g.values());for(let M=0;M<p.length;M++)A=A.concat(p[M])}return A},t.set=function(p,A){return Je(this),this.i=null,p=nr(this,p),st(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[A]),this.h+=1,this},t.get=function(p,A){return p?(p=this.V(p),0<p.length?String(p[0]):A):A};function Tt(p,A,M){at(p,A),0<M.length&&(p.i=null,p.g.set(nr(p,A),g(M)),p.h+=M.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],A=Array.from(this.g.keys());for(var M=0;M<A.length;M++){var z=A[M];const ye=encodeURIComponent(String(z)),Ue=this.V(z);for(z=0;z<Ue.length;z++){var de=ye;Ue[z]!==""&&(de+="="+encodeURIComponent(String(Ue[z]))),p.push(de)}}return this.i=p.join("&")};function nr(p,A){return A=String(A),p.j&&(A=A.toLowerCase()),A}function Et(p,A){A&&!p.j&&(Je(p),p.i=null,p.g.forEach(function(M,z){var de=z.toLowerCase();z!=de&&(at(this,z),Tt(this,de,M))},p)),p.j=A}function et(p,A){const M=new Ne;if(l.Image){const z=new Image;z.onload=m(ar,M,"TestLoadImage: loaded",!0,A,z),z.onerror=m(ar,M,"TestLoadImage: error",!1,A,z),z.onabort=m(ar,M,"TestLoadImage: abort",!1,A,z),z.ontimeout=m(ar,M,"TestLoadImage: timeout",!1,A,z),l.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=p}else A(!1)}function Wr(p,A){const M=new Ne,z=new AbortController,de=setTimeout(()=>{z.abort(),ar(M,"TestPingServer: timeout",!1,A)},1e4);fetch(p,{signal:z.signal}).then(ye=>{clearTimeout(de),ye.ok?ar(M,"TestPingServer: ok",!0,A):ar(M,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(de),ar(M,"TestPingServer: error",!1,A)})}function ar(p,A,M,z,de){try{de&&(de.onload=null,de.onerror=null,de.onabort=null,de.ontimeout=null),z(M)}catch{}}function _r(){this.g=new _n}function fr(p,A,M){const z=M||"";try{Qd(p,function(de,ye){let Ue=de;u(de)&&(Ue=Tr(de)),A.push(z+ye+"="+encodeURIComponent(Ue))})}catch(de){throw A.push(z+"type="+encodeURIComponent("_badmap")),de}}function kt(p){this.l=p.Ub||null,this.j=p.eb||!1}y(kt,Sn),kt.prototype.g=function(){return new ta(this.l,this.j)},kt.prototype.i=function(p){return function(){return p}}({});function ta(p,A){Ae.call(this),this.D=p,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(ta,Ae),t=ta.prototype,t.open=function(p,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=A,this.readyState=1,ra(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const A={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(A.body=p),(this.D||l).fetch(new Request(this.A,A)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Qa(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ra(this)),this.g&&(this.readyState=3,ra(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Qr(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Qr(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var A=p.value?p.value:new Uint8Array(0);(A=this.v.decode(A,{stream:!p.done}))&&(this.response=this.responseText+=A)}p.done?Qa(this):ra(this),this.readyState==3&&Qr(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,Qa(this))},t.Qa=function(p){this.g&&(this.response=p,Qa(this))},t.ga=function(){this.g&&Qa(this)};function Qa(p){p.readyState=4,p.l=null,p.j=null,p.v=null,ra(p)}t.setRequestHeader=function(p,A){this.u.append(p,A)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],A=this.h.entries();for(var M=A.next();!M.done;)M=M.value,p.push(M[0]+": "+M[1]),M=A.next();return p.join(`\r
`)};function ra(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(ta.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function pa(p){let A="";return C(p,function(M,z){A+=z,A+=":",A+=M,A+=`\r
`}),A}function ws(p,A,M){e:{for(z in M){var z=!1;break e}z=!0}z||(M=pa(M),typeof p=="string"?M!=null&&encodeURIComponent(String(M)):rr(p,A,M))}function Sr(p){Ae.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Sr,Ae);var rn=/^https?$/i,Pc=["POST","PUT"];t=Sr.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,A,M,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);A=A?A.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xt.g(),this.v=this.o?Ar(this.o):Ar(xt),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(A,String(p),!0),this.B=!1}catch(ye){Xd(this,ye);return}if(p=M||"",M=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var de in z)M.set(de,z[de]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const ye of z.keys())M.set(ye,z.get(ye));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(M.keys()).find(ye=>ye.toLowerCase()=="content-type"),de=l.FormData&&p instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Pc,A,void 0))||z||de||M.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ye,Ue]of M)this.g.setRequestHeader(ye,Ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{na(this),this.u=!0,this.g.send(p),this.u=!1}catch(ye){Xd(this,ye)}};function Xd(p,A){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=A,p.m=5,Mt(p),Dr(p)}function Mt(p){p.A||(p.A=!0,it(p,"complete"),it(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,it(this,"complete"),it(this,"abort"),Dr(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Dr(this,!0)),Sr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Cr(this):this.bb())},t.bb=function(){Cr(this)};function Cr(p){if(p.h&&typeof o<"u"&&(!p.v[1]||Cn(p)!=4||p.Z()!=2)){if(p.u&&Cn(p)==4)mt(p.Ea,0,p);else if(it(p,"readystatechange"),Cn(p)==4){p.h=!1;try{const Ue=p.Z();e:switch(Ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var M;if(!(M=A)){var z;if(z=Ue===0){var de=String(p.D).match(Yd)[1]||null;!de&&l.self&&l.self.location&&(de=l.self.location.protocol.slice(0,-1)),z=!rn.test(de?de.toLowerCase():"")}M=z}if(M)it(p,"complete"),it(p,"success");else{p.m=6;try{var ye=2<Cn(p)?p.g.statusText:""}catch{ye=""}p.l=ye+" ["+p.Z()+"]",Mt(p)}}finally{Dr(p)}}}}function Dr(p,A){if(p.g){na(p);const M=p.g,z=p.v[0]?()=>{}:null;p.g=null,p.v=null,A||it(p,"ready");try{M.onreadystatechange=z}catch{}}}function na(p){p.I&&(l.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function Cn(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<Cn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var A=this.g.responseText;return p&&A.indexOf(p)==0&&(A=A.substring(p.length)),Wa(A)}};function sp(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function q$(p){const A={};p=(p.g&&2<=Cn(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<p.length;z++){if(v(p[z]))continue;var M=T(p[z]);const de=M[0];if(M=M[1],typeof M!="string")continue;M=M.trim();const ye=A[de]||[];A[de]=ye,ye.push(M)}N(A,function(z){return z.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Jd(p,A,M){return M&&M.internalChannelParams&&M.internalChannelParams[p]||A}function f2(p){this.Aa=0,this.i=[],this.j=new Ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Jd("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Jd("baseRetryDelayMs",5e3,p),this.cb=Jd("retryDelaySeedMs",1e4,p),this.Wa=Jd("forwardChannelMaxRetries",2,p),this.wa=Jd("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new ep(p&&p.concurrentRequestLimit),this.Da=new _r,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=f2.prototype,t.la=8,t.G=1,t.connect=function(p,A,M,z){Z(0),this.W=p,this.H=A||{},M&&z!==void 0&&(this.H.OSID=M,this.H.OAID=z),this.F=this.X,this.I=j2(this,null,this.W),op(this)};function vv(p){if(m2(p),p.G==3){var A=p.U++,M=Ga(p.I);if(rr(M,"SID",p.K),rr(M,"RID",A),rr(M,"TYPE","terminate"),Zd(p,M),A=new Ge(p,p.j,A),A.L=2,A.v=ml(Ga(M)),M=!1,l.navigator&&l.navigator.sendBeacon)try{M=l.navigator.sendBeacon(A.v.toString(),"")}catch{}!M&&l.Image&&(new Image().src=A.v,M=!0),M||(A.g=N2(A.j,null),A.g.ea(A.v)),A.F=Date.now(),lo(A)}w2(p)}function ip(p){p.g&&(wv(p),p.g.cancel(),p.g=null)}function m2(p){ip(p),p.u&&(l.clearTimeout(p.u),p.u=null),lp(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&l.clearTimeout(p.s),p.s=null)}function op(p){if(!Cc(p.h)&&!p.s){p.s=!0;var A=p.Ga;Y||X(),W||(Y(),W=!0),L.add(A,p),p.B=0}}function H$(p,A){return qs(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=A.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=fe(f(p.Ga,p,A),b2(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const de=new Ge(this,this.j,p);let ye=this.o;if(this.S&&(ye?(ye=w(ye),k(ye,this.S)):ye=this.S),this.m!==null||this.O||(de.H=ye,ye=null),this.P)e:{for(var A=0,M=0;M<this.i.length;M++){t:{var z=this.i[M];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(A+=z,4096<A){A=M;break e}if(A===4096||M===this.i.length-1){A=M+1;break e}}A=1e3}else A=1e3;A=g2(this,de,A),M=Ga(this.I),rr(M,"RID",p),rr(M,"CVER",22),this.D&&rr(M,"X-HTTP-Session-Id",this.D),Zd(this,M),ye&&(this.O?A="headers="+encodeURIComponent(String(pa(ye)))+"&"+A:this.m&&ws(M,this.m,ye)),Kd(this.h,de),this.Ua&&rr(M,"TYPE","init"),this.P?(rr(M,"$req",A),rr(M,"SID","null"),de.T=!0,Or(de,M,null)):Or(de,M,A),this.G=2}}else this.G==3&&(p?p2(this,p):this.i.length==0||Cc(this.h)||p2(this))};function p2(p,A){var M;A?M=A.l:M=p.U++;const z=Ga(p.I);rr(z,"SID",p.K),rr(z,"RID",M),rr(z,"AID",p.T),Zd(p,z),p.m&&p.o&&ws(z,p.m,p.o),M=new Ge(p,p.j,M,p.B+1),p.m===null&&(M.H=p.o),A&&(p.i=A.D.concat(p.i)),A=g2(p,M,1e3),M.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Kd(p.h,M),Or(M,z,A)}function Zd(p,A){p.H&&C(p.H,function(M,z){rr(A,z,M)}),p.l&&Qd({},function(M,z){rr(A,z,M)})}function g2(p,A,M){M=Math.min(p.i.length,M);var z=p.l?f(p.l.Na,p.l,p):null;e:{var de=p.i;let ye=-1;for(;;){const Ue=["count="+M];ye==-1?0<M?(ye=de[0].g,Ue.push("ofs="+ye)):ye=0:Ue.push("ofs="+ye);let cr=!0;for(let En=0;En<M;En++){let qt=de[En].g;const Fn=de[En].map;if(qt-=ye,0>qt)ye=Math.max(0,de[En].g-100),cr=!1;else try{fr(Fn,Ue,"req"+qt+"_")}catch{z&&z(Fn)}}if(cr){z=Ue.join("&");break e}}}return p=p.i.splice(0,M),A.D=p,z}function y2(p){if(!p.g&&!p.u){p.Y=1;var A=p.Fa;Y||X(),W||(Y(),W=!0),L.add(A,p),p.v=0}}function bv(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=fe(f(p.Fa,p),b2(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,x2(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=fe(f(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Z(10),ip(this),x2(this))};function wv(p){p.A!=null&&(l.clearTimeout(p.A),p.A=null)}function x2(p){p.g=new Ge(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var A=Ga(p.qa);rr(A,"RID","rpc"),rr(A,"SID",p.K),rr(A,"AID",p.T),rr(A,"CI",p.F?"0":"1"),!p.F&&p.ja&&rr(A,"TO",p.ja),rr(A,"TYPE","xmlhttp"),Zd(p,A),p.m&&p.o&&ws(A,p.m,p.o),p.L&&(p.g.I=p.L);var M=p.g;p=p.ia,M.L=1,M.v=ml(Ga(A)),M.m=null,M.P=!0,io(M,p)}t.Za=function(){this.C!=null&&(this.C=null,ip(this),bv(this),Z(19))};function lp(p){p.C!=null&&(l.clearTimeout(p.C),p.C=null)}function v2(p,A){var M=null;if(p.g==A){lp(p),wv(p),p.g=null;var z=2}else if(Ec(p.h,A))M=A.D,tp(p.h,A),z=1;else return;if(p.G!=0){if(A.o)if(z==1){M=A.m?A.m.length:0,A=Date.now()-A.F;var de=p.B;z=me(),it(z,new ce(z,M)),op(p)}else y2(p);else if(de=A.s,de==3||de==0&&0<A.X||!(z==1&&H$(p,A)||z==2&&bv(p)))switch(M&&0<M.length&&(A=p.h,A.i=A.i.concat(M)),de){case 1:pl(p,5);break;case 4:pl(p,10);break;case 3:pl(p,6);break;default:pl(p,2)}}}function b2(p,A){let M=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(M*=2),M*A}function pl(p,A){if(p.j.info("Error code "+A),A==2){var M=f(p.fb,p),z=p.Xa;const de=!z;z=new Hs(z||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||vr(z,"https"),ml(z),de?et(z.toString(),M):Wr(z.toString(),M)}else Z(2);p.G=0,p.l&&p.l.sa(A),w2(p),m2(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),Z(2)):(this.j.info("Failed to ping google.com"),Z(1))};function w2(p){if(p.G=0,p.ka=[],p.l){const A=rp(p.h);(A.length!=0||p.i.length!=0)&&(x(p.ka,A),x(p.ka,p.i),p.h.i.length=0,g(p.i),p.i.length=0),p.l.ra()}}function j2(p,A,M){var z=M instanceof Hs?Ga(M):new Hs(M);if(z.g!="")A&&(z.g=A+"."+z.g),co(z,z.s);else{var de=l.location;z=de.protocol,A=A?A+"."+de.hostname:de.hostname,de=+de.port;var ye=new Hs(null);z&&vr(ye,z),A&&(ye.g=A),de&&co(ye,de),M&&(ye.l=M),z=ye}return M=p.D,A=p.ya,M&&A&&rr(z,M,A),rr(z,"VER",p.la),Zd(p,z),z}function N2(p,A,M){if(A&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return A=p.Ca&&!p.pa?new Sr(new kt({eb:M})):new Sr(p.pa),A.Ha(p.J),A}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function _2(){}t=_2.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function cp(){}cp.prototype.g=function(p,A){return new Ta(p,A)};function Ta(p,A){Ae.call(this),this.g=new f2(A),this.l=p,this.h=A&&A.messageUrlParams||null,p=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(p?p["X-WebChannel-Content-Type"]=A.messageContentType:p={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.va&&(p?p["X-WebChannel-Client-Profile"]=A.va:p={"X-WebChannel-Client-Profile":A.va}),this.g.S=p,(p=A&&A.Sb)&&!v(p)&&(this.g.m=p),this.v=A&&A.supportsCrossDomainXhr||!1,this.u=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!v(A)&&(this.g.D=A,p=this.h,p!==null&&A in p&&(p=this.h,A in p&&delete p[A])),this.j=new Tc(this)}y(Ta,Ae),Ta.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ta.prototype.close=function(){vv(this.g)},Ta.prototype.o=function(p){var A=this.g;if(typeof p=="string"){var M={};M.__data__=p,p=M}else this.u&&(M={},M.__data__=Tr(p),p=M);A.i.push(new Gd(A.Ya++,p)),A.G==3&&op(A)},Ta.prototype.N=function(){this.g.l=null,delete this.j,vv(this.g),delete this.g,Ta.aa.N.call(this)};function S2(p){Hr.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var A=p.__sm__;if(A){e:{for(const M in A){p=M;break e}p=void 0}(this.i=p)&&(p=this.i,A=A!==null&&p in A?A[p]:void 0),this.data=A}else this.data=p}y(S2,Hr);function C2(){kr.call(this),this.status=1}y(C2,kr);function Tc(p){this.g=p}y(Tc,_2),Tc.prototype.ua=function(){it(this.g,"a")},Tc.prototype.ta=function(p){it(this.g,new S2(p))},Tc.prototype.sa=function(p){it(this.g,new C2)},Tc.prototype.ra=function(){it(this.g,"b")},cp.prototype.createWebChannel=cp.prototype.g,Ta.prototype.send=Ta.prototype.o,Ta.prototype.open=Ta.prototype.m,Ta.prototype.close=Ta.prototype.close,m5=function(){return new cp},f5=function(){return me()},h5=F,oj={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fe.NO_ERROR=0,Fe.TIMEOUT=8,Fe.HTTP_ERROR=6,Sg=Fe,It.COMPLETE="complete",d5=It,hn.EventType=Ir,Ir.OPEN="a",Ir.CLOSE="b",Ir.ERROR="c",Ir.MESSAGE="d",Ae.prototype.listen=Ae.prototype.K,Ih=hn,Sr.prototype.listenOnce=Sr.prototype.L,Sr.prototype.getLastError=Sr.prototype.Ka,Sr.prototype.getLastErrorCode=Sr.prototype.Ba,Sr.prototype.getStatus=Sr.prototype.Z,Sr.prototype.getResponseJson=Sr.prototype.Oa,Sr.prototype.getResponseText=Sr.prototype.oa,Sr.prototype.send=Sr.prototype.ea,Sr.prototype.setWithCredentials=Sr.prototype.Ha,u5=Sr}).apply(typeof Op<"u"?Op:typeof self<"u"?self:typeof window<"u"?window:{});const LE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Wn.UNAUTHENTICATED=new Wn(null),Wn.GOOGLE_CREDENTIALS=new Wn("google-credentials-uid"),Wn.FIRST_PARTY=new Wn("first-party-uid"),Wn.MOCK_USER=new Wn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _d="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rc=new l_("@firebase/firestore");function lh(){return rc.logLevel}function lt(t,...e){if(rc.logLevel<=$t.DEBUG){const r=e.map(w_);rc.debug(`Firestore (${_d}): ${t}`,...r)}}function Ki(t,...e){if(rc.logLevel<=$t.ERROR){const r=e.map(w_);rc.error(`Firestore (${_d}): ${t}`,...r)}}function nc(t,...e){if(rc.logLevel<=$t.WARN){const r=e.map(w_);rc.warn(`Firestore (${_d}): ${t}`,...r)}}function w_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(t="Unexpected state"){const e=`FIRESTORE (${_d}) INTERNAL ASSERTION FAILED: `+t;throw Ki(e),new Error(e)}function Zt(t,e){t||Nt()}function Ct(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const je={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class He extends eo{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class g5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Wn.UNAUTHENTICATED))}shutdown(){}}class kz{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Oz{constructor(e){this.t=e,this.currentUser=Wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Zt(this.o===void 0);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let i=new Mi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Mi,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{lt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(lt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Mi)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(lt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Zt(typeof n.accessToken=="string"),new p5(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Zt(e===null||typeof e=="string"),new Wn(e)}}class Dz{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Wn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Mz{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Dz(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Wn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Rz{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $z{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Zt(this.o===void 0);const n=i=>{i.error!=null&&lt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,lt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{lt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):lt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Zt(typeof r.token=="string"),this.R=r.token,new Rz(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lz(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=Lz(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function Ht(t,e){return t<e?-1:t>e?1:0}function Ru(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new He(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new He(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new He(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new He(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return en.fromMillis(Date.now())}static fromDate(e){return en.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new en(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ht(this.nanoseconds,e.nanoseconds):Ht(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.timestamp=e}static fromTimestamp(e){return new St(e)}static min(){return new St(new en(0,0))}static max(){return new St(new en(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,r,n){r===void 0?r=0:r>e.length&&Nt(),n===void 0?n=e.length-r:n>e.length-r&&Nt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return kf.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof kf?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),o=r.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class gr extends kf{construct(e,r,n){return new gr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new He(je.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new gr(r)}static emptyPath(){return new gr([])}}const Vz=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends kf{construct(e,r,n){return new xn(e,r,n)}static isValidIdentifier(e){return Vz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new xn(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new He(je.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new He(je.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new He(je.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(n+=l,s++):(i(),s++)}if(i(),o)throw new He(je.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xn(r)}static emptyPath(){return new xn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.path=e}static fromPath(e){return new dt(gr.fromString(e))}static fromName(e){return new dt(gr.fromString(e).popFirst(5))}static empty(){return new dt(gr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return gr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dt(new gr(e.slice()))}}function Fz(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=St.fromTimestamp(n===1e9?new en(r+1,0):new en(r,n));return new Ko(s,dt.empty(),e)}function Bz(t){return new Ko(t.readTime,t.key,-1)}class Ko{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ko(St.min(),dt.empty(),-1)}static max(){return new Ko(St.max(),dt.empty(),-1)}}function Uz(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=dt.comparator(t.documentKey,e.documentKey),r!==0?r:Ht(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zz="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class qz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dm(t){if(t.code!==je.FAILED_PRECONDITION||t.message!==zz)throw t;lt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Nt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ie((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ie?r:Ie.resolve(r)}catch(r){return Ie.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ie.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ie.reject(r)}static resolve(e){return new Ie((r,n)=>{r(e)})}static reject(e){return new Ie((r,n)=>{n(e)})}static waitFor(e){return new Ie((r,n)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&r()},c=>n(c))}),o=!0,i===s&&r()})}static or(e){let r=Ie.resolve(!1);for(const n of e)r=r.next(s=>s?Ie.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new Ie((n,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;r(e[u]).next(d=>{o[u]=d,++l,l===i&&n(o)},d=>s(d))}})}static doWhile(e,r){return new Ie((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function Hz(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Mm(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}N_.oe=-1;function Jy(t){return t==null}function p0(t){return t===0&&1/t==-1/0}function Wz(t){return typeof t=="number"&&Number.isInteger(t)&&!p0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function yc(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function y5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,r){this.comparator=e,this.root=r||On.EMPTY}insert(e,r){return new Vr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,On.BLACK,null,null))}remove(e){return new Vr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,On.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dp(this.root,e,this.comparator,!0)}}class Dp{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class On{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??On.RED,this.left=s??On.EMPTY,this.right=i??On.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new On(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return On.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return On.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,On.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,On.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Nt();const e=this.left.check();if(e!==this.right.check())throw Nt();return e+(this.isRed()?0:1)}}On.EMPTY=null,On.RED=!0,On.BLACK=!1;On.EMPTY=new class{constructor(){this.size=0}get key(){throw Nt()}get value(){throw Nt()}get color(){throw Nt()}get left(){throw Nt()}get right(){throw Nt()}copy(e,r,n,s,i){return this}insert(e,r,n){return new On(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.comparator=e,this.data=new Vr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new FE(this.data.getIterator())}getIteratorFrom(e){return new FE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof $n)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new $n(this.comparator);return r.data=e,r}}class FE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.fields=e,e.sort(xn.comparator)}static empty(){return new $a([])}unionWith(e){let r=new $n(xn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new $a(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ru(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new x5("Invalid base64 string: "+i):i}}(e);return new jn(r)}static fromUint8Array(e){const r=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new jn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ht(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jn.EMPTY_BYTE_STRING=new jn("");const Gz=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qo(t){if(Zt(!!t),typeof t=="string"){let e=0;const r=Gz.exec(t);if(Zt(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Gr(t.seconds),nanos:Gr(t.nanos)}}function Gr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ac(t){return typeof t=="string"?jn.fromBase64String(t):jn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zy(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function __(t){const e=t.mapValue.fields.__previous_value__;return Zy(e)?__(e):e}function Of(t){const e=Qo(t.mapValue.fields.__local_write_time__.timestampValue);return new en(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kz{constructor(e,r,n,s,i,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class $u{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new $u("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof $u&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function sc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zy(t)?4:Yz(t)?9007199254740991:Qz(t)?10:11:Nt()}function ci(t,e){if(t===e)return!0;const r=sc(t);if(r!==sc(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Of(t).isEqual(Of(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Qo(s.timestampValue),l=Qo(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ac(s.bytesValue).isEqual(ac(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Gr(s.geoPointValue.latitude)===Gr(i.geoPointValue.latitude)&&Gr(s.geoPointValue.longitude)===Gr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Gr(s.integerValue)===Gr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Gr(s.doubleValue),l=Gr(i.doubleValue);return o===l?p0(o)===p0(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Ru(t.arrayValue.values||[],e.arrayValue.values||[],ci);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(VE(o)!==VE(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!ci(o[c],l[c])))return!1;return!0}(t,e);default:return Nt()}}function Df(t,e){return(t.values||[]).find(r=>ci(r,e))!==void 0}function Lu(t,e){if(t===e)return 0;const r=sc(t),n=sc(e);if(r!==n)return Ht(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Ht(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Gr(i.integerValue||i.doubleValue),c=Gr(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return BE(t.timestampValue,e.timestampValue);case 4:return BE(Of(t),Of(e));case 5:return Ht(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ac(i),c=ac(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Ht(l[u],c[u]);if(d!==0)return d}return Ht(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Ht(Gr(i.latitude),Gr(o.latitude));return l!==0?l:Ht(Gr(i.longitude),Gr(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return UE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const h=i.fields||{},f=o.fields||{},m=(l=h.value)===null||l===void 0?void 0:l.arrayValue,y=(c=f.value)===null||c===void 0?void 0:c.arrayValue,g=Ht(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return g!==0?g:UE(m,y)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Mp.mapValue&&o===Mp.mapValue)return 0;if(i===Mp.mapValue)return 1;if(o===Mp.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const f=Ht(c[h],d[h]);if(f!==0)return f;const m=Lu(l[c[h]],u[d[h]]);if(m!==0)return m}return Ht(c.length,d.length)}(t.mapValue,e.mapValue);default:throw Nt()}}function BE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ht(t,e);const r=Qo(t),n=Qo(e),s=Ht(r.seconds,n.seconds);return s!==0?s:Ht(r.nanos,n.nanos)}function UE(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Lu(r[s],n[s]);if(i)return i}return Ht(r.length,n.length)}function Vu(t){return lj(t)}function lj(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Qo(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ac(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return dt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=lj(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${lj(r.fields[o])}`;return s+"}"}(t.mapValue):Nt()}function g0(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function cj(t){return!!t&&"integerValue"in t}function S_(t){return!!t&&"arrayValue"in t}function zE(t){return!!t&&"nullValue"in t}function qE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Cg(t){return!!t&&"mapValue"in t}function Qz(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Kh(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return yc(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Kh(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Kh(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Yz(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e){this.value=e}static empty(){return new va({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Cg(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kh(r)}setAll(e){let r=xn.emptyPath(),n={},s=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=l.popLast()}o?n[l.lastSegment()]=Kh(o):s.push(l.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());Cg(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ci(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Cg(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){yc(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new va(Kh(this.value))}}function v5(t){const e=[];return yc(t.fields,(r,n)=>{const s=new xn([r]);if(Cg(n)){const i=v5(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new $a(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,r,n,s,i,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Kn(e,0,St.min(),St.min(),St.min(),va.empty(),0)}static newFoundDocument(e,r,n,s){return new Kn(e,1,r,St.min(),n,s,0)}static newNoDocument(e,r){return new Kn(e,2,r,St.min(),St.min(),va.empty(),0)}static newUnknownDocument(e,r){return new Kn(e,3,r,St.min(),St.min(),va.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(St.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=va.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=va.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=St.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Kn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Kn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,r){this.position=e,this.inclusive=r}}function HE(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?n=dt.comparator(dt.fromName(o.referenceValue),r.key):n=Lu(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function WE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ci(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,r="asc"){this.field=e,this.dir=r}}function Xz(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let b5=class{};class Zr extends b5{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Zz(e,r,n):r==="array-contains"?new rq(e,n):r==="in"?new nq(e,n):r==="not-in"?new aq(e,n):r==="array-contains-any"?new sq(e,n):new Zr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new eq(e,n):new tq(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Lu(r,this.value)):r!==null&&sc(this.value)===sc(r)&&this.matchesComparison(Lu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Nt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Us extends b5{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Us(e,r)}matches(e){return w5(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function w5(t){return t.op==="and"}function j5(t){return Jz(t)&&w5(t)}function Jz(t){for(const e of t.filters)if(e instanceof Us)return!1;return!0}function uj(t){if(t instanceof Zr)return t.field.canonicalString()+t.op.toString()+Vu(t.value);if(j5(t))return t.filters.map(e=>uj(e)).join(",");{const e=t.filters.map(r=>uj(r)).join(",");return`${t.op}(${e})`}}function N5(t,e){return t instanceof Zr?function(n,s){return s instanceof Zr&&n.op===s.op&&n.field.isEqual(s.field)&&ci(n.value,s.value)}(t,e):t instanceof Us?function(n,s){return s instanceof Us&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,o,l)=>i&&N5(o,s.filters[l]),!0):!1}(t,e):void Nt()}function _5(t){return t instanceof Zr?function(r){return`${r.field.canonicalString()} ${r.op} ${Vu(r.value)}`}(t):t instanceof Us?function(r){return r.op.toString()+" {"+r.getFilters().map(_5).join(" ,")+"}"}(t):"Filter"}class Zz extends Zr{constructor(e,r,n){super(e,r,n),this.key=dt.fromName(n.referenceValue)}matches(e){const r=dt.comparator(e.key,this.key);return this.matchesComparison(r)}}class eq extends Zr{constructor(e,r){super(e,"in",r),this.keys=S5("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class tq extends Zr{constructor(e,r){super(e,"not-in",r),this.keys=S5("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function S5(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>dt.fromName(n.referenceValue))}class rq extends Zr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return S_(r)&&Df(r.arrayValue,this.value)}}class nq extends Zr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Df(this.value.arrayValue,r)}}class aq extends Zr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Df(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Df(this.value.arrayValue,r)}}class sq extends Zr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!S_(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Df(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iq{constructor(e,r=null,n=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function GE(t,e=null,r=[],n=[],s=null,i=null,o=null){return new iq(t,e,r,n,s,i,o)}function C_(t){const e=Ct(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>uj(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Jy(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Vu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Vu(n)).join(",")),e.ue=r}return e.ue}function E_(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Xz(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!N5(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!WE(t.startAt,e.startAt)&&WE(t.endAt,e.endAt)}function dj(t){return dt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,r=null,n=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function oq(t,e,r,n,s,i,o,l){return new xc(t,e,r,n,s,i,o,l)}function ex(t){return new xc(t)}function KE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function P_(t){return t.collectionGroup!==null}function yu(t){const e=Ct(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new $n(xn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Mf(i,n))}),r.has(xn.keyField().canonicalString())||e.ce.push(new Mf(xn.keyField(),n))}return e.ce}function ri(t){const e=Ct(t);return e.le||(e.le=lq(e,yu(t))),e.le}function lq(t,e){if(t.limitType==="F")return GE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Mf(s.field,i)});const r=t.endAt?new Fu(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Fu(t.startAt.position,t.startAt.inclusive):null;return GE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function hj(t,e){const r=t.filters.concat([e]);return new xc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function y0(t,e,r){return new xc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function tx(t,e){return E_(ri(t),ri(e))&&t.limitType===e.limitType}function C5(t){return`${C_(ri(t))}|lt:${t.limitType}`}function Rc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>_5(s)).join(", ")}]`),Jy(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Vu(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Vu(s)).join(",")),`Target(${n})`}(ri(t))}; limitType=${t.limitType})`}function rx(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):dt.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of yu(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,l,c){const u=HE(o,l,c);return o.inclusive?u<=0:u<0}(n.startAt,yu(n),s)||n.endAt&&!function(o,l,c){const u=HE(o,l,c);return o.inclusive?u>=0:u>0}(n.endAt,yu(n),s))}(t,e)}function cq(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function E5(t){return(e,r)=>{let n=!1;for(const s of yu(t)){const i=uq(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function uq(t,e,r){const n=t.field.isKeyField()?dt.comparator(e.key,r.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Lu(c,u):Nt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Nt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){yc(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return y5(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dq=new Vr(dt.comparator);function Qi(){return dq}const P5=new Vr(dt.comparator);function kh(...t){let e=P5;for(const r of t)e=e.insert(r.key,r);return e}function T5(t){let e=P5;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ol(){return Qh()}function A5(){return Qh()}function Qh(){return new Sd(t=>t.toString(),(t,e)=>t.isEqual(e))}const hq=new Vr(dt.comparator),fq=new $n(dt.comparator);function Rt(...t){let e=fq;for(const r of t)e=e.add(r);return e}const mq=new $n(Ht);function pq(){return mq}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:p0(e)?"-0":e}}function I5(t){return{integerValue:""+t}}function k5(t,e){return Wz(e)?I5(e):T_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(){this._=void 0}}function gq(t,e,r){return t instanceof x0?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Zy(i)&&(i=__(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(r,e):t instanceof Bu?D5(t,e):t instanceof Rf?M5(t,e):function(s,i){const o=O5(s,i),l=QE(o)+QE(s.Pe);return cj(o)&&cj(s.Pe)?I5(l):T_(s.serializer,l)}(t,e)}function yq(t,e,r){return t instanceof Bu?D5(t,e):t instanceof Rf?M5(t,e):r}function O5(t,e){return t instanceof $f?function(n){return cj(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class x0 extends nx{}class Bu extends nx{constructor(e){super(),this.elements=e}}function D5(t,e){const r=R5(e);for(const n of t.elements)r.some(s=>ci(s,n))||r.push(n);return{arrayValue:{values:r}}}class Rf extends nx{constructor(e){super(),this.elements=e}}function M5(t,e){let r=R5(e);for(const n of t.elements)r=r.filter(s=>!ci(s,n));return{arrayValue:{values:r}}}class $f extends nx{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function QE(t){return Gr(t.integerValue||t.doubleValue)}function R5(t){return S_(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e,r){this.field=e,this.transform=r}}function xq(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Bu&&s instanceof Bu||n instanceof Rf&&s instanceof Rf?Ru(n.elements,s.elements,ci):n instanceof $f&&s instanceof $f?ci(n.Pe,s.Pe):n instanceof x0&&s instanceof x0}(t.transform,e.transform)}class vq{constructor(e,r){this.version=e,this.transformResults=r}}class ca{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ca}static exists(e){return new ca(void 0,e)}static updateTime(e){return new ca(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Eg(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ax{}function L5(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new sx(t.key,ca.none()):new Rm(t.key,t.data,ca.none());{const r=t.data,n=va.empty();let s=new $n(xn.comparator);for(let i of e.fields)if(!s.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new sl(t.key,n,new $a(s.toArray()),ca.none())}}function bq(t,e,r){t instanceof Rm?function(s,i,o){const l=s.value.clone(),c=XE(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof sl?function(s,i,o){if(!Eg(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=XE(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(V5(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function Yh(t,e,r,n){return t instanceof Rm?function(i,o,l,c){if(!Eg(i.precondition,o))return l;const u=i.value.clone(),d=JE(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof sl?function(i,o,l,c){if(!Eg(i.precondition,o))return l;const u=JE(i.fieldTransforms,c,o),d=o.data;return d.setAll(V5(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(i,o,l){return Eg(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function wq(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=O5(n.transform,s||null);i!=null&&(r===null&&(r=va.empty()),r.set(n.field,i))}return r||null}function YE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Ru(n,s,(i,o)=>xq(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Rm extends ax{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class sl extends ax{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function V5(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function XE(t,e,r){const n=new Map;Zt(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);n.set(i.field,yq(o,l,r[s]))}return n}function JE(t,e,r){const n=new Map;for(const s of t){const i=s.transform,o=r.data.field(s.field);n.set(s.field,gq(i,o,e))}return n}class sx extends ax{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class jq extends ax{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nq{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&bq(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Yh(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Yh(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=A5();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=r.has(s.key)?null:l;const c=L5(o,l);c!==null&&n.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(St.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Rt())}isEqual(e){return this.batchId===e.batchId&&Ru(this.mutations,e.mutations,(r,n)=>YE(r,n))&&Ru(this.baseMutations,e.baseMutations,(r,n)=>YE(r,n))}}class A_{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Zt(e.mutations.length===n.length);let s=function(){return hq}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new A_(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _q{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sq{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yr,Vt;function Cq(t){switch(t){default:return Nt();case je.CANCELLED:case je.UNKNOWN:case je.DEADLINE_EXCEEDED:case je.RESOURCE_EXHAUSTED:case je.INTERNAL:case je.UNAVAILABLE:case je.UNAUTHENTICATED:return!1;case je.INVALID_ARGUMENT:case je.NOT_FOUND:case je.ALREADY_EXISTS:case je.PERMISSION_DENIED:case je.FAILED_PRECONDITION:case je.ABORTED:case je.OUT_OF_RANGE:case je.UNIMPLEMENTED:case je.DATA_LOSS:return!0}}function F5(t){if(t===void 0)return Ki("GRPC error has no .code"),je.UNKNOWN;switch(t){case Yr.OK:return je.OK;case Yr.CANCELLED:return je.CANCELLED;case Yr.UNKNOWN:return je.UNKNOWN;case Yr.DEADLINE_EXCEEDED:return je.DEADLINE_EXCEEDED;case Yr.RESOURCE_EXHAUSTED:return je.RESOURCE_EXHAUSTED;case Yr.INTERNAL:return je.INTERNAL;case Yr.UNAVAILABLE:return je.UNAVAILABLE;case Yr.UNAUTHENTICATED:return je.UNAUTHENTICATED;case Yr.INVALID_ARGUMENT:return je.INVALID_ARGUMENT;case Yr.NOT_FOUND:return je.NOT_FOUND;case Yr.ALREADY_EXISTS:return je.ALREADY_EXISTS;case Yr.PERMISSION_DENIED:return je.PERMISSION_DENIED;case Yr.FAILED_PRECONDITION:return je.FAILED_PRECONDITION;case Yr.ABORTED:return je.ABORTED;case Yr.OUT_OF_RANGE:return je.OUT_OF_RANGE;case Yr.UNIMPLEMENTED:return je.UNIMPLEMENTED;case Yr.DATA_LOSS:return je.DATA_LOSS;default:return Nt()}}(Vt=Yr||(Yr={}))[Vt.OK=0]="OK",Vt[Vt.CANCELLED=1]="CANCELLED",Vt[Vt.UNKNOWN=2]="UNKNOWN",Vt[Vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vt[Vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vt[Vt.NOT_FOUND=5]="NOT_FOUND",Vt[Vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vt[Vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vt[Vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vt[Vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vt[Vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vt[Vt.ABORTED=10]="ABORTED",Vt[Vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vt[Vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vt[Vt.INTERNAL=13]="INTERNAL",Vt[Vt.UNAVAILABLE=14]="UNAVAILABLE",Vt[Vt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eq(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pq=new Bl([4294967295,4294967295],0);function ZE(t){const e=Eq().encode(t),r=new c5;return r.update(e),new Uint8Array(r.digest())}function eP(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Bl([r,n],0),new Bl([s,i],0)]}class I_{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Oh(`Invalid padding: ${r}`);if(n<0)throw new Oh(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Oh(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Oh(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Bl.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(Bl.fromNumber(n)));return s.compare(Pq)===1&&(s=new Bl([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=ZE(e),[n,s]=eP(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);if(!this.de(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new I_(i,s,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=ZE(e),[n,s]=eP(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Oh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,$m.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new ix(St.min(),s,new Vr(Ht),Qi(),Rt())}}class $m{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new $m(n,r,Rt(),Rt(),Rt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class B5{constructor(e,r){this.targetId=e,this.me=r}}class U5{constructor(e,r,n=jn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class tP{constructor(){this.fe=0,this.ge=nP(),this.pe=jn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Rt(),r=Rt(),n=Rt();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Nt()}}),new $m(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=nP()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Zt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Tq{constructor(e){this.Le=e,this.Be=new Map,this.ke=Qi(),this.qe=rP(),this.Qe=new Vr(Ht)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Nt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(dj(i))if(n===0){const o=new dt(i.path);this.Ue(r,o,Kn.newNoDocument(o,St.min()))}else Zt(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let o,l;try{o=ac(n).toUint8Array()}catch(c){if(c instanceof x5)return nc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new I_(o,s,i)}catch(c){return nc(c instanceof Oh?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&dj(l.target)){const c=new dt(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Kn.newNoDocument(c,e))}i.be&&(r.set(o,i.ve()),i.Ce())}});let n=Rt();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new ix(e,r,this.Qe,this.ke,n);return this.ke=Qi(),this.qe=rP(),this.Qe=new Vr(Ht),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new tP,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new $n(Ht),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||lt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new tP),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function rP(){return new Vr(dt.comparator)}function nP(){return new Vr(dt.comparator)}const Aq={asc:"ASCENDING",desc:"DESCENDING"},Iq={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kq={and:"AND",or:"OR"};class Oq{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function fj(t,e){return t.useProto3Json||Jy(e)?e:{value:e}}function v0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function z5(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Dq(t,e){return v0(t,e.toTimestamp())}function ni(t){return Zt(!!t),St.fromTimestamp(function(r){const n=Qo(r);return new en(n.seconds,n.nanos)}(t))}function k_(t,e){return mj(t,e).canonicalString()}function mj(t,e){const r=function(s){return new gr(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function q5(t){const e=gr.fromString(t);return Zt(Q5(e)),e}function pj(t,e){return k_(t.databaseId,e.path)}function ub(t,e){const r=q5(e);if(r.get(1)!==t.databaseId.projectId)throw new He(je.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new He(je.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new dt(W5(r))}function H5(t,e){return k_(t.databaseId,e)}function Mq(t){const e=q5(t);return e.length===4?gr.emptyPath():W5(e)}function gj(t){return new gr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function W5(t){return Zt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function aP(t,e,r){return{name:pj(t,e),fields:r.value.mapValue.fields}}function Rq(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Nt()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Zt(d===void 0||typeof d=="string"),jn.fromBase64String(d||"")):(Zt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),jn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?je.UNKNOWN:F5(u.code);return new He(d,u.message||"")}(o);r=new U5(n,s,i,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=ub(t,n.document.name),i=ni(n.document.updateTime),o=n.document.createTime?ni(n.document.createTime):St.min(),l=new va({mapValue:{fields:n.document.fields}}),c=Kn.newFoundDocument(s,i,o,l),u=n.targetIds||[],d=n.removedTargetIds||[];r=new Pg(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=ub(t,n.document),i=n.readTime?ni(n.readTime):St.min(),o=Kn.newNoDocument(s,i),l=n.removedTargetIds||[];r=new Pg([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=ub(t,n.document),i=n.removedTargetIds||[];r=new Pg([],i,s,null)}else{if(!("filter"in e))return Nt();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new Sq(s,i),l=n.targetId;r=new B5(l,o)}}return r}function $q(t,e){let r;if(e instanceof Rm)r={update:aP(t,e.key,e.value)};else if(e instanceof sx)r={delete:pj(t,e.key)};else if(e instanceof sl)r={update:aP(t,e.key,e.data),updateMask:Wq(e.fieldMask)};else{if(!(e instanceof jq))return Nt();r={verify:pj(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const l=o.transform;if(l instanceof x0)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Bu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Rf)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof $f)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw Nt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Dq(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Nt()}(t,e.precondition)),r}function Lq(t,e){return t&&t.length>0?(Zt(e!==void 0),t.map(r=>function(s,i){let o=s.updateTime?ni(s.updateTime):ni(i);return o.isEqual(St.min())&&(o=ni(i)),new vq(o,s.transformResults||[])}(r,e))):[]}function Vq(t,e){return{documents:[H5(t,e.path)]}}function Fq(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=H5(t,s);const i=function(u){if(u.length!==0)return K5(Us.create(u,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(f){return{field:$c(f.field),direction:zq(f.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=fj(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:s}}function Bq(t){let e=Mq(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Zt(n===1);const d=r.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];r.where&&(i=function(h){const f=G5(h);return f instanceof Us&&j5(f)?f.getFilters():[f]}(r.where));let o=[];r.orderBy&&(o=function(h){return h.map(f=>function(y){return new Mf(Lc(y.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(f))}(r.orderBy));let l=null;r.limit&&(l=function(h){let f;return f=typeof h=="object"?h.value:h,Jy(f)?null:f}(r.limit));let c=null;r.startAt&&(c=function(h){const f=!!h.before,m=h.values||[];return new Fu(m,f)}(r.startAt));let u=null;return r.endAt&&(u=function(h){const f=!h.before,m=h.values||[];return new Fu(m,f)}(r.endAt)),oq(e,s,o,i,l,"F",c,u)}function Uq(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Nt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function G5(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Lc(r.unaryFilter.field);return Zr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Lc(r.unaryFilter.field);return Zr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Lc(r.unaryFilter.field);return Zr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Lc(r.unaryFilter.field);return Zr.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Nt()}}(t):t.fieldFilter!==void 0?function(r){return Zr.create(Lc(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Nt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Us.create(r.compositeFilter.filters.map(n=>G5(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Nt()}}(r.compositeFilter.op))}(t):Nt()}function zq(t){return Aq[t]}function qq(t){return Iq[t]}function Hq(t){return kq[t]}function $c(t){return{fieldPath:t.canonicalString()}}function Lc(t){return xn.fromServerFormat(t.fieldPath)}function K5(t){return t instanceof Zr?function(r){if(r.op==="=="){if(qE(r.value))return{unaryFilter:{field:$c(r.field),op:"IS_NAN"}};if(zE(r.value))return{unaryFilter:{field:$c(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(qE(r.value))return{unaryFilter:{field:$c(r.field),op:"IS_NOT_NAN"}};if(zE(r.value))return{unaryFilter:{field:$c(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$c(r.field),op:qq(r.op),value:r.value}}}(t):t instanceof Us?function(r){const n=r.getFilters().map(s=>K5(s));return n.length===1?n[0]:{compositeFilter:{op:Hq(r.op),filters:n}}}(t):Nt()}function Wq(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Q5(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,r,n,s,i=St.min(),o=St.min(),l=jn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ao(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ao(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gq{constructor(e){this.ct=e}}function Kq(t){const e=Bq({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?y0(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qq{constructor(){this.un=new Yq}addToCollectionParentIndex(e,r){return this.un.add(r),Ie.resolve()}getCollectionParents(e,r){return Ie.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Ie.resolve()}deleteFieldIndex(e,r){return Ie.resolve()}deleteAllFieldIndexes(e){return Ie.resolve()}createTargetIndexes(e,r){return Ie.resolve()}getDocumentsMatchingTarget(e,r){return Ie.resolve(null)}getIndexType(e,r){return Ie.resolve(0)}getFieldIndexes(e,r){return Ie.resolve([])}getNextCollectionGroupToUpdate(e){return Ie.resolve(null)}getMinOffset(e,r){return Ie.resolve(Ko.min())}getMinOffsetFromCollectionGroup(e,r){return Ie.resolve(Ko.min())}updateCollectionGroup(e,r,n){return Ie.resolve()}updateIndexEntries(e,r){return Ie.resolve()}}class Yq{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new $n(gr.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new $n(gr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Uu(0)}static kn(){return new Uu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xq{constructor(){this.changes=new Sd(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Kn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ie.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jq{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zq{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Yh(n.mutation,s,$a.empty(),en.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Rt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Rt()){const s=Ol();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let o=kh();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=Ol();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Rt()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,s){let i=Qi();const o=Qh(),l=function(){return Qh()}();return r.forEach((c,u)=>{const d=n.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof sl)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Yh(d.mutation,u,d.mutation.getFieldMask(),en.now())):o.set(u.key,$a.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),r.forEach((u,d)=>{var h;return l.set(u,new Jq(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,r){const n=Qh();let s=new Vr((o,l)=>o-l),i=Rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let d=n.get(c)||$a.empty();d=l.applyToLocalView(u,d),n.set(c,d);const h=(s.get(l.batchId)||Rt()).add(c);s=s.insert(l.batchId,h)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,h=A5();d.forEach(f=>{if(!i.has(f)){const m=L5(r.get(f),n.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return Ie.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return dt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):P_(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):Ie.resolve(Ol());let l=-1,c=i;return o.next(u=>Ie.forEach(u,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?Ie.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Rt())).next(d=>({batchId:l,changes:T5(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new dt(r)).next(n=>{let s=kh();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let o=kh();return this.indexManager.getCollectionParents(e,i).next(l=>Ie.forEach(l,c=>{const u=function(h,f){return new xc(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,n,s).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Kn.newInvalidDocument(d)))});let l=kh();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&Yh(d.mutation,u,$a.empty(),en.now()),rx(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eH{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Ie.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:ni(s.createTime)}}(r)),Ie.resolve()}getNamedQuery(e,r){return Ie.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:Kq(s.bundledQuery),readTime:ni(s.readTime)}}(r)),Ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tH{constructor(){this.overlays=new Vr(dt.comparator),this.Ir=new Map}getOverlay(e,r){return Ie.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ol();return Ie.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),Ie.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),Ie.resolve()}getOverlaysForCollection(e,r,n){const s=Ol(),i=r.length+1,o=new dt(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>n&&s.set(c.getKey(),c)}return Ie.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Vr((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let d=i.get(u.largestBatchId);d===null&&(d=Ol(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Ol(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return Ie.resolve(l)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new _q(r,n));let i=this.Ir.get(r);i===void 0&&(i=Rt(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rH{constructor(){this.sessionToken=jn.EMPTY_BYTE_STRING}getSessionToken(e){return Ie.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(){this.Tr=new $n(fn.Er),this.dr=new $n(fn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new fn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new fn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new dt(new gr([])),n=new fn(r,e),s=new fn(r,e+1),i=[];return this.dr.forEachInRange([n,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new dt(new gr([])),n=new fn(r,e),s=new fn(r,e+1);let i=Rt();return this.dr.forEachInRange([n,s],o=>{i=i.add(o.key)}),i}containsKey(e){const r=new fn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class fn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return dt.comparator(e.key,r.key)||Ht(e.wr,r.wr)}static Ar(e,r){return Ht(e.wr,r.wr)||dt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nH{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new $n(fn.Er)}checkEmpty(e){return Ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Nq(i,r,n,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new fn(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Ie.resolve(o)}lookupMutationBatch(e,r){return Ie.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return Ie.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ie.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new fn(r,0),s=new fn(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],o=>{const l=this.Dr(o.wr);i.push(l)}),Ie.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new $n(Ht);return r.forEach(s=>{const i=new fn(s,0),o=new fn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{n=n.add(l.wr)})}),Ie.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;dt.isDocumentKey(i)||(i=i.child(""));const o=new fn(new dt(i),0);let l=new $n(Ht);return this.br.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},o),Ie.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){Zt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Ie.forEach(r.mutations,s=>{const i=new fn(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new fn(r,0),s=this.br.firstAfterOrEqual(n);return Ie.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ie.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aH{constructor(e){this.Mr=e,this.docs=function(){return new Vr(dt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ie.resolve(n?n.document.mutableCopy():Kn.newInvalidDocument(r))}getEntries(e,r){let n=Qi();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Kn.newInvalidDocument(s))}),Ie.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=Qi();const o=r.path,l=new dt(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Uz(Bz(d),n)<=0||(s.has(d.key)||rx(r,d))&&(i=i.insert(d.key,d.mutableCopy()))}return Ie.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Nt()}Or(e,r){return Ie.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new sH(this)}getSize(e){return Ie.resolve(this.size)}}class sH extends Xq{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),Ie.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iH{constructor(e){this.persistence=e,this.Nr=new Sd(r=>C_(r),E_),this.lastRemoteSnapshotVersion=St.min(),this.highestTargetId=0,this.Lr=0,this.Br=new O_,this.targetCount=0,this.kr=Uu.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),Ie.resolve()}getLastRemoteSnapshotVersion(e){return Ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ie.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Ie.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Ie.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Uu(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Ie.resolve()}updateTargetData(e,r){return this.Kn(r),Ie.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Ie.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),Ie.waitFor(i).next(()=>s)}getTargetCount(e){return Ie.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Ie.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Ie.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),Ie.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Ie.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Ie.resolve(n)}containsKey(e,r){return Ie.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oH{constructor(e,r){this.qr={},this.overlays={},this.Qr=new N_(0),this.Kr=!1,this.Kr=!0,this.$r=new rH,this.referenceDelegate=e(this),this.Ur=new iH(this),this.indexManager=new Qq,this.remoteDocumentCache=function(s){return new aH(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new Gq(r),this.Gr=new eH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new tH,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new nH(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){lt("MemoryPersistence","Starting transaction:",e);const s=new lH(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return Ie.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class lH extends qz{constructor(e){super(),this.currentSequenceNumber=e}}class D_{constructor(e){this.persistence=e,this.Jr=new O_,this.Yr=null}static Zr(e){return new D_(e)}get Xr(){if(this.Yr)return this.Yr;throw Nt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Ie.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Ie.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Ie.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ie.forEach(this.Xr,n=>{const s=dt.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,St.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Ie.or([()=>Ie.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=Rt(),s=Rt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new M_(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uH{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return a7()?8:Hz(Zn())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new cH;return this.Xi(e,r,o).next(l=>{if(i.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(lh()<=$t.DEBUG&&lt("QueryEngine","SDK will not create cache indexes for query:",Rc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Ie.resolve()):(lh()<=$t.DEBUG&&lt("QueryEngine","Query:",Rc(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(lh()<=$t.DEBUG&&lt("QueryEngine","The SDK decides to create cache indexes for query:",Rc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ri(r))):Ie.resolve())}Yi(e,r){if(KE(r))return Ie.resolve(null);let n=ri(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=y0(r,null,"F"),n=ri(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=Rt(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.ts(r,l);return this.ns(r,u,o,c.readTime)?this.Yi(e,y0(r,null,"F")):this.rs(e,u,r,c)}))})))}Zi(e,r,n,s){return KE(r)||s.isEqual(St.min())?Ie.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const o=this.ts(r,i);return this.ns(r,o,n,s)?Ie.resolve(null):(lh()<=$t.DEBUG&&lt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Rc(r)),this.rs(e,o,r,Fz(s,-1)).next(l=>l))})}ts(e,r){let n=new $n(E5(e));return r.forEach((s,i)=>{rx(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return lh()<=$t.DEBUG&&lt("QueryEngine","Using full collection scan to execute query:",Rc(r)),this.Ji.getDocumentsMatchingQuery(e,r,Ko.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dH{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Vr(Ht),this._s=new Sd(i=>C_(i),E_),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Zq(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function hH(t,e,r,n){return new dH(t,e,r,n)}async function Y5(t,e){const r=Ct(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],l=[];let c=Rt();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function fH(t,e){const r=Ct(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const h=u.batch,f=h.keys();let m=Ie.resolve();return f.forEach(y=>{m=m.next(()=>d.getEntry(c,y)).next(g=>{const x=u.docVersions.get(y);Zt(x!==null),g.version.compareTo(x)<0&&(h.applyToRemoteDocument(g,u),g.isValidDocument()&&(g.setReadTime(u.commitVersion),d.addEntry(g)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Rt();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function X5(t){const e=Ct(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function mH(t,e){const r=Ct(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const l=[];e.targetChanges.forEach((d,h)=>{const f=s.get(h);if(!f)return;l.push(r.Ur.removeMatchingKeys(i,d.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(i,d.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(jn.EMPTY_BYTE_STRING,St.min()).withLastLimboFreeSnapshotVersion(St.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,n)),s=s.insert(h,m),function(g,x,b){return g.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(f,m,d)&&l.push(r.Ur.updateTargetData(i,m))});let c=Qi(),u=Rt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(pH(i,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!n.isEqual(St.min())){const d=r.Ur.getLastRemoteSnapshotVersion(i).next(h=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));l.push(d)}return Ie.waitFor(l).next(()=>o.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(r.os=s,i))}function pH(t,e,r){let n=Rt(),s=Rt();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let o=Qi();return r.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(St.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):lt("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function gH(t,e){const r=Ct(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function yH(t,e){const r=Ct(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,Ie.resolve(s)):r.Ur.allocateTargetId(n).next(o=>(s=new Ao(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function yj(t,e,r){const n=Ct(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Mm(o))throw o;lt("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function sP(t,e,r){const n=Ct(t);let s=St.min(),i=Rt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const h=Ct(c),f=h._s.get(d);return f!==void 0?Ie.resolve(h.os.get(f)):h.Ur.getTargetData(u,d)}(n,o,ri(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?s:St.min(),r?i:Rt())).next(l=>(xH(n,cq(e),l),{documents:l,Ts:i})))}function xH(t,e,r){let n=t.us.get(e)||St.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class iP{constructor(){this.activeTargetIds=pq()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vH{constructor(){this.so=new iP,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new iP,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bH{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){lt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){lt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rp=null;function db(){return Rp===null?Rp=function(){return 268435456+Math.round(2147483648*Math.random())}():Rp++,"0x"+Rp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jH{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn="WebChannelConnection";class NH extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,o){const l=db(),c=this.xo(r,n.toUriEncodedString());lt("RestConnection",`Sending RPC '${r}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(r,c,u,s).then(d=>(lt("RestConnection",`Received RPC '${r}' ${l}: `,d),d),d=>{throw nc("RestConnection",`RPC '${r}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(r,n,s,i,o,l){return this.Mo(r,n,s,i,o)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+_d}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,o)=>r[o]=i),s&&s.headers.forEach((i,o)=>r[o]=i)}xo(r,n){const s=wH[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=db();return new Promise((o,l)=>{const c=new u5;c.setWithCredentials(!0),c.listenOnce(d5.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Sg.NO_ERROR:const d=c.getResponseJson();lt(qn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Sg.TIMEOUT:lt(qn,`RPC '${e}' ${i} timed out`),l(new He(je.DEADLINE_EXCEEDED,"Request time out"));break;case Sg.HTTP_ERROR:const h=c.getStatus();if(lt(qn,`RPC '${e}' ${i} failed with status:`,h,"response text:",c.getResponseText()),h>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const y=function(x){const b=x.toLowerCase().replace(/_/g,"-");return Object.values(je).indexOf(b)>=0?b:je.UNKNOWN}(m.status);l(new He(y,m.message))}else l(new He(je.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new He(je.UNAVAILABLE,"Connection failed."));break;default:Nt()}}finally{lt(qn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);lt(qn,`RPC '${e}' ${i} sending request:`,s),c.send(r,"POST",u,n,15)})}Bo(e,r,n){const s=db(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=m5(),l=f5(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=i.join("");lt(qn,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=o.createWebChannel(d,c);let f=!1,m=!1;const y=new jH({Io:x=>{m?lt(qn,`Not sending because RPC '${e}' stream ${s} is closed:`,x):(f||(lt(qn,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),lt(qn,`RPC '${e}' stream ${s} sending:`,x),h.send(x))},To:()=>h.close()}),g=(x,b,v)=>{x.listen(b,j=>{try{v(j)}catch(S){setTimeout(()=>{throw S},0)}})};return g(h,Ih.EventType.OPEN,()=>{m||(lt(qn,`RPC '${e}' stream ${s} transport opened.`),y.yo())}),g(h,Ih.EventType.CLOSE,()=>{m||(m=!0,lt(qn,`RPC '${e}' stream ${s} transport closed`),y.So())}),g(h,Ih.EventType.ERROR,x=>{m||(m=!0,nc(qn,`RPC '${e}' stream ${s} transport errored:`,x),y.So(new He(je.UNAVAILABLE,"The operation could not be completed")))}),g(h,Ih.EventType.MESSAGE,x=>{var b;if(!m){const v=x.data[0];Zt(!!v);const j=v,S=j.error||((b=j[0])===null||b===void 0?void 0:b.error);if(S){lt(qn,`RPC '${e}' stream ${s} received error:`,S);const _=S.status;let C=function(E){const k=Yr[E];if(k!==void 0)return F5(k)}(_),N=S.message;C===void 0&&(C=je.INTERNAL,N="Unknown error status: "+_+" with message "+S.message),m=!0,y.So(new He(C,N)),h.close()}else lt(qn,`RPC '${e}' stream ${s} received:`,v),y.bo(v)}}),g(l,h5.STAT_EVENT,x=>{x.stat===oj.PROXY?lt(qn,`RPC '${e}' stream ${s} detected buffering proxy`):x.stat===oj.NOPROXY&&lt(qn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function hb(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(t){return new Oq(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J5{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&lt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{constructor(e,r,n,s,i,o,l,c){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new J5(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===je.RESOURCE_EXHAUSTED?(Ki(r.toString()),Ki("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===je.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new He(je.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return lt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(lt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _H extends Z5{constructor(e,r,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=Rq(this.serializer,e),n=function(i){if(!("targetChange"in i))return St.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?St.min():o.readTime?ni(o.readTime):St.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=gj(this.serializer),r.addTarget=function(i,o){let l;const c=o.target;if(l=dj(c)?{documents:Vq(i,c)}:{query:Fq(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=z5(i,o.resumeToken);const u=fj(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(St.min())>0){l.readTime=v0(i,o.snapshotVersion.toTimestamp());const u=fj(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=Uq(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=gj(this.serializer),r.removeTarget=e,this.a_(r)}}class SH extends Z5{constructor(e,r,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Zt(!!e.streamToken),this.lastStreamToken=e.streamToken,Zt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Zt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=Lq(e.writeResults,e.commitTime),n=ni(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=gj(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>$q(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CH extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new He(je.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,mj(r,n),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new He(je.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,mj(r,n),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new He(je.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class EH{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ki(r),this.D_=!1):lt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PH{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{n.enqueueAndForget(async()=>{vc(this)&&(lt("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=Ct(c);u.L_.add(4),await Lm(u),u.q_.set("Unknown"),u.L_.delete(4),await lx(u)}(this))})}),this.q_=new EH(n,s)}}async function lx(t){if(vc(t))for(const e of t.B_)await e(!0)}async function Lm(t){for(const e of t.B_)await e(!1)}function eM(t,e){const r=Ct(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),V_(r)?L_(r):Cd(r).r_()&&$_(r,e))}function R_(t,e){const r=Ct(t),n=Cd(r);r.N_.delete(e),n.r_()&&tM(r,e),r.N_.size===0&&(n.r_()?n.o_():vc(r)&&r.q_.set("Unknown"))}function $_(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(St.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Cd(t).A_(e)}function tM(t,e){t.Q_.xe(e),Cd(t).R_(e)}function L_(t){t.Q_=new Tq({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Cd(t).start(),t.q_.v_()}function V_(t){return vc(t)&&!Cd(t).n_()&&t.N_.size>0}function vc(t){return Ct(t).L_.size===0}function rM(t){t.Q_=void 0}async function TH(t){t.q_.set("Online")}async function AH(t){t.N_.forEach((e,r)=>{$_(t,e)})}async function IH(t,e){rM(t),V_(t)?(t.q_.M_(e),L_(t)):t.q_.set("Unknown")}async function kH(t,e,r){if(t.q_.set("Online"),e instanceof U5&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(n){lt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await b0(t,n)}else if(e instanceof Pg?t.Q_.Ke(e):e instanceof B5?t.Q_.He(e):t.Q_.We(e),!r.isEqual(St.min()))try{const n=await X5(t.localStore);r.compareTo(n)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(jn.EMPTY_BYTE_STRING,d.snapshotVersion)),tM(i,c);const h=new Ao(d.target,c,u,d.sequenceNumber);$_(i,h)}),i.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){lt("RemoteStore","Failed to raise snapshot:",n),await b0(t,n)}}async function b0(t,e,r){if(!Mm(e))throw e;t.L_.add(1),await Lm(t),t.q_.set("Offline"),r||(r=()=>X5(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{lt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await lx(t)})}function nM(t,e){return e().catch(r=>b0(t,r,e))}async function cx(t){const e=Ct(t),r=Yo(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;OH(e);)try{const s=await gH(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,DH(e,s)}catch(s){await b0(e,s)}aM(e)&&sM(e)}function OH(t){return vc(t)&&t.O_.length<10}function DH(t,e){t.O_.push(e);const r=Yo(t);r.r_()&&r.V_&&r.m_(e.mutations)}function aM(t){return vc(t)&&!Yo(t).n_()&&t.O_.length>0}function sM(t){Yo(t).start()}async function MH(t){Yo(t).p_()}async function RH(t){const e=Yo(t);for(const r of t.O_)e.m_(r.mutations)}async function $H(t,e,r){const n=t.O_.shift(),s=A_.from(n,e,r);await nM(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await cx(t)}async function LH(t,e){e&&Yo(t).V_&&await async function(n,s){if(function(o){return Cq(o)&&o!==je.ABORTED}(s.code)){const i=n.O_.shift();Yo(n).s_(),await nM(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await cx(n)}}(t,e),aM(t)&&sM(t)}async function lP(t,e){const r=Ct(t);r.asyncQueue.verifyOperationInProgress(),lt("RemoteStore","RemoteStore received new credentials");const n=vc(r);r.L_.add(3),await Lm(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await lx(r)}async function VH(t,e){const r=Ct(t);e?(r.L_.delete(2),await lx(r)):e||(r.L_.add(2),await Lm(r),r.q_.set("Unknown"))}function Cd(t){return t.K_||(t.K_=function(r,n,s){const i=Ct(r);return i.w_(),new _H(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:TH.bind(null,t),Ro:AH.bind(null,t),mo:IH.bind(null,t),d_:kH.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),V_(t)?L_(t):t.q_.set("Unknown")):(await t.K_.stop(),rM(t))})),t.K_}function Yo(t){return t.U_||(t.U_=function(r,n,s){const i=Ct(r);return i.w_(),new SH(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:MH.bind(null,t),mo:LH.bind(null,t),f_:RH.bind(null,t),g_:$H.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await cx(t)):(await t.U_.stop(),t.O_.length>0&&(lt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Mi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const o=Date.now()+n,l=new F_(e,r,o,s,i);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new He(je.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function B_(t,e){if(Ki("AsyncQueue",`${e}: ${t}`),Mm(t))return new He(je.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e){this.comparator=e?(r,n)=>e(r,n)||dt.comparator(r.key,n.key):(r,n)=>dt.comparator(r.key,n.key),this.keyedMap=kh(),this.sortedSet=new Vr(this.comparator)}static emptySet(e){return new xu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof xu)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new xu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(){this.W_=new Vr(dt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Nt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class zu{constructor(e,r,n,s,i,o,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,s,i){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new zu(e,r,xu.emptySet(r),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tx(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FH{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class BH{constructor(){this.queries=uP(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Ct(r),i=s.queries;s.queries=uP(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new He(je.ABORTED,"Firestore shutting down"))}}function uP(){return new Sd(t=>C5(t),tx)}async function U_(t,e){const r=Ct(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new FH,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const l=B_(o,`Initialization of query '${Rc(e.query)}' failed`);return void e.onError(l)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&q_(r)}async function z_(t,e){const r=Ct(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function UH(t,e){const r=Ct(t);let n=!1;for(const s of e){const i=s.query,o=r.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(n=!0);o.z_=s}}n&&q_(r)}function zH(t,e,r){const n=Ct(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function q_(t){t.Y_.forEach(e=>{e.next()})}var xj,dP;(dP=xj||(xj={})).ea="default",dP.Cache="cache";class H_{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new zu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=zu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==xj.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(e){this.key=e}}class oM{constructor(e){this.key=e}}class qH{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Rt(),this.mutatedKeys=Rt(),this.Aa=E5(e),this.Ra=new xu(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new cP,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const f=s.get(d),m=rx(this.query,h)?h:null,y=!!f&&this.mutatedKeys.has(f.key),g=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let x=!1;f&&m?f.data.isEqual(m.data)?y!==g&&(n.track({type:3,doc:m}),x=!0):this.ga(f,m)||(n.track({type:2,doc:m}),x=!0,(c&&this.Aa(m,c)>0||u&&this.Aa(m,u)<0)&&(l=!0)):!f&&m?(n.track({type:0,doc:m}),x=!0):f&&!m&&(n.track({type:1,doc:f}),x=!0,(c||u)&&(l=!0)),x&&(m?(o=o.add(m),i=g?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{Ra:o,fa:n,ns:l,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,h)=>function(m,y){const g=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Nt()}};return g(m)-g(y)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(n),s=s!=null&&s;const l=r&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new zu(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new cP,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Rt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new oM(n))}),this.da.forEach(n=>{e.has(n)||r.push(new iM(n))}),r}ba(e){this.Ta=e.Ts,this.da=Rt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return zu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class HH{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class WH{constructor(e){this.key=e,this.va=!1}}class GH{constructor(e,r,n,s,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Sd(l=>C5(l),tx),this.Ma=new Map,this.xa=new Set,this.Oa=new Vr(dt.comparator),this.Na=new Map,this.La=new O_,this.Ba={},this.ka=new Map,this.qa=Uu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function KH(t,e,r=!0){const n=fM(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await lM(n,e,r,!0),s}async function QH(t,e){const r=fM(t);await lM(r,e,!0,!1)}async function lM(t,e,r,n){const s=await yH(t.localStore,ri(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let l;return n&&(l=await YH(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&eM(t.remoteStore,s),l}async function YH(t,e,r,n,s){t.Ka=(h,f,m)=>async function(g,x,b,v){let j=x.view.ma(b);j.ns&&(j=await sP(g.localStore,x.query,!1).then(({documents:N})=>x.view.ma(N,j)));const S=v&&v.targetChanges.get(x.targetId),_=v&&v.targetMismatches.get(x.targetId)!=null,C=x.view.applyChanges(j,g.isPrimaryClient,S,_);return fP(g,x.targetId,C.wa),C.snapshot}(t,h,f,m);const i=await sP(t.localStore,e,!0),o=new qH(e,i.Ts),l=o.ma(i.documents),c=$m.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);fP(t,r,u.wa);const d=new HH(e,r,o);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function XH(t,e,r){const n=Ct(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(o=>!tx(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await yj(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&R_(n.remoteStore,s.targetId),vj(n,s.targetId)}).catch(Dm)):(vj(n,s.targetId),await yj(n.localStore,s.targetId,!0))}async function JH(t,e){const r=Ct(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),R_(r.remoteStore,n.targetId))}async function ZH(t,e,r){const n=iW(t);try{const s=await function(o,l){const c=Ct(o),u=en.now(),d=l.reduce((m,y)=>m.add(y.key),Rt());let h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=Qi(),g=Rt();return c.cs.getEntries(m,d).next(x=>{y=x,y.forEach((b,v)=>{v.isValidDocument()||(g=g.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,y)).next(x=>{h=x;const b=[];for(const v of l){const j=wq(v,h.get(v.key).overlayedDocument);j!=null&&b.push(new sl(v.key,j,v5(j.value.mapValue),ca.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,b,l)}).next(x=>{f=x;const b=x.applyToLocalDocumentSet(h,g);return c.documentOverlayCache.saveOverlays(m,x.batchId,b)})}).then(()=>({batchId:f.batchId,changes:T5(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new Vr(Ht)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(n,s.batchId,r),await Vm(n,s.changes),await cx(n.remoteStore)}catch(s){const i=B_(s,"Failed to persist write");r.reject(i)}}async function cM(t,e){const r=Ct(t);try{const n=await mH(r.localStore,e);e.targetChanges.forEach((s,i)=>{const o=r.Na.get(i);o&&(Zt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Zt(o.va):s.removedDocuments.size>0&&(Zt(o.va),o.va=!1))}),await Vm(r,n,e)}catch(n){await Dm(n)}}function hP(t,e,r){const n=Ct(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Ct(o);c.onlineState=l;let u=!1;c.queries.forEach((d,h)=>{for(const f of h.j_)f.Z_(l)&&(u=!0)}),u&&q_(c)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function eW(t,e,r){const n=Ct(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let o=new Vr(dt.comparator);o=o.insert(i,Kn.newNoDocument(i,St.min()));const l=Rt().add(i),c=new ix(St.min(),new Map,new Vr(Ht),o,l);await cM(n,c),n.Oa=n.Oa.remove(i),n.Na.delete(e),W_(n)}else await yj(n.localStore,e,!1).then(()=>vj(n,e,r)).catch(Dm)}async function tW(t,e){const r=Ct(t),n=e.batch.batchId;try{const s=await fH(r.localStore,e);dM(r,n,null),uM(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Vm(r,s)}catch(s){await Dm(s)}}async function rW(t,e,r){const n=Ct(t);try{const s=await function(o,l){const c=Ct(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(h=>(Zt(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(n.localStore,e);dM(n,e,r),uM(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Vm(n,s)}catch(s){await Dm(s)}}function uM(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function dM(t,e,r){const n=Ct(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function vj(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||hM(t,n)})}function hM(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(R_(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),W_(t))}function fP(t,e,r){for(const n of r)n instanceof iM?(t.La.addReference(n.key,e),nW(t,n)):n instanceof oM?(lt("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||hM(t,n.key)):Nt()}function nW(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(lt("SyncEngine","New document in limbo: "+r),t.xa.add(n),W_(t))}function W_(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new dt(gr.fromString(e)),n=t.qa.next();t.Na.set(n,new WH(r)),t.Oa=t.Oa.insert(r,n),eM(t.remoteStore,new Ao(ri(ex(r.path)),n,"TargetPurposeLimboResolution",N_.oe))}}async function Vm(t,e,r){const n=Ct(t),s=[],i=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(u=>{var d;if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:(d=r==null?void 0:r.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=M_.Wi(c.targetId,u);i.push(h)}}))}),await Promise.all(o),n.Ca.d_(s),await async function(c,u){const d=Ct(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Ie.forEach(u,f=>Ie.forEach(f.$i,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>Ie.forEach(f.Ui,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!Mm(h))throw h;lt("LocalStore","Failed to update sequence numbers: "+h)}for(const h of u){const f=h.targetId;if(!h.fromCache){const m=d.os.get(f),y=m.snapshotVersion,g=m.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(f,g)}}}(n.localStore,i))}async function aW(t,e){const r=Ct(t);if(!r.currentUser.isEqual(e)){lt("SyncEngine","User change. New user:",e.toKey());const n=await Y5(r.localStore,e);r.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new He(je.CANCELLED,o))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Vm(r,n.hs)}}function sW(t,e){const r=Ct(t),n=r.Na.get(e);if(n&&n.va)return Rt().add(n.key);{let s=Rt();const i=r.Ma.get(e);if(!i)return s;for(const o of i){const l=r.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function fM(t){const e=Ct(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=cM.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sW.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eW.bind(null,e),e.Ca.d_=UH.bind(null,e.eventManager),e.Ca.$a=zH.bind(null,e.eventManager),e}function iW(t){const e=Ct(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rW.bind(null,e),e}class w0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ox(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return hH(this.persistence,new uH,e.initialUser,this.serializer)}Ga(e){return new oH(D_.Zr,this.serializer)}Wa(e){return new vH}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}w0.provider={build:()=>new w0};class bj{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>hP(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=aW.bind(null,this.syncEngine),await VH(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BH}()}createDatastore(e){const r=ox(e.databaseInfo.databaseId),n=function(i){return new NH(i)}(e.databaseInfo);return function(i,o,l,c){return new CH(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,o,l){return new PH(n,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>hP(this.syncEngine,r,0),function(){return oP.D()?new oP:new bH}())}createSyncEngine(e,r){return function(s,i,o,l,c,u,d){const h=new GH(s,i,o,l,c,u);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Ct(s);lt("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Lm(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}bj.provider={build:()=>new bj};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ki("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oW{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Wn.UNAUTHENTICATED,this.clientId=j_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{lt("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(lt("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Mi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=B_(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function fb(t,e){t.asyncQueue.verifyOperationInProgress(),lt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await Y5(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function mP(t,e){t.asyncQueue.verifyOperationInProgress();const r=await lW(t);lt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>lP(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>lP(e.remoteStore,s)),t._onlineComponents=e}async function lW(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){lt("FirestoreClient","Using user provided OfflineComponentProvider");try{await fb(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===je.FAILED_PRECONDITION||s.code===je.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;nc("Error using user provided cache. Falling back to memory cache: "+r),await fb(t,new w0)}}else lt("FirestoreClient","Using default OfflineComponentProvider"),await fb(t,new w0);return t._offlineComponents}async function mM(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(lt("FirestoreClient","Using user provided OnlineComponentProvider"),await mP(t,t._uninitializedComponentsProvider._online)):(lt("FirestoreClient","Using default OnlineComponentProvider"),await mP(t,new bj))),t._onlineComponents}function cW(t){return mM(t).then(e=>e.syncEngine)}async function j0(t){const e=await mM(t),r=e.eventManager;return r.onListen=KH.bind(null,e.syncEngine),r.onUnlisten=XH.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=QH.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=JH.bind(null,e.syncEngine),r}function uW(t,e,r={}){const n=new Mi;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new G_({next:f=>{d.Za(),o.enqueueAndForget(()=>z_(i,h));const m=f.docs.has(l);!m&&f.fromCache?u.reject(new He(je.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&c&&c.source==="server"?u.reject(new He(je.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new H_(ex(l.path),d,{includeMetadataChanges:!0,_a:!0});return U_(i,h)}(await j0(t),t.asyncQueue,e,r,n)),n.promise}function pM(t,e,r={}){const n=new Mi;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new G_({next:f=>{d.Za(),o.enqueueAndForget(()=>z_(i,h)),f.fromCache&&c.source==="server"?u.reject(new He(je.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new H_(l,d,{includeMetadataChanges:!0,_a:!0});return U_(i,h)}(await j0(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gM(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yM(t,e,r){if(!r)throw new He(je.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function xM(t,e,r,n){if(e===!0&&n===!0)throw new He(je.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function gP(t){if(!dt.isDocumentKey(t))throw new He(je.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function yP(t){if(dt.isDocumentKey(t))throw new He(je.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ux(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Nt()}function bn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new He(je.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=ux(t);throw new He(je.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function dW(t,e){if(e<=0)throw new He(je.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new He(je.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new He(je.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gM((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new He(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new He(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new He(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dx{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xP({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new He(je.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new He(je.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xP(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new g5;switch(n.type){case"firstParty":return new Mz(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new He(je.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=pP.get(r);n&&(lt("ComponentProvider","Removing Datastore"),pP.delete(r),n.terminate())}(this),Promise.resolve()}}function vM(t,e,r,n={}){var s;const i=(t=bn(t,dx))._getSettings(),o=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&nc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Wn.MOCK_USER;else{l=XB(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new He(je.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Wn(u)}t._authCredentials=new kz(new p5(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ys(this.firestore,e,this._query)}}class Ln{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ri(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ln(this.firestore,e,this._key)}}class Ri extends ys{constructor(e,r,n){super(e,r,ex(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ln(this.firestore,null,new dt(e))}withConverter(e){return new Ri(this.firestore,e,this._path)}}function yt(t,e,...r){if(t=zr(t),yM("collection","path",e),t instanceof dx){const n=gr.fromString(e,...r);return yP(n),new Ri(t,null,n)}{if(!(t instanceof Ln||t instanceof Ri))throw new He(je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(gr.fromString(e,...r));return yP(n),new Ri(t.firestore,null,n)}}function ht(t,e,...r){if(t=zr(t),arguments.length===1&&(e=j_.newId()),yM("doc","path",e),t instanceof dx){const n=gr.fromString(e,...r);return gP(n),new Ln(t,null,new dt(n))}{if(!(t instanceof Ln||t instanceof Ri))throw new He(je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(gr.fromString(e,...r));return gP(n),new Ln(t.firestore,t instanceof Ri?t.converter:null,new dt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new J5(this,"async_queue_retry"),this.Vu=()=>{const n=hb();n&&lt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=hb();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=hb();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Mi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Mm(e))throw e;lt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw Ki("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=F_.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Nt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function bP(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class ps extends dx{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new vP,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vP(e),this._firestoreClient=void 0,await e}}}function bM(t,e){const r=typeof t=="object"?t:_3(),n=typeof t=="string"?t:e||"(default)",s=u_(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=QB("firestore");i&&vM(s,...i)}return s}function bc(t){if(t._terminated)throw new He(je.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||hW(t),t._firestoreClient}function hW(t){var e,r,n;const s=t._freezeSettings(),i=function(l,c,u,d){return new Kz(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,gM(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new oW(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ic(jn.fromBase64String(e))}catch(r){throw new He(je.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ic(jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new He(je.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new He(je.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new He(je.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ht(this._lat,e._lat)||Ht(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fW=/^__.*__$/;class mW{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new sl(e,this.data,this.fieldMask,r,this.fieldTransforms):new Rm(e,this.data,r,this.fieldTransforms)}}class wM{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new sl(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function jM(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Nt()}}class mx{constructor(e,r,n,s,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new mx(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return N0(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(jM(this.Cu)&&fW.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class pW{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||ox(e)}Qu(e,r,n,s=!1){return new mx({Cu:e,methodName:r,qu:n,path:xn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Td(t){const e=t._freezeSettings(),r=ox(t._databaseId);return new pW(t._databaseId,!!e.ignoreUndefinedProperties,r)}function K_(t,e,r,n,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);X_("Data must be an object, but it was:",o,n);const l=CM(n,o);let c,u;if(i.merge)c=new $a(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const f=wj(e,h,r);if(!o.contains(f))throw new He(je.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);PM(d,f)||d.push(f)}c=new $a(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new mW(new va(l),c,u)}class px extends Pd{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof px}}function gW(t,e,r){return new mx({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Q_ extends Pd{constructor(e,r){super(e),this.Ku=r}_toFieldTransform(e){const r=gW(this,e,!0),n=this.Ku.map(i=>Ad(i,r)),s=new Bu(n);return new $5(e.path,s)}isEqual(e){return e instanceof Q_&&Pf(this.Ku,e.Ku)}}class Y_ extends Pd{constructor(e,r){super(e),this.$u=r}_toFieldTransform(e){const r=new $f(e.serializer,k5(e.serializer,this.$u));return new $5(e.path,r)}isEqual(e){return e instanceof Y_&&this.$u===e.$u}}function NM(t,e,r,n){const s=t.Qu(1,e,r);X_("Data must be an object, but it was:",s,n);const i=[],o=va.empty();yc(n,(c,u)=>{const d=J_(e,c,r);u=zr(u);const h=s.Nu(d);if(u instanceof px)i.push(d);else{const f=Ad(u,h);f!=null&&(i.push(d),o.set(d,f))}});const l=new $a(i);return new wM(o,l,s.fieldTransforms)}function _M(t,e,r,n,s,i){const o=t.Qu(1,e,r),l=[wj(e,n,r)],c=[s];if(i.length%2!=0)throw new He(je.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)l.push(wj(e,i[f])),c.push(i[f+1]);const u=[],d=va.empty();for(let f=l.length-1;f>=0;--f)if(!PM(u,l[f])){const m=l[f];let y=c[f];y=zr(y);const g=o.Nu(m);if(y instanceof px)u.push(m);else{const x=Ad(y,g);x!=null&&(u.push(m),d.set(m,x))}}const h=new $a(u);return new wM(d,h,o.fieldTransforms)}function SM(t,e,r,n=!1){return Ad(r,t.Qu(n?4:3,e))}function Ad(t,e){if(EM(t=zr(t)))return X_("Unsupported field value:",e,t),CM(t,e);if(t instanceof Pd)return function(n,s){if(!jM(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let o=0;for(const l of n){let c=Ad(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=zr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return k5(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=en.fromDate(n);return{timestampValue:v0(s.serializer,i)}}if(n instanceof en){const i=new en(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:v0(s.serializer,i)}}if(n instanceof hx)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ic)return{bytesValue:z5(s.serializer,n._byteString)};if(n instanceof Ln){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:k_(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof fx)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return T_(l.serializer,c)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${ux(n)}`)}(t,e)}function CM(t,e){const r={};return y5(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yc(t,(n,s)=>{const i=Ad(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function EM(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof en||t instanceof hx||t instanceof ic||t instanceof Ln||t instanceof Pd||t instanceof fx)}function X_(t,e,r){if(!EM(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=ux(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function wj(t,e,r){if((e=zr(e))instanceof Ed)return e._internalPath;if(typeof e=="string")return J_(t,e);throw N0("Field path arguments must be of type string or ",t,!1,void 0,r)}const yW=new RegExp("[~\\*/\\[\\]]");function J_(t,e,r){if(e.search(yW)>=0)throw N0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Ed(...e.split("."))._internalPath}catch{throw N0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function N0(t,e,r,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${n}`),o&&(c+=` in document ${s}`),c+=")"),new He(je.INVALID_ARGUMENT,l+t+c)}function PM(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ln(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new xW(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(gx("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class xW extends Z_{data(){return super.data()}}function gx(t,e){return typeof e=="string"?J_(t,e):e instanceof Ed?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TM(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new He(je.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class eS{}class Fm extends eS{}function Bt(t,e,...r){let n=[];e instanceof eS&&n.push(e),n=n.concat(r),function(i){const o=i.filter(c=>c instanceof yx).length,l=i.filter(c=>c instanceof Bm).length;if(o>1||o>0&&l>0)throw new He(je.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Bm extends Fm{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Bm(e,r,n)}_apply(e){const r=this._parse(e);return AM(e._query,r),new ys(e.firestore,e.converter,hj(e._query,r))}_parse(e){const r=Td(e.firestore);return function(i,o,l,c,u,d,h){let f;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new He(je.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){jP(h,d);const m=[];for(const y of h)m.push(wP(c,i,y));f={arrayValue:{values:m}}}else f=wP(c,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||jP(h,d),f=SM(l,o,h,d==="in"||d==="not-in");return Zr.create(u,d,f)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function or(t,e,r){const n=e,s=gx("where",t);return Bm._create(s,n,r)}class yx extends eS{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new yx(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Us.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)AM(o,c),o=hj(o,c)}(e._query,r),new ys(e.firestore,e.converter,hj(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class xx extends Fm{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new xx(e,r)}_apply(e){const r=function(s,i,o){if(s.startAt!==null)throw new He(je.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new He(je.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Mf(i,o)}(e._query,this._field,this._direction);return new ys(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new xc(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function dr(t,e="asc"){const r=e,n=gx("orderBy",t);return xx._create(n,r)}class vx extends Fm{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new vx(e,r,n)}_apply(e){return new ys(e.firestore,e.converter,y0(e._query,this._limit,this._limitType))}}function oc(t){return dW("limit",t),vx._create("limit",t,"F")}class bx extends Fm{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new bx(e,r,n)}_apply(e){const r=vW(e,this.type,this._docOrFields,this._inclusive);return new ys(e.firestore,e.converter,function(s,i){return new xc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,r))}}function Um(...t){return bx._create("startAfter",t,!1)}function vW(t,e,r,n){if(r[0]=zr(r[0]),r[0]instanceof Z_)return function(i,o,l,c,u){if(!c)throw new He(je.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const d=[];for(const h of yu(i))if(h.field.isKeyField())d.push(g0(o,c.key));else{const f=c.data.field(h.field);if(Zy(f))throw new He(je.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){const m=h.field.canonicalString();throw new He(je.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}d.push(f)}return new Fu(d,u)}(t._query,t.firestore._databaseId,e,r[0]._document,n);{const s=Td(t.firestore);return function(o,l,c,u,d,h){const f=o.explicitOrderBy;if(d.length>f.length)throw new He(je.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const m=[];for(let y=0;y<d.length;y++){const g=d[y];if(f[y].field.isKeyField()){if(typeof g!="string")throw new He(je.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof g}`);if(!P_(o)&&g.indexOf("/")!==-1)throw new He(je.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${g}' contains a slash.`);const x=o.path.child(gr.fromString(g));if(!dt.isDocumentKey(x))throw new He(je.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${x}' is not because it contains an odd number of segments.`);const b=new dt(x);m.push(g0(l,b))}else{const x=SM(c,u,g);m.push(x)}}return new Fu(m,h)}(t._query,t.firestore._databaseId,s,e,r,n)}}function wP(t,e,r){if(typeof(r=zr(r))=="string"){if(r==="")throw new He(je.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!P_(e)&&r.indexOf("/")!==-1)throw new He(je.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(gr.fromString(r));if(!dt.isDocumentKey(n))throw new He(je.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return g0(t,new dt(n))}if(r instanceof Ln)return g0(t,r._key);throw new He(je.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ux(r)}.`)}function jP(t,e){if(!Array.isArray(t)||t.length===0)throw new He(je.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function AM(t,e){const r=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new He(je.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new He(je.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class IM{convertValue(e,r="none"){switch(sc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ac(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Nt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return yc(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>Gr(o.doubleValue));return new fx(i)}convertGeoPoint(e){return new hx(Gr(e.latitude),Gr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=__(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Of(e));default:return null}}convertTimestamp(e){const r=Qo(e);return new en(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=gr.fromString(e);Zt(Q5(n));const s=new $u(n.get(1),n.get(3)),i=new dt(n.popFirst(5));return s.isEqual(r)||Ki(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class rS extends Z_{constructor(e,r,n,s,i,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Xh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(gx("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Xh extends rS{data(e={}){return super.data(e)}}class wx{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new eu(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Xh(this._firestore,this._userDataWriter,n.key,n,new eu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new He(je.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Xh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new eu(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Xh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new eu(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:bW(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function bW(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Nt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(t){t=bn(t,Ln);const e=bn(t.firestore,ps);return uW(bc(e),t._key).then(r=>kM(e,t,r))}class jx extends IM{constructor(e){super(),this.firestore=e}convertBytes(e){return new ic(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ln(this.firestore,null,r)}}function Kt(t){t=bn(t,ys);const e=bn(t.firestore,ps),r=bc(e),n=new jx(e);return TM(t._query),pM(r,t._query).then(s=>new wx(e,n,t,s))}function jj(t){t=bn(t,ys);const e=bn(t.firestore,ps),r=bc(e),n=new jx(e);return pM(r,t._query,{source:"server"}).then(s=>new wx(e,n,t,s))}function zm(t,e,r){t=bn(t,Ln);const n=bn(t.firestore,ps),s=tS(t.converter,e,r);return Id(n,[K_(Td(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,ca.none())])}function ja(t,e,r,...n){t=bn(t,Ln);const s=bn(t.firestore,ps),i=Td(s);let o;return o=typeof(e=zr(e))=="string"||e instanceof Ed?_M(i,"updateDoc",t._key,e,r,n):NM(i,"updateDoc",t._key,e),Id(s,[o.toMutation(t._key,ca.exists(!0))])}function to(t){return Id(bn(t.firestore,ps),[new sx(t._key,ca.none())])}function qm(t,e){const r=bn(t.firestore,ps),n=ht(t),s=tS(t.converter,e);return Id(r,[K_(Td(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,ca.exists(!1))]).then(()=>n)}function ua(t,...e){var r,n,s;t=zr(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||bP(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(bP(e[o])){const h=e[o];e[o]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[o+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,d;if(t instanceof Ln)u=bn(t.firestore,ps),d=ex(t._key.path),c={next:h=>{e[o]&&e[o](kM(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=bn(t,ys);u=bn(h.firestore,ps),d=h._query;const f=new jx(u);c={next:m=>{e[o]&&e[o](new wx(u,f,h,m))},error:e[o+1],complete:e[o+2]},TM(t._query)}return function(f,m,y,g){const x=new G_(g),b=new H_(m,x,y);return f.asyncQueue.enqueueAndForget(async()=>U_(await j0(f),b)),()=>{x.Za(),f.asyncQueue.enqueueAndForget(async()=>z_(await j0(f),b))}}(bc(u),d,l,c)}function Id(t,e){return function(n,s){const i=new Mi;return n.asyncQueue.enqueueAndForget(async()=>ZH(await cW(n),s,i)),i.promise}(bc(t),e)}function kM(t,e,r){const n=r.docs.get(e._key),s=new jx(t);return new rS(t,s,e._key,n,new eu(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Td(e)}set(e,r,n){this._verifyNotCommitted();const s=mb(e,this._firestore),i=tS(s.converter,r,n),o=K_(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,ca.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=mb(e,this._firestore);let o;return o=typeof(r=zr(r))=="string"||r instanceof Ed?_M(this._dataReader,"WriteBatch.update",i._key,r,n,s):NM(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,ca.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=mb(e,this._firestore);return this._mutations=this._mutations.concat(new sx(r._key,ca.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new He(je.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function mb(t,e){if((t=zr(t)).firestore!==e)throw new He(je.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function DM(...t){return new Q_("arrayUnion",t)}function ba(t){return new Y_("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(t){return bc(t=bn(t,ps)),new OM(t,e=>Id(t,e))}(function(e,r=!0){(function(s){_d=s})(jd),Mu(new Zl("firestore",(n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),l=new ps(new Oz(n.getProvider("auth-internal")),new $z(n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new He(je.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $u(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:r},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),zo(LE,"4.7.3",e),zo(LE,"4.7.3","esm2017")})();const $p=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:IM,Bytes:ic,CollectionReference:Ri,DocumentReference:Ln,DocumentSnapshot:rS,FieldPath:Ed,FieldValue:Pd,Firestore:ps,FirestoreError:He,GeoPoint:hx,Query:ys,QueryCompositeFilterConstraint:yx,QueryConstraint:Fm,QueryDocumentSnapshot:Xh,QueryFieldFilterConstraint:Bm,QueryLimitConstraint:vx,QueryOrderByConstraint:xx,QuerySnapshot:wx,QueryStartAtConstraint:bx,SnapshotMetadata:eu,Timestamp:en,VectorValue:fx,WriteBatch:OM,_AutoId:j_,_ByteString:jn,_DatabaseId:$u,_DocumentKey:dt,_EmptyAuthCredentialsProvider:g5,_FieldPath:xn,_cast:bn,_logWarn:nc,_validateIsNotUsedTogether:xM,addDoc:qm,arrayUnion:DM,collection:yt,connectFirestoreEmulator:vM,deleteDoc:to,doc:ht,ensureFirestoreConfigured:bc,executeWrite:Id,getDoc:Yn,getDocs:Kt,getDocsFromServer:jj,getFirestore:bM,increment:ba,limit:oc,onSnapshot:ua,orderBy:dr,query:Bt,setDoc:zm,startAfter:Um,updateDoc:ja,where:or,writeBatch:us},Symbol.toStringTag,{value:"Module"}));var wW="firebase",jW="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zo(wW,jW,"app");const NW={apiKey:"AIzaSyC2qH28cydE9OKg_9cERvQ3IBRReXHPNLo",authDomain:"finanzas-personales-60d5c.firebaseapp.com",projectId:"finanzas-personales-60d5c",storageBucket:"finanzas-personales-60d5c.firebasestorage.app",messagingSenderId:"1010030707667",appId:"1:1010030707667:web:0a82f7da2be72de30ae526"},MM=d_(NW),Pe=bM(MM),ch=l5(MM),Ke={PRODUCTS:"products",CATEGORIES:"categories",SALES:"sales",CUSTOMERS:"customers",LAYAWAYS:"layaways",TECHNICAL_SERVICES:"technicalservice",USERS:"users",TECHNICIANS:"technicians",TECHNICIAN_LIQUIDATIONS:"technicianliquidations",STATS:"stats",PURCHASES:"purchases",COURTESIES:"courtesies"},_W=async(t,e={})=>{const r=ht(Pe,Ke.USERS,t.uid);if(!(await Yn(r)).exists()){const{email:s}=t,i=new Date().toISOString();try{await zm(r,{email:s,createdAt:i,role:"user",...e})}catch(o){console.error("Error creating user profile:",o)}}return r},pb=async t=>{var e;try{const r=ht(Pe,Ke.USERS,t),n=await Yn(r);if(n.exists()){const s=n.data();return{id:t,username:s.username||((e=s.email)==null?void 0:e.split("@")[0])||"Usuario",email:s.email,role:s.role||"user"}}}catch(r){console.error("Error getting user profile:",r)}return null},Lp={async signIn(t,e){try{const r=await g8(ch,t,e);return await pb(r.user.uid)}catch(r){throw console.error("Error signing in:",r),r}},async signUp(t,e,r,n="user"){try{const s=await X3(ch,t,e);return await _W(s.user,{username:r,role:n}),{id:s.user.uid,username:r,email:t,role:n}}catch(s){throw console.error("Error signing up:",s),s}},async signOut(){try{await b8(ch)}catch(t){throw console.error("Error signing out:",t),t}},onAuthStateChanged(t){return v8(ch,async e=>{if(e){const r=await pb(e.uid);t(r)}else t(null)})},async getCurrentUser(){const t=ch.currentUser;return t?await pb(t.uid):null}},tu={admin:{dashboard:!0,inventory:!0,purchases:!0,sales:!0,salesHistory:!0,technicalServiceHistory:!0,technicalServiceCenter:!0,purchasesHistory:!0,layaway:!0,technicalService:!0,customers:!0,categories:!0,reports:!0,userManagement:!0,technicianManagement:!0,technicianLiquidation:!0,myDailySales:!1,courtesies:!0},employee:{dashboard:!1,inventory:!1,purchases:!1,sales:!0,salesHistory:!1,technicalServiceHistory:!1,technicalServiceCenter:!1,purchasesHistory:!1,layaway:!0,technicalService:!0,customers:!0,categories:!1,reports:!1,userManagement:!1,technicianManagement:!1,technicianLiquidation:!1,myDailySales:!0,courtesies:!1}},gb=t=>{const e=s=>t[s]||!1;return{hasPermission:e,hasAnyPermission:s=>s.some(i=>e(i)),hasAllPermissions:s=>s.every(i=>e(i)),permissions:t}},SW=t=>[{id:"dashboard",name:"Panel de Control",requiredPermissions:["dashboard"]},{id:"inventory",name:"Inventario",requiredPermissions:["inventory"]},{id:"purchases",name:"Compras",requiredPermissions:["purchases"]},{id:"sales",name:"Ventas",requiredPermissions:["sales"]},{id:"sales-history",name:"Gestin de Ventas",requiredPermissions:["salesHistory"]},{id:"my-daily-sales",name:"Mis Ventas del Da",requiredPermissions:["myDailySales"]},{id:"technical-service-center",name:"Centro de Servicios Tcnicos",requiredPermissions:["technicalServiceCenter"]},{id:"purchases-history",name:"Gestin de Compras",requiredPermissions:["purchasesHistory"]},{id:"layaway",name:"Plan Separe",requiredPermissions:["layaway"]},{id:"technical-service",name:"Servicio Tcnico",requiredPermissions:["technicalService"]},{id:"customers",name:"Clientes",requiredPermissions:["customers"]},{id:"categories",name:"Categoras",requiredPermissions:["categories"]},{id:"reports",name:"Reportes",requiredPermissions:["reports"]},{id:"user-management",name:"Gestin de Usuarios",requiredPermissions:["userManagement"]},{id:"technician-management",name:"Gestin de Tcnicos",requiredPermissions:["technicianManagement"]},{id:"technician-liquidation",name:"Liquidacin de Tcnicos",requiredPermissions:["technicianLiquidation"]},{id:"courtesies",name:"Cortesas",requiredPermissions:["courtesies"]}].filter(r=>r.requiredPermissions.every(n=>t[n])),RM=I.createContext(void 0);function CW({children:t}){const[e,r]=I.useState(null),[n,s]=I.useState(null),[i,o]=I.useState(null),[l,c]=I.useState(null),[u,d]=I.useState(!0),[h,f]=I.useState(!1),m=(S=!1)=>{S&&setTimeout(async()=>{try{const{customersService:_}=await gn(async()=>{const{customersService:w}=await Promise.resolve().then(()=>Oa);return{customersService:w}},void 0);(await _.getAll()).some(w=>{if(!w.birthDate)return!1;try{const E=w.birthDate.split("-");if(E.length!==3)return!1;const k=new Date().getFullYear(),T=parseInt(E[1],10)-1,P=parseInt(E[2],10);let O=new Date(k,T,P);O<new Date&&(O=new Date(k+1,T,P));const D=O.getTime()-new Date().getTime(),R=Math.ceil(D/(1e3*60*60*24));return R>=0&&R<=5}catch{return!1}})&&f(!0)}catch(_){console.error("Error checking birthday notifications:",_)}},3e3)},y=async S=>{var _;try{const C=await Yn(ht(Pe,"users",S.id));if(C.exists()){const N=C.data();s(N),o(N.permissions),c(gb(N.permissions))}else{const N={uid:S.id,email:S.email||"",displayName:S.username||((_=S.email)==null?void 0:_.split("@")[0])||"",role:"employee",permissions:tu.employee,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),lastLoginAt:new Date().toISOString()};await zm(ht(Pe,"users",S.id),N),s(N),o(N.permissions),c(gb(N.permissions))}}catch(C){console.error("Error loading user data:",C);const N=tu.employee;o(N),c(gb(N))}};I.useEffect(()=>{const S=async C=>{if(C){const N=new Date().toISOString().split("T")[0],w=localStorage.getItem("lastLoginDate");if(w&&w!==N){await Lp.signOut(),r(null),s(null),o(null),c(null),localStorage.removeItem("lastLoginDate"),d(!1),localStorage.setItem("sessionExpiredMsg","Por seguridad, debes volver a iniciar sesin.");return}r(C),await y(C),d(!1)}else r(null),s(null),o(null),c(null),d(!1)};return Lp.onAuthStateChanged(C=>{S(C)})},[]);const g=async(S,_)=>{var C;try{d(!0);const N=await Lp.signIn(S,_);if(N){r(N);const w=new Date().toISOString().split("T")[0];return localStorage.setItem("lastLoginDate",w),m(!0),null}return"Email o contrasea incorrectos"}catch(N){if(console.error("Login error:",N),N&&N.message==="INVALID_LOGIN_CREDENTIALS")return"Email o contrasea incorrectos";if(N&&N.code)switch(N.code){case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contrasea incorrecta";case"auth/invalid-email":return"Email invlido";case"auth/invalid-credential":return"Email o contrasea incorrectos";default:return N.message||"Error desconocido al iniciar sesin"}return N&&typeof N.message=="string"?N.message:N&&N.errors&&Array.isArray(N.errors)&&((C=N.errors[0])==null?void 0:C.message)==="INVALID_LOGIN_CREDENTIALS"?"Email o contrasea incorrectos":N&&N.error&&typeof N.error.message=="string"?N.error.message==="INVALID_LOGIN_CREDENTIALS"?"Email o contrasea incorrectos":N.error.message:"Error desconocido al iniciar sesin"}finally{d(!1)}},x=()=>{f(!1)},b=()=>{console.log(" Forzando notificacin de cumpleaos..."),f(!0)};typeof window<"u";const j={user:e,appUser:n,permissions:i,permissionHelpers:l,login:g,logout:async()=>{try{await Lp.signOut(),r(null),s(null),o(null),c(null),localStorage.removeItem("lastLoginDate")}catch(S){console.error("Logout error:",S)}},isAuthenticated:!!e,isLoading:u,showBirthdayNotification:h,dismissBirthdayNotification:x};return a.jsx(RM.Provider,{value:j,children:t})}function ma(){const t=I.useContext(RM);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const Hm=()=>UV(),Wm=t=>{if(!t)return{date:new Date,isValid:!1};let e;if(/^\d{4}-\d{2}-\d{2}$/.test(t)){const[n,s,i]=t.split("-").map(Number);e=new Date(n,s-1,i)}else if(/^\d{2}\/\d{2}\/\d{4}$/.test(t)){const[n,s,i]=t.split("/").map(Number);e=new Date(i,s-1,n)}else/^\d{4}-\d{2}-\d{2}T/.test(t)?e=new Date(t):e=new Date(t);const r=!isNaN(e.getTime());return{date:r?e:new Date,isValid:r}},uh=t=>{const{date:e,isValid:r}=Wm(t);if(!r)return!1;const n=new Date;return e.getMonth()===n.getMonth()&&e.getDate()===n.getDate()},NP=(t,e=7)=>{const{date:r,isValid:n}=Wm(t);if(!n)return!1;const s=new Date,i=s.getFullYear();let o=new Date(i,r.getMonth(),r.getDate());o<s&&(o=new Date(i+1,r.getMonth(),r.getDate()));const l=o.getTime()-s.getTime(),c=Math.ceil(l/(1e3*60*60*24));return c<=e&&c>=0},Jh=t=>{const{date:e,isValid:r}=Wm(t);if(!r)return null;const n=new Date;let s=n.getFullYear()-e.getFullYear();const i=n.getMonth()-e.getMonth();return(i<0||i===0&&n.getDate()<e.getDate())&&s--,s>=0?s:null},Nj=t=>{const{date:e,isValid:r}=Wm(t);return r?e.toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"}):"Fecha invlida"},$M=t=>{const{date:e,isValid:r}=Wm(t);return r?e.toISOString().split("T")[0]:""},Qe=()=>new Date().toISOString(),EW=[],_t=t=>t?t.toDate?t.toDate().toISOString():t instanceof Date?t.toISOString():t||Qe():Qe(),ss=t=>{if(t==null)return t;if(Array.isArray(t))return t.map(e=>ss(e));if(typeof t=="object"){if(t.toDate&&typeof t.toDate=="function")return t.toDate().toISOString();const e={};for(const[r,n]of Object.entries(t))e[r]=ss(n);return e}return t},Lf=t=>{if(t==null)return t;if(Array.isArray(t))return t.map(e=>Lf(e));if(typeof t=="object"){if(t.constructor&&t.constructor.name&&(t.constructor.name.includes("Timestamp")||t.constructor.name.includes("FieldValue")||t.constructor.name.includes("GeoPoint")))return t;const e={};for(const[r,n]of Object.entries(t))n!==void 0&&(e[r]=Lf(n));return e}return t},Ul={async getAll(){try{console.log(" Obteniendo todas las categoras...");const e=(await Kt(Bt(yt(Pe,Ke.CATEGORIES),dr("name")))).docs.map(r=>({id:r.id,...r.data(),createdAt:_t(r.data().createdAt),updatedAt:_t(r.data().updatedAt)}));if(console.log(` Se encontraron ${e.length} categoras`),e.length===0){console.log(" No hay categoras, creando categoras predeterminadas...");const n=(await Kt(Bt(yt(Pe,Ke.CATEGORIES),dr("name")))).docs.map(s=>({id:s.id,...s.data(),createdAt:_t(s.data().createdAt),updatedAt:_t(s.data().updatedAt)}));return console.log(` Categoras predeterminadas creadas: ${n.length}`),n}return e}catch(t){throw console.error(" Error obteniendo categoras:",t),t}},async createDefaultCategories(){try{console.log(" Creando categoras predeterminadas...");const t=us(Pe);EW.forEach(e=>{const r=ht(yt(Pe,Ke.CATEGORIES));t.set(r,{...e,productCount:0,createdAt:Qe(),updatedAt:Qe()}),console.log(` Preparando categora: ${e.name}`)}),await t.commit(),console.log(" Categoras predeterminadas creadas exitosamente")}catch(t){throw console.error(" Error creando categoras predeterminadas:",t),t}},async add(t){var e;try{if(console.log(" Agregando nueva categora:",t),!t.name||t.name.trim()==="")throw new Error("El nombre de la categora es requerido");if(!t.color)throw new Error("El color de la categora es requerido");const r={name:t.name.trim(),description:((e=t.description)==null?void 0:e.trim())||"",color:t.color,icon:t.icon||"Tag",isActive:!0,productCount:0,createdAt:Qe(),updatedAt:Qe()};console.log(" Datos a guardar:",r);const n=await qm(yt(Pe,Ke.CATEGORIES),r);return console.log(" Categora agregada exitosamente con ID:",n.id),n.id}catch(r){throw console.error(" Error agregando categora:",r),r instanceof Error?new Error(`Error al guardar categora: ${r.message}`):new Error("Error desconocido al guardar la categora")}},async update(t,e){var r;try{if(console.log(" Actualizando categora:",t,e),!t)throw new Error("ID de categora requerido para actualizar");const n=ht(Pe,Ke.CATEGORIES,t),s=await Yn(n);if(!s.exists())throw new Error("La categora no existe");const i=s.data();if(((r=i==null?void 0:i.name)==null?void 0:r.toLowerCase())==="celulares"&&e.name&&e.name.toLowerCase()!=="celulares")throw new Error('No se puede modificar el nombre de la categora "Celulares" ya que es una categora esencial del sistema');const o={...e,updatedAt:Qe()};await ja(n,o),console.log(" Categora actualizada exitosamente:",t)}catch(n){throw console.error(" Error actualizando categora:",n),n}},async delete(t){var e;try{if(console.log(" Eliminando categora:",t),!t)throw new Error("ID de categora requerido para eliminar");const r=ht(Pe,Ke.CATEGORIES,t),n=await Yn(r);if(!n.exists())throw new Error("La categora no existe");const s=n.data();if(((e=s==null?void 0:s.name)==null?void 0:e.toLowerCase())==="celulares")throw new Error('No se puede eliminar la categora "Celulares" ya que es una categora esencial del sistema');await to(r),console.log(" Categora eliminada exitosamente:",t)}catch(r){throw console.error(" Error eliminando categora:",r),r}},subscribe(t){return console.log(" Iniciando suscripcin a categoras..."),ua(Bt(yt(Pe,Ke.CATEGORIES),dr("name")),e=>{console.log(` Actualizacin de categoras recibida: ${e.docs.length} categoras`);const r=e.docs.map(n=>({id:n.id,...n.data(),createdAt:_t(n.data().createdAt),updatedAt:_t(n.data().updatedAt)}));t(r)},e=>{console.error(" Error en suscripcin de categoras:",e)})}},La={async getAll(){return(await Kt(Bt(yt(Pe,Ke.PRODUCTS),dr("createdAt","desc")))).docs.map(e=>({id:e.id,...e.data(),createdAt:_t(e.data().createdAt),updatedAt:_t(e.data().updatedAt)}))},async add(t){const e=us(Pe),r=ht(yt(Pe,Ke.PRODUCTS));if(e.set(r,{...t,createdAt:Qe(),updatedAt:Qe()}),t.categoryId){const n=ht(Pe,Ke.CATEGORIES,t.categoryId);e.update(n,{productCount:ba(1),updatedAt:Qe()})}return await e.commit(),r.id},async update(t,e){const r=ht(Pe,Ke.PRODUCTS,t),s=(await Yn(r)).data(),i=us(Pe);if(i.update(r,{...e,updatedAt:Qe()}),e.categoryId&&s.categoryId!==e.categoryId){if(s.categoryId){const l=ht(Pe,Ke.CATEGORIES,s.categoryId);i.update(l,{productCount:ba(-1),updatedAt:Qe()})}const o=ht(Pe,Ke.CATEGORIES,e.categoryId);i.update(o,{productCount:ba(1),updatedAt:Qe()})}await i.commit()},async delete(t){const e=ht(Pe,Ke.PRODUCTS,t),n=(await Yn(e)).data(),s=us(Pe);if(s.delete(e),n.categoryId){const i=ht(Pe,Ke.CATEGORIES,n.categoryId);s.update(i,{productCount:ba(-1),updatedAt:Qe()})}await s.commit()},async updateStock(t,e){console.log(` Actualizando stock del producto ${t}: cambio de ${e}`);const r=ht(Pe,Ke.PRODUCTS,t),n=await Yn(r);if(n.exists()){const s=n.data();console.log(` Stock actual: ${s.stock}, nuevo stock: ${s.stock+e}`)}await ja(r,{stock:ba(e),updatedAt:Qe()}),console.log(` Stock actualizado exitosamente para producto ${t}`)},subscribe(t){return ua(Bt(yt(Pe,Ke.PRODUCTS),dr("createdAt","desc")),e=>{const r=e.docs.map(n=>({id:n.id,...n.data(),createdAt:_t(n.data().createdAt),updatedAt:_t(n.data().updatedAt)}));t(r)})}},Xo={async getAll(){return(await Kt(Bt(yt(Pe,Ke.SALES),dr("createdAt","desc")))).docs.map(e=>{const r=e.data(),n=ss(r);return{id:e.id,...n}})},async add(t){const e=us(Pe),r=ht(yt(Pe,Ke.SALES)),n=Lf({...t,createdAt:Qe()});e.set(r,n);for(const s of t.items){const i=ht(Pe,Ke.PRODUCTS,s.productId);e.update(i,{stock:ba(-s.quantity),updatedAt:Qe()})}if(t.courtesyItems&&Array.isArray(t.courtesyItems)){for(const s of t.courtesyItems)if(s.productId){const i=ht(Pe,Ke.PRODUCTS,s.productId);e.update(i,{stock:ba(-s.quantity),updatedAt:Qe()})}}return await e.commit(),r.id},async update(t,e){const r=ht(Pe,Ke.SALES,t);await ja(r,{...e,updatedAt:Qe()})},async delete(t){const e=ht(Pe,Ke.SALES,t),r=await Yn(e);if(!r.exists())throw new Error("Venta no encontrada");const n=r.data(),s=us(Pe);s.delete(e);for(const i of n.items){const o=ht(Pe,Ke.PRODUCTS,i.productId);(await Yn(o)).exists()&&s.update(o,{stock:ba(i.quantity),updatedAt:Qe()})}await s.commit()},subscribe(t){return ua(Bt(yt(Pe,Ke.SALES),dr("createdAt","desc")),e=>{const r=e.docs.map(n=>{const s=n.data(),i=ss(s);return{id:n.id,...i}});t(r)})},subscribeTodaySalesBySalesperson(t,e){console.log(" Suscripcin optimizada: Solo ventas del da para vendedor",t);const r=Bt(yt(Pe,Ke.SALES),or("salesPersonId","==",t),dr("createdAt","desc"));return ua(r,n=>{const s=new Date,i=new Date(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0,0),o=new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59,59,999),l=n.docs.map(u=>{const d=u.data(),h=ss(d);return{id:u.id,...h}}),c=l.filter(u=>{if(!u.createdAt)return!1;if(u.createdAt._methodName==="serverTimestamp")return console.warn(" Venta con timestamp corrupto en MyDailySales, ignorando:",u.id),!1;let d;return typeof u.createdAt=="string"?d=new Date(u.createdAt):u.createdAt.toDate&&typeof u.createdAt.toDate=="function"?d=u.createdAt.toDate():u.createdAt.seconds?d=new Date(u.createdAt.seconds*1e3):d=new Date(u.createdAt),d>=i&&d<=o});console.log(` Ventas totales del vendedor: ${l.length}`),console.log(` Ventas del da (filtradas): ${c.length}`),console.log(` Rango del da: ${i.toISOString()} - ${o.toISOString()}`),e(c)})}},Mn={async getAll(){return(await Kt(Bt(yt(Pe,Ke.CUSTOMERS),dr("name")))).docs.map(e=>({id:e.id,...e.data(),createdAt:_t(e.data().createdAt),updatedAt:_t(e.data().updatedAt)}))},async add(t){return(await qm(yt(Pe,Ke.CUSTOMERS),{...t,credit:0,createdAt:Qe(),updatedAt:Qe()})).id},async update(t,e){const r=ht(Pe,Ke.CUSTOMERS,t);await ja(r,{...e,updatedAt:Qe()})},async delete(t){await to(ht(Pe,Ke.CUSTOMERS,t))},subscribe(t){return ua(Bt(yt(Pe,Ke.CUSTOMERS),dr("name")),e=>{const r=e.docs.map(n=>({id:n.id,...n.data(),createdAt:_t(n.data().createdAt),updatedAt:_t(n.data().updatedAt)}));t(r)})}},kn={async getAll(){console.log(" Obteniendo todos los planes separe...");try{const e=(await Kt(yt(Pe,Ke.LAYAWAYS))).docs.map(r=>({id:r.id,...r.data(),createdAt:_t(r.data().createdAt),updatedAt:_t(r.data().updatedAt)}));return console.log(` Se encontraron ${e.length} planes separe en total`),e}catch(t){throw console.error(" Error obteniendo planes separe:",t),t}},async getActiveLayaways(){console.log(" Obteniendo planes separe activos...");try{const t=await this.getAll(),e=t.filter(r=>r.status==="active");return console.log(` Se encontraron ${e.length} planes separe activos de ${t.length} totales`),e}catch(t){throw console.error(" Error obteniendo planes separe activos:",t),t}},async add(t){console.log(" Creando plan separe con actualizacin de inventario...",t);const e=us(Pe),r=ht(yt(Pe,Ke.LAYAWAYS)),n={...t,payments:t.downPayment>0?[{id:crypto.randomUUID(),amount:t.downPayment,paymentDate:Qe(),paymentMethod:"cash",notes:"Pago inicial"}]:[],remainingBalance:t.totalAmount-t.downPayment,createdAt:Qe(),updatedAt:Qe()};e.set(r,n),console.log(" Actualizando inventario para reservar productos...");for(const s of t.items){console.log(` Reservando ${s.quantity} unidades de ${s.productName} (ID: ${s.productId})`);const i=ht(Pe,Ke.PRODUCTS,s.productId);e.update(i,{stock:ba(-s.quantity),updatedAt:Qe()})}return await e.commit(),console.log(" Plan separe creado e inventario actualizado exitosamente"),r.id},async update(t,e){console.log(" Actualizando plan separe:",t,e);const r=ht(Pe,Ke.LAYAWAYS,t);await ja(r,{...e,updatedAt:Qe()}),console.log(" Plan separe actualizado exitosamente")},async addProductsToLayaway(t,e,r){console.log(" Agregando productos al plan separe existente...",{layawayId:t,newItems:e,additionalAmount:r});const n=us(Pe),s=ht(Pe,Ke.LAYAWAYS,t),i=await Yn(s);if(!i.exists())throw new Error("Plan separe no encontrado");const o=i.data(),l=[...o.items,...e],c=o.totalAmount+r,u=o.remainingBalance+r;n.update(s,{items:l,totalAmount:c,remainingBalance:u,updatedAt:Qe()}),console.log(" Actualizando inventario para nuevos productos...");for(const d of e){console.log(` Reservando ${d.quantity} unidades de ${d.productName} (ID: ${d.productId})`);const h=ht(Pe,Ke.PRODUCTS,d.productId);n.update(h,{stock:ba(-d.quantity),updatedAt:Qe()})}await n.commit(),console.log(" Productos agregados al plan separe e inventario actualizado exitosamente")},subscribe(t){return console.log(" Iniciando suscripcin simple a planes separe..."),ua(yt(Pe,Ke.LAYAWAYS),e=>{console.log(` Actualizacin de planes separe: ${e.docs.length}`);const r=e.docs.map(n=>({id:n.id,...n.data(),createdAt:_t(n.data().createdAt),updatedAt:_t(n.data().updatedAt)}));t(r)},e=>{console.error(" Error en suscripcin de planes separe:",e)})},subscribeByStatus(t,e){console.log(` Iniciando suscripcin a planes separe con estado: ${t}...`);const r=Bt(yt(Pe,Ke.LAYAWAYS),or("status","==",t));return ua(r,n=>{let s=n.docs.map(i=>({id:i.id,...i.data(),createdAt:_t(i.data().createdAt),updatedAt:_t(i.data().updatedAt)}));console.log(` Planes separe ${t} actualizados (${s.length})`),e(s)},n=>{console.error(` Error en suscripcin a planes separe ${t}:`,n)})},async delete(t){console.log(" Eliminando plan separe:",t),await to(ht(Pe,Ke.LAYAWAYS,t)),console.log(" Plan separe eliminado")}},Fr={async getAll(){console.log(" Obteniendo todos los servicios tcnicos...");try{const e=(await Kt(yt(Pe,Ke.TECHNICAL_SERVICES))).docs.map(r=>({id:r.id,...r.data(),createdAt:_t(r.data().createdAt),updatedAt:_t(r.data().updatedAt),completedAt:_t(r.data().completedAt),deliveredAt:_t(r.data().deliveredAt),estimatedCompletionDate:_t(r.data().estimatedCompletionDate)}));return console.log(` Se obtuvieron ${e.length} servicios tcnicos`),e}catch(t){throw console.error(" Error obteniendo servicios tcnicos:",t),t}},async getByStatus(t){console.log(` Obteniendo servicios tcnicos con estado: ${t}...`);try{const e=Bt(yt(Pe,Ke.TECHNICAL_SERVICES),or("status","==",t));let n=(await Kt(e)).docs.map(s=>({id:s.id,...s.data(),createdAt:_t(s.data().createdAt),updatedAt:_t(s.data().updatedAt),completedAt:_t(s.data().completedAt),deliveredAt:_t(s.data().deliveredAt),estimatedCompletionDate:_t(s.data().estimatedCompletionDate)}));return n.sort((s,i)=>{const o=s.createdAt?new Date(s.createdAt).getTime():0;return(i.createdAt?new Date(i.createdAt).getTime():0)-o}),console.log(` Servicios tcnicos obtenidos (${t}): ${n.length}`),n}catch(e){throw console.error(` Error obteniendo servicios tcnicos (${t}):`,e),e}},async getById(t){try{const e=ht(Pe,Ke.TECHNICAL_SERVICES,t),r=await Yn(e);if(r.exists()){const n=r.data();return{id:r.id,...n,createdAt:_t(n.createdAt),updatedAt:_t(n.updatedAt),completedAt:_t(n.completedAt),deliveredAt:_t(n.deliveredAt),estimatedCompletionDate:_t(n.estimatedCompletionDate)}}return null}catch(e){throw console.error("Error getting technical service:",e),e}},async add(t){console.log(" Creando nuevo servicio tcnico...");try{const e=us(Pe),r=ht(yt(Pe,Ke.TECHNICAL_SERVICES)),n={...t,createdAt:Qe(),updatedAt:Qe()},s=Lf(ss(n));e.set(r,s);for(const i of t.items)if(i.productId){const o=ht(Pe,Ke.PRODUCTS,i.productId);e.update(o,{stock:ba(-i.quantity),updatedAt:Qe()})}if(t.courtesyItems&&Array.isArray(t.courtesyItems)){for(const i of t.courtesyItems)if(i.productId){const o=ht(Pe,Ke.PRODUCTS,i.productId);e.update(o,{stock:ba(-i.quantity),updatedAt:Qe()})}}return await e.commit(),console.log(" Servicio tcnico creado con ID:",r.id),r.id}catch(e){throw console.error(" Error creando servicio tcnico:",e),e}},async update(t,e){console.log(" Actualizando servicio tcnico:",t);try{const r=ht(Pe,Ke.TECHNICAL_SERVICES,t),n={...e,updatedAt:Qe()};await ja(r,ss(n)),console.log(" Servicio tcnico actualizado")}catch(r){throw console.error(" Error actualizando servicio tcnico:",r),r}},async addPayment(t,e){console.log(" Agregando pago al servicio tcnico:",t);try{const r=ht(Pe,Ke.TECHNICAL_SERVICES,t),n=await Yn(r);if(!n.exists())throw new Error("Servicio tcnico no encontrado");const s=n.data(),i=[...s.payments||[],e],o=i.reduce((u,d)=>u+d.amount,0),l=Math.max(0,s.totalAmount-o),c={payments:i,remainingBalance:l,updatedAt:Qe()};l===0&&s.status==="completed"&&(c.status="delivered",c.deliveredAt=Qe()),await ja(r,ss(c)),console.log(" Pago agregado al servicio tcnico")}catch(r){throw console.error(" Error agregando pago al servicio tcnico:",r),r}},async delete(t){console.log(" Eliminando servicio tcnico:",t),await to(ht(Pe,Ke.TECHNICAL_SERVICES,t)),console.log(" Servicio tcnico eliminado")},subscribe(t){const e=Bt(yt(Pe,Ke.TECHNICAL_SERVICES),dr("createdAt","desc"));return ua(e,r=>{const n=r.docs.map(s=>({id:s.id,...s.data(),createdAt:_t(s.data().createdAt),updatedAt:_t(s.data().updatedAt),completedAt:_t(s.data().completedAt),deliveredAt:_t(s.data().deliveredAt),estimatedCompletionDate:_t(s.data().estimatedCompletionDate)}));t(n)})},subscribeByStatus(t,e){console.log(` Iniciando suscripcin a servicios tcnicos con estado: ${t}...`);const r=Bt(yt(Pe,Ke.TECHNICAL_SERVICES),or("status","==",t));return ua(r,n=>{let s=n.docs.map(i=>({id:i.id,...i.data(),createdAt:_t(i.data().createdAt),updatedAt:_t(i.data().updatedAt),completedAt:_t(i.data().completedAt),deliveredAt:_t(i.data().deliveredAt),estimatedCompletionDate:_t(i.data().estimatedCompletionDate)}));s.sort((i,o)=>{const l=i.createdAt?new Date(i.createdAt).getTime():0;return(o.createdAt?new Date(o.createdAt).getTime():0)-l}),console.log(` Servicios tcnicos actualizados (${t}): ${s.length}`),e(s)})}},LM={async getDashboardStats(){const[t,e,r,n,s]=await Promise.all([La.getAll(),Xo.getAll(),kn.getAll(),Mn.getAll(),Ul.getAll()]),i=r.filter(v=>v.status==="active"),o=new Date().toDateString(),l=e.filter(v=>new Date(v.createdAt).toDateString()===o),c=r.reduce((v,j)=>v+(j.totalAmount-j.remainingBalance),0),u=e.filter(v=>!v.type||v.type==="regular"),d=e.filter(v=>v.type==="layaway_payment"),h=e.filter(v=>v.type==="technical_service_payment"),f=[...u,...d,...h].reduce((v,j)=>v+(j.finalTotal||j.total),0),m=e.reduce((v,j)=>v+j.totalCost,0),y=e.reduce((v,j)=>v+j.totalProfit,0),g=f>0?y/f*100:0,x=t.reduce((v,j)=>v+j.stock*j.purchasePrice,0),b=t.reduce((v,j)=>v+j.stock*j.salePrice,0);return{totalSales:f,totalProducts:t.length,lowStockCount:t.filter(v=>v.stock<=5).length,todaysSales:l.reduce((v,j)=>v+(j.finalTotal||j.total),0),todaysTransactions:l.length,activeLayaways:i.length,layawayRevenue:c,totalCost:m,totalProfit:y,averageProfitMargin:g,inventoryValue:x,potentialRevenue:b,totalCustomers:n.length,totalCategories:s.filter(v=>v.isActive).length}}},VM={async add(t){try{const e=us(Pe),r=ht(yt(Pe,Ke.PURCHASES)),n={items:t.items,totalCost:t.totalCost,totalItems:t.totalItems,createdAt:Qe()};t.notes&&t.notes.trim()&&(n.notes=t.notes.trim()),e.set(r,n);for(const s of t.items){const i=ht(Pe,Ke.PRODUCTS,s.productId),o=await Yn(i);if(!o.exists())throw new Error(`Producto no encontrado: ${s.productId}`);const l=o.data(),c=l.stock,u=l.purchasePrice,d=c+s.quantity,h=c*u+s.quantity*s.purchasePrice,f=d>0?h/d:s.purchasePrice;e.update(i,{stock:d,purchasePrice:Math.round(f),salePrice:s.newSalePrice||l.salePrice,updatedAt:Qe()})}return await e.commit(),r.id}catch(e){throw console.error("Error adding purchase:",e),e}},async getAll(){try{const t=Bt(yt(Pe,Ke.PURCHASES),dr("createdAt","desc"));return(await Kt(t)).docs.map(r=>({id:r.id,...r.data()}))}catch(t){throw console.error("Error getting purchases:",t),t}},async getById(t){try{const e=ht(Pe,Ke.PURCHASES,t),r=await Yn(e);return r.exists()?{id:r.id,...r.data()}:null}catch(e){throw console.error("Error getting purchase:",e),e}},async delete(t){try{await to(ht(Pe,Ke.PURCHASES,t))}catch(e){throw console.error("Error deleting purchase:",e),e}},subscribe(t){const e=Bt(yt(Pe,Ke.PURCHASES),dr("createdAt","desc"));return ua(e,r=>{const n=r.docs.map(s=>({id:s.id,...s.data()}));t(n)})}},Nx={async getAll(){try{return(await Kt(Bt(yt(Pe,Ke.COURTESIES),dr("createdAt","desc")))).docs.map(e=>{const r=e.data(),n=ss(r);return{id:e.id,...n}})}catch(t){throw console.error("Error getting courtesies:",t),t}},async add(t){try{const e=ht(yt(Pe,Ke.COURTESIES)),r=Lf({...t,createdAt:Qe()});return await zm(e,r),e.id}catch(e){throw console.error("Error adding courtesy:",e),e}},async delete(t){try{await to(ht(Pe,Ke.COURTESIES,t))}catch(e){throw console.error("Error deleting courtesy:",e),e}},async getByDateRange(t,e){try{return(await Kt(Bt(yt(Pe,Ke.COURTESIES),or("createdAt",">=",t),or("createdAt","<=",e),dr("createdAt","desc")))).docs.map(n=>{const s=n.data(),i=ss(s);return{id:n.id,...i}})}catch(r){throw console.error("Error getting courtesies by date range:",r),r}},async getBySalesperson(t){try{return(await Kt(Bt(yt(Pe,Ke.COURTESIES),or("salesPersonId","==",t),dr("createdAt","desc")))).docs.map(r=>{const n=r.data(),s=ss(n);return{id:r.id,...s}})}catch(e){throw console.error("Error getting courtesies by salesperson:",e),e}},async getByCustomer(t){try{return(await Kt(Bt(yt(Pe,Ke.COURTESIES),or("customerId","==",t),dr("createdAt","desc")))).docs.map(r=>{const n=r.data(),s=ss(n);return{id:r.id,...s}})}catch(e){throw console.error("Error getting courtesies by customer:",e),e}}},Oa=Object.freeze(Object.defineProperty({__proto__:null,categoriesService:Ul,courtesiesService:Nx,customersService:Mn,layawaysService:kn,productsService:La,purchasesService:VM,salesService:Xo,statsService:LM,technicalServicesService:Fr},Symbol.toStringTag,{value:"Module"})),FM=I.createContext(void 0);function PW({children:t}){const e=Hm(),r=I.useRef(new Map),[n,s]=I.useState(!1),i=I.useCallback(P=>{console.log(` Invalidando cach de: ${P}`),r.current.delete(P)},[]),o=I.useCallback(()=>{console.log(" Invalidando todo el cach"),r.current.clear()},[]),l=I.useCallback(()=>{console.log(" Invalidando cach de ventas - se solicitarn datos frescos"),s(!0),i("sales")},[i]),c=I.useCallback(()=>{console.log(" Datos de ventas marcados como ledos"),s(!1)},[]),u=I.useCallback(P=>{const O=r.current.get(P);return O?Date.now()-O<10*60*1e3:!1},[]),d=I.useCallback(P=>{r.current.set(P,Date.now())},[]),h=I.useCallback(async()=>{if(!u("products"))try{console.log(" Cargando productos bajo demanda..."),e(Jc(!0)),e(Ph(null));const P=await La.getAll();e(vg(P)),d("products"),console.log(` Productos cargados: ${P.length}`)}catch(P){console.error(" Error cargando productos:",P),e(Ph(P instanceof Error?P.message:"Error loading products"))}finally{e(Jc(!1))}},[e,u,d]),f=I.useCallback(async()=>{try{console.log(" Forzando recarga de productos..."),e(Jc(!0)),e(Ph(null));const P=await La.getAll();e(vg(P)),d("products"),console.log(` Productos forzadamente recargados: ${P.length}`)}catch(P){console.error(" Error forzando recarga de productos:",P),e(Ph(P instanceof Error?P.message:"Error loading products"))}finally{e(Jc(!1))}},[e,d]),m=I.useCallback(async()=>{if(!u("categories"))try{console.log(" Cargando categoras bajo demanda..."),e(eE(!0)),e(tE(null));const P=await Ul.getAll();e(ZC(P)),d("categories"),console.log(` Categoras cargadas: ${P.length}`)}catch(P){console.error(" Error cargando categoras:",P),e(tE(P instanceof Error?P.message:"Error loading categories"))}finally{e(eE(!1))}},[e,u,d]),y=I.useCallback(async()=>{if(!u("sales"))try{console.log(" Cargando ventas bajo demanda..."),e(nE(!0)),e(aE(null));const P=await Xo.getAll();e(rE(P)),d("sales"),console.log(` Ventas cargadas: ${P.length}`)}catch(P){console.error(" Error cargando ventas:",P),e(aE(P instanceof Error?P.message:"Error loading sales"))}finally{e(nE(!1))}},[e,u,d]),g=I.useCallback(async()=>{if(!u("customers"))try{console.log(" Cargando clientes bajo demanda..."),e(i0(!0)),e(Qw(null));const P=await Mn.getAll();e(Kw(P)),d("customers"),console.log(` Clientes cargados: ${P.length}`)}catch(P){console.error(" Error cargando clientes:",P),e(Qw(P instanceof Error?P.message:"Error loading customers"))}finally{e(i0(!1))}},[e,u,d]),x=I.useCallback(async()=>{if(!u("layaways"))try{console.log(" Cargando planes separe bajo demanda..."),e(o0(!0)),e(Yw(null));const P=await kn.getAll();e(bg(P)),d("layaways"),console.log(` Planes separe cargados: ${P.length}`)}catch(P){console.error(" Error cargando planes separe:",P),e(Yw(P instanceof Error?P.message:"Error loading layaways"))}finally{e(o0(!1))}},[e,u,d]),b=I.useCallback(async()=>{if(!u("technicalServices"))try{console.log(" Cargando servicios tcnicos bajo demanda..."),e(Ou(!0)),e(l0(null));const P=await Fr.getAll();e(Wh(P)),d("technicalServices"),console.log(` Servicios tcnicos cargados: ${P.length}`)}catch(P){console.error(" Error cargando servicios tcnicos:",P),e(l0(P instanceof Error?P.message:"Error loading technical services"))}finally{e(Ou(!1))}},[e,u,d]),v=I.useCallback(async()=>{try{console.log(" Cargando estadsticas bajo demanda..."),e(sE(!0)),e(iE(null));const P=await LM.getDashboardStats();e(IB(P)),console.log(" Estadsticas cargadas")}catch(P){console.error(" Error cargando estadsticas:",P),e(iE(P instanceof Error?P.message:"Error loading stats"))}finally{e(sE(!1))}},[e]),j=I.useCallback(()=>La.subscribe(O=>{e(vg(O))}),[e]),S=I.useCallback(()=>Ul.subscribe(O=>{e(ZC(O))}),[e]),_=I.useCallback(()=>Xo.subscribe(O=>{e(rE(O))}),[e]),C=I.useCallback(()=>Mn.subscribe(O=>{e(Kw(O))}),[e]),N=I.useCallback(()=>kn.subscribe(O=>{e(bg(O))}),[e]),w=I.useCallback(P=>kn.subscribeByStatus(P,D=>{e(bg(D))}),[e]),E=I.useCallback(()=>Fr.subscribe(O=>{e(Wh(O))}),[e]),k=I.useCallback(P=>Fr.subscribeByStatus(P,D=>{e(Wh(D))}),[e]),T={loadProducts:h,forceLoadProducts:f,loadCategories:m,loadSales:y,loadCustomers:g,loadLayaways:x,loadTechnicalServices:b,loadStats:v,invalidateCache:i,invalidateAllCache:o,invalidateSales:l,needsFreshSalesData:n,markSalesDataAsRead:c,subscribeToProducts:j,subscribeToCategories:S,subscribeToSales:_,subscribeToCustomers:C,subscribeToLayaways:N,subscribeToLayawaysByStatus:w,subscribeToTechnicalServices:E,subscribeToTechnicalServicesByStatus:k};return a.jsx(FM.Provider,{value:T,children:t})}function wc(){const t=I.useContext(FM);if(t===void 0)throw new Error("useFirebase must be used within a FirebaseProvider");return t}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var TW={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AW=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ze=(t,e)=>{const r=I.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...u},d)=>I.createElement("svg",{ref:d,...TW,width:s,height:s,stroke:n,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${AW(t)}`,l].join(" "),...u},[...e.map(([h,f])=>I.createElement(h,f)),...Array.isArray(c)?c:[c]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _j=Ze("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vf=Ze("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=Ze("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IW=Ze("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vp=Ze("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=Ze("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=Ze("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0=Ze("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=Ze("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=Ze("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=Ze("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kW=Ze("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sj=Ze("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=Ze("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $i=Ze("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ef=Ze("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=Ze("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=Ze("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OW=Ze("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=Ze("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DW=Ze("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=Ze("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=Ze("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MW=Ze("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=Ze("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=Ze("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=Ze("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=Ze("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=Ze("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RW=Ze("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ej=Ze("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=Ze("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=Ze("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _x=Ze("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $W=Ze("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=Ze("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LW=Ze("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CP=Ze("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pj=Ze("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _l=Ze("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VW=Ze("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z",key:"uf6l00"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h0",key:"k2aug8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Ze("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=Ze("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ru=Ze("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=Ze("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FW=Ze("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=Ze("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=Ze("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zl=Ze("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=Ze("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=Ze("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=Ze("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=Ze("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=Ze("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=Ze("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=Ze("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BW=Ze("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=Ze("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UW=Ze("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zW=Ze("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qW=Ze("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HW=Ze("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=Ze("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0=Ze("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WW=Ze("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GW=Ze("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KW=Ze("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QW=Ze("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=Ze("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),HM=I.createContext(void 0);function hi(){const t=I.useContext(HM);if(t===void 0)throw new Error("useNotification must be used within a NotificationProvider");return t}function YW({children:t}){const[e,r]=I.useState([]),[n,s]=I.useState(null),i=(x,b,v,j=5e3)=>{const S=crypto.randomUUID(),_={id:S,type:x,title:b,message:v,duration:j};r(C=>[...C,_]),j>0&&setTimeout(()=>{h(S)},j)},o=(x,b,v=5e3)=>{i("success",x,b,v)},l=(x,b,v=8e3)=>{i("error",x,b,v)},c=(x,b,v=6e3)=>{i("warning",x,b,v)},u=(x,b,v=5e3)=>{i("info",x,b,v)},d=(x,b,v,j)=>{s({title:x,message:b,onConfirm:v,onCancel:j})},h=x=>{r(b=>b.filter(v=>v.id!==x))},f=()=>{n&&(n.onConfirm(),s(null))},m=()=>{var x;n&&((x=n.onCancel)==null||x.call(n),s(null))},y=x=>{switch(x){case"success":return a.jsx(ai,{className:"h-5 w-5 text-green-600"});case"error":return a.jsx(QW,{className:"h-5 w-5 text-red-600"});case"warning":return a.jsx(is,{className:"h-5 w-5 text-orange-600"});case"info":return a.jsx(_P,{className:"h-5 w-5 text-blue-600"});default:return a.jsx(_P,{className:"h-5 w-5 text-gray-600"})}},g=x=>{switch(x){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-orange-50 border-orange-200 text-orange-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}};return a.jsxs(HM.Provider,{value:{notifications:e,showSuccess:o,showError:l,showWarning:c,showInfo:u,showConfirm:d,removeNotification:h},children:[t,a.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm",children:e.map(x=>a.jsx("div",{className:`p-4 rounded-lg border shadow-lg transition-all duration-300 transform ${g(x.type)}`,children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:y(x.type)}),a.jsxs("div",{className:"ml-3 flex-1",children:[a.jsx("h4",{className:"text-sm font-semibold",children:x.title}),a.jsx("p",{className:"text-sm mt-1",children:x.message})]}),a.jsx("button",{onClick:()=>h(x.id),className:"flex-shrink-0 ml-2 text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(ct,{className:"h-4 w-4"})})]})},x.id))}),n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6 shadow-xl",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(is,{className:"h-6 w-6 text-orange-600 mr-3"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n.title})]}),a.jsx("p",{className:"text-gray-600 mb-6",children:n.message}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:m,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancelar"}),a.jsx("button",{onClick:f,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Confirmar"})]})]})})]})}function XW(){const[t,e]=I.useState(""),[r,n]=I.useState(""),[s,i]=I.useState(!1),[o,l]=I.useState(""),[c,u]=I.useState(null),{login:d,isLoading:h}=ma();ee.useEffect(()=>{const g=localStorage.getItem("sessionExpiredMsg");g&&u(g)},[]),ee.useEffect(()=>{c&&(localStorage.removeItem("sessionExpiredMsg"),localStorage.removeItem("lastLoginDate"))},[c]);const f=async g=>{if(g.preventDefault(),!t||!r){l("Por favor ingresa email y contrasea");return}const x=await d(t,r);x?(l(x),alert(x)):u(null)},m=g=>{e(g.target.value),o&&l("")},y=g=>{n(g.target.value),o&&l("")};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-sky-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"w-56 h-32 mx-auto mb-2 flex items-center justify-center overflow-hidden",children:a.jsx("img",{src:"/celumaria.jpeg",alt:"Celu Maria",className:"w-56 h-56 object-cover object-top",style:{background:"#fff"}})}),a.jsx("h1",{className:"text-3xl font-bold mb-2",style:{color:"#90c5e7"},children:"Sede Centro"}),a.jsx("p",{className:"text-gray-600 text-base",children:"Sistema de Control de Inventario y Ventas"})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Iniciar Sesin"}),a.jsx("p",{className:"text-gray-600",children:"Accede a tu cuenta para continuar"}),c&&a.jsx("div",{className:"mt-4 mb-2 p-3 bg-yellow-100 border border-yellow-300 rounded text-center",children:a.jsx("span",{className:"text-yellow-800 text-base font-semibold",children:c})}),o&&a.jsx("div",{className:"mt-4 mb-2 p-3 bg-red-100 border border-red-300 rounded text-center",children:a.jsx("span",{className:"text-red-700 text-base font-semibold",children:o})})]}),a.jsxs("form",{onSubmit:f,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(Rr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"email",value:t,onChange:m,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-colors",placeholder:"Ingresa tu email",disabled:h})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),a.jsxs("div",{className:"relative",children:[a.jsx(RW,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:s?"text":"password",value:r,onChange:y,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-colors",placeholder:"Ingresa tu contrasea",disabled:h}),a.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",disabled:h,children:s?a.jsx(OW,{className:"h-5 w-5"}):a.jsx(os,{className:"h-5 w-5"})})]})]}),a.jsx("button",{type:"submit",disabled:h,className:"w-full text-white py-3 px-4 rounded-lg font-medium hover:opacity-90 focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",style:{backgroundColor:"#90c5e7"},children:h?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Iniciando sesin..."]}):"Iniciar Sesin"})]})]}),a.jsx("div",{className:"text-center mt-8",children:a.jsx("p",{className:"text-sm text-gray-500",children:" 2025 Celu Maria. Todos los derechos reservados."})})]})})}function JW({children:t}){const{isAuthenticated:e,isLoading:r}=ma();return r?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#90c5e7] mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Cargando..."})]})}):e?a.jsx(a.Fragment,{children:t}):a.jsx(XW,{})}function Pn({permission:t,children:e,fallback:r}){const{permissionHelpers:n}=ma();return n?n.hasPermission(t)?a.jsx(a.Fragment,{children:e}):r?a.jsx(a.Fragment,{children:r}):a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Acceso Denegado"}),a.jsx("p",{className:"text-gray-600",children:"No tienes permisos para acceder a esta seccin."}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Contacta al administrador si necesitas acceso."})]})}):a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}function ZW({isOpen:t,onConfirm:e,onCancel:r,userName:n}){if(!t)return null;const s=i=>{i.target===i.currentTarget&&r()};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-200",onClick:s,children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 transform transition-transform duration-200 scale-100",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(Ej,{className:"w-5 h-5 text-red-600"})}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Cerrar Sesin"})]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200 rounded-full p-1 hover:bg-gray-100",children:a.jsx(ct,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("p",{className:"text-gray-700 text-base leading-relaxed",children:n?a.jsxs(a.Fragment,{children:["Hola ",a.jsx("span",{className:"font-medium text-gray-900",children:n}),", ests seguro de que quieres cerrar tu sesin?"]}):"Ests seguro de que quieres cerrar sesin?"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Tendrs que iniciar sesin nuevamente para acceder al sistema."})]}),a.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:[a.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-200 transition-colors duration-200",children:"Cancelar"}),a.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors duration-200",children:"Cerrar Sesin"})]})]})})}const Tg=[{id:"operations",name:"Operaciones",icon:_j,items:[{id:"dashboard",name:"Panel de Control",icon:UM},{id:"sales",name:"Ventas",icon:Jo},{id:"my-daily-sales",name:"Mis Ventas del Da",icon:Wt},{id:"layaway",name:"Plan Separe",icon:Xn},{id:"technical-service",name:"Servicio Tcnico",icon:zl},{id:"technician-liquidation",name:"Liquidacin de Tcnicos",icon:Wt},{id:"customers",name:"Clientes",icon:E0},{id:"courtesies",name:"Cortesas",icon:ur}]},{id:"inventory",name:"Inventario",icon:IW,items:[{id:"inventory",name:"Productos",icon:ea},{id:"purchases",name:"Compras",icon:$W},{id:"categories",name:"Categoras",icon:nS}]},{id:"analytics",name:"Anlisis",icon:ds,items:[{id:"reports",name:"Reportes",icon:ga},{id:"sales-history",name:"Gestin de Ventas",icon:Cj},{id:"purchases-history",name:"Gestin de Compras",icon:Cj},{id:"technical-service-center",name:"Centro de Servicios Tcnicos",icon:zl}]},{id:"settings",name:"Configuracin",icon:zl,items:[{id:"user-management",name:"Gestin de Usuarios",icon:zW},{id:"technician-management",name:"Gestin de Tcnicos",icon:KW}]}],eG=Tg.flatMap(t=>t.items);function tG({children:t,currentView:e,onViewChange:r}){const{user:n,appUser:s,permissions:i,logout:o}=ma(),[l,c]=I.useState(!1),[u,d]=I.useState(!1),[h,f]=I.useState(!1),[m,y]=I.useState(()=>{const N=Tg.find(w=>w.items.some(E=>E.id===e));return new Set(N?[N.id]:["operations"])}),g=N=>{y(w=>{const E=new Set(w);return E.has(N)?E.delete(N):E.add(N),E})};I.useEffect(()=>{const N=Tg.find(w=>w.items.some(E=>E.id===e));N&&y(w=>new Set([...w,N.id]))},[e]);const x=I.useMemo(()=>i?SW(i).map(w=>{const E=eG.find(k=>k.id===w.id);return{...w,icon:(E==null?void 0:E.icon)||UM}}):[],[i]),b=I.useMemo(()=>i?Tg.map(N=>({...N,items:N.items.filter(w=>x.some(E=>E.id===w.id))})).filter(N=>N.items.length>0):[],[x]);I.useEffect(()=>{if(x.length>0&&!x.some(w=>w.id===e)){const w=x[0];w&&(console.log(` Usuario sin permisos para '${e}', redirigiendo a '${w.id}'`),r(w.id))}},[x,e,r]);const v=()=>{d(!0)},j=()=>{o(),d(!1)},S=()=>{d(!1)},_=N=>N==="admin"?"Administrador":"Empleado",C=(N,w)=>{if(N&&N.trim())return N.charAt(0).toUpperCase()+N.slice(1);if(w){const E=w.split("@")[0];return E.charAt(0).toUpperCase()+E.slice(1)}return"Usuario"};return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("header",{className:"bg-white shadow-lg sticky top-0 z-30 sm:hidden",children:a.jsxs("div",{className:"flex items-center justify-between h-14 px-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 focus:outline-none border border-gray-200 transition-all duration-200",onClick:()=>c(!l),"aria-label":"Abrir men",children:a.jsx("svg",{className:"h-5 w-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-bold text-sm text-gray-900",children:"Celu Maria"}),a.jsx("span",{className:"text-xs",style:{color:"#90c5e7"},children:C((s==null?void 0:s.displayName)||"",(s==null?void 0:s.email)||(n==null?void 0:n.email))})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(s==null?void 0:s.role)==="admin"?"text-white":"bg-blue-100 text-blue-700"}`,style:(s==null?void 0:s.role)==="admin"?{backgroundColor:"#90c5e7"}:{},children:_((s==null?void 0:s.role)||"")}),a.jsxs("button",{onClick:v,className:"flex items-center space-x-1 bg-red-50 hover:bg-red-100 text-red-600 hover:text-red-700 px-2 py-1 rounded-lg transition-all duration-200 border border-red-200 z-50 relative",title:"Cerrar sesin",children:[a.jsx(Ej,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs font-medium",children:"Salir"})]})]})]})}),a.jsx("header",{className:"bg-white fixed top-0 left-0 right-0 z-30 hidden sm:block h-16",children:a.jsxs("div",{className:"relative h-full",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-50/30 via-transparent to-purple-50/30"}),a.jsxs("div",{className:"relative flex flex-row justify-between items-center h-16 px-8",children:[a.jsxs("div",{className:"flex items-center pl-2 -space-x-6",children:[a.jsx("div",{className:"w-12 h-12 flex items-center justify-center z-10 relative",children:a.jsx("img",{src:"/logoLetras.jpeg",alt:"Celu Maria Logo",className:"w-full h-full object-contain"})}),a.jsx("div",{className:"w-48 h-14 flex items-center justify-center",children:a.jsx("img",{src:"/logoNombre.jpeg",alt:"Celu Maria",className:"w-full h-full object-contain"})}),a.jsxs("div",{className:"border-l border-gray-300 pl-4 ml-2",children:[a.jsx("h1",{className:"text-lg font-bold text-gray-900 tracking-tight",children:"Sistema de Gestin"}),a.jsx("p",{className:"text-xs font-medium",style:{color:"#90c5e7"},children:"Control de Inventario y Ventas"})]})]}),a.jsxs("div",{className:"flex items-center space-x-6 pr-4",children:[a.jsxs("div",{className:"flex items-center space-x-3 bg-gray-50 rounded-lg px-4 py-2 border border-gray-200 shadow-sm",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:a.jsx(Rr,{className:"h-4 w-4 text-white"})}),a.jsxs("div",{className:"text-left",children:[a.jsx("span",{className:"block text-sm font-semibold text-gray-900",children:C((s==null?void 0:s.displayName)||"",(s==null?void 0:s.email)||(n==null?void 0:n.email))}),a.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium mt-0.5 ${(s==null?void 0:s.role)==="admin"?"text-white":"bg-blue-100 text-blue-700"}`,style:(s==null?void 0:s.role)==="admin"?{backgroundColor:"#90c5e7"}:{},children:_((s==null?void 0:s.role)||"")})]})]}),a.jsxs("button",{onClick:v,className:"flex items-center space-x-2 bg-red-50 hover:bg-red-100 text-red-600 hover:text-red-700 px-4 py-2 rounded-lg transition-all duration-200 border border-red-200 hover:border-red-300 shadow-sm z-50 relative",title:"Cerrar sesin",children:[a.jsx(Ej,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-medium",children:"Cerrar Sesin"})]})]})]}),a.jsx("div",{className:"absolute bottom-0 h-full transition-all duration-700 ease-out shadow-xl",style:{left:h?"288px":"64px",right:"0"}}),a.jsx("div",{className:"absolute bottom-0 h-0.5 transition-all duration-700 ease-out z-10",style:{backgroundColor:"#90c5e7",left:h?"288px":"64px",right:"0"}})]})}),a.jsxs("div",{className:"flex",children:[l&&a.jsx("nav",{className:"fixed inset-0 z-40 bg-black bg-opacity-30 sm:hidden",onClick:()=>c(!1),children:a.jsxs("div",{className:"w-72 bg-white shadow-sm border-r border-gray-200 h-full p-4 transform transition-transform duration-200 translate-x-0 overflow-y-auto flex flex-col relative",onClick:N=>N.stopPropagation(),children:[a.jsx("div",{className:"absolute top-0 right-0 bottom-0 w-0.5",style:{backgroundColor:"#90c5e7"}}),a.jsx("button",{className:"mb-4 p-2 rounded-md hover:bg-gray-100",onClick:()=>c(!1),"aria-label":"Cerrar men",children:a.jsx("svg",{className:"h-6 w-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),a.jsxs("div",{className:"flex flex-col items-center mb-4",children:[a.jsx("div",{className:"w-28 h-28 flex items-center justify-center mb-2",children:a.jsx("img",{src:"/logoNombre.jpeg",alt:"Celu Maria",className:"w-full h-full object-contain"})}),a.jsx("span",{className:"font-bold text-base text-gray-900",children:"Celu Maria"})]}),a.jsx("div",{className:"space-y-3 flex-1 overflow-y-auto pb-4 relative",children:b.map(N=>{const w=N.icon,E=m.has(N.id);return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("button",{onClick:()=>g(N.id),className:"w-full flex items-center justify-between px-3 py-2 text-sm font-semibold text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(w,{className:"mr-3 h-4 w-4 text-gray-600"}),N.name]}),E?a.jsx(Da,{className:"h-4 w-4 text-gray-500"}):a.jsx(Sj,{className:"h-4 w-4 text-gray-500"})]}),E&&a.jsx("ul",{className:"ml-4 space-y-1",children:N.items.map(k=>{const T=k.icon;return a.jsx("li",{children:a.jsxs("button",{onClick:()=>{r(k.id),c(!1)},className:`w-full flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ${e===k.id?"text-white border":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,style:e===k.id?{backgroundColor:"#90c5e7",borderColor:"#90c5e7"}:{},children:[a.jsx(T,{className:"mr-3 h-4 w-4"}),k.name]})},k.id)})})]},N.id)})})]})}),a.jsxs("div",{className:`hidden sm:block bg-white shadow-xl border-r border-gray-300 fixed left-0 top-16 bottom-0 overflow-hidden z-20 transition-all duration-700 ease-out ${h?"w-72":"w-16"}`,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:[a.jsx("div",{className:"absolute top-0 right-0 bottom-0 w-0.5",style:{backgroundColor:"#90c5e7"}}),a.jsxs("div",{className:`h-full relative ${h?"overflow-y-auto":"overflow-y-auto scrollbar-hide"}`,children:[!h&&a.jsx("div",{className:"py-3 px-2 space-y-2",children:b.map(N=>{const w=N.icon,E=m.has(N.id);return a.jsxs("div",{className:"space-y-1",children:[a.jsx("button",{onClick:()=>g(N.id),className:`w-full flex items-center justify-center py-2.5 rounded-lg transition-colors ${E?"bg-gray-100 text-gray-700":"text-gray-600 hover:bg-gray-100"}`,title:N.name,children:a.jsx(w,{className:"h-6 w-6 stroke-[1.5]"})}),E&&a.jsx("div",{className:"space-y-1 ml-0.5",children:N.items.map(k=>{const T=k.icon;return a.jsx("button",{onClick:()=>r(k.id),className:`w-full flex items-center justify-center py-2.5 rounded-lg transition-colors ${e===k.id?"text-white":"text-gray-600 hover:bg-gray-100"}`,style:e===k.id?{backgroundColor:"#90c5e7"}:{},title:k.name,children:a.jsx(T,{className:"h-5 w-5 stroke-[1.5]"})},k.id)})})]},N.id)})}),h&&a.jsx("div",{className:"p-4 space-y-3 h-full overflow-y-auto pb-4",children:b.map(N=>{const w=N.icon,E=m.has(N.id);return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("button",{onClick:()=>g(N.id),className:"w-full flex items-center justify-between px-3 py-2 text-sm font-semibold text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(w,{className:"mr-3 h-4 w-4 text-gray-600"}),N.name]}),E?a.jsx(Da,{className:"h-4 w-4 text-gray-500"}):a.jsx(Sj,{className:"h-4 w-4 text-gray-500"})]}),E&&a.jsx("ul",{className:"ml-4 space-y-1",children:N.items.map(k=>{const T=k.icon;return a.jsx("li",{children:a.jsxs("button",{onClick:()=>r(k.id),className:`w-full flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ${e===k.id?"text-white border":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,style:e===k.id?{backgroundColor:"#90c5e7",borderColor:"#90c5e7"}:{},children:[a.jsx(T,{className:"mr-3 h-4 w-4"}),k.name]})},k.id)})})]},N.id)})})]})]}),a.jsx("main",{className:`transition-all duration-700 ease-out w-full ${h?"sm:ml-72":"sm:ml-16"}`,style:{marginTop:"64px"},children:a.jsx("div",{className:"max-w-7xl mx-auto px-3",children:t})})]}),a.jsx(ZW,{isOpen:u,onConfirm:j,onCancel:S,userName:C((s==null?void 0:s.displayName)||"",n==null?void 0:n.email)})]})}const Xt=HV,ro=t=>t.firebase.products.items,aS=t=>t.firebase.categories.items,Gm=t=>t.firebase.sales.items,kd=t=>t.firebase.customers.items,Sx=t=>t.firebase.layaways.items,WM=t=>t.firebase.technicalServices.items;wd([ro],t=>t.filter(e=>e.stock<=5));const rG=wd([aS],t=>t);wd([Sx],t=>t.filter(e=>e.status==="active"));wd([Gm],t=>{const e=new Date().toDateString();return t.filter(r=>new Date(r.createdAt).toDateString()===e)});wd([Gm],t=>t.slice(-10).reverse());const tf={calculateMargin(t,e){return e<=0?0:(e-t)/e*100},calculateProfit(t,e){return Math.max(0,e-t)},calculateInventoryValue(t){return t.reduce((e,r)=>e+r.stock*r.purchasePrice,0)},calculatePotentialRevenue(t){return t.reduce((e,r)=>e+r.stock*r.salePrice,0)},getLowStockProducts(t,e=5){return t.filter(r=>r.stock<=e&&r.stock>0)}},Ff={calculateSaleTotal(t,e=0){const r=t.reduce((c,u)=>c+u.totalRevenue,0),n=t.reduce((c,u)=>c+u.totalCost,0),s=Math.min(e,r),i=r-s,o=i-n,l=i>0?o/i*100:0;return{subtotal:r,appliedDiscount:s,total:i,totalCost:n,totalProfit:o,profitMargin:l}},calculateSalesStats(t,e,r){const n=t.filter(h=>{const f=new Date(h.createdAt);return!(e&&f<e||r&&f>r)}),s=n.reduce((h,f)=>h+(f.finalTotal||f.total),0),i=n.reduce((h,f)=>h+(f.totalCost||0),0),o=n.reduce((h,f)=>h+(f.totalProfit||0),0),l=n.length>0?s/n.length:0,u=n.filter(h=>(h.finalTotal||h.total)>0).reduce((h,f)=>h+(f.finalTotal||f.total),0),d=u>0?o/u*100:0;return{totalSales:s,totalCost:i,totalProfit:o,averageTransaction:l,profitMargin:d,transactionCount:n.length}},getTodaysSales(t){const e=new Date().toDateString();return t.filter(r=>new Date(r.createdAt).toDateString()===e)},getTodaysSalesBreakdown(t){const e=this.getTodaysSales(t);let r=0,n=0,s=0,i=0;e.forEach(l=>{const c=l.finalTotal||l.total;if(l.type==="technical_service_payment"){s+=c;return}if(l.type==="layaway_payment"){i+=c;return}if(l.type!=="layaway_delivery"&&(l.type==="regular"||!l.type)&&(l.items.forEach(u=>{const d=u.totalRevenue;u.category&&u.category.toLowerCase().includes("celular")?r+=d:n+=d}),l.discount>0)){const u=l.subtotal;if(u>0){const d=l.discount/u;r-=l.items.filter(h=>h.category&&h.category.toLowerCase().includes("celular")).reduce((h,f)=>h+f.totalRevenue,0)*d,n-=l.items.filter(h=>!h.category||!h.category.toLowerCase().includes("celular")).reduce((h,f)=>h+f.totalRevenue,0)*d}}});const o=r+n+s+i;return{total:o,cellphones:r,otherProducts:n,technicalServices:s,layawayPayments:i,percentages:{cellphones:o>0?r/o*100:0,otherProducts:o>0?n/o*100:0,technicalServices:o>0?s/o*100:0,layawayPayments:o>0?i/o*100:0},transactionCount:e.length}},getTopSellingProducts(t,e,r=5){const n={};return t.forEach(s=>{s.items.forEach(i=>{if(!n[i.productId]){const o=e.find(l=>l.id===i.productId);o&&(n[i.productId]={product:o,totalSold:0,totalRevenue:0,totalProfit:0})}n[i.productId]&&(n[i.productId].totalSold+=i.quantity,n[i.productId].totalRevenue+=i.totalRevenue,n[i.productId].totalProfit+=i.profit)})}),Object.values(n).sort((s,i)=>i.totalProfit-s.totalProfit).slice(0,r)}},nG={calculateDashboardStats(t,e,r,n,s){const i=Ff.getTodaysSales(e),o=r.filter(f=>f.status==="active"),l=r.reduce((f,m)=>f+(m.totalAmount-m.remainingBalance),0),c=Ff.calculateSalesStats(e),u=tf.calculateInventoryValue(t),d=tf.calculatePotentialRevenue(t),h=tf.getLowStockProducts(t).length;return{totalSales:c.totalSales,totalProducts:t.length,lowStockCount:h,todaysSales:i.reduce((f,m)=>f+(m.finalTotal||m.total),0),todaysTransactions:i.length,activeLayaways:o.length,layawayRevenue:l,totalCost:c.totalCost,totalProfit:c.totalProfit,averageProfitMargin:c.profitMargin,inventoryValue:u,potentialRevenue:d,totalCustomers:n.length,totalCategories:s.filter(f=>f.isActive).length}},recalculateStats(t){const{products:e,sales:r,layaways:n,customers:s,categories:i}=t.firebase;return this.calculateDashboardStats(e.items,r.items,n.items,s.items,i.items)}},aG={debounce(t,e){let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>t(...n),e)}},memoize(t){const e=new Map;return(...r)=>{const n=JSON.stringify(r);if(e.has(n))return e.get(n);const s=t(...r);return e.set(n,s),s}},shouldRecalculate(t,e){return t.length!==e.length||JSON.stringify(t)!==JSON.stringify(e)}},sG={products:tf,sales:Ff,dashboard:nG,utils:aG},V=t=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),sr=t=>new Intl.NumberFormat("es-CO").format(t),Cs=t=>new Intl.NumberFormat("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t),Yt=t=>{const e=t.toString().replace(/[^\d]/g,"");if(!e)return"";const r=parseInt(e,10);return new Intl.NumberFormat("es-CO").format(r)},jt=t=>{const e=t.replace(/[^\d]/g,"");return e?parseInt(e,10):0};function iG(){const[t,e]=I.useState(!1),r=Xt(ro),n=Xt(Gm),s=Xt(Sx),i=Xt(kd),o=Xt(aS),[l,c]=I.useState("month"),{startDate:u,endDate:d}=I.useMemo(()=>{const j=new Date,S=new Date(j);S.setHours(23,59,59,999);const _=new Date(j);switch(_.setHours(0,0,0,0),l){case"today":break;case"week":_.setDate(j.getDate()-7);break;case"month":_.setMonth(j.getMonth()-1);break;case"2months":_.setMonth(j.getMonth()-2);break}return{startDate:_,endDate:S}},[l]),h=I.useMemo(()=>n.filter(j=>{const S=new Date(j.createdAt);return S>=u&&S<=d}),[n,u,d]),f=I.useMemo(()=>s.filter(j=>{const S=new Date(j.createdAt);return S>=u&&S<=d}),[s,u,d]),m=I.useMemo(()=>sG.dashboard.calculateDashboardStats(r,h,f,i,o),[r,h,f,i,o]),y=I.useMemo(()=>Ff.getTodaysSales(n).reduce((j,S)=>j+(S.finalTotal||S.total),0),[n]),g=I.useMemo(()=>tf.getLowStockProducts(r).length,[r]),x=I.useMemo(()=>r.filter(j=>j.stock===0).length,[r]),b=I.useMemo(()=>s.filter(j=>j.status==="active").length,[s]);if(t||!m)return a.jsx("div",{className:"bg-gray-50 flex items-center justify-center",style:{height:"calc(100vh - 88px)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#90c5e7] mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Cargando panel de control..."})]})});const v={today:"del Da",week:"de la Semana",month:"del Mes","2months":"de 2 Meses"};return a.jsxs("div",{className:"bg-gray-50 flex flex-col py-4",style:{height:"calc(100vh - 88px)",overflow:"hidden"},children:[a.jsx("div",{className:"flex justify-end items-center mb-4 flex-shrink-0",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(_j,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{className:"text-sm font-semibold text-slate-700",children:"En vivo"})]}),a.jsx("div",{className:"bg-white rounded-lg shadow border border-slate-200",children:a.jsxs("select",{value:l,onChange:j=>c(j.target.value),className:"bg-transparent border-0 rounded-lg px-3 py-1 text-xs font-semibold text-slate-700 focus:outline-none cursor-pointer",children:[a.jsx("option",{value:"today",children:"Hoy"}),a.jsx("option",{value:"week",children:"Semana"}),a.jsx("option",{value:"month",children:"Mes"}),a.jsx("option",{value:"2months",children:"2 Meses"})]})})]})}),a.jsxs("div",{className:"mb-4 flex-shrink-0 bg-white rounded-lg p-3 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("div",{className:"w-5 h-5 bg-emerald-100 rounded flex items-center justify-center",children:a.jsx(ds,{className:"w-3 h-3 text-emerald-600"})}),a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Rendimiento Financiero"}),a.jsx("div",{className:"flex-1 h-px bg-slate-300"})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Wt,{className:"w-3 h-3 text-emerald-600 group-hover:text-emerald-700"})}),a.jsxs("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:["Ventas ",v[l]]}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(m.totalSales)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ds,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsxs("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:["Ganancia ",v[l]]}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:V(m.totalProfit)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-purple-500/10 hover:-translate-y-0.5 hover:border-purple-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-purple-50 rounded flex items-center justify-center group-hover:bg-purple-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(qM,{className:"w-3 h-3 text-purple-600 group-hover:text-purple-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Margen"}),a.jsxs("p",{className:"text-base font-bold text-slate-900 group-hover:text-purple-900 transition-colors duration-300",children:[m.averageProfitMargin.toFixed(1),"%"]})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-amber-500/10 hover:-translate-y-0.5 hover:border-amber-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-amber-50 rounded flex items-center justify-center group-hover:bg-amber-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Xn,{className:"w-3 h-3 text-amber-600 group-hover:text-amber-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Plan Separe"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-amber-900 transition-colors duration-300",children:V(m.layawayRevenue)})]})})]})]}),a.jsxs("div",{className:"mb-4 flex-shrink-0 rounded-lg p-3 border border-gray-100",style:{backgroundColor:"#fafbfc"},children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("div",{className:"w-5 h-5 bg-blue-100 rounded flex items-center justify-center",children:a.jsx(_j,{className:"w-3 h-3 text-blue-600"})}),a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Estado Operativo"}),a.jsx("div",{className:"flex-1 h-px bg-slate-300"})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-cyan-500/10 hover:-translate-y-0.5 hover:border-cyan-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-cyan-50 rounded flex items-center justify-center group-hover:bg-cyan-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Jo,{className:"w-3 h-3 text-cyan-600 group-hover:text-cyan-700"})}),a.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse group-hover:scale-125 transition-transform duration-300 mx-auto mb-1"}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Hoy"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-cyan-900 transition-colors duration-300",children:V(y)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-violet-500/10 hover:-translate-y-0.5 hover:border-violet-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-violet-50 rounded flex items-center justify-center group-hover:bg-violet-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ea,{className:"w-3 h-3 text-violet-600 group-hover:text-violet-700"})}),a.jsx("span",{className:"text-xs px-1 py-0.5 rounded bg-slate-100 text-slate-600 group-hover:bg-violet-100 group-hover:text-violet-700 transition-all duration-300 mb-1 inline-block",children:"Items"}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Productos"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-violet-900 transition-colors duration-300",children:r.length})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(GW,{className:"w-3 h-3 text-emerald-600 group-hover:text-emerald-700"})}),a.jsx("span",{className:"text-xs px-1 py-0.5 rounded bg-emerald-100 text-emerald-600 group-hover:bg-emerald-200 group-hover:text-emerald-800 transition-all duration-300 mb-1 inline-block",children:"Activo"}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Inventario"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(m.inventoryValue)})]})}),a.jsx("div",{className:`group relative rounded-lg shadow-lg border p-2 hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 ease-out ${g>0?"bg-gradient-to-br from-red-50 to-orange-50 border-red-200 hover:shadow-red-500/20 hover:border-red-300":"bg-white border-gray-300 hover:shadow-xl hover:border-gray-400"}`,children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:`w-5 h-5 mx-auto mb-1 rounded flex items-center justify-center group-hover:scale-110 transition-all duration-300 ${g>0?"bg-red-50 group-hover:bg-red-100":"bg-slate-100 group-hover:bg-slate-200"}`,children:a.jsx(is,{className:`w-3 h-3 transition-colors duration-300 ${g>0?"text-red-600 group-hover:text-red-700":"text-slate-500 group-hover:text-slate-600"}`})}),g>0?a.jsx("span",{className:"text-xs px-1 py-0.5 rounded bg-red-100 text-red-600 animate-pulse group-hover:bg-red-200 group-hover:text-red-700 transition-all duration-300 mb-1 inline-block",children:"!"}):a.jsx("span",{className:"text-xs px-1 py-0.5 rounded bg-green-100 text-green-600 group-hover:bg-green-200 group-hover:text-green-700 transition-all duration-300 mb-1 inline-block",children:"OK"}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Poco Stock"}),a.jsx("p",{className:`text-base font-bold transition-colors duration-300 ${g>0?"text-red-600 group-hover:text-red-800":"text-slate-900 group-hover:text-slate-700"}`,children:g})]})})]})]}),a.jsxs("div",{className:"flex-1 min-h-0 bg-white rounded-lg p-3 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("div",{className:"w-5 h-5 bg-indigo-100 rounded flex items-center justify-center",children:a.jsx(_l,{className:"w-3 h-3 text-indigo-600"})}),a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Resumen Inventario"}),a.jsx("div",{className:"flex-1 h-px bg-slate-300"})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsx("div",{className:`group relative rounded-lg shadow-lg border p-2 hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 ease-out ${x>0?"bg-gradient-to-br from-red-50 to-pink-50 border-red-200 hover:shadow-red-500/20 hover:border-red-300":"bg-white border-gray-300 hover:shadow-xl hover:border-gray-400"}`,children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:`w-5 h-5 mx-auto mb-1 rounded flex items-center justify-center group-hover:scale-110 transition-all duration-300 ${x>0?"bg-red-50 group-hover:bg-red-100":"bg-slate-100 group-hover:bg-slate-200"}`,children:a.jsx(ea,{className:`w-3 h-3 transition-colors duration-300 ${x>0?"text-red-600 group-hover:text-red-700":"text-slate-500 group-hover:text-slate-600"}`})}),a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase mb-0.5 group-hover:text-slate-600 transition-colors duration-300",children:"Sin Stock"}),a.jsx("p",{className:`text-sm font-bold transition-colors duration-300 ${x>0?"text-red-600 group-hover:text-red-800":"text-slate-900 group-hover:text-slate-700"}`,children:x})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-amber-500/10 hover:-translate-y-0.5 hover:border-amber-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-amber-50 rounded flex items-center justify-center group-hover:bg-amber-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Xn,{className:"w-3 h-3 text-amber-600 group-hover:text-amber-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase mb-0.5 group-hover:text-slate-600 transition-colors duration-300",children:"Plan Separe"}),a.jsx("p",{className:"text-sm font-bold text-slate-900 group-hover:text-amber-900 transition-colors duration-300",children:b})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(E0,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase mb-0.5 group-hover:text-slate-600 transition-colors duration-300",children:"Clientes"}),a.jsx("p",{className:"text-sm font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:i.length})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-purple-500/10 hover:-translate-y-0.5 hover:border-purple-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-purple-50 rounded flex items-center justify-center group-hover:bg-purple-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(nS,{className:"w-3 h-3 text-purple-600 group-hover:text-purple-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase mb-0.5 group-hover:text-slate-600 transition-colors duration-300",children:"Categoras"}),a.jsx("p",{className:"text-sm font-bold text-slate-900 group-hover:text-purple-900 transition-colors duration-300",children:o.filter(j=>j.isActive).length})]})})]})]})]})}function oG({searchTerm:t="",categoryFilter:e="all",stockFilter:r="all",sortBy:n="name",sortOrder:s="asc",itemsPerPage:i=10}){const[o,l]=I.useState([]),[c,u]=I.useState(!1),[d,h]=I.useState(null),[f,m]=I.useState(1),[y,g]=I.useState(!1),[x,b]=I.useState(!1),v=I.useCallback(async(C=null)=>{let N=yt(Pe,"products"),w=[];e!=="all"&&w.push(or("categoryId","==",e)),r==="low"?(w.push(or("stock",">",0)),w.push(or("stock","<=",5))):r==="out"&&w.push(or("stock","==",0));let E=n;w.push(dr(E,s));const k=t?1e4:i+1;return w.push(oc(k)),C&&w.push(Um(C)),Bt(N,...w)},[t,e,r,n,s,i]),j=I.useCallback(async C=>{u(!0),h(null);try{let N=null,w=[],E=null;if(t){const T=await v(null);w=(await Kt(T)).docs}else for(let T=1;T<=C;T++){const P=await v(N),D=(await Kt(P)).docs;T===C&&(w=D),E=D[D.length-1],N=E}let k=w.map(T=>({id:T.id,...T.data()}));if(t){const T=t.toLowerCase();k=k.filter(P=>{var W,L,X,G,K;const O=(W=P.name)==null?void 0:W.toLowerCase().includes(T),D=(L=P.description)==null?void 0:L.toLowerCase().includes(T),R=(X=P.referencia)==null?void 0:X.toLowerCase().includes(T),B=(G=P.imei)==null?void 0:G.toLowerCase().includes(T),Y=(K=P.barcode)==null?void 0:K.toLowerCase().includes(T);return O||D||R||B||Y}),g(!1),b(!1)}else g(k.length>i),b(C>1);!t&&k.length>i&&(k=k.slice(0,i)),l(k)}catch(N){h(N.message||"Error al cargar productos")}finally{u(!1)}},[v,i,t]);return I.useEffect(()=>{m(1),j(1)},[t,e,r,n,s,i,j]),{products:o,loading:c,error:d,currentPage:f,hasNextPage:y,hasPrevPage:x,nextPage:()=>{y&&(m(C=>C+1),j(f+1))},prevPage:()=>{x&&f>1&&(m(C=>C-1),j(f-1))},setPage:C=>{m(C),j(C)},refetch:()=>j(f)}}function lG(){var oe,Ce,ke;Xt(ro);const t=Xt(rG),{showSuccess:e,showError:r,showConfirm:n}=hi();Hm();const s=wc(),[i,o]=I.useState(!1),[l,c]=I.useState(null),[u,d]=I.useState(""),[h,f]=I.useState("all"),[m,y]=I.useState("all"),[g,x]=I.useState(!1),[b,v]=I.useState(!1),[j,S]=I.useState(0),[_,C]=I.useState([]),[N,w]=I.useState(""),[E,k]=I.useState(""),[T,P]=I.useState(""),[O,D]=I.useState(""),R=I.useRef(null),B=I.useCallback(async()=>{try{const ue=await La.getAll();C(ue)}catch(ue){console.error("Error loading all products for stats:",ue)}},[]);I.useEffect(()=>{B()},[B]);const{products:Y,loading:W,error:L,currentPage:X,hasNextPage:G,hasPrevPage:K,nextPage:q,prevPage:ie,refetch:ge}=oG({searchTerm:u,categoryFilter:h,stockFilter:m,sortBy:"name",sortOrder:"asc",itemsPerPage:15});I.useEffect(()=>{l?(w(Yt(l.purchasePrice)),k(Yt(l.salePrice)),P(Yt(l.stock)),D(l.categoryId)):(w(""),k(""),P(""),D(""))},[l]);const be=Y,Ye=async ue=>{var se,We,Ae,it,ut,mt;ue.preventDefault(),x(!0);try{const pt=new FormData(ue.currentTarget),gt=jt(N),lr=jt(E),dn=jt(T),qr=pt.get("categoryId");if(lr<=gt){r("Error de validacin","El precio de venta debe ser mayor al precio de compra"),x(!1);return}const Tr=t.find(Ar=>Ar.id===qr),Wa=(Tr==null?void 0:Tr.name)||"Sin categora",_n={name:pt.get("name"),description:pt.get("description"),purchasePrice:gt,salePrice:lr,stock:dn,categoryId:qr,category:Wa,referencia:((se=pt.get("referencia"))==null?void 0:se.toString())||"",barcode:((We=pt.get("barcode"))==null?void 0:We.toString())||"",...he(qr)&&{imei:((Ae=pt.get("imei"))==null?void 0:Ae.toString())||""}};console.log("Datos del producto:",_n);const Sn=_n.barcode.trim();if(Sn){const Ar=(await gn(async()=>{const{getFirestore:Oe}=await Promise.resolve().then(()=>$p);return{getFirestore:Oe}},void 0)).getFirestore(),{query:hn,collection:Ir,where:Hr,getDocs:kr,limit:F}=await gn(async()=>{const{query:Oe,collection:H,where:Z,getDocs:ce,limit:fe}=await Promise.resolve().then(()=>$p);return{query:Oe,collection:H,where:Z,getDocs:ce,limit:fe}},void 0),ae=Ir(Ar,"products");let me;if(l?me=hn(ae,Hr("barcode","==",Sn),Hr("__name__","!=",l.id),F(1)):me=hn(ae,Hr("barcode","==",Sn),F(1)),!(await kr(me)).empty){r("Error de validacin","Ya existe otro producto con el mismo cdigo de barras."),x(!1);return}}if(he(qr)){const Ar=(it=_n.imei)==null?void 0:it.trim();if(Ar){const hn=(await gn(async()=>{const{getFirestore:H}=await Promise.resolve().then(()=>$p);return{getFirestore:H}},void 0)).getFirestore(),{query:Ir,collection:Hr,where:kr,getDocs:F,limit:ae}=await gn(async()=>{const{query:H,collection:Z,where:ce,getDocs:fe,limit:Ne}=await Promise.resolve().then(()=>$p);return{query:H,collection:Z,where:ce,getDocs:fe,limit:Ne}},void 0),me=Hr(hn,"products");let Se;if(l?Se=Ir(me,kr("imei","==",Ar),kr("__name__","!=",l.id),ae(1)):Se=Ir(me,kr("imei","==",Ar),ae(1)),!(await F(Se)).empty){r("Error de validacin","Ya existe otro producto con el mismo IMEI."),x(!1);return}}}if(l)console.log("Actualizando producto:",l.id),await La.update(l.id,_n),(ut=R.current)==null||ut.reset(),w(""),k(""),P(""),D(""),c(null),o(!1),e("Producto actualizado",`El producto "${_n.name}" se actualiz correctamente`),ge(),await B(),S(Ar=>Ar+1),console.log("Producto actualizado exitosamente");else{console.log("Creando nuevo producto");const Ar=await La.add(_n);console.log("Nuevo producto creado con ID:",Ar),(mt=R.current)==null||mt.reset(),w(""),k(""),P(""),D(""),o(!1),e("Producto creado",`El producto "${_n.name}" se cre correctamente`),ge(),await B(),S(hn=>hn+1)}}catch(pt){console.error("Error saving product:",pt);let gt="Error desconocido al guardar el producto";pt instanceof Error&&(pt.message.includes("permission-denied")?gt="No tienes permisos para guardar productos. Verifica que ests logueado como administrador.":pt.message.includes("network")?gt="Error de conexin. Verifica tu conexin a internet.":pt.message.includes("quota-exceeded")?gt="Se ha excedido la cuota de Firebase. Intenta ms tarde.":gt=pt.message),r("Error al guardar producto",gt)}finally{x(!1)}},ze=async ue=>{n("Confirmar eliminacin",`Ests seguro de que quieres eliminar el producto "${ue.name}"? Esta accin no se puede deshacer.`,async()=>{v(!0);try{await La.delete(ue.id),await s.forceLoadProducts(),await B(),S(se=>se+1),e("Producto eliminado",`El producto "${ue.name}" se elimin correctamente`),ge()}catch(se){console.error("Error deleting product:",se),r("Error al eliminar","No se pudo eliminar el producto. Intntalo de nuevo.")}finally{v(!1)}})},U=(ue,se)=>{if(typeof ue!="number"||typeof se!="number"||isNaN(ue)||isNaN(se)||se<=0)return"0";const We=(se-ue)/se*100;return isNaN(We)||!isFinite(We)?"0":We.toFixed(1)},Q=ue=>{if(ue.categoryId){const se=t.find(We=>We.id===ue.categoryId);return(se==null?void 0:se.name)||ue.category||"Sin categora"}return ue.category||"Sin categora"},re=ue=>{if(ue.categoryId){const se=t.find(We=>We.id===ue.categoryId);return(se==null?void 0:se.color)||"#6B7280"}return"#6B7280"},te=ue=>{switch(ue){case"low":return"Pocas Unidades (5)";case"out":return"Sin Stock (0)";case"all":return"Todos los niveles";default:return"Todos los niveles"}},pe=ue=>{c(ue),o(!0)},xe=()=>{var ue;c(null),o(!1),w(""),k(""),P(""),D(""),(ue=R.current)==null||ue.reset()},he=ue=>{const se=t.find(We=>We.id===ue);return se==null?void 0:se.name.toLowerCase().includes("celulares")},Le=I.useMemo(()=>_.length,[_,j]),qe=I.useMemo(()=>_.filter(ue=>ue.stock===0).length,[_,j]),De=I.useMemo(()=>_.filter(ue=>ue.stock>0&&ue.stock<=5).length,[_,j]),ne=I.useMemo(()=>_.reduce((ue,se)=>ue+(typeof se.purchasePrice=="number"&&typeof se.stock=="number"?se.purchasePrice*se.stock:0),0),[_,j]);return I.useMemo(()=>_.reduce((ue,se)=>ue+(typeof se.salePrice=="number"&&typeof se.stock=="number"?se.salePrice*se.stock:0),0),[_,j]),a.jsxs("div",{className:"space-y-4 sm:space-y-6 max-w-full overflow-x-hidden relative",children:[b&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 flex flex-col items-center space-y-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"}),a.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Eliminando producto..."}),a.jsx("p",{className:"text-sm text-gray-500",children:"Por favor espera mientras se procesa la eliminacin"})]})}),a.jsx("div",{className:"mb-4 pt-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestin de Inventario"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Administra los productos, precios y niveles de stock de tu tienda"})]}),a.jsx("div",{className:"flex gap-2",children:a.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[a.jsx(wn,{className:"h-5 w-5"}),a.jsx("span",{children:"Agregar Producto"})]})})]})}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ea,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Total Productos"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:Le})]})}),a.jsx("div",{className:`group relative rounded-lg shadow-lg border p-2 hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 ease-out ${qe>0?"bg-gradient-to-br from-red-50 to-pink-50 border-red-200 hover:shadow-red-500/20 hover:border-red-300":"bg-white border-gray-300 hover:shadow-xl hover:border-gray-400"}`,children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:`w-5 h-5 mx-auto mb-1 rounded flex items-center justify-center group-hover:scale-110 transition-all duration-300 ${qe>0?"bg-red-50 group-hover:bg-red-100":"bg-slate-100 group-hover:bg-slate-200"}`,children:a.jsx(is,{className:`w-3 h-3 transition-colors duration-300 ${qe>0?"text-red-600 group-hover:text-red-700":"text-slate-500 group-hover:text-slate-600"}`})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Sin Stock"}),a.jsx("p",{className:`text-base font-bold transition-colors duration-300 ${qe>0?"text-red-600 group-hover:text-red-800":"text-slate-900 group-hover:text-slate-700"}`,children:qe})]})}),a.jsx("div",{className:`group relative rounded-lg shadow-lg border p-2 hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 ease-out ${De>0?"bg-gradient-to-br from-orange-50 to-yellow-50 border-orange-200 hover:shadow-orange-500/20 hover:border-orange-300":"bg-white border-gray-300 hover:shadow-xl hover:border-gray-400"}`,children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:`w-5 h-5 mx-auto mb-1 rounded flex items-center justify-center group-hover:scale-110 transition-all duration-300 ${De>0?"bg-orange-50 group-hover:bg-orange-100":"bg-slate-100 group-hover:bg-slate-200"}`,children:a.jsx(is,{className:`w-3 h-3 transition-colors duration-300 ${De>0?"text-orange-600 group-hover:text-orange-700":"text-slate-500 group-hover:text-slate-600"}`})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Bajo Stock"}),a.jsx("p",{className:`text-base font-bold transition-colors duration-300 ${De>0?"text-orange-600 group-hover:text-orange-800":"text-slate-900 group-hover:text-slate-700"}`,children:De})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ds,{className:"w-3 h-3 text-emerald-600 group-hover:text-emerald-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Valor Inventario"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(ne)})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-3 sm:p-6 shadow-sm border border-gray-100",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-4 max-w-full",children:[a.jsxs("div",{className:"flex-1 relative min-w-0",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar por nombre, descripcin, referencia, cdigo de barras o IMEI...",value:u,onChange:ue=>d(ue.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 md:gap-4 w-full md:w-auto",children:[a.jsxs("select",{value:h,onChange:ue=>f(ue.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full md:w-auto",children:[a.jsx("option",{value:"all",children:"Todas las Categoras"}),t.map(ue=>a.jsx("option",{value:ue.id,children:ue.name},ue.id))]}),a.jsxs("div",{className:"relative w-full md:w-auto",children:[a.jsx(S0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsxs("select",{value:m,onChange:ue=>y(ue.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none w-full md:w-auto",children:[a.jsx("option",{value:"all",children:"Todos los niveles"}),a.jsx("option",{value:"low",children:"Pocas Unidades (5)"}),a.jsx("option",{value:"out",children:"Sin Stock (0)"})]})]})]})]}),(u||h!=="all"||m!=="all")&&a.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[a.jsx("span",{className:"text-blue-800 font-medium",children:"Filtros activos:"}),u&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:['Bsqueda: "',u,'"']}),h!=="all"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["Categora: ",(oe=t.find(ue=>ue.id===h))==null?void 0:oe.name]}),m!=="all"&&a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${m==="low"?"bg-orange-100 text-orange-800":m==="out"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:te(m)}),a.jsx("span",{className:"text-blue-600 font-medium",children:W?"Cargando...":`(${be.length} productos encontrados)`})]})})]}),(i||l)&&a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l?"Editar Producto":"Agregar Nuevo Producto"}),a.jsx("button",{onClick:xe,className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{ref:R,onSubmit:Ye,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),a.jsx("input",{type:"text",name:"name",defaultValue:(l==null?void 0:l.name)||"",required:!0,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Referencia (Opcional)"}),a.jsx("input",{type:"text",name:"referencia",defaultValue:(l==null?void 0:l.referencia)||"",disabled:g,placeholder:"Ej: REF001, SKU123, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categora"}),a.jsx("select",{name:"categoryId",value:O||(l==null?void 0:l.categoryId)||((Ce=t[0])==null?void 0:Ce.id)||"",onChange:ue=>D(ue.target.value),required:!0,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",children:t.map(ue=>a.jsx("option",{value:ue.id,children:ue.name},ue.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio de Compra (COP)"}),a.jsx("input",{type:"text",value:N,onChange:ue=>w(Yt(ue.target.value)),required:!0,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio de Venta (COP)"}),a.jsx("input",{type:"text",value:E,onChange:ue=>k(Yt(ue.target.value)),required:!0,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad en Stock"}),a.jsx("input",{type:"text",value:T,onChange:ue=>P(Yt(ue.target.value)),required:!0,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cdigo de Barras (Opcional)"}),a.jsx("input",{type:"text",name:"barcode",defaultValue:(l==null?void 0:l.barcode)||"",disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),he(O||(l==null?void 0:l.categoryId)||((ke=t[0])==null?void 0:ke.id)||"")&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IMEI"}),a.jsx("input",{type:"text",name:"imei",defaultValue:(l==null?void 0:l.imei)||"",disabled:g,placeholder:"Ej: 123456789012345",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nmero IMEI del dispositivo celular"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("textarea",{name:"description",rows:3,defaultValue:(l==null?void 0:l.description)||"",required:!0,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:xe,disabled:g,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[g&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:g?"Guardando...":l?"Actualizar Producto":"Agregar Producto"})]})]})]})]}),a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[W&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"text-gray-500 mt-2",children:"Cargando productos..."})]}),!W&&be.map(ue=>{const se=U(ue.purchasePrice,ue.salePrice);return a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 flex flex-col gap-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-bold text-gray-900 text-base",children:ue.name}),a.jsx("span",{className:"px-2 py-1 rounded-full text-xs text-white font-medium",style:{backgroundColor:re(ue)},children:Q(ue)})]}),ue.referencia&&a.jsxs("div",{className:"text-xs text-blue-600 font-medium",children:["Ref: ",ue.referencia]}),a.jsx("div",{className:"text-xs text-gray-500 mb-1",children:ue.description}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[a.jsxs("span",{className:"bg-gray-100 px-2 py-1 rounded",children:["Compra: ",V(ue.purchasePrice)]}),a.jsxs("span",{className:"bg-gray-100 px-2 py-1 rounded",children:["Venta: ",V(ue.salePrice)]}),a.jsxs("span",{className:`px-2 py-1 rounded ${parseFloat(se)>=30?"bg-green-100 text-green-800":parseFloat(se)>=15?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:["Margen: ",se,"%"]}),a.jsx("span",{className:`px-2 py-1 rounded ${ue.stock===0?"bg-red-100 text-red-800":ue.stock<=5?"bg-orange-100 text-orange-800":ue.stock<=10?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:ue.stock===0?"Sin stock":`${sr(ue.stock)} unidades`})]}),a.jsxs("div",{className:"flex gap-2 mt-2",children:[a.jsx("button",{onClick:()=>pe(ue),className:"flex-1 text-blue-600 hover:text-blue-900 p-2 rounded hover:bg-blue-50 transition-colors text-xs font-medium",children:"Editar"}),a.jsx("button",{onClick:()=>ze(ue),className:"flex-1 text-red-600 hover:text-red-900 p-2 rounded hover:bg-red-50 transition-colors text-xs font-medium",children:"Eliminar"})]})]},ue.id)})]}),a.jsxs("div",{className:"bg-white rounded-xl p-3 sm:p-6 shadow-sm border border-gray-100 overflow-x-auto hidden sm:block",children:[W&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"text-gray-500 mt-2",children:"Cargando productos..."})]}),!W&&a.jsx("div",{className:"w-full",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200 text-xs sm:text-sm table-auto",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-1 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-tight",children:"Producto"}),a.jsx("th",{className:"px-1 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-tight hidden lg:table-cell",children:"Ref"}),a.jsx("th",{className:"px-1 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-tight hidden lg:table-cell",children:"IMEI"}),a.jsx("th",{className:"px-1 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-tight hidden md:table-cell",children:"Categora"}),a.jsx("th",{className:"px-1 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-tight",children:"P. Compra"}),a.jsx("th",{className:"px-1 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-tight",children:"P. Venta"}),a.jsx("th",{className:"px-1 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-tight hidden xl:table-cell",children:"Margen"}),a.jsx("th",{className:"px-1 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-tight",children:"Stock"}),a.jsx("th",{className:"px-1 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-tight",children:"Acciones"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:be.map(ue=>{const se=U(ue.purchasePrice,ue.salePrice);return typeof ue.salePrice=="number"&&typeof ue.purchasePrice=="number"&&ue.salePrice-ue.purchasePrice,a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-1 sm:px-3 py-2",children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate max-w-32",children:ue.name}),ue.stock<=5&&ue.stock>0&&a.jsx(is,{className:"ml-1 h-3 w-3 text-orange-500","aria-label":"Pocas unidades"}),ue.stock===0&&a.jsx(is,{className:"ml-1 h-3 w-3 text-red-500","aria-label":"Sin stock"})]}),a.jsx("div",{className:"text-xs text-gray-500 truncate max-w-32 hidden sm:block",children:ue.description})]})}),a.jsx("td",{className:"px-1 sm:px-3 py-2 text-xs text-gray-500 hidden lg:table-cell",children:ue.referencia||"-"}),a.jsx("td",{className:"px-1 sm:px-3 py-2 text-xs text-gray-500 hidden lg:table-cell",children:ue.imei||"-"}),a.jsx("td",{className:"px-1 sm:px-3 py-2 hidden md:table-cell",children:a.jsx("span",{className:"px-1 py-1 rounded text-xs text-white font-medium truncate max-w-16 inline-block",style:{backgroundColor:re(ue)},children:Q(ue)})}),a.jsx("td",{className:"px-1 sm:px-3 py-2 text-xs text-gray-900",children:V(typeof ue.purchasePrice=="number"?ue.purchasePrice:0)}),a.jsx("td",{className:"px-1 sm:px-3 py-2 text-xs text-gray-900",children:V(typeof ue.salePrice=="number"?ue.salePrice:0)}),a.jsx("td",{className:"px-1 sm:px-3 py-2 hidden xl:table-cell",children:a.jsxs("span",{className:`inline-flex px-1 py-1 text-xs font-semibold rounded ${parseFloat(se)>=30?"bg-green-100 text-green-800":parseFloat(se)>=15?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[se,"%"]})}),a.jsx("td",{className:"px-1 sm:px-3 py-2",children:a.jsx("span",{className:`inline-flex px-1 py-1 text-xs font-semibold rounded ${ue.stock===0?"bg-red-100 text-red-800":ue.stock<=5?"bg-orange-100 text-orange-800":ue.stock<=10?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:ue.stock===0?"0":sr(ue.stock)})}),a.jsx("td",{className:"px-1 sm:px-3 py-2",children:a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("button",{onClick:()=>pe(ue),className:"text-blue-600 hover:text-blue-900 p-0.5 rounded hover:bg-blue-50 transition-colors",title:"Editar",children:a.jsx(Hu,{className:"h-3 w-3"})}),a.jsx("button",{onClick:()=>ze(ue),className:"text-red-600 hover:text-red-900 p-0.5 rounded hover:bg-red-50 transition-colors",title:"Eliminar",children:a.jsx(rs,{className:"h-3 w-3"})})]})})]},ue.id)})})]})})]}),(be.length>0||X>1)&&a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("span",{children:["Pgina ",a.jsx("span",{className:"font-medium",children:X})]}),W&&a.jsx("span",{className:"ml-2 text-blue-600",children:"Cargando..."}),L&&a.jsxs("span",{className:"ml-2 text-red-600",children:["Error: ",L]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("button",{onClick:ie,disabled:!K||W,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[a.jsx(kW,{className:"h-4 w-4 mr-1"}),"Anterior"]}),a.jsxs("button",{onClick:q,disabled:!G||W,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["Siguiente",a.jsx(Sj,{className:"h-4 w-4 ml-1"})]})]})]})}),be.length===0&&!W&&a.jsxs("div",{className:"bg-white rounded-xl p-6 sm:p-12 text-center shadow-sm border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(ea,{className:"h-10 w-10 sm:h-12 sm:w-12 mx-auto"})}),a.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"No se encontraron productos"}),a.jsx("p",{className:"text-gray-500 text-xs sm:text-base",children:u||h!=="all"||m!=="all"?"Intenta ajustar tus criterios de bsqueda o filtro.":"Comienza agregando tu primer producto al inventario."}),m==="low"&&a.jsx("p",{className:"text-orange-600 mt-2 text-xs sm:text-sm",children:"Excelente! No tienes productos con pocas unidades."}),m==="out"&&a.jsx("p",{className:"text-green-600 mt-2 text-xs sm:text-sm",children:"Perfecto! No tienes productos sin stock."})]})]})}const dh=["#EC4899","#3B82F6","#F59E0B","#8B5CF6","#10B981","#EF4444","#06B6D4","#84CC16","#F97316","#6366F1","#14B8A6","#F43F5E","#8B5CF6","#22C55E","#E11D48"],cG=["Tag","Package","Shirt","User","Gem","Diamond","Footprints","Crown","Watch","Glasses","Heart","Star","Circle","Square"];function uG(){var N,w,E,k;const t=Xt(aS),{showSuccess:e,showError:r,showWarning:n,showConfirm:s}=hi(),i=I.useRef(null),[o,l]=I.useState(!1),[c,u]=I.useState(null),[d,h]=I.useState(""),[f,m]=I.useState(dh[0]),[y,g]=I.useState("Tag"),[x,b]=I.useState(!1),v=t.filter(T=>d===""||T.name.toLowerCase().includes(d.toLowerCase())||T.description&&T.description.toLowerCase().includes(d.toLowerCase())),j=async T=>{var P,O;T.preventDefault(),b(!0);try{const D=new FormData(T.currentTarget),R={name:D.get("name"),description:D.get("description")||"",color:f,icon:y};if(!R.name.trim()){b(!1),r("Error de validacin","El nombre de la categora es requerido");return}if(c&&c.name.toLowerCase()==="celulares"&&R.name.toLowerCase()!=="celulares"){b(!1),r("Error de validacin",'No se puede modificar el nombre de la categora "Celulares"');return}if(!R.color){b(!1),r("Error de validacin","Debes seleccionar un color para la categora");return}if(console.log("Enviando datos de categora:",R),c)console.log("Actualizando categora:",c.id),await Ul.update(c.id,R),(P=i.current)==null||P.reset(),m(dh[0]),g("Tag"),u(null),l(!1),e("Categora actualizada",`La categora "${R.name}" se actualiz correctamente`),console.log("Categora actualizada exitosamente");else{console.log("Creando nueva categora");const B=await Ul.add(R);console.log("Nueva categora creada con ID:",B),(O=i.current)==null||O.reset(),m(dh[0]),g("Tag"),l(!1),e("Categora creada",`La categora "${R.name}" se cre correctamente`)}}catch(D){console.error("Error detallado al guardar categora:",D);let R="Error desconocido al guardar la categora";D instanceof Error&&(D.message.includes("permission-denied")?R="No tienes permisos para crear categoras. Verifica que ests logueado como administrador.":D.message.includes("network")?R="Error de conexin. Verifica tu conexin a internet.":D.message.includes("quota-exceeded")?R="Se ha excedido la cuota de Firebase. Intenta ms tarde.":R=D.message),r("Error al guardar categora",R)}finally{b(!1)}},S=async T=>{if(T.name.toLowerCase()==="celulares"){n("Categora protegida",'La categora "Celulares" no se puede eliminar ya que es una categora esencial del sistema.');return}if(T.productCount>0){n("No se puede eliminar",`No se puede eliminar esta categora porque tiene ${T.productCount} producto(s) asociado(s). Primero reasigna o elimina los productos.`);return}s("Confirmar eliminacin",`Ests seguro de que quieres eliminar la categora "${T.name}"? Esta accin no se puede deshacer.`,async()=>{try{await Ul.delete(T.id),e("Categora eliminada",`La categora "${T.name}" se elimin correctamente`)}catch(P){console.error("Error deleting category:",P),r("Error al eliminar","No se pudo eliminar la categora. Intntalo de nuevo.")}})},_=T=>{u(T),m(T.color),g(T.icon||"Tag"),l(!0)},C=()=>{u(null),l(!1),m(dh[0]),g("Tag")};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"mb-4 pt-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestin de Categoras"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Organiza y administra las categoras de productos de tu tienda"})]}),a.jsx("div",{className:"flex gap-2",children:a.jsxs("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[a.jsx(wn,{className:"h-5 w-5"}),a.jsx("span",{children:"Nueva Categora"})]})})]})}),a.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:a.jsx("div",{className:"flex flex-col lg:flex-row gap-4",children:a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar categoras...",value:d,onChange:T=>h(T.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})}),o&&a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c?"Editar Categora":"Nueva Categora"}),a.jsx("button",{onClick:C,className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsxs("form",{ref:i,onSubmit:j,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nombre de la Categora *",((N=c==null?void 0:c.name)==null?void 0:N.toLowerCase())==="celulares"&&a.jsx("span",{className:"text-xs text-amber-600 ml-2",children:"(Protegido - No modificable)"})]}),a.jsx("input",{type:"text",name:"name",defaultValue:(c==null?void 0:c.name)||"",required:!0,disabled:x||((w=c==null?void 0:c.name)==null?void 0:w.toLowerCase())==="celulares",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"Ej: Celulares",title:((E=c==null?void 0:c.name)==null?void 0:E.toLowerCase())==="celulares"?'El nombre de la categora "Celulares" no se puede modificar':""}),((k=c==null?void 0:c.name)==null?void 0:k.toLowerCase())==="celulares"&&a.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"Esta es una categora esencial del sistema y su nombre no puede ser modificado."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("input",{type:"text",name:"description",defaultValue:(c==null?void 0:c.description)||"",disabled:x,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"Descripcin opcional"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(LW,{className:"inline h-4 w-4 mr-1"}),"Color de Identificacin"]}),a.jsx("div",{className:"grid grid-cols-5 gap-2",children:dh.map(T=>a.jsx("button",{type:"button",disabled:x,onClick:()=>m(T),className:`w-10 h-10 rounded-lg border-2 transition-all disabled:opacity-50 ${f===T?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:T}},T))}),a.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[a.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:f}}),a.jsx("span",{className:"text-sm text-gray-600",children:f})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(MW,{className:"inline h-4 w-4 mr-1"}),"Icono (Opcional)"]}),a.jsx("select",{value:y,onChange:T=>g(T.target.value),disabled:x,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",children:cG.map(T=>a.jsx("option",{value:T,children:T},T))}),a.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Vista previa del icono seleccionado"})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:C,disabled:x,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:x,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[x&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:x?"Guardando...":c?"Actualizar Categora":"Crear Categora"})]})]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(T=>a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border transition-all hover:shadow-md border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:T.color},children:T.name.charAt(0).toUpperCase()}),a.jsx("div",{className:"ml-3",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:T.name})})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("button",{onClick:()=>_(T),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50 transition-colors",title:"Editar categora",children:a.jsx(Hu,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>S(T),className:`p-1 rounded transition-colors ${T.name.toLowerCase()==="celulares"||T.productCount>0?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-900 hover:bg-red-50"}`,title:T.name.toLowerCase()==="celulares"?"Categora protegida - No se puede eliminar":T.productCount>0?`No se puede eliminar - Tiene ${T.productCount} producto(s)`:"Eliminar categora",disabled:T.name.toLowerCase()==="celulares"||T.productCount>0,children:a.jsx(rs,{className:"h-4 w-4"})})]})]}),T.description&&a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:T.description}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ea,{className:"h-4 w-4 text-gray-500 mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Productos"})]}),a.jsx("span",{className:`text-sm font-bold ${T.productCount>0?"text-blue-600":"text-gray-400"}`,children:T.productCount})]}),T.productCount===0&&a.jsxs("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center",children:[a.jsx(is,{className:"h-4 w-4 text-yellow-600 mr-2"}),a.jsx("span",{className:"text-xs text-yellow-700",children:"Sin productos asignados"})]})]},T.id))}),v.length===0&&a.jsxs("div",{className:"bg-white rounded-xl p-12 text-center shadow-sm border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(nS,{className:"h-12 w-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron categoras"}),a.jsx("p",{className:"text-gray-500",children:d?"Intenta ajustar tus criterios de bsqueda.":"Comienza creando tu primera categora de productos."})]})]})}function dG(t){const{loadProducts:e,loadSales:r,loadLayaways:n,loadCustomers:s,loadCategories:i,invalidateCache:o}=wc();return I.useEffect(()=>{(async()=>{switch(console.log(` Navegando a: ${t} - Cargando datos frescos`),t){case"dashboard":o("products"),o("sales"),o("layaways"),o("customers"),o("categories"),await Promise.all([e(),r(),n(),s(),i()]);break;case"inventory":o("products"),o("categories"),await e(),await i();break;case"categories":o("categories"),await i();break;case"sales":o("products"),o("customers"),await e(),await s();break;case"sales-history":o("sales"),await r();break;case"my-daily-sales":o("sales"),await r();break;case"purchases":case"purchases-history":console.log(" Vista de compras - datos cargados bajo demanda");break;case"customers":o("customers"),await s();break;case"courtesies":console.log(" Vista de cortesas - datos cargados bajo demanda");break;case"layaway":o("layaways"),o("products"),o("customers"),await n(),await e(),await s();break;case"reports":console.log(" Vista de reportes - datos cargados bajo demanda");break;case"technical-service":case"technical-service-center":o("customers"),await s();break;case"technician-liquidation":console.log(" Vista de liquidacin de tcnicos - datos cargados bajo demanda");break;default:console.log(`Vista no reconocida: ${t}`)}})()},[t,e,r,n,s,i,o]),{}}function Tj(t){const e=wc();I.useEffect(()=>{let r;switch(t){case"products":r=e.subscribeToProducts();break;case"categories":r=e.subscribeToCategories();break;case"sales":r=e.subscribeToSales();break;case"customers":r=e.subscribeToCustomers();break;case"layaways":r=e.subscribeToLayaways();break;case"technicalServices":r=e.subscribeToTechnicalServices();break}return()=>{r&&r()}},[t,e])}function hG(){Tj("products"),Tj("purchases");const t=Xt(ro),{showError:e,showWarning:r}=hi(),[n,s]=I.useState([]),[i,o]=I.useState(""),[l,c]=I.useState("1"),[u,d]=I.useState(0),[h,f]=I.useState(""),[m,y]=I.useState(0),[g,x]=I.useState(""),[b,v]=I.useState(""),[j,S]=I.useState("dropdown"),[_,C]=I.useState(!1),[N,w]=I.useState(""),[E,k]=I.useState(!1),[T,P]=I.useState(""),[O,D]=I.useState(null),R=I.useRef(null),B=I.useRef(null),Y=(Q,re,te)=>{D({show:!0,type:Q,title:re,message:te}),setTimeout(()=>{D(null)},4e3)};I.useEffect(()=>{j==="barcode"&&R.current&&R.current.focus()},[j]),I.useEffect(()=>{if(i){const Q=t.find(re=>re.id===i);Q&&(d(Q.purchasePrice),f(V(Q.purchasePrice)),y(Q.salePrice),x(V(Q.salePrice)))}},[i,t]),I.useEffect(()=>{d(jt(h))},[h]),I.useEffect(()=>{y(jt(g))},[g]);const W=Q=>{const re=t.find(te=>te.barcode===Q);re?(o(re.id),v(""),d(re.purchasePrice),f(V(re.purchasePrice)),y(re.salePrice),x(V(re.salePrice)),X(re.id,1,re.purchasePrice,re.salePrice)):(v(""),e("Producto no encontrado","No se encontr un producto con ese cdigo de barras"))},L=Q=>{Q.key==="Enter"&&b.trim()&&W(b.trim())},X=(Q,re,te,pe)=>{const xe=t.find(qe=>qe.id===Q);if(!xe||re<=0||te<=0){xe?re<=0?e("Error","La cantidad debe ser mayor a cero"):te<=0&&e("Error","El precio de compra debe ser mayor a cero"):e("Error","Producto no encontrado");return}const he=pe||xe.salePrice,Le=n.find(qe=>qe.productId===xe.id);if(Le){const qe=Le.quantity*Le.purchasePrice,De=re*te,ne=Le.quantity+re,oe=(qe+De)/ne;s(Ce=>Ce.map(ke=>ke.productId===xe.id?{...ke,quantity:ne,purchasePrice:Math.round(oe),totalCost:ne*Math.round(oe),newSalePrice:he}:ke))}else{const qe={productId:xe.id,productName:xe.name,quantity:re,purchasePrice:te,totalCost:re*te,newSalePrice:he};s(De=>[...De,qe])}},G=()=>{if(!i){r("Selecciona un producto","Debes seleccionar un producto antes de agregarlo a la compra");return}const Q=jt(h),re=jt(g);if(Q<=0){r("Precio invlido","El precio de compra debe ser mayor a cero");return}if(re<=0){r("Precio de venta invlido","El precio de venta debe ser mayor a cero");return}X(i,parseInt(l)||1,Q,re),o(""),c("1"),d(0),f(""),y(0),x(""),w("")},K=Q=>{s(re=>re.filter(te=>te.productId!==Q))},q=(Q,re)=>{re<=0||s(te=>te.map(pe=>pe.productId===Q?{...pe,quantity:re,totalCost:re*pe.purchasePrice}:pe))},ie=(Q,re)=>{re<=0||s(te=>te.map(pe=>pe.productId===Q?{...pe,purchasePrice:re,totalCost:pe.quantity*re}:pe))},ge=(Q,re)=>{re<=0||s(te=>te.map(pe=>pe.productId===Q?{...pe,newSalePrice:re}:pe))},be=()=>{const Q=n.reduce((te,pe)=>te+pe.totalCost,0),re=n.reduce((te,pe)=>te+pe.quantity,0);return{totalCost:Q,totalItems:re}},Ye=async()=>{if(n.length===0){r("Compra vaca","Debes agregar al menos un producto a la compra");return}const{totalCost:Q,totalItems:re}=be();if(Q<=0){e("Total invlido","El total de la compra debe ser mayor a cero");return}C(!0);try{const pe={items:await Promise.all(n.map(async he=>{const Le=t.find(qe=>qe.id===he.productId);if(!Le)throw new Error(`Producto no encontrado: ${he.productId}`);return{productId:he.productId,productName:he.productName,quantity:he.quantity,purchasePrice:he.purchasePrice,totalCost:he.totalCost,previousStock:Le.stock,previousPurchasePrice:Le.purchasePrice,newSalePrice:he.newSalePrice,previousSalePrice:Le.salePrice}})),totalCost:Q,totalItems:re},xe=T.trim();xe&&(pe.notes=xe),await VM.add(pe),s([]),P(""),o(""),c("1"),d(0),f(""),y(0),x(""),v(""),Y("success","Compra registrada",`Compra por ${V(Q)} procesada exitosamente. ${sr(re)} producto(s) agregado(s) al inventario.`)}catch(te){let pe="Error desconocido al procesar la compra";te instanceof Error&&(te.message.includes("permission-denied")?pe="No tienes permisos para registrar compras. Verifica que ests logueado como administrador.":te.message.includes("network")?pe="Error de conexin. Verifica tu conexin a internet.":te.message.includes("quota-exceeded")?pe="Se ha excedido la cuota de Firebase. Intenta ms tarde.":pe=te.message),Y("error","Error al procesar compra",pe)}finally{C(!1)}},{totalCost:ze,totalItems:U}=be();return a.jsxs("div",{className:"min-h-screen bg-gray-50 p-4",children:[a.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Compras"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Registra nuevas compras de productos y actualiza el inventario"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[a.jsx(ea,{className:"h-5 w-5 mr-2"}),"Registro de Compras"]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 max-w-md",children:[a.jsx("button",{onClick:()=>S("dropdown"),disabled:_,className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors disabled:opacity-50 ${j==="dropdown"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Lista de Productos"}),a.jsxs("button",{onClick:()=>S("barcode"),disabled:_,className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors flex items-center justify-center disabled:opacity-50 ${j==="barcode"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(qu,{className:"h-4 w-4 mr-1"}),"Cdigo de Barras"]})]}),j==="dropdown"?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"relative w-full max-w-2xl",children:a.jsx("div",{className:"flex gap-3",children:a.jsxs("div",{className:"flex-1 relative",children:[a.jsx("input",{ref:B,type:"text",placeholder:"Buscar por nombre o referencia...",value:N,onChange:Q=>{w(Q.target.value),k(!0)},onFocus:()=>k(!0),onBlur:()=>setTimeout(()=>k(!1),150),disabled:_,className:"px-4 py-3 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full disabled:opacity-50"}),E&&N&&a.jsx("div",{className:"absolute z-20 left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto mt-1",children:t.filter(Q=>Q.name.toLowerCase().includes(N.toLowerCase())||Q.referencia&&Q.referencia.toLowerCase().includes(N.toLowerCase())).length===0?a.jsx("div",{className:"p-4 text-gray-500 text-sm",children:"No hay productos"}):t.filter(Q=>Q.name.toLowerCase().includes(N.toLowerCase())||Q.referencia&&Q.referencia.toLowerCase().includes(N.toLowerCase())).map(Q=>a.jsx("button",{type:"button",onMouseDown:()=>{o(Q.id),w(Q.name),d(Q.purchasePrice),f(V(Q.purchasePrice)),y(Q.salePrice),x(V(Q.salePrice)),k(!1),setTimeout(()=>{var re;return(re=B.current)==null?void 0:re.blur()},0)},className:`w-full text-left px-4 py-3 hover:bg-blue-50 ${i===Q.id?"bg-blue-100":""}`,children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-base",children:Q.name}),a.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[Q.referencia&&a.jsxs("span",{className:"mr-3",children:["Ref: ",Q.referencia]}),"Stock: ",sr(Q.stock)," | Compra: ",V(Q.purchasePrice)," | Venta: ",V(Q.salePrice)]}),a.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Margen: ",Q.salePrice>0?Math.round((Q.salePrice-Q.purchasePrice)/Q.salePrice*100):0,"%"]})]})},Q.id))})]})})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cantidad"}),a.jsx("input",{type:"text",value:l,onChange:Q=>{const re=Q.target.value;(re===""||/^\d+$/.test(re))&&c(re)},onFocus:Q=>{Q.target.value==="1"&&c("")},onBlur:Q=>{const re=Q.target.value;(re===""||parseInt(re)<=0)&&c("1")},disabled:_,className:"w-full px-4 py-3 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Precio de Compra (c/u)"}),a.jsxs("div",{className:"relative",children:[a.jsx(Wt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",value:h,onChange:Q=>f(Yt(Q.target.value)),disabled:_,className:"w-full pl-10 pr-4 py-3 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"0"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nuevo Precio de Venta"}),a.jsxs("div",{className:"relative",children:[a.jsx(Wt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",value:g,onChange:Q=>x(Yt(Q.target.value)),disabled:_,className:"w-full pl-10 pr-4 py-3 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"0"})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("button",{onClick:G,disabled:!i||parseInt(l)<=0||u<=0||m<=0||_,className:"w-full bg-blue-600 text-white px-6 py-3 text-base rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[a.jsx(wn,{className:"h-5 w-5 mr-2"}),"Agregar"]})})]})]}):a.jsxs("div",{className:"space-y-3 max-w-2xl",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(qu,{className:"h-6 w-6 text-gray-400"}),a.jsx("input",{ref:R,type:"text",placeholder:"Escanea o ingresa cdigo de barras...",value:b,onChange:Q=>v(Q.target.value),onKeyPress:L,disabled:_,className:"flex-1 px-4 py-3 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),a.jsx("button",{onClick:()=>W(b.trim()),disabled:!b.trim()||_,className:"bg-green-600 text-white px-6 py-3 text-base rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar"})]}),a.jsx("p",{className:"text-sm text-gray-500 ml-9",children:"Presiona Enter o haz clic en Agregar despus de escanear/ingresar el cdigo de barras"})]}),a.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 bg-gray-50",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Productos en la compra"}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:n.length===0?a.jsx("p",{className:"text-gray-500 text-center py-8",children:"No hay artculos agregados a la compra"}):a.jsx("div",{className:"space-y-3",children:n.map(Q=>a.jsxs("div",{className:"flex justify-between items-center p-4 bg-white rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium text-gray-900",children:Q.productName}),a.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[(()=>{const re=t.find(te=>te.id===Q.productId);return re!=null&&re.referencia?`Ref: ${re.referencia}  `:""})(),sr(Q.quantity)," unidades  ",V(Q.purchasePrice)]}),a.jsxs("div",{className:"text-sm text-blue-600 mt-1",children:["Precio venta: ",V(Q.newSalePrice)]})]}),a.jsxs("div",{className:"flex items-center space-x-4 ml-4",children:[a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>q(Q.productId,Q.quantity-1),disabled:_,className:"w-8 h-8 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center text-lg font-medium disabled:opacity-50",children:"-"}),a.jsx("input",{type:"text",value:Q.quantity,onChange:re=>{const te=re.target.value;if(te===""||/^\d+$/.test(te)){const pe=parseInt(te)||0;pe>0&&q(Q.productId,pe)}},onFocus:re=>{re.target.select()},onBlur:re=>{const te=re.target.value;(te===""||parseInt(te)<=0)&&q(Q.productId,1)},disabled:_,className:"w-20 text-center font-medium px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),a.jsx("button",{onClick:()=>q(Q.productId,Q.quantity+1),disabled:_,className:"w-8 h-8 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center text-lg font-medium disabled:opacity-50",children:"+"})]}),a.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"Cantidad"})]}),a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("input",{type:"number",min:"0",step:"1",value:Q.purchasePrice,onChange:re=>ie(Q.productId,Math.max(0,parseFloat(re.target.value)||0)),disabled:_,className:"w-24 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 text-center"}),a.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"Compra"})]}),a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("input",{type:"number",min:"0",step:"1",value:Q.newSalePrice,onChange:re=>ge(Q.productId,Math.max(0,parseFloat(re.target.value)||0)),disabled:_,className:"w-24 px-3 py-2 text-sm border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 text-center"}),a.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Venta"})]}),a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("span",{className:"font-semibold text-lg text-green-600",children:V(Q.totalCost)}),a.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"Total"})]}),a.jsx("button",{onClick:()=>K(Q.productId),disabled:_,className:"text-red-600 hover:text-red-800 w-8 h-8 flex items-center justify-center text-xl disabled:opacity-50",children:""})]})]},Q.productId))})})]}),n.length>0&&a.jsxs("div",{className:"border-t pt-6 space-y-4 bg-gray-50 -mx-6 -mb-6 px-6 pb-6 rounded-b-xl",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"flex justify-between text-base",children:[a.jsx("span",{className:"font-medium",children:"Total de productos:"}),a.jsxs("span",{className:"font-semibold",children:[sr(U)," unidades"]})]}),a.jsxs("div",{className:"flex justify-between font-bold text-xl",children:[a.jsx("span",{children:"Costo Total:"}),a.jsx("span",{className:"text-green-600",children:V(ze)})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notas (opcional)"}),a.jsx("textarea",{value:T,onChange:Q=>P(Q.target.value),disabled:_,rows:3,className:"w-full px-4 py-3 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"Ej: Proveedor, factura #, observaciones..."})]}),a.jsx("button",{onClick:Ye,disabled:ze<=0||_,className:"w-full bg-green-600 text-white px-6 py-4 text-lg rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center space-x-3 disabled:opacity-50 disabled:cursor-not-allowed",children:_?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),a.jsx("span",{children:"Procesando..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Jo,{className:"h-6 w-6"}),a.jsx("span",{children:"Registrar Compra"})]})})]})]})]})]}),O&&a.jsx("div",{className:"fixed top-4 right-4 z-[103] max-w-sm w-full",children:a.jsx("div",{className:`rounded-lg shadow-lg border-l-4 p-4 ${O.type==="success"?"bg-green-50 border-green-400":"bg-red-50 border-red-400"}`,children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:O.type==="success"?a.jsx(ai,{className:"h-5 w-5 text-green-400"}):a.jsx(Vf,{className:"h-5 w-5 text-red-400"})}),a.jsxs("div",{className:"ml-3 w-0 flex-1",children:[a.jsx("p",{className:`text-sm font-medium ${O.type==="success"?"text-green-800":"text-red-800"}`,children:O.title}),a.jsx("p",{className:`mt-1 text-sm ${O.type==="success"?"text-green-700":"text-red-700"}`,children:O.message})]}),a.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:a.jsx("button",{onClick:()=>D(null),className:`rounded-md inline-flex ${O.type==="success"?"text-green-400 hover:text-green-600":"text-red-400 hover:text-red-600"} focus:outline-none`,children:a.jsx(ct,{className:"h-4 w-4"})})})]})})})]})}const GM=(t,e)=>{switch(t){case"tarjeta":return e*.04;case"crdito":case"efectivo":case"transferencia":default:return 0}},PP=(t,e)=>{switch(t){case"tarjeta":return e*.03;default:return 0}},fG=t=>{switch(t){case"efectivo":return"Efectivo";case"transferencia":return"Transferencia";case"tarjeta":return"Tarjeta";case"crdito":return"Crdito";case"credit":return"Saldo a favor";default:return t}},mG=(t,e,r,n,s)=>{const i=t.reduce((y,g)=>y+g.totalRevenue,0),o=t.reduce((y,g)=>y+g.totalCost,0),l=Math.min(e,i),c=i-l;let u=0,d=0;s?(u=n.reduce((y,g)=>y+(g.commission||0),0),d=n.reduce((y,g)=>y+PP(g.method,g.amount),0)):(u=GM(r,c),d=PP(r,c));const h=c+d,f=c-o-u,m=c>0?f/c*100:0;return{subtotal:i,appliedDiscount:l,total:c,totalCost:o,totalProfit:f,profitMargin:m,totalCommissions:u,customerSurcharge:d,finalTotal:h}},KM=(t,e,r)=>{const n=r.filter(s=>s.method!=="credit").reduce((s,i)=>s+i.amount,0);return Math.min(t,Math.max(0,e-n))},pG=(t,e,r,n)=>{let s=t.reduce((i,o)=>i+o.amount,0);if(r&&e>0){const i=KM(e,n,t);s+=i}return s};function QM({onClose:t,onAdd:e}){const r=Xt(ro),[n,s]=I.useState(""),[i,o]=I.useState(null),[l,c]=I.useState(1),[u,d]=I.useState(""),h=I.useMemo(()=>{if(!n||n.trim().length<4)return[];const y=n.toLowerCase();return r.filter(g=>{var x,b,v;return g.name.toLowerCase().includes(y)||((x=g.referencia)==null?void 0:x.toLowerCase().includes(y))||((b=g.category)==null?void 0:b.toLowerCase().includes(y))||((v=g.imei)==null?void 0:v.toLowerCase().includes(y))})},[r,n]),f=y=>{o(y),s("")},m=()=>{const y=typeof l=="number"?l:parseInt(l||"0");if(!i||y<1)return;if(i.stock<y){alert(`Stock insuficiente. Solo hay ${i.stock} unidades disponibles.`);return}const g={productId:i.id,productName:i.name,quantity:y,normalPrice:i.salePrice,purchasePrice:i.purchasePrice,totalValue:i.salePrice*y,totalCost:i.purchasePrice*y};i.category&&(g.category=i.category),i.referencia&&(g.referencia=i.referencia),i.imei&&(g.imei=i.imei),u.trim()&&(g.reason=u.trim()),e(g),t()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-[99] bg-black bg-opacity-50",onClick:t}),a.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"p-2 bg-cyan-100 rounded-lg",children:a.jsx(ur,{className:"h-6 w-6 text-cyan-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Aadir Cortesa"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Selecciona un producto para regalar al cliente"})]})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsx("div",{className:"p-6 space-y-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:i?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"p-4 bg-cyan-50 border border-cyan-200 rounded-lg",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:i.name}),a.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-600",children:[i.referencia&&a.jsxs("span",{children:["Ref: ",i.referencia]}),i.imei&&a.jsxs("span",{children:["IMEI: ",i.imei]}),a.jsxs("span",{children:["Stock: ",i.stock]})]}),a.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Valor: "}),a.jsx("span",{className:"font-bold text-cyan-600",children:V(i.salePrice)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Costo: "}),a.jsx("span",{className:"font-semibold text-gray-700",children:V(i.purchasePrice)})]})]})]}),a.jsx("button",{onClick:()=>o(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-5 w-5"})})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cantidad"}),a.jsx("input",{type:"number",min:"1",max:i.stock,value:l,onChange:y=>{const g=y.target.value;if(g==="")c("");else{const x=parseInt(g);!isNaN(x)&&x>=1&&c(x)}},onBlur:()=>{(l===""||l<1)&&c(1)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo (opcional)"}),a.jsx("textarea",{value:u,onChange:y=>d(y.target.value),placeholder:"Ej: Cliente frecuente, promocin, etc.",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent resize-none"})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Valor total regalado:"}),a.jsx("span",{className:"font-bold text-cyan-600",children:V(i.salePrice*(typeof l=="number"?l:0))})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Costo real:"}),a.jsxs("span",{className:"font-semibold text-red-600",children:["-",V(i.purchasePrice*(typeof l=="number"?l:0))]})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar producto por nombre, referencia, IMEI...",value:n,onChange:y=>s(y.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",autoFocus:!0})]}),a.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:n.trim().length<4?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"Escribe al menos 4 caracteres para buscar productos"}):h.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No se encontraron productos"}):h.map(y=>a.jsx("button",{onClick:()=>f(y),className:"w-full p-4 border border-gray-200 rounded-lg hover:border-cyan-500 hover:bg-cyan-50 transition-all text-left",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:y.name}),a.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[y.referencia&&a.jsxs("span",{children:["Ref: ",y.referencia]}),y.imei&&a.jsxs("span",{children:["IMEI: ",y.imei]}),a.jsxs("span",{className:y.stock>0?"text-green-600":"text-red-600",children:["Stock: ",y.stock]})]})]}),a.jsxs("div",{className:"text-right ml-4",children:[a.jsx("div",{className:"text-lg font-bold text-cyan-600",children:V(y.salePrice)}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Costo: ",V(y.purchasePrice)]})]})]})},y.id))})]})}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg transition-colors",children:"Cancelar"}),i&&a.jsxs("button",{onClick:m,disabled:l===""||typeof l=="number"&&(l<1||l>i.stock),className:"flex items-center space-x-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(wn,{className:"h-4 w-4"}),a.jsx("span",{children:"Aadir Cortesa"})]})]})]})})]})}function sS({sale:t,onClose:e}){var s,i,o;const r=I.useRef(null),n=()=>{if(r.current){const l=r.current.innerHTML,c=window.open("","","width=320,height=800");c&&(c.document.write(`
          <html>
            <head>
              <title>Factura</title>
              <style>
                @media print {
                  @page { margin: 0 !important; size: 75mm auto !important; }
                  * { margin: 0 !important; padding: 0 !important; box-sizing: border-box !important; }
                  html, body {
                    width: 75mm !important;
                    min-width: 75mm !important;
                    max-width: 75mm !important;
                    margin: 0 !important;
                    padding: 0 !important;
                    background: #fff !important;
                  }
                  body, .factura-recibo {
                    font-family: monospace, Arial, sans-serif !important;
                    font-size: 15px !important;
                    width: 75mm !important;
                    margin: 0 !important;
                    padding: 0 !important;
                  }
                  .factura-recibo {
                    width: 75mm !important;
                    margin: 0 auto !important;
                    padding: 0 6mm 0 12mm !important;
                  }
                  .factura-recibo .logo-text {
                    font-size: 24px !important;
                    font-weight: bold !important;
                    font-style: italic !important;
                    letter-spacing: -1px !important;
                    text-align: center !important;
                    margin: 0 auto !important;
                    display: block !important;
                    color: #000 !important;
                  }
                  .factura-recibo h2, .factura-recibo .center {
                    text-align: center !important;
                    margin: 0 !important;
                  }
                  .factura-recibo h2 {
                    font-size: 15px !important;
                    margin-bottom: 2px !important;
                  }
                  .factura-recibo table {
                    width: 100% !important;
                    border-collapse: collapse !important;
                    margin-top: 4px !important;
                  }
                  .factura-recibo th, .factura-recibo td {
                    padding: 4px 0 !important;
                    text-align: left !important;
                    font-size: 12px !important;
                  }
                  .factura-recibo th {
                    background: none !important;
                  }
                  .factura-recibo .total-row {
                    border-top: 1px solid #000 !important;
                    font-weight: bold !important;
                  }
                  .factura-recibo .totals { font-weight: bold !important; }
                  .factura-recibo .right { text-align: right !important; }
                  .factura-recibo .center { text-align: center !important; }
                  .factura-recibo .no-border { border: none !important; }
                  .factura-recibo > *:not(:last-child) { margin-bottom: 1px !important; }
                  .factura-recibo img + div { margin-top: 0 !important; }
                }
                /* Visual (modal) styles remain igual */
                body { width: 75mm; margin: 0; font-family: monospace, Arial, sans-serif; font-size: 15px; }
                .factura-recibo { width: 75mm; margin: 0 auto; padding: 0 6mm 0 12mm; }
                h2 { font-size: 17px; margin: 0 0 4px 0; text-align: center; }
                table { width: 100%; border-collapse: collapse; margin-top: 6px; }
                th, td { padding: 4px 0; text-align: left; font-size: 15px; }
                th { background: none; }
                .total-row { border-top: 1px solid #000 !important; font-weight: bold; }
                .totals { font-weight: bold; }
                .right { text-align: right; }
                .center { text-align: center; }
                .no-border { border: none !important; }
              </style>
            </head>
            <body>
              <div class="factura-recibo">${l}</div>
            </body>
          </html>
        `),c.document.close(),c.focus(),c.print(),c.close())}};return t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-[99] pointer-events-none",children:a.jsx("div",{className:"absolute left-0 right-0 top-[5vh] bottom-0 bg-black bg-opacity-50"})}),a.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6 sm:p-8 relative border border-gray-200",children:[a.jsx("button",{onClick:e,className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-xl",children:""}),a.jsxs("div",{ref:r,className:"factura-recibo",children:[a.jsxs("div",{className:"center",style:{marginBottom:"12px"},children:[a.jsx("div",{className:"logo-text",style:{fontSize:"24px",fontWeight:"bold",fontStyle:"italic",letterSpacing:"-1px",textAlign:"center",margin:"0 auto 8px auto",display:"block"},children:"CELU MARIA"}),a.jsx("div",{className:"center",style:{fontSize:"12px",marginBottom:"2px",lineHeight:"1.3"},children:"Carrera 45 # 71a-17"}),a.jsx("div",{className:"center",style:{fontSize:"12px",marginBottom:"2px",lineHeight:"1.3"},children:"Celular +57 3043884525"}),a.jsx("div",{className:"center",style:{fontSize:"12px",marginBottom:"2px",lineHeight:"1.3"},children:"Instagram @celu.maria"})]}),a.jsx("div",{style:{borderBottom:"1px dashed #000",margin:"8px 0"}}),a.jsx("h2",{className:"font-bold mb-2 center",style:{fontSize:"16px",margin:"8px 0"},children:"Cuenta de Cobro"}),a.jsxs("div",{className:"text-xs text-gray-600 mb-3",style:{marginBottom:"4px",fontSize:"11px",textAlign:"left"},children:["Fecha: ",new Date().toLocaleString()]}),t.customerName&&a.jsxs("div",{className:"text-xs text-gray-900 mb-2",style:{marginBottom:"2px",fontWeight:"500",fontSize:"11px",textAlign:"left"},children:["Cliente: ",t.customerName]}),t.salesPersonName&&a.jsxs("div",{className:"text-xs text-gray-700 mb-3",style:{marginBottom:"4px",fontWeight:"500",fontSize:"11px",textAlign:"left"},children:["Vendedor: ",t.salesPersonName]}),a.jsx("div",{style:{borderBottom:"1px dashed #000",margin:"8px 0"}}),t.type==="technical_service_payment"&&t.technicalServiceDetails?a.jsxs("div",{style:{marginTop:"8px",marginBottom:"12px"},children:[a.jsx("div",{style:{fontSize:"13px",fontWeight:"bold",marginBottom:"8px"},children:"SERVICIO TCNICO"}),a.jsxs("div",{style:{fontSize:"11px",marginBottom:"4px"},children:[a.jsx("span",{style:{fontWeight:"bold"},children:"Equipo:"})," ",t.technicalServiceDetails.deviceBrandModel||"N/A"]}),t.technicalServiceDetails.deviceImei&&a.jsxs("div",{style:{fontSize:"11px",marginBottom:"4px"},children:[a.jsx("span",{style:{fontWeight:"bold"},children:"IMEI:"})," ",t.technicalServiceDetails.deviceImei]}),t.technicalServiceDetails.reportedIssue&&a.jsxs("div",{style:{fontSize:"11px",marginBottom:"4px"},children:[a.jsx("span",{style:{fontWeight:"bold"},children:"Problema:"})," ",t.technicalServiceDetails.reportedIssue]}),t.technicalServiceDetails.technicianName&&a.jsxs("div",{style:{fontSize:"11px",marginBottom:"8px"},children:[a.jsx("span",{style:{fontWeight:"bold"},children:"Tcnico:"})," ",t.technicalServiceDetails.technicianName]})]}):a.jsxs("table",{className:"w-full text-xs",style:{marginTop:"8px",marginBottom:"12px"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{padding:"4px 0",fontWeight:"bold"},children:"Producto"}),a.jsx("th",{style:{padding:"4px 0",fontWeight:"bold"},children:"Cant"}),a.jsx("th",{style:{padding:"4px 0",fontWeight:"bold"},children:"Precio"}),a.jsx("th",{style:{padding:"4px 0",fontWeight:"bold"},children:"Total"})]})}),a.jsxs("tbody",{children:[t.items.map(l=>{var c;return a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:"3px 0"},children:[l.productName,l.referencia&&a.jsxs("div",{style:{fontSize:"10px",color:"#000",marginTop:"1px"},children:["Ref: ",l.referencia]}),((c=l.category)==null?void 0:c.includes("Celulares"))&&l.imei&&a.jsxs("div",{style:{fontSize:"10px",color:"#000",marginTop:"1px"},children:["IMEI: ",l.imei]})]}),a.jsx("td",{className:"right",style:{padding:"3px 0"},children:l.quantity}),a.jsx("td",{className:"right",style:{padding:"3px 0"},children:V(l.salePrice)}),a.jsx("td",{className:"right",style:{padding:"3px 0"},children:V(l.totalRevenue)})]},l.productId)}),a.jsxs("tr",{className:"total-row",children:[a.jsx("td",{style:{fontWeight:"bold",padding:"6px 0 3px 0"},children:"Total Artculos:"}),a.jsx("td",{className:"right",style:{fontWeight:"bold",padding:"6px 0 3px 0"},children:t.items.reduce((l,c)=>l+c.quantity,0)}),a.jsx("td",{style:{padding:"6px 0 3px 0"}}),a.jsx("td",{style:{padding:"6px 0 3px 0"}})]})]})]}),t.courtesyItems&&t.courtesyItems.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{borderBottom:"1px dashed #000",margin:"8px 0"}}),a.jsx("div",{className:"text-center",style:{fontSize:"12px",fontWeight:"bold",margin:"8px 0",color:"#0891b2"},children:"CORTESAS"}),a.jsx("table",{className:"w-full text-xs",style:{marginTop:"4px",marginBottom:"4px"},children:a.jsx("tbody",{children:t.courtesyItems.map((l,c)=>a.jsxs("tr",{children:[a.jsx("td",{style:{padding:"2px 0",fontSize:"11px"},children:l.productName}),a.jsx("td",{className:"center",style:{padding:"2px 0",fontSize:"11px"},children:l.quantity}),a.jsx("td",{className:"right",style:{padding:"2px 0",fontSize:"11px",textDecoration:"line-through"},children:V(l.normalPrice)}),a.jsx("td",{className:"right",style:{padding:"2px 0",fontSize:"11px",fontWeight:"bold"},children:"$0"})]},c))})}),t.courtesyTotalValue&&a.jsxs("div",{className:"flex justify-between",style:{marginTop:"4px",marginBottom:"8px",fontSize:"11px",color:"#0891b2",fontStyle:"italic"},children:[a.jsx("span",{children:"Valor cortesas:"}),a.jsx("span",{children:V(t.courtesyTotalValue)})]})]}),a.jsx("div",{style:{borderBottom:"1px dashed #000",margin:"8px 0"}}),a.jsxs("div",{className:"mt-4",style:{marginTop:"12px"},children:[a.jsxs("div",{className:"flex justify-between",style:{marginBottom:"6px",fontSize:"13px"},children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{children:V(t.subtotal)})]}),t.discount>0&&a.jsxs("div",{className:"flex justify-between",style:{marginBottom:"6px",fontSize:"13px"},children:[a.jsx("span",{children:"Descuento:"}),a.jsxs("span",{children:["-",V(t.discount)]})]}),t.customerSurcharge>0&&a.jsxs("div",{className:"flex justify-between text-orange-600",style:{marginBottom:"6px",fontSize:"13px"},children:[a.jsx("span",{children:"Recargo por mtodo de pago:"}),a.jsxs("span",{children:["+",V(t.customerSurcharge)]})]}),a.jsx("div",{style:{borderBottom:"1px solid #000",margin:"8px 0"}}),a.jsxs("div",{className:"flex justify-between totals",style:{marginBottom:"8px",fontSize:"14px",fontWeight:"bold"},children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:V(t.finalTotal||t.total)})]}),t.paymentMethods&&t.paymentMethods.some(l=>l.method==="credit")&&a.jsxs("div",{className:"flex justify-between text-green-700 font-semibold",style:{marginBottom:"6px",fontSize:"13px"},children:[a.jsx("span",{children:"Saldo a favor aplicado:"}),a.jsxs("span",{children:["-",V(((s=t.paymentMethods.find(l=>l.method==="credit"))==null?void 0:s.amount)||0)]})]}),t.paymentMethods&&t.paymentMethods.some(l=>l.method==="credit")&&a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{borderBottom:"1px solid #000",margin:"8px 0"}}),a.jsxs("div",{className:"flex justify-between totals",style:{marginBottom:"8px",fontSize:"14px",fontWeight:"bold"},children:[a.jsx("span",{children:"Total a pagar tras saldo a favor:"}),a.jsx("span",{children:V((t.finalTotal||t.total)-(((o=(i=t.paymentMethods)==null?void 0:i.find(l=>l.method==="credit"))==null?void 0:o.amount)||0))})]})]}),t.paymentMethods&&t.paymentMethods.filter(l=>l.method!=="credit").length>0&&a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{borderBottom:"1px dashed #000",margin:"8px 0"}}),a.jsxs("div",{className:"text-xs",style:{marginTop:"8px"},children:[a.jsx("div",{className:"flex justify-between",style:{marginBottom:"4px",fontWeight:"bold",fontSize:"13px"},children:a.jsx("span",{children:"Mtodos de pago:"})}),t.paymentMethods.filter(l=>l.method!=="credit").map((l,c)=>a.jsxs("div",{className:"flex justify-between",style:{marginLeft:"8px",marginBottom:"4px",fontSize:"12px"},children:[a.jsxs("span",{children:[l.method==="efectivo"?"Efectivo":l.method==="transferencia"?"Transferencia":l.method==="tarjeta"?"Tarjeta":l.method==="crdito"?"Crdito":l.method,":"]}),a.jsx("span",{children:V(l.amount)})]},c))]})]})]}),a.jsx("div",{style:{borderBottom:"1px dashed #000",margin:"12px 0 8px 0"}}),a.jsx("div",{className:"center text-xs",style:{fontSize:"13px",fontWeight:"bold",marginBottom:"6px",lineHeight:"1.3"},children:"Celu Mara tecnologa confiable, gente real, soluciones honestas!"}),a.jsx("div",{className:"center text-xs",style:{fontSize:"12px",marginBottom:"4px",fontWeight:"500"},children:"Gracias por su compra!"}),a.jsx("div",{className:"center text-xs",style:{fontSize:"11px",color:"#000"},children:"Carrera 45 # 71a-17"})]}),a.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[a.jsx("button",{onClick:n,className:"bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 text-xs",children:"Imprimir"}),a.jsx("button",{onClick:e,className:"bg-gray-200 text-gray-700 px-3 py-1 rounded hover:bg-gray-300 text-xs",children:"Cerrar"})]})]})})]}):null}function gG(){var qe,De;const t=Xt(ro),e=Xt(Gm),r=Xt(ne=>ne.firebase.customers.items),{showSuccess:n,showError:s,showWarning:i}=hi(),{appUser:o}=ma(),l=wc();I.useCallback(ne=>{const oe=new Date;return oe.setDate(oe.getDate()-30),e.filter(Ce=>Ce.customerId!==ne?!1:new Date(Ce.createdAt)>=oe).length},[e]);const[c,u]=I.useState({currentSale:[],selectedProduct:"",quantity:1,discount:0,discountDisplay:"",paymentMethod:"efectivo",paymentMethods:[],useMultiplePayments:!1,courtesyItems:[]}),[d,h]=I.useState({selectedCustomer:null,customerSearch:"",applyCredit:!1}),[f,m]=I.useState({isProcessing:!1,productSearch:"",showProductDropdown:!1,lastSale:null,showInvoice:!1,lastAddedItem:null,showCourtesyModal:!1}),y=I.useRef(null);I.useRef(null);const g=I.useRef(null);I.useState(-1);const[x,b]=I.useState(!1),v=I.useRef(null),j=I.useRef(0),S=I.useRef(""),_=I.useRef(""),C=I.useRef(!1),N=I.useRef(null),w=I.useCallback(ne=>{u(oe=>({...oe,...ne}))},[]),E=I.useCallback(ne=>{h(oe=>({...oe,...ne}))},[]),k=I.useCallback(ne=>{m(oe=>({...oe,...ne}))},[]),T=I.useCallback(()=>{k({showCourtesyModal:!0})},[k]),P=I.useCallback(()=>{k({showCourtesyModal:!1})},[k]),O=I.useCallback(ne=>{w({courtesyItems:[...c.courtesyItems,ne]})},[w,c.courtesyItems]),D=I.useCallback(ne=>{const oe=c.courtesyItems.filter((Ce,ke)=>ke!==ne);w({courtesyItems:oe})},[w,c.courtesyItems]);I.useEffect(()=>()=>{v.current&&clearTimeout(v.current)},[]);const R=I.useCallback(()=>{if(g.current){const ne=g.current,oe=ne.scrollHeight,Ce=ne.clientHeight,ke=oe>Ce;b(ke)}},[]);I.useEffect(()=>{const ne=setTimeout(R,150);return()=>clearTimeout(ne)},[c.currentSale,c.paymentMethods,c.useMultiplePayments,d.selectedCustomer,R]),I.useEffect(()=>{const ne=()=>{setTimeout(R,100)};return window.addEventListener("resize",ne),()=>window.removeEventListener("resize",ne)},[R]);const B=I.useMemo(()=>{if(!f.productSearch)return t.filter(oe=>oe.stock>0);const ne=f.productSearch.toLowerCase();return/^\d+$/.test(f.productSearch)?t.filter(oe=>oe.stock>0&&oe.barcode===f.productSearch):t.filter(oe=>oe.stock>0&&(oe.name.toLowerCase().includes(ne)||oe.referencia&&oe.referencia.toLowerCase().includes(ne)))},[t,f.productSearch]),Y=I.useMemo(()=>{if(!d.customerSearch)return r;const ne=d.customerSearch.toLowerCase();return r.filter(oe=>oe.name.toLowerCase().includes(ne)||oe.phone&&oe.phone.toLowerCase().includes(ne)||oe.email&&oe.email.toLowerCase().includes(ne))},[r,d.customerSearch]),W=I.useMemo(()=>mG(c.currentSale,c.discount,c.paymentMethod,c.paymentMethods,c.useMultiplePayments),[c.currentSale,c.discount,c.paymentMethod,c.paymentMethods,c.useMultiplePayments]);I.useMemo(()=>!d.selectedCustomer||!d.applyCredit?0:KM(d.selectedCustomer.credit,W.total,c.paymentMethods),[d.selectedCustomer,d.applyCredit,W.total,c.paymentMethods]);const L=I.useMemo(()=>{var ne;return pG(c.paymentMethods,((ne=d.selectedCustomer)==null?void 0:ne.credit)||0,d.applyCredit,W.total)},[c.paymentMethods,(qe=d.selectedCustomer)==null?void 0:qe.credit,d.applyCredit,W.total]),X=I.useMemo(()=>Math.max(0,W.total-L),[W.total,L]),G=I.useCallback((ne,oe)=>{if(oe<=0)return;const Ce=GM(ne,oe),ke={method:ne,amount:oe,commission:Ce};w({paymentMethods:[...c.paymentMethods,ke]})},[c.paymentMethods,w]),K=I.useCallback(ne=>{w({paymentMethods:c.paymentMethods.filter((oe,Ce)=>Ce!==ne)})},[c.paymentMethods,w]),q=I.useCallback((ne,oe)=>{const Ce=t.find(ue=>ue.id===ne);if(!Ce||oe<=0||oe>Ce.stock){Ce?oe>Ce.stock&&i("Stock insuficiente",`Solo hay ${sr(Ce.stock)} unidades disponibles en stock`):s("Error","Producto no encontrado");return}const ke=Date.now();N.current&&N.current.productId===ne&&ke-N.current.timestamp<1e3||(u(ue=>{const se=ue.currentSale.find(We=>We.productId===Ce.id);if(se){const We=se.quantity+oe;return We>Ce.stock?(i("Stock insuficiente",`Solo hay ${sr(Ce.stock)} unidades disponibles en stock`),ue):{...ue,currentSale:ue.currentSale.map(Ae=>Ae.productId===Ce.id?{...Ae,quantity:We,totalCost:We*Ce.purchasePrice,totalRevenue:We*Ce.salePrice,profit:We*Ce.salePrice-We*Ce.purchasePrice}:Ae)}}else{const We={productId:Ce.id,productName:Ce.name,quantity:oe,purchasePrice:Ce.purchasePrice,salePrice:Ce.salePrice,totalCost:oe*Ce.purchasePrice,totalRevenue:oe*Ce.salePrice,profit:oe*Ce.salePrice-oe*Ce.purchasePrice,...Ce.referencia&&{referencia:Ce.referencia},...Ce.category&&{category:Ce.category},...Ce.imei&&{imei:Ce.imei}};return N.current={productId:ne,timestamp:ke},{...ue,currentSale:[...ue.currentSale,We]}}}),N.current={productId:ne,timestamp:ke})},[t,s,i]),ie=I.useCallback(ne=>{if(C.current)return;C.current=!0;const oe=t.find(Ce=>Ce.barcode===ne);if(oe){if(oe.stock<=0){i("Stock insuficiente","Este producto no tiene stock disponible"),k({productSearch:""}),_.current="",C.current=!1;return}q(oe.id,1),k({productSearch:""}),n("Producto agregado",`${oe.name} agregado a la venta`)}else k({productSearch:""}),s("Producto no encontrado","No se encontr un producto con ese cdigo de barras");_.current="",setTimeout(()=>{C.current=!1},200)},[t,q,k,n,s,i]),ge=I.useCallback(ne=>{const oe=Date.now();oe-j.current<50&&ne.length>S.current.length?(S.current=ne,j.current=oe,v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{const ke=S.current.trim();/^\d{6,}$/.test(ke)&&(_.current=ke,ie(ke)),S.current=""},300)):(j.current=oe,S.current=ne)},[ie]),be=I.useCallback(ne=>{w({currentSale:c.currentSale.filter(oe=>oe.productId!==ne)})},[c.currentSale,w]),Ye=I.useCallback(ne=>{const oe=t.find(ue=>ue.id===ne),Ce=c.currentSale.find(ue=>ue.productId===ne);if(!oe||!Ce)return;if(Ce.quantity>=oe.stock){i("Stock insuficiente",`Solo hay ${sr(oe.stock)} unidades disponibles`);return}const ke=Ce.quantity+1;w({currentSale:c.currentSale.map(ue=>ue.productId===ne?{...ue,quantity:ke,totalCost:ke*ue.purchasePrice,totalRevenue:ke*ue.salePrice,profit:ke*ue.salePrice-ke*ue.purchasePrice}:ue)})},[t,c.currentSale,w,i]),ze=I.useCallback(ne=>{const oe=c.currentSale.find(ke=>ke.productId===ne);if(!oe)return;if(oe.quantity<=1){be(ne);return}const Ce=oe.quantity-1;w({currentSale:c.currentSale.map(ke=>ke.productId===ne?{...ke,quantity:Ce,totalCost:Ce*ke.purchasePrice,totalRevenue:Ce*ke.salePrice,profit:Ce*ke.salePrice-Ce*ke.purchasePrice}:ke)})},[c.currentSale,w,be]),U=I.useCallback(ne=>{const oe=jt(ne),Ce=Math.max(0,Math.min(oe,W.subtotal)),ke=Yt(Ce.toString());w({discountDisplay:ke,discount:Ce})},[W.subtotal,w]),Q=I.useCallback(ne=>{const oe=W.subtotal*ne,Ce=Yt(oe.toString());w({discountDisplay:Ce,discount:oe})},[W.subtotal,w]),re=I.useCallback(async()=>{if(c.currentSale.length===0){i("Venta vaca","Debes agregar al menos un producto a la venta");return}if(!d.selectedCustomer){i("Cliente requerido","Debes seleccionar un cliente para completar la venta");return}const{subtotal:ne,appliedDiscount:oe,total:Ce,totalCost:ke,totalProfit:ue,profitMargin:se}=W;if(Ce<=0){s("Total invlido","El total de la venta debe ser mayor a cero");return}k({isProcessing:!0});try{const Ae={items:c.currentSale.map(ut=>{const mt={productId:ut.productId,productName:ut.productName,quantity:ut.quantity,purchasePrice:ut.purchasePrice,salePrice:ut.salePrice,totalCost:ut.totalCost,totalRevenue:ut.totalRevenue,profit:ut.profit};return ut.referencia&&(mt.referencia=ut.referencia),ut.category&&(mt.category=ut.category),ut.imei&&(mt.imei=ut.imei),mt}),subtotal:ne,discount:oe,tax:0,total:Ce,totalCost:ke,totalProfit:ue,profitMargin:se,paymentMethod:c.paymentMethod,customerId:d.selectedCustomer.id,customerName:d.selectedCustomer.name};if(c.useMultiplePayments&&c.paymentMethods.length>0&&(Ae.paymentMethods=c.paymentMethods,Ae.useMultiplePayments=!0,he!==Ce&&(Ae.finalTotal=he,Ae.customerSurcharge=Le)),o&&(Ae.salesPersonId=o.uid,Ae.salesPersonName=o.displayName||o.email),c.courtesyItems.length>0){Ae.courtesyItems=c.courtesyItems;const ut=c.courtesyItems.reduce((pt,gt)=>pt+gt.totalValue,0),mt=c.courtesyItems.reduce((pt,gt)=>pt+gt.totalCost,0);Ae.courtesyTotalValue=ut,Ae.courtesyTotalCost=mt,Ae.realTotalCost=ke+mt,Ae.realProfit=ue-mt}const it=await Xo.add(Ae);if(c.courtesyItems.length>0){const ut=c.courtesyItems.map(async mt=>{var gt,lr;const pt={saleId:it,salesPersonId:(o==null?void 0:o.uid)||"",salesPersonName:(o==null?void 0:o.displayName)||(o==null?void 0:o.email)||"",item:mt};return(gt=d.selectedCustomer)!=null&&gt.id&&(pt.customerId=d.selectedCustomer.id),(lr=d.selectedCustomer)!=null&&lr.name&&(pt.customerName=d.selectedCustomer.name),mt.reason&&(pt.reason=mt.reason),Nx.add(pt)});await Promise.all(ut)}k({lastSale:{...Ae,id:it},showInvoice:!0}),u({currentSale:[],selectedProduct:"",quantity:1,discount:0,discountDisplay:"",paymentMethod:"efectivo",paymentMethods:[],useMultiplePayments:!1,courtesyItems:[]}),E({applyCredit:!1,selectedCustomer:null,customerSearch:""}),k({productSearch:"",lastAddedItem:null}),n("Venta completada",`Venta por ${V(Ce)} procesada exitosamente.`),l.invalidateSales()}catch(We){console.error("Error completo al procesar venta:",We);const Ae=We instanceof Error?We.message:"Error desconocido al procesar la venta";s("Error al procesar venta",Ae)}finally{k({isProcessing:!1})}},[c,d,W,k,E,i,s,n,o]),{subtotal:te,appliedDiscount:pe,total:xe,finalTotal:he,customerSurcharge:Le}=W;return a.jsxs("div",{ref:g,className:"bg-gray-50 p-4",style:{height:"calc(100vh - 88px)",overflow:x?"auto":"hidden"},children:[a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ventas"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Procesa ventas y gestiona transacciones"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:[a.jsxs("div",{className:"lg:col-span-3 space-y-3",children:[a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg shadow-lg border border-gray-300 p-3",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Rr,{className:"h-4 w-4 text-gray-500 mr-2"}),a.jsx("label",{className:"text-base font-semibold text-gray-900",children:"Cliente *"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar cliente por nombre, telfono o email...",value:d.customerSearch,onChange:ne=>E({customerSearch:ne.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm"}),d.customerSearch&&d.customerSearch!==(((De=d.selectedCustomer)==null?void 0:De.name)||"")&&a.jsx("div",{className:"absolute z-20 left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto mt-1",children:Y.length===0?a.jsx("div",{className:"p-4 text-gray-500 text-sm",children:"No hay clientes"}):Y.map(ne=>a.jsxs("button",{type:"button",onMouseDown:oe=>{oe.preventDefault(),E({selectedCustomer:ne,customerSearch:ne.name,applyCredit:!1})},className:"w-full text-left px-4 py-3 hover:bg-blue-50",children:[a.jsx("div",{className:"font-medium",children:ne.name}),a.jsxs("div",{className:"text-sm text-gray-500",children:[ne.phone&&a.jsxs("span",{className:"mr-3",children:["Tel: ",ne.phone]}),ne.email&&a.jsxs("span",{className:"mr-3",children:["Email: ",ne.email]}),"Saldo: ",V(ne.credit||0)]})]},ne.id))})]}),d.selectedCustomer&&a.jsxs("div",{className:"mt-4 p-3 rounded-lg bg-white border border-gray-400 shadow-md",children:[a.jsx("div",{className:"font-medium text-gray-900",children:d.selectedCustomer.name}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[d.selectedCustomer.phone&&a.jsxs("span",{className:"mr-3",children:["Tel: ",d.selectedCustomer.phone]}),d.selectedCustomer.email&&a.jsxs("span",{children:["Email: ",d.selectedCustomer.email]})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-slate-50 rounded-lg shadow-lg border border-gray-300 p-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.productSearch&&/^\d+$/.test(f.productSearch)&&a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-blue-600 font-medium animate-pulse",children:"Presiona Enter "}),a.jsx("input",{ref:y,type:"text",placeholder:"Buscar producto o escanear cdigo de barras (automtico)...",value:f.productSearch,onChange:ne=>{const oe=ne.target.value;k({productSearch:oe,showProductDropdown:!0}),ge(oe)},onFocus:()=>k({showProductDropdown:!0}),onKeyDown:ne=>{if(ne.key==="Enter"&&f.productSearch.trim()){ne.preventDefault();const oe=f.productSearch.trim();/^\d+$/.test(oe)?_.current===oe?(k({productSearch:""}),_.current=""):ie(oe):B.length>0&&(q(B[0].id,1),k({productSearch:"",showProductDropdown:!1}),n("Producto agregado",`${B[0].name} agregado a la venta`))}},className:"w-full pl-10 pr-4 py-3 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm"}),f.showProductDropdown&&f.productSearch&&a.jsx("div",{className:"absolute z-20 left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto mt-1",children:B.length===0?a.jsx("div",{className:"p-4 text-gray-500 text-sm",children:/^\d+$/.test(f.productSearch)?`No se encontr producto con cdigo de barras: ${f.productSearch}`:"No hay productos"}):B.map(ne=>a.jsxs("button",{type:"button",onMouseDown:()=>{q(ne.id,1),k({productSearch:"",showProductDropdown:!1}),n("Producto agregado",`${ne.name} agregado a la venta`)},className:"w-full text-left px-4 py-3 hover:bg-blue-50",children:[a.jsxs("div",{className:"font-medium",children:[ne.name,/^\d+$/.test(f.productSearch)&&a.jsxs("span",{className:"ml-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:["Cdigo: ",ne.barcode]})]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[ne.referencia&&a.jsxs("span",{className:"mr-3",children:["Ref: ",ne.referencia]}),V(ne.salePrice),"  Stock: ",sr(ne.stock)]})]},ne.id))})]}),a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:" Escanea cdigos de barras (automtico) o busca por nombre + Enter "})]}),a.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-gray-100 rounded-lg shadow-lg border border-slate-300 p-3",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Jo,{className:"h-4 w-4 text-cyan-600 mr-2"}),a.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:["Productos en la venta (",c.currentSale.length," tipos, ",c.currentSale.reduce((ne,oe)=>ne+oe.quantity,0)," unidades)"]})]}),a.jsx("div",{className:"min-h-32 bg-white rounded-lg p-3 border border-gray-200",children:c.currentSale.length===0?a.jsx("div",{className:"text-center text-gray-500 py-6",children:"No hay productos agregados"}):a.jsx("div",{className:"space-y-2",children:c.currentSale.map(ne=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-white to-gray-50 rounded-lg border border-gray-300 shadow-md",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-gray-900",children:ne.productName}),a.jsxs("div",{className:"text-sm text-gray-500",children:[V(ne.salePrice)," por unidad"]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex items-center space-x-1 bg-white border border-gray-300 rounded-lg",children:[a.jsx("button",{onClick:()=>ze(ne.productId),className:"p-1 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-l-lg transition-colors",title:"Disminuir cantidad",children:a.jsx(_x,{className:"h-3 w-3"})}),a.jsx("span",{className:"px-2 py-1 text-sm font-medium text-gray-900 min-w-[2rem] text-center",children:ne.quantity}),a.jsx("button",{onClick:()=>Ye(ne.productId),className:"p-1 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-r-lg transition-colors",title:"Aumentar cantidad",children:a.jsx(wn,{className:"h-3 w-3"})})]}),a.jsx("span",{className:"font-semibold text-blue-600 min-w-[4rem] text-right",children:V(ne.totalRevenue)}),a.jsx("button",{onClick:()=>be(ne.productId),className:"text-red-500 hover:text-red-700 p-1 hover:bg-red-50 rounded transition-colors",title:"Eliminar producto",children:a.jsx(ct,{className:"h-4 w-4"})})]})]},ne.productId))})}),c.courtesyItems.length>0&&a.jsxs("div",{className:"mt-4",children:[a.jsxs("h3",{className:"text-sm font-semibold text-cyan-700 mb-2 flex items-center space-x-2",children:[a.jsx(ur,{className:"h-4 w-4"}),a.jsxs("span",{children:["Cortesas (",c.courtesyItems.length,")"]})]}),a.jsx("div",{className:"space-y-2",children:c.courtesyItems.map((ne,oe)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-cyan-50 to-cyan-100 rounded-lg border border-cyan-300",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-cyan-900",children:ne.productName}),a.jsxs("div",{className:"text-xs text-cyan-600",children:["Valor: ",V(ne.normalPrice),"  ",ne.quantity," = ",V(ne.totalValue)]}),ne.reason&&a.jsx("div",{className:"text-xs text-cyan-500 italic mt-1",children:ne.reason})]}),a.jsx("button",{onClick:()=>D(oe),className:"p-2 text-cyan-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar cortesa",children:a.jsx(ct,{className:"h-4 w-4"})})]},oe))})]})]})]}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-gradient-to-br from-gray-100 to-slate-100 rounded-lg shadow-lg border border-gray-300 p-4",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Resumen de Venta"}),a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal"}),a.jsx("span",{className:"text-base font-semibold",children:V(te)})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-600 mb-2",children:"Descuento"}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Wt,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",value:c.discountDisplay,onChange:ne=>U(ne.target.value),className:"w-full pl-6 pr-2 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]})}),a.jsxs("div",{className:"flex space-x-1 mt-2",children:[a.jsx("button",{onClick:()=>Q(.05),className:"px-2 py-0.5 text-xs bg-yellow-100 text-yellow-800 rounded hover:bg-yellow-200",children:"5%"}),a.jsx("button",{onClick:()=>Q(.1),className:"px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded hover:bg-green-200",children:"10%"}),a.jsx("button",{onClick:()=>Q(.15),className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200",children:"15%"})]})]}),a.jsxs("div",{className:"flex justify-between items-center mb-4 text-lg font-bold border-t border-gray-200 pt-3",children:[a.jsx("span",{children:"TOTAL"}),a.jsx("span",{children:V(xe)})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(WW,{className:"h-4 w-4 text-gray-500 mr-2"}),a.jsx("label",{className:"block text-gray-600",children:"Mtodo de Pago"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:c.useMultiplePayments,onChange:ne=>{w({useMultiplePayments:ne.target.checked,paymentMethods:ne.target.checked?c.paymentMethods:[]})},disabled:f.isProcessing,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-2 mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Pagos mltiples"})]})]}),c.useMultiplePayments?a.jsxs("div",{className:"space-y-3",children:[c.paymentMethods.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Pagos agregados:"}),c.paymentMethods.map((ne,oe)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-medium",children:fG(ne.method)}),a.jsx("div",{className:"text-xs text-gray-600",children:V(ne.amount)})]}),a.jsx("button",{onClick:()=>K(oe),disabled:f.isProcessing,className:"text-red-600 hover:text-red-800 p-1 disabled:opacity-50",children:a.jsx(ct,{className:"h-4 w-4"})})]},oe)),a.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[a.jsx("span",{children:"Total pagado:"}),a.jsx("span",{className:"font-medium",children:V(L)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Restante por pagar:"}),a.jsx("span",{className:`font-medium ${X>0?"text-red-600":"text-green-600"}`,children:V(X)})]})]}),X>0&&a.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Agregar pago:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:c.paymentMethod,onChange:ne=>w({paymentMethod:ne.target.value}),disabled:f.isProcessing,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 text-sm",children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]}),a.jsx("button",{onClick:()=>{X>0&&G(c.paymentMethod,X)},disabled:f.isProcessing||X<=0,className:"px-3 py-2 bg-gray-600 text-white text-xs rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Todo"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"text",placeholder:"Monto",disabled:f.isProcessing,className:"flex-1 px-4 py-3 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",onChange:ne=>{const oe=jt(ne.target.value),Ce=Math.min(oe,X);ne.target.value=Yt(Ce.toString())},onKeyDown:ne=>{if(ne.key==="Enter"){const oe=jt(ne.currentTarget.value);oe>0&&oe<=X&&(G(c.paymentMethod,oe),ne.currentTarget.value="")}}}),a.jsx("button",{onClick:ne=>{var ke;const oe=(ke=ne.currentTarget.parentElement)==null?void 0:ke.querySelector("input"),Ce=jt((oe==null?void 0:oe.value)||"0");Ce>0&&Ce<=X&&(G(c.paymentMethod,Ce),oe&&(oe.value=""))},disabled:f.isProcessing,className:"px-6 py-3 text-base bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar"})]})]})]})]}):a.jsxs("select",{value:c.paymentMethod,onChange:ne=>w({paymentMethod:ne.target.value}),disabled:f.isProcessing,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]})]}),a.jsxs("button",{onClick:T,disabled:f.isProcessing||!d.selectedCustomer,className:"w-full bg-cyan-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-cyan-700 transition-colors disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center space-x-2 mb-3",children:[a.jsx(ur,{className:"h-5 w-5"}),a.jsx("span",{children:"Aadir Cortesa"})]}),a.jsx("button",{onClick:re,disabled:xe<=0||f.isProcessing||!d.selectedCustomer||c.currentSale.length===0||c.useMultiplePayments&&(c.paymentMethods.length===0||X>.01),className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-green-700 transition-colors disabled:opacity-40 disabled:cursor-not-allowed disabled:bg-gray-400 flex items-center justify-center space-x-2",children:f.isProcessing?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),a.jsx("span",{children:"Procesando..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Jo,{className:"h-5 w-5"}),a.jsx("span",{children:"Completar Venta"})]})})]})})]})]}),f.lastSale&&f.showInvoice&&a.jsx(sS,{sale:f.lastSale,onClose:()=>k({showInvoice:!1})}),f.showCourtesyModal&&a.jsx(QM,{onClose:P,onAdd:O}),f.lastSale&&!f.showInvoice&&a.jsx("div",{className:"fixed bottom-6 right-6 z-40",children:a.jsxs("button",{className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-3 rounded-lg shadow-lg hover:bg-blue-700 transition-colors",onClick:()=>k({showInvoice:!0}),children:[a.jsx(Pi,{className:"h-5 w-5"}),"Imprimir factura"]})})]})}function yG({searchTerm:t="",dateFilter:e="today",customDateRange:r={startDate:"",endDate:""},timeRange:n={startTime:"",endTime:""},paymentMethodFilter:s="all",salesPersonFilter:i="all",sortBy:o="date",sortOrder:l="desc",itemsPerPage:c=10,minAmount:u,maxAmount:d,profitRangeFilter:h="all",useFreshData:f=!1}){const[m,y]=I.useState([]),[g,x]=I.useState(!1),[b,v]=I.useState(null),[j,S]=I.useState(null),[_,C]=I.useState(1),[N,w]=I.useState(!1),[E,k]=I.useState(!1),T=I.useCallback(async(B,Y=null)=>{let W=yt(Pe,"sales"),L=[];const X=new Date;let G=null,K=null;switch(e){case"today":{G=new Date(X.getFullYear(),X.getMonth(),X.getDate(),0,0,0,0),K=new Date(X.getFullYear(),X.getMonth(),X.getDate(),23,59,59,999),console.log(" Filtro TODAY:",{start:G.toISOString(),end:K.toISOString()});break}case"week":G=new Date(X.getTime()-7*24*60*60*1e3);break;case"month":G=new Date(X.getTime()-30*24*60*60*1e3);break;case"3months":G=new Date(X.getTime()-90*24*60*60*1e3);break;case"6months":G=new Date(X.getTime()-180*24*60*60*1e3);break;case"year":G=new Date(X.getTime()-365*24*60*60*1e3);break;case"custom":if(r.startDate&&r.endDate){const[ie,ge,be]=r.startDate.split("-").map(Number),[Ye,ze,U]=r.endDate.split("-").map(Number);G=new Date(ie,ge-1,be,0,0,0,0),K=new Date(Ye,ze-1,U,23,59,59,999)}else return null;break}if(n.startTime&&n.endTime&&G&&K){const[ie,ge]=n.startTime.split(":").map(Number),[be,Ye]=n.endTime.split(":").map(Number);G.setHours(ie,ge,0,0),K.setHours(be,Ye,59,999)}i!=="all"&&L.push(or("salesPersonId","==",i)),u&&u>0&&L.push(or("total",">=",u)),d&&d>0&&L.push(or("total","<=",d));let q="createdAt";return o==="total"&&(q="total"),o==="profit"&&(q="totalProfit"),L.push(dr(q,l)),t.trim()||e!=="all"?L.push(oc(1e3)):(L.push(oc(c+1)),Y&&L.push(Um(Y))),Bt(W,...L)},[e,r,n,s,i,o,l,c,u,d,t]),P=I.useCallback(B=>{var X;const Y=new Date;let W=null,L=null;switch(e){case"today":W=new Date(Y.getFullYear(),Y.getMonth(),Y.getDate(),0,0,0,0),L=new Date(Y.getFullYear(),Y.getMonth(),Y.getDate(),23,59,59,999);break;case"week":W=new Date(Y.getTime()-7*24*60*60*1e3);break;case"month":W=new Date(Y.getTime()-30*24*60*60*1e3);break;case"3months":W=new Date(Y.getTime()-90*24*60*60*1e3);break;case"6months":W=new Date(Y.getTime()-180*24*60*60*1e3);break;case"year":W=new Date(Y.getTime()-365*24*60*60*1e3);break;case"custom":if(r.startDate&&r.endDate){const[G,K,q]=r.startDate.split("-").map(Number),[ie,ge,be]=r.endDate.split("-").map(Number);W=new Date(G,K-1,q,0,0,0,0),L=new Date(ie,ge-1,be,23,59,59,999)}break}return e==="today"&&B.length>0&&console.log(" Filtro de fecha CLIENT-SIDE:",{dateFilter:e,startDate:W==null?void 0:W.toISOString(),endDate:L==null?void 0:L.toISOString(),totalVentas:B.length,primeraVenta:(X=B[0])==null?void 0:X.createdAt}),B.filter(G=>{if(G.createdAt){if(G.createdAt._methodName==="serverTimestamp")return console.warn(" Venta con timestamp corrupto, ignorando:",G.id),!1;let K;if(typeof G.createdAt=="string"?K=new Date(G.createdAt):G.createdAt.toDate&&typeof G.createdAt.toDate=="function"?K=G.createdAt.toDate():G.createdAt.seconds?K=new Date(G.createdAt.seconds*1e3):K=new Date(G.createdAt),e==="today"&&B.indexOf(G)<3&&console.log(` Venta ${G.id}:`,{createdAt:G.createdAt,createdAtType:typeof G.createdAt,saleDate:K.toISOString(),startDate:W==null?void 0:W.toISOString(),endDate:L==null?void 0:L.toISOString(),pasaInicio:!W||K>=W,pasaFin:!L||K<=L}),W&&K<W||L&&K>L)return!1}if(t.trim()){const K=t.toLowerCase(),q=G.id.toLowerCase().includes(K),ie=G.items.some(be=>be.productName.toLowerCase().includes(K)),ge=G.customerName&&G.customerName.toLowerCase().includes(K);if(!q&&!ie&&!ge)return!1}if(s!=="all"){if(Array.isArray(G.paymentMethods)){if(!G.paymentMethods.some(q=>q.method===s))return!1}else if(G.paymentMethod!==s)return!1}if(h!=="all"){const K=G.profitMargin??0;switch(h){case"high":if(K<=30)return!1;break;case"medium":if(K<15||K>30)return!1;break;case"low":if(K>=15||K<0)return!1;break;case"loss":if(K>=0)return!1;break}}return!0})},[t,s,h,e,r]),O=I.useCallback(async B=>{x(!0),v(null);try{if(!await T(1,null)){y([]),w(!1),k(B>1),S(null),x(!1);return}let W=[];if(t.trim()||e!=="all"){const L=await T(1,null);if(!L){y([]),w(!1),k(!1),S(null);return}const X=f?await jj(L):await Kt(L);console.log(" Bsqueda/Filtros activos - ventas obtenidas:",X.docs.length),W=X.docs.map(ie=>({id:ie.id,...ie.data()})),W=P(W),console.log(" Resultados despus de filtros:",W.length);const G=W.length,K=(B-1)*c,q=K+c;w(q<G),k(B>1),W=W.slice(K,q),S(null)}else{let L=null,X=[],G=null;for(let q=1;q<=B;q++){const ie=await T(q,L);if(!ie){y([]),w(!1),k(B>1),S(null);return}const ge=f?await jj(ie):await Kt(ie);f&&q===1&&console.log(" Obteniendo ventas frescas desde el servidor (sin cach)");const be=ge.docs;q===B&&(X=be),G=be[be.length-1],L=G}W=X.map(q=>({id:q.id,...q.data()})),console.log(" Ventas obtenidas de Firestore:",W.length),W.length>0?console.log(" DEBUG - Primeras 3 ventas con sus fechas:",W.slice(0,3).map(q=>({id:q.id,createdAt:q.createdAt,createdAtType:typeof q.createdAt}))):console.log(" DEBUG - No hay ventas en Firestore con los filtros aplicados");const K=W.length;W=P(W),console.log(` Despus del filtro de fecha: ${W.length} ventas (antes: ${K})`),w(W.length>c),k(B>1),W.length>c&&(W=W.slice(0,c)),S(G)}y(W)}catch(Y){v(Y.message||"Error al cargar ventas")}finally{x(!1)}},[T,c,P,f]);return I.useEffect(()=>{if(e==="custom"&&(!r.startDate||!r.endDate)){console.log(" Limpiando tabla inmediatamente - filtro personalizado sin fechas completas"),y([]),w(!1),k(!1),x(!1),C(1);return}(async()=>{console.log(" Cargando datos con filtros:",{dateFilter:e,customDateRange:r}),C(1),await O(1)})()},[t,e,r,n,s,i,o,l,c,u,d,h,f]),{sales:m,loading:g,error:b,currentPage:_,hasNextPage:N,hasPrevPage:E,nextPage:()=>{N&&(C(B=>B+1),O(_+1))},prevPage:()=>{E&&_>1&&(C(B=>B-1),O(_-1))},setPage:B=>{C(B),O(B)},refetch:()=>O(_)}}function YM({searchTerm:t="",dateFilter:e="today",customDateRange:r={startDate:"",endDate:""},timeRange:n={startTime:"",endTime:""},paymentMethodFilter:s="all",salesPersonFilter:i="all"}){const o=I.useRef(!1),l=I.useRef(!1),c=I.useRef(""),[u,d]=I.useState({totalSales:0,totalProfit:0,totalCost:0,totalDiscounts:0,averageTransaction:0,profitMargin:0,transactionCount:0,loading:!0,error:null,filteredSales:[],periodComparison:null,historicalData:[],topProducts:[],allTimeBest:{totalSales:0,totalProfit:0,bestDay:null,bestMonth:null}}),h=async()=>{if(!o.current){o.current=!0,d(m=>({...m,loading:!0,error:null}));try{if(e==="custom"&&(!r.startDate||!r.endDate)){o.current=!1,d({totalSales:0,totalProfit:0,totalCost:0,totalDiscounts:0,averageTransaction:0,profitMargin:0,transactionCount:0,loading:!1,error:null,filteredSales:[],periodComparison:null,historicalData:[],topProducts:[],allTimeBest:{totalSales:0,totalProfit:0,bestDay:null,bestMonth:null}});return}let m=yt(Pe,"sales"),y=[];const g=new Date;let x=null,b=null;switch(e){case"today":{x=new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0,0),b=new Date(g.getFullYear(),g.getMonth(),g.getDate(),23,59,59,999);break}case"week":x=new Date(g.getTime()-7*24*60*60*1e3);break;case"month":x=new Date(g.getTime()-30*24*60*60*1e3);break;case"3months":x=new Date(g.getTime()-90*24*60*60*1e3);break;case"6months":x=new Date(g.getTime()-180*24*60*60*1e3);break;case"year":x=new Date(g.getTime()-365*24*60*60*1e3);break;case"custom":if(r.startDate&&r.endDate){const[G,K,q]=r.startDate.split("-").map(Number),[ie,ge,be]=r.endDate.split("-").map(Number);x=new Date(G,K-1,q,0,0,0,0),b=new Date(ie,ge-1,be,23,59,59,999)}break}if(n.startTime&&n.endTime&&x&&b){const[G,K]=n.startTime.split(":").map(Number),[q,ie]=n.endTime.split(":").map(Number);x.setHours(G,K,0,0),b.setHours(q,ie,59,999)}s!=="all"&&y.push(or("paymentMethod","==",s)),i!=="all"&&y.push(or("salesPersonId","==",i));const v=Bt(m,...y),S=(await Kt(v)).docs.map(G=>({id:G.id,...G.data()}));let _=S.filter(G=>{if(G.createdAt&&G.createdAt._methodName==="serverTimestamp")return console.warn(" Venta con timestamp corrupto en stats, ignorando:",G.id),!1;if(G.createdAt&&(x||b)){let K;if(typeof G.createdAt=="string"?K=new Date(G.createdAt):G.createdAt.toDate&&typeof G.createdAt.toDate=="function"?K=G.createdAt.toDate():G.createdAt.seconds?K=new Date(G.createdAt.seconds*1e3):K=new Date(G.createdAt),x&&K<x||b&&K>b)return!1}return!0});if(t){const G=t.toLowerCase();_=S.filter(K=>{const q=K.id.toLowerCase().includes(G)||K.items&&K.items.some(ge=>{var be;return(be=ge.productName)==null?void 0:be.toLowerCase().includes(G)});let ie=!1;if(K.createdAt){let ge;typeof K.createdAt=="object"&&K.createdAt!==null&&"seconds"in K.createdAt&&typeof K.createdAt.seconds=="number"?ge=new Date(K.createdAt.seconds*1e3):ge=new Date(K.createdAt),isNaN(ge.getTime())||(ie=ge.toLocaleDateString("es-CO").toLowerCase().includes(G))}return q||ie})}const C=_.reduce((G,K)=>G+(K.finalTotal??K.total??0),0),N=_.reduce((G,K)=>{const q=K.courtesyItems&&K.courtesyItems.length>0;return G+(q?K.realProfit??0:K.totalProfit??0)},0),w=_.reduce((G,K)=>{const q=K.courtesyItems&&K.courtesyItems.length>0;return G+(q?K.realTotalCost??0:K.totalCost??0)},0),E=_.reduce((G,K)=>G+(K.discount??0),0),k=_.length>0?C/_.length:0,P=_.filter(G=>(G.finalTotal??G.total??0)>0).reduce((G,K)=>G+(K.finalTotal??K.total??0),0),O=P>0?N/P*100:0,D=G=>{const K=new Map;return G.forEach(q=>{let ie;if(typeof q.createdAt=="object"&&q.createdAt!==null&&"seconds"in q.createdAt?ie=new Date(q.createdAt.seconds*1e3):ie=new Date(q.createdAt),!isNaN(ie.getTime())){const ge=`${ie.getFullYear()}-${String(ie.getMonth()+1).padStart(2,"0")}`,be=K.get(ge)||{period:ge,totalSales:0,totalProfit:0,transactionCount:0,profitMargin:0},Ye=q.courtesyItems&&q.courtesyItems.length>0;be.totalSales+=q.finalTotal??q.total??0,be.totalProfit+=Ye?q.realProfit??0:q.totalProfit??0,be.transactionCount+=1,K.set(ge,be)}}),K.forEach(q=>{q.profitMargin=q.totalSales>0?q.totalProfit/q.totalSales*100:0}),Array.from(K.values()).sort((q,ie)=>q.period.localeCompare(ie.period))},R=G=>{const K=new Map;return G.forEach(q=>{var ie;(ie=q.items)==null||ie.forEach(ge=>{const be=K.get(ge.productId)||{productId:ge.productId,productName:ge.productName,totalSold:0,totalRevenue:0,totalProfit:0};be.totalSold+=ge.quantity||0,be.totalRevenue+=ge.totalRevenue||0,be.totalProfit+=ge.profit||0,K.set(ge.productId,be)})}),Array.from(K.values()).sort((q,ie)=>ie.totalRevenue-q.totalRevenue).slice(0,10)},B=G=>{const K=new Map,q=new Map;let ie=0,ge=0;G.forEach(ze=>{const U=ze.finalTotal??ze.total??0;ie+=U,ge+=ze.totalProfit??0;let Q;if(typeof ze.createdAt=="object"&&ze.createdAt!==null&&"seconds"in ze.createdAt?Q=new Date(ze.createdAt.seconds*1e3):Q=new Date(ze.createdAt),!isNaN(Q.getTime())){const re=Q.toISOString().split("T")[0],te=`${Q.getFullYear()}-${String(Q.getMonth()+1).padStart(2,"0")}`;K.set(re,(K.get(re)||0)+U),q.set(te,(q.get(te)||0)+U)}});let be=null;K.forEach((ze,U)=>{(!be||ze>be.amount)&&(be={date:U,amount:ze})});let Ye=null;return q.forEach((ze,U)=>{(!Ye||ze>Ye.amount)&&(Ye={month:U,amount:ze})}),{totalSales:ie,totalProfit:ge,bestDay:be,bestMonth:Ye}},Y=D(_),W=R(_),L=B(_);d({totalSales:C,totalProfit:N,totalCost:w,totalDiscounts:E,averageTransaction:k,profitMargin:O,transactionCount:_.length,loading:!1,error:null,filteredSales:_,periodComparison:null,historicalData:Y,topProducts:W,allTimeBest:L}),o.current=!1}catch(m){o.current=!1,d(y=>({...y,loading:!1,error:m.message||"Error al calcular totales"}))}}},f=I.useCallback(()=>{h()},[]);return I.useEffect(()=>{e==="custom"&&(!r.startDate||!r.endDate)&&d({totalSales:0,totalProfit:0,totalCost:0,totalDiscounts:0,averageTransaction:0,profitMargin:0,transactionCount:0,loading:!1,error:null,filteredSales:[],periodComparison:null,historicalData:[],topProducts:[],allTimeBest:{totalSales:0,totalProfit:0,bestDay:null,bestMonth:null}})},[e,r.startDate,r.endDate]),I.useEffect(()=>{const m=JSON.stringify({searchTerm:t,dateFilter:e,startDate:r.startDate,endDate:r.endDate,timeRange:n,paymentMethodFilter:s,salesPersonFilter:i});if(!(m===c.current&&l.current))if(c.current=m,l.current=!0,t){const y=setTimeout(()=>{h()},300);return()=>clearTimeout(y)}else h()},[t,e,r.startDate,r.endDate,n,s,i]),{...u,refetch:f}}function xG({searchTerm:t="",dateFilter:e="today",customDateRange:r={startDate:"",endDate:""},timeRange:n={startTime:"",endTime:""},paymentMethodFilter:s="all",salesPersonFilter:i="all"}){const[o,l]=I.useState({totalSales:0,totalProfit:0,totalCost:0,totalDiscounts:0,averageTransaction:0,profitMargin:0,transactionCount:0,loading:!0,error:null}),c=Xt(h=>h.firebase.products.items),u=Xt(h=>h.firebase.categories.items),d=I.useCallback(async()=>{l(h=>({...h,loading:!0,error:null}));try{if(e==="custom"&&(!r.startDate||!r.endDate)){l({totalSales:0,totalProfit:0,totalCost:0,totalDiscounts:0,averageTransaction:0,profitMargin:0,transactionCount:0,loading:!1,error:null});return}const h=u.find(P=>{const O=P.name.toLowerCase();return O.includes("celular")||O.includes("mvil")||O.includes("movil")||O.includes("telfono")||O.includes("telefono")||O.includes("phone")||O.includes("smartphone")}),f=h?c.filter(P=>P.categoryId===h.id).map(P=>P.id):[];if(f.length===0){l({totalSales:0,totalProfit:0,totalCost:0,totalDiscounts:0,averageTransaction:0,profitMargin:0,transactionCount:0,loading:!1,error:null});return}let m=yt(Pe,"sales"),y=[];const g=new Date;let x=null,b=null;switch(e){case"today":{x=new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0,0),b=new Date(g.getFullYear(),g.getMonth(),g.getDate(),23,59,59,999);break}case"week":x=new Date(g.getTime()-7*24*60*60*1e3);break;case"month":x=new Date(g.getTime()-30*24*60*60*1e3);break;case"3months":x=new Date(g.getTime()-90*24*60*60*1e3);break;case"6months":x=new Date(g.getTime()-180*24*60*60*1e3);break;case"year":x=new Date(g.getTime()-365*24*60*60*1e3);break;case"custom":if(r.startDate&&r.endDate){const[P,O,D]=r.startDate.split("-").map(Number),[R,B,Y]=r.endDate.split("-").map(Number);x=new Date(P,O-1,D,0,0,0,0),b=new Date(R,B-1,Y,23,59,59,999)}break}if(n.startTime&&n.endTime&&x&&b){const[P,O]=n.startTime.split(":").map(Number),[D,R]=n.endTime.split(":").map(Number);x.setHours(P,O,0,0),b.setHours(D,R,59,999)}s!=="all"&&y.push(or("paymentMethod","==",s)),i!=="all"&&y.push(or("salesPersonId","==",i));const v=Bt(m,...y);let S=(await Kt(v)).docs.map(P=>({id:P.id,...P.data()}));S=S.filter(P=>{if(P.createdAt&&P.createdAt._methodName==="serverTimestamp")return!1;if(P.createdAt&&(x||b)){let O;if(typeof P.createdAt=="string"?O=new Date(P.createdAt):P.createdAt.toDate&&typeof P.createdAt.toDate=="function"?O=P.createdAt.toDate():P.createdAt.seconds?O=new Date(P.createdAt.seconds*1e3):O=new Date(P.createdAt),x&&O<x||b&&O>b)return!1}return!0});let _=0,C=0,N=0,w=0,E=0;S.forEach(P=>{var D,R;if(P.isLayaway||P.type==="layaway_payment")return;const O=((D=P.items)==null?void 0:D.filter(B=>f.includes(B.productId)))||[];if(O.length>0){const B=O.reduce((ie,ge)=>ie+(ge.totalRevenue||0),0),Y=O.reduce((ie,ge)=>ie+(ge.profit||0),0),W=O.reduce((ie,ge)=>ie+(ge.totalCost||0),0),L=((R=P.items)==null?void 0:R.reduce((ie,ge)=>ie+(ge.totalRevenue||0),0))||0;let X=0,G=0;if(L>0){const ie=B/L;X=(P.discount||0)*ie,w+=X,G=(P.customerSurcharge||0)*ie}const K=B-X+G;_+=K;const q=K-W;C+=q,N+=W,E+=1}});const k=E>0?_/E:0,T=_>0?C/_*100:0;l({totalSales:_,totalProfit:C,totalCost:N,totalDiscounts:w,averageTransaction:k,profitMargin:T,transactionCount:E,loading:!1,error:null})}catch(h){console.error("Error en estadsticas de celulares:",h),l(f=>({...f,loading:!1,error:h.message||"Error al calcular estadsticas de celulares"}))}},[t,e,r.startDate,r.endDate,n.startTime,n.endTime,s,i,c,u]);return I.useEffect(()=>{e==="custom"&&(!r.startDate||!r.endDate)&&l({totalSales:0,totalProfit:0,totalCost:0,totalDiscounts:0,averageTransaction:0,profitMargin:0,transactionCount:0,loading:!1,error:null})},[e,r.startDate,r.endDate]),I.useEffect(()=>{d()},[d]),{...o,refetch:d}}rl("sales/processSale",async(t,{dispatch:e})=>(e(PB(t)),t.items.forEach(r=>{e(o_({productId:r.productId,quantityChange:-r.quantity}))}),t));const vG=rl("sales/processProductReturn",async({saleId:t,productId:e,returnQuantity:r},{dispatch:n,getState:s})=>{const i=s(),o=i.firebase.sales.items.find(m=>m.id===t);if(!o)throw new Error("Venta no encontrada");const l=o.items.findIndex(m=>m.productId===e);if(l===-1)throw new Error("Producto no encontrado en la venta");const c=o.items[l];if(r>c.quantity)throw new Error("No se puede devolver ms cantidad de la vendida");const u=[...o.items];if(r===c.quantity)u.splice(l,1);else{const m=c.quantity-r;u[l]={...c,quantity:m,totalCost:c.purchasePrice*m,totalRevenue:c.salePrice*m,profit:c.salePrice*m-c.purchasePrice*m}}const d=Ff.calculateSaleTotal(u,o.discount),h={items:u,subtotal:d.subtotal,total:d.total,totalCost:d.totalCost,totalProfit:d.totalProfit,profitMargin:d.profitMargin};await Xo.update(t,h);const f=i.firebase.products.items.find(m=>m.id===e);return f&&await La.update(e,{stock:f.stock+r}),n(TB({id:t,updates:h})),n(o_({productId:e,quantityChange:r})),{saleId:t,productId:e,returnQuantity:r,updatedSale:{...o,items:u,...d}}}),bG=rl("sales/deleteSale",async(t,{dispatch:e,getState:r})=>{const s=r().firebase.sales.items.find(i=>i.id===t);if(!s)throw new Error("Venta no encontrada");return await Xo.delete(t),e(AB(t)),s.items.forEach(i=>{e(o_({productId:i.productId,quantityChange:i.quantity}))}),{saleId:t,deletedSale:s}}),Aj=rl("customers/fetchCustomers",async(t,{dispatch:e})=>{try{e(i0(!0));const r=await Mn.getAll();e(Kw(r))}catch(r){e(Qw(r.message||"Error al cargar clientes"))}finally{e(i0(!1))}}),wG=Object.freeze(Object.defineProperty({__proto__:null,fetchCustomers:Aj},Symbol.toStringTag,{value:"Module"}));function hh(t){if(!t)return null;if(typeof t.toDate=="function")return t.toDate();const e=new Date(t);return isNaN(e.getTime())?null:e}function jG(){var Wa,_n,Sn,Ar,hn,Ir,Hr,kr;const[t,e]=I.useState(""),[r,n]=I.useState("today"),[s,i]=I.useState({startDate:"",endDate:""}),[o,l]=I.useState({startTime:"",endTime:""}),[c,u]=I.useState(!1),[d,h]=I.useState("all"),[f,m]=I.useState("all"),[y,g]=I.useState("general"),[x,b]=I.useState("date"),[v,j]=I.useState("desc"),[S,_]=I.useState(null),[C,N]=I.useState(!1),[w,E]=I.useState(null),[k,T]=I.useState(null),[P,O]=I.useState(null),[D,R]=I.useState(!1),[B,Y]=I.useState([]),W=10,L=I.useMemo(()=>c?o:{startTime:"",endTime:""},[c,o.startTime,o.endTime]),X=Hm(),G=Xt(F=>F.firebase.customers.items),K=Xt(F=>F.firebase.customers.loading);ma();const q=wc();ee.useEffect(()=>{G.length===0&&!K&&X(Aj())},[X,G.length,K]),ee.useEffect(()=>{(async()=>{try{const ae=yt(Pe,"users"),Se=(await Kt(ae)).docs.map(Oe=>({...Oe.data(),uid:Oe.data().uid||Oe.id}));Y(Se)}catch(ae){console.error("Error loading users:",ae)}})()},[]);const ie=(F,ae,me)=>{O({show:!0,type:F,title:ae,message:me}),setTimeout(()=>{O(null)},4e3)},{sales:ge,loading:be,error:Ye,currentPage:ze,hasNextPage:U,hasPrevPage:Q,nextPage:re,prevPage:te,setPage:pe,refetch:xe}=yG({searchTerm:t,dateFilter:r,customDateRange:s,timeRange:L,paymentMethodFilter:d,salesPersonFilter:f,sortBy:x,sortOrder:v,itemsPerPage:W,useFreshData:q.needsFreshSalesData}),he=r==="custom"&&(!s.startDate||!s.endDate)?[]:ge;ee.useEffect(()=>{!be&&q.needsFreshSalesData&&q.markSalesDataAsRead()},[be,q]);const{refetch:Le,filteredSales:qe,...De}=YM({searchTerm:t,dateFilter:r,customDateRange:s,timeRange:L,paymentMethodFilter:d,salesPersonFilter:f}),ne=xG({searchTerm:t,dateFilter:r,customDateRange:s,timeRange:L,paymentMethodFilter:d,salesPersonFilter:f}),oe=F=>{switch(F){case"efectivo":return{name:"Efectivo",icon:Zh,color:"text-green-600",bgColor:"bg-green-100"};case"transferencia":return{name:"Transferencia",icon:Sl,color:"text-blue-600",bgColor:"bg-blue-100"};case"tarjeta":return{name:"Tarjeta",icon:ef,color:"text-purple-600",bgColor:"bg-purple-100"};case"crdito":case"credit":return{name:"Crdito",icon:$i,color:"text-orange-600",bgColor:"bg-orange-100"};default:return{name:F,icon:Wt,color:"text-gray-600",bgColor:"bg-gray-100"}}},Ce=I.useMemo(()=>{const F={};return!qe||!Array.isArray(qe)||qe.forEach(ae=>{const me=ae.finalTotal||ae.total||0;if(Array.isArray(ae.paymentMethods)&&ae.paymentMethods.length>0)ae.paymentMethods.forEach(Se=>{const Oe=Se.method||"efectivo";F[Oe]=(F[Oe]||0)+Se.amount});else{const Se=ae.paymentMethod||"efectivo";F[Se]=(F[Se]||0)+me}}),F},[qe]),ke=F=>{x===F?j(v==="asc"?"desc":"asc"):(b(F),j("desc")),xe()},ue=F=>{n(F),i(F!=="custom"?{startDate:"",endDate:""}:{startDate:"",endDate:""}),F!=="today"&&F!=="custom"&&(u(!1),l({startTime:"",endTime:""})),pe(1)},se=(F,ae)=>{const me={...s,[F]:ae};if(me.startDate&&me.endDate){const Se=pt(me.startDate),Oe=pt(me.endDate);if((Oe.getTime()-Se.getTime())/(1e3*3600*24)>365)if(F==="endDate"){const ce=new Date(Oe);ce.setFullYear(ce.getFullYear()-1),me.startDate=ce.toISOString().split("T")[0]}else{const ce=new Date(Se);ce.setFullYear(ce.getFullYear()+1),me.endDate=ce.toISOString().split("T")[0]}}i(me),pe(1)},We=()=>{i({startDate:"",endDate:""}),l({startTime:"",endTime:""}),u(!1),n("today"),pe(1)},Ae=(F,ae,me,Se,Oe=0)=>{E({show:!0,saleId:F,productId:ae,productName:me,productSalePrice:Oe,maxQuantity:Se,quantity:1,selectedCustomerId:"",customerSearch:""})},it=F=>{T({show:!0,saleId:F.id,saleData:F})},ut=async()=>{var F,ae,me;if(k){R(!0);try{if((F=k==null?void 0:k.saleData)!=null&&F.isLayaway&&((ae=k==null?void 0:k.saleData)!=null&&ae.layawayId))try{const{layawaysService:Se}=await gn(async()=>{const{layawaysService:Z}=await Promise.resolve().then(()=>Oa);return{layawaysService:Z}},void 0),H=(await Se.getAll()).find(Z=>Z.id===k.saleData.layawayId);if(H){const Z=H.payments.find(ce=>ce.amount===k.saleData.total);if(Z){const ce=H.payments.filter(ot=>ot.id!==Z.id),fe=ce.reduce((ot,Te)=>ot+Te.amount,0),Ne=H.totalAmount-fe;let Ve=H.status,_e=H.items;H.status==="completed"&&Ne>0&&(Ve="active",_e=H.items.map(ot=>{var It;const Te=((It=ot.pickedUpHistory)==null?void 0:It.filter(xt=>xt.notes!=="Marcado automticamente como recogido al completar el pago"))||[],Fe=Te.reduce((xt,Dt)=>xt+Dt.quantity,0);return{...ot,pickedUpQuantity:Fe,pickedUpHistory:Te}}));const Xe={payments:ce,remainingBalance:Ne,status:Ve};Ve==="active"&&H.status==="completed"&&(Xe.items=_e),await Se.update(H.id,Xe)}}}catch(Se){console.error("Error eliminando abono en plan separe:",Se)}await X(bG(k.saleId)).unwrap(),S&&S.id===k.saleId&&_(null),xe(),Le(),T(null),ie("success","Venta eliminada",(me=k==null?void 0:k.saleData)!=null&&me.isLayaway?"El abono ha sido eliminado exitosamente del plan separe y del historial de ventas.":"La venta ha sido eliminada exitosamente. El inventario ha sido restaurado.")}catch(Se){ie("error","Error al eliminar",Se.message||"Error desconocido al eliminar la venta")}finally{R(!1)}}},mt=async()=>{if(w){R(!0);try{const F=w.productSalePrice*w.quantity;if(await X(vG({saleId:w.saleId,productId:w.productId,returnQuantity:w.quantity})).unwrap(),w.selectedCustomerId){const ae=G.find(me=>me.id===w.selectedCustomerId);if(ae){const me=(ae.credit||0)+F;await Mn.update(w.selectedCustomerId,{credit:me}),X(Aj()),ie("success","Producto devuelto",`El producto ha sido devuelto exitosamente. Se han agregado ${V(F)} al saldo a favor de ${ae.name}. El inventario ha sido actualizado.`)}else ie("success","Producto devuelto","El producto ha sido devuelto exitosamente. El inventario ha sido actualizado.")}else ie("success","Producto devuelto","El producto ha sido devuelto exitosamente. El inventario ha sido actualizado.");S&&S.id===w.saleId&&_(null),xe(),Le(),E(null)}catch(F){ie("error","Error en devolucin",F.message||"Error desconocido al procesar la devolucin")}finally{R(!1)}}};function pt(F){const[ae,me,Se]=F.split("-").map(Number);return new Date(ae,me-1,Se,0,0,0,0)}const gt=()=>{if(r==="custom"&&(s.startDate||s.endDate)){const F=s.startDate?pt(s.startDate).toLocaleDateString():"Inicio",ae=s.endDate?pt(s.endDate).toLocaleDateString():"Fin";let me=`${F} - ${ae}`;return c&&o.startTime&&o.endTime&&(me+=` (${o.startTime} - ${o.endTime})`),me}return""},lr=F=>{if(F.paymentMethods&&F.paymentMethods.length>1){if(F.paymentMethods.some(me=>String(me.method)==="credit")){const me=F.paymentMethods.map(H=>dn(H.method)),Se=me.filter(H=>H==="Saldo a favor"),Oe=me.filter(H=>H!=="Saldo a favor");return`Pagos mltiples: ${Se.join(" + ")}${Oe.length>0?" + "+Oe.join(" + "):""}`}return`Mltiples mtodos: ${F.paymentMethods.map(me=>dn(me.method)).join(" + ")}`}return F.paymentMethods&&F.paymentMethods.length===1?dn(F.paymentMethods[0].method):dn(F.paymentMethod)},dn=F=>{switch(F){case"efectivo":return"Efectivo";case"transferencia":return"Transferencia";case"tarjeta":return"Tarjeta";case"crdito":return"Crdito";case"credit":return"Saldo a favor";default:return F}},qr=F=>{if(F.paymentMethods&&F.paymentMethods.length>1)return"bg-purple-100 text-purple-800";switch(F.paymentMethods&&F.paymentMethods.length===1?F.paymentMethods[0].method:F.paymentMethod){case"efectivo":return"bg-green-100 text-green-800";case"transferencia":return"bg-purple-100 text-purple-800";case"tarjeta":return"bg-blue-100 text-blue-800";case"crdito":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},Tr=()=>{const F=["Fecha","ID Venta","Productos","Subtotal","Descuento","Total","Costo","Ganancia","Margen %","Mtodo de Pago","Vendedor"],ae=he.map(Z=>{if(Z.type==="layaway_payment"||Z.type==="technical_service_payment"||Z.type==="layaway_delivery"){const ce=Z.total??0,fe=Z.totalCost??0,Ne=ce-fe,Ve=fe>0?Ne/fe*100:0;return[new Date(Z.createdAt).toLocaleDateString(),Z.id,Z.type==="layaway_payment"?"Abono a plan separe":Z.type==="technical_service_payment"?"Pago servicio tcnico":"Entrega de plan separe",Cs(Z.subtotal??0),Cs(Z.discount??0),Cs(Z.total??0),Cs(Z.totalCost??0),Cs(Ne),Ve.toFixed(1),lr(Z),Z.salesPersonName||"N/A"]}return[new Date(Z.createdAt).toLocaleDateString(),Z.id,Z.items.map(ce=>`${ce.quantity}x ${ce.productName}`).join("; "),Cs(Z.subtotal??0),Cs(Z.discount??0),Cs(Z.total??0),Cs(Z.totalCost??0),Cs(Z.totalProfit??0),(Z.profitMargin??0).toFixed(1),lr(Z),Z.salesPersonName||"N/A"]}),me=[F,...ae].map(Z=>Z.map(ce=>`"${ce}"`).join(",")).join(`
`),Se=new Blob([me],{type:"text/csv;charset=utf-8;"}),Oe=document.createElement("a"),H=URL.createObjectURL(Se);Oe.setAttribute("href",H),Oe.setAttribute("download",`historial-ventas-${new Date().toISOString().split("T")[0]}.csv`),Oe.style.visibility="hidden",document.body.appendChild(Oe),Oe.click(),document.body.removeChild(Oe)};return a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"mb-4 pt-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestin de Ventas"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Consulta y analiza todas las transacciones realizadas"})]}),a.jsxs("button",{onClick:Tr,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[a.jsx(BM,{className:"h-5 w-5"}),a.jsx("span",{children:"Exportar CSV"})]})]})}),a.jsx("div",{className:"border-b border-gray-200 mb-6",children:a.jsxs("nav",{className:"-mb-px flex",children:[a.jsx("button",{onClick:()=>g("general"),className:`px-6 py-3 text-sm font-medium border-b-2 ${y==="general"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Estadsticas Generales"}),a.jsx("button",{onClick:()=>g("cellphones"),className:`px-6 py-3 text-sm font-medium border-b-2 ${y==="cellphones"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Ventas de Celulares"})]})}),y==="general"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"rounded-xl p-4 border border-gray-100 shadow-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:" Estadsticas Generales"}),a.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full font-medium",children:"Mismo perodo"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7 gap-4",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ga,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Transacciones"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:De.transactionCount})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Wt,{className:"w-3 h-3 text-emerald-600 group-hover:text-emerald-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Ventas Totales"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(De.totalSales)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-orange-500/10 hover:-translate-y-0.5 hover:border-orange-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-orange-50 rounded flex items-center justify-center group-hover:bg-orange-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(CP,{className:"w-3 h-3 text-orange-600 group-hover:text-orange-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Descuentos"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-orange-900 transition-colors duration-300",children:V(De.totalDiscounts)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-green-500/10 hover:-translate-y-0.5 hover:border-green-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-green-50 rounded flex items-center justify-center group-hover:bg-green-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ds,{className:"w-3 h-3 text-green-600 group-hover:text-green-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Ganancia Total"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-green-900 transition-colors duration-300",children:V(De.totalProfit)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-red-500/10 hover:-translate-y-0.5 hover:border-red-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-red-50 rounded flex items-center justify-center group-hover:bg-red-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ea,{className:"w-3 h-3 text-red-600 group-hover:text-red-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Costo Total"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-red-900 transition-colors duration-300",children:V(De.totalCost)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-purple-500/10 hover:-translate-y-0.5 hover:border-purple-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-purple-50 rounded flex items-center justify-center group-hover:bg-purple-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Rr,{className:"w-3 h-3 text-purple-600 group-hover:text-purple-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Promedio/Venta"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-purple-900 transition-colors duration-300",children:V(De.averageTransaction)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-indigo-500/10 hover:-translate-y-0.5 hover:border-indigo-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-indigo-50 rounded flex items-center justify-center group-hover:bg-indigo-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ga,{className:"w-3 h-3 text-indigo-600 group-hover:text-indigo-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Margen Promedio"}),a.jsxs("p",{className:"text-base font-bold text-slate-900 group-hover:text-indigo-900 transition-colors duration-300",children:[De.profitMargin.toFixed(1),"%"]})]})})]})]}),Object.keys(Ce).length>0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[" Ingresos por Mtodo de Pago",a.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full font-medium",children:"Perodo filtrado"})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Desglose exacto de ingresos reales por cada mtodo de pago"})]}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(Ce).sort(([,F],[,ae])=>ae-F).map(([F,ae])=>{const me=oe(F),Se=me.icon;return a.jsxs("div",{className:"flex items-center p-4 rounded-lg border border-gray-200 hover:border-gray-300 transition-colors",children:[a.jsx("div",{className:`p-2 rounded-full ${me.bgColor}`,children:a.jsx(Se,{className:`h-5 w-5 ${me.color}`})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:me.name}),a.jsx("p",{className:"text-lg font-bold text-gray-900",children:V(ae)})]})]},F)})})})]}),a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"relative md:col-span-2",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar por producto, cliente o ID de venta...",value:t,onChange:F=>e(F.target.value),className:"w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsxs("select",{value:r,onChange:F=>ue(F.target.value),className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none text-sm",children:[a.jsx("option",{value:"today",children:"Hoy"}),a.jsx("option",{value:"week",children:"ltima semana"}),a.jsx("option",{value:"month",children:"ltimo mes"}),a.jsx("option",{value:"3months",children:"ltimos 3 meses"}),a.jsx("option",{value:"6months",children:"ltimos 6 meses"}),a.jsx("option",{value:"year",children:"ltimos 12 meses"}),a.jsx("option",{value:"custom",children:"Rango personalizado"})]})]}),a.jsxs("select",{value:d,onChange:F=>h(F.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"all",children:"Todos"}),a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]}),a.jsxs("select",{value:f,onChange:F=>m(F.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"all",children:"Vendedores"}),B.map(F=>a.jsx("option",{value:F.uid,children:F.displayName||F.email},F.uid))]}),a.jsxs("select",{value:`${x}-${v}`,onChange:F=>{const[ae,me]=F.target.value.split("-");b(ae),j(me)},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"date-desc",children:"Ms recientes"}),a.jsx("option",{value:"date-asc",children:"Ms antiguos"}),a.jsx("option",{value:"total-desc",children:"Mayor monto"}),a.jsx("option",{value:"total-asc",children:"Menor monto"}),a.jsx("option",{value:"profit-desc",children:"Mayor ganancia"}),a.jsx("option",{value:"profit-asc",children:"Menor ganancia"})]})]}),(r==="today"||r==="custom")&&a.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("input",{type:"checkbox",id:"enable-time-filter",checked:c,onChange:F=>{u(F.target.checked),F.target.checked||l({startTime:"",endTime:""})},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-blue-300 rounded"}),a.jsx("label",{htmlFor:"enable-time-filter",className:"text-sm font-medium text-gray-700",children:"Filtrar por horas especficas"})]}),c&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 text-sm font-medium text-blue-800",children:"Hora de Inicio:"}),a.jsxs("div",{className:"flex",children:[a.jsxs("select",{value:o.startTime?o.startTime.split(":")[0]:"",onChange:F=>{const ae=F.target.value,me=o.startTime?o.startTime.split(":")[1]:"00",Se=ae?`${ae}:${me}`:"";o.endTime&&Se>o.endTime?l(Oe=>({...Oe,startTime:Se,endTime:Se})):l(Oe=>({...Oe,startTime:Se}))},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-l-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",children:[a.jsx("option",{value:"",children:"Hora"}),Array.from({length:24},(F,ae)=>a.jsx("option",{value:ae.toString().padStart(2,"0"),children:ae.toString().padStart(2,"0")},ae))]}),a.jsx("div",{className:"flex items-center px-3 bg-gray-50 border-t border-b border-gray-300",children:a.jsx("span",{className:"text-gray-500",children:":"})}),a.jsxs("select",{value:o.startTime?o.startTime.split(":")[1]:"",onChange:F=>{const ae=F.target.value,me=o.startTime?o.startTime.split(":")[0]:"00",Se=ae!==""?`${me}:${ae}`:"";o.endTime&&Se>o.endTime?l(Oe=>({...Oe,startTime:Se,endTime:Se})):l(Oe=>({...Oe,startTime:Se}))},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-r-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",children:[a.jsx("option",{value:"",children:"Min"}),["00","15","30","45"].map(F=>a.jsx("option",{value:F,children:F},F))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 text-sm font-medium text-blue-800",children:"Hora de Fin:"}),a.jsxs("div",{className:"flex",children:[a.jsxs("select",{value:o.endTime?o.endTime.split(":")[0]:"",onChange:F=>{const ae=F.target.value,me=o.endTime?o.endTime.split(":")[1]:"00",Se=ae?`${ae}:${me}`:"";l(Oe=>({...Oe,endTime:Se}))},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-l-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",children:[a.jsx("option",{value:"",children:"Hora"}),Array.from({length:24},(F,ae)=>{const me=ae.toString().padStart(2,"0"),Se=o.startTime?me<o.startTime.split(":")[0]:!1;return a.jsx("option",{value:me,disabled:Se,children:me},ae)})]}),a.jsx("div",{className:"flex items-center px-3 bg-gray-50 border-t border-b border-gray-300",children:a.jsx("span",{className:"text-gray-500",children:":"})}),a.jsxs("select",{value:o.endTime?o.endTime.split(":")[1]:"",onChange:F=>{const ae=F.target.value,me=o.endTime?o.endTime.split(":")[0]:"00",Se=ae!==""?`${me}:${ae}`:"";l(Oe=>({...Oe,endTime:Se}))},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-r-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",children:[a.jsx("option",{value:"",children:"Min"}),["00","15","30","45"].map(F=>a.jsx("option",{value:F,children:F},F))]})]})]})]})]}),r==="custom"&&a.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(_0,{className:"h-5 w-5 text-blue-600 mr-2"}),a.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Seleccionar Rango de Fechas"})]}),(s.startDate||s.endDate)&&a.jsxs("button",{onClick:We,className:"text-blue-600 hover:text-blue-800 text-sm flex items-center",children:[a.jsx(ct,{className:"h-4 w-4 mr-1"}),"Limpiar"]})]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-1",children:"Fecha de Inicio"}),a.jsx("input",{type:"date",value:s.startDate,onChange:F=>se("startDate",F.target.value),max:s.endDate||new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",title:"Fecha de inicio (mximo 1 ao de rango)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-1",children:"Fecha de Fin"}),a.jsx("input",{type:"date",value:s.endDate,onChange:F=>se("endDate",F.target.value),min:s.startDate,max:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",title:"Fecha de fin (mximo 1 ao de rango)"})]})]})}),gt()&&a.jsxs("div",{className:"mt-3 p-2 bg-blue-100 rounded text-sm text-blue-800",children:[a.jsx("strong",{children:"Rango seleccionado:"})," ",gt()]}),a.jsx("div",{className:"mt-3 bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:" Nota:"})," Por rendimiento, el rango personalizado est limitado a un mximo de 1 ao."]})})]}),(t||r!=="month"||d!=="all"||f!=="all")&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-2 border-t border-gray-200",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Filtros activos:"}),t&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:['Bsqueda: "',t,'"',a.jsx("button",{onClick:()=>e(""),className:"ml-1 text-blue-600 hover:text-blue-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),r!=="month"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[r==="custom"?`Rango: ${gt()}`:r==="today"?"Hoy":r==="week"?"ltima semana":r==="3months"?"ltimos 3 meses":r==="6months"?"ltimos 6 meses":r==="year"?"ltimos 12 meses":"Personalizado",a.jsx("button",{onClick:()=>ue("month"),className:"ml-1 text-green-600 hover:text-green-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),d!=="all"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[dn(d),a.jsx("button",{onClick:()=>h("all"),className:"ml-1 text-purple-600 hover:text-purple-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),f!=="all"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:["Vendedor: ",((Wa=B.find(F=>F.uid===f))==null?void 0:Wa.displayName)||((_n=B.find(F=>F.uid===f))==null?void 0:_n.email)||"Desconocido",a.jsx("button",{onClick:()=>m("all"),className:"ml-1 text-indigo-600 hover:text-indigo-800",children:a.jsx(ct,{className:"h-3 w-3"})})]})]})]})}),be?a.jsx("div",{className:"flex justify-center items-center py-12",children:a.jsx("span",{className:"text-gray-500",children:"Cargando ventas..."})}):Ye?a.jsx("div",{className:"flex justify-center items-center py-12 text-red-600",children:Ye}):a.jsx("div",{className:"grid gap-3 sm:hidden",children:he.map(F=>a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Wt,{className:"w-3 h-3 text-emerald-600 group-hover:text-emerald-700"})}),a.jsxs("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:["Venta #",F.id.substring(0,8)]}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(F.finalTotal??F.total??0)}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("div",{className:"text-xs text-slate-500",children:[(()=>{const ae=hh(F.createdAt);return ae?ae.toLocaleDateString():"-"})(),"  ",F.salesPersonName||"Sin vendedor"]}),a.jsxs("div",{className:"text-xs text-slate-600",children:[F.type==="layaway_payment"?"Abono plan separe":F.type==="technical_service_payment"?"Servicio tcnico":F.type==="layaway_delivery"?"Entrega plan separe":`${F.items.length} producto${F.items.length!==1?"s":""}`,F.courtesyItems&&F.courtesyItems.length>0&&a.jsxs("span",{className:"ml-1 text-cyan-600",children:["+ ",F.courtesyItems.length," "]})]}),(()=>{const ae=F.courtesyItems&&F.courtesyItems.length>0,me=ae?F.realProfit??0:F.totalProfit??0,Se=ae?(F.realProfit??0)/(F.realTotalCost??1)*100:F.profitMargin??0,Oe=me<0;return a.jsxs("div",{className:"flex justify-center items-center space-x-3 text-xs",children:[a.jsxs("span",{className:`font-medium ${Oe?"text-red-600":"text-green-600"}`,children:[Oe?"":"+",V(me)]}),a.jsxs("span",{className:"text-orange-600 font-medium",children:[Se.toFixed(1),"%"]})]})})(),a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${qr(F)}`,children:F.paymentMethods&&F.paymentMethods.length>1?"Mltiples":lr(F)}),a.jsxs("div",{className:"flex gap-1 justify-center mt-2",children:[a.jsxs("button",{onClick:()=>_(F),disabled:D,className:"group/btn bg-blue-50 hover:bg-blue-100 text-blue-600 hover:text-blue-700 px-2 py-1 rounded transition-all duration-300 ease-out text-xs font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105",title:"Ver detalles",children:[a.jsx(os,{className:"h-3 w-3 group-hover/btn:scale-110 transition-transform duration-300"}),"Ver"]}),a.jsxs("button",{onClick:()=>it(F),disabled:D,className:"group/btn bg-red-50 hover:bg-red-100 text-red-600 hover:text-red-700 px-2 py-1 rounded transition-all duration-300 ease-out text-xs font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105",title:"Eliminar venta",children:[a.jsx(rs,{className:"h-3 w-3 group-hover/btn:scale-110 transition-transform duration-300"}),"Eliminar"]})]})]})]})},F.id))}),be?a.jsx("div",{className:"hidden sm:flex justify-center items-center py-12",children:a.jsx("span",{className:"text-gray-500",children:"Cargando ventas..."})}):Ye?a.jsx("div",{className:"hidden sm:flex justify-center items-center py-12 text-red-600",children:Ye}):a.jsxs("div",{className:"hidden sm:block bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto w-full",children:a.jsxs("table",{className:"min-w-full w-full table-fixed",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("button",{onClick:()=>ke("date"),className:"flex items-center space-x-1 hover:text-gray-700",children:[a.jsx("span",{children:"Fecha"}),x==="date"&&(v==="desc"?a.jsx(Da,{className:"h-4 w-4"}):a.jsx(Is,{className:"h-4 w-4"}))]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Productos"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subtotal"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descuento"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("button",{onClick:()=>ke("total"),className:"flex items-center space-x-1 hover:text-gray-700",children:[a.jsx("span",{children:"Total"}),x==="total"&&(v==="desc"?a.jsx(Da,{className:"h-4 w-4"}):a.jsx(Is,{className:"h-4 w-4"}))]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("button",{onClick:()=>ke("profit"),className:"flex items-center space-x-1 hover:text-gray-700",children:[a.jsx("span",{children:"Ganancia"}),x==="profit"&&(v==="desc"?a.jsx(Da,{className:"h-4 w-4"}):a.jsx(Is,{className:"h-4 w-4"}))]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mtodo de Pago"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendedor"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:he.map(F=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx($i,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("div",{children:(()=>{const ae=hh(F.createdAt);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:ae?ae.toLocaleDateString():"-"}),a.jsx("div",{className:"text-sm text-gray-500",children:ae?ae.toLocaleTimeString():"-"})]})})()})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"text-sm text-gray-900",children:[F.type==="layaway_payment"?a.jsx("span",{className:"text-purple-700 font-semibold",children:"Abono a plan separe"}):F.type==="technical_service_payment"?a.jsx("span",{className:"text-green-700 font-semibold",children:"Pago servicio tcnico"}):F.type==="layaway_delivery"?a.jsx("span",{className:"text-blue-700 font-semibold",children:"Entrega de plan separe"}):F.items.slice(0,2).map((ae,me)=>a.jsxs("div",{children:[ae.quantity," ",ae.productName]},me)),(!F.type||F.type==="regular")&&F.items.length>2&&a.jsxs("div",{className:"text-xs text-gray-500",children:["+",F.items.length-2," productos ms..."]}),F.courtesyItems&&F.courtesyItems.length>0&&a.jsxs("div",{className:"flex items-center mt-1 text-xs text-cyan-600 font-medium",children:[a.jsx(ur,{className:"h-3 w-3 mr-1"}),a.jsxs("span",{children:[F.courtesyItems.length," cortesa",F.courtesyItems.length>1?"s":""]}),a.jsxs("span",{className:"ml-1 text-gray-500",children:["(-",V(F.courtesyTotalValue||0),")"]})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:V(F.subtotal??0)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(F.discount??0)>0?a.jsxs("div",{className:"text-sm font-medium text-orange-600",children:["-",V(F.discount??0)]}):a.jsx("div",{className:"text-sm text-gray-400",children:"-"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:V(F.finalTotal??F.total??0)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:F.courtesyItems&&F.courtesyItems.length>0?a.jsx(a.Fragment,{children:(()=>{const ae=F.realProfit??0,me=ae<0,Se=(F.realProfit??0)/(F.realTotalCost??1)*100;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`text-sm font-medium ${me?"text-red-600":"text-amber-600"}`,children:[me?"":"+",V(ae)]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[Se.toFixed(1),"% margen real"]}),a.jsxs("div",{className:"text-xs text-red-500 flex items-center mt-0.5",children:[a.jsx(ur,{className:"h-3 w-3 mr-1"}),"-",V(F.courtesyTotalCost||0)," en cortesas"]})]})})()}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-sm font-medium text-green-600",children:["+",V(F.totalProfit??0)]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[(F.profitMargin??0).toFixed(1),"% margen"]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${qr(F)}`,children:F.paymentMethods&&F.paymentMethods.length>1?"Pagos mltiples":lr(F)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Rr,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("span",{className:"text-sm text-gray-900",children:F.salesPersonName||"N/A"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>_(F),disabled:D,className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Ver detalles",children:a.jsx(os,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>it(F),disabled:D,className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Eliminar venta",children:a.jsx(rs,{className:"h-4 w-4"})})]})})]},F.id))})]})}),a.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200",children:[a.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[a.jsx("button",{onClick:()=>pe(1),disabled:ze===1,className:"relative inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Primera"}),a.jsx("button",{onClick:te,disabled:!Q,className:"relative inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),a.jsx("span",{className:"px-2 py-2 text-sm text-gray-600",children:ze}),a.jsx("button",{onClick:re,disabled:!U,className:"relative inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Siguiente"})]}),a.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[a.jsx("div",{children:a.jsxs("p",{className:"text-sm text-gray-700",children:["Pgina ",a.jsx("span",{className:"font-medium",children:ze})]})}),a.jsx("div",{children:a.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[a.jsx("button",{onClick:()=>pe(1),disabled:ze===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Primera"}),a.jsx("button",{onClick:te,disabled:!Q,className:"relative inline-flex items-center px-2 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),a.jsx("span",{className:"px-3 py-2 border-t border-b border-gray-300 bg-white text-sm text-gray-700",children:ze}),a.jsx("button",{onClick:re,disabled:!U,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Siguiente"})]})})]})]})]}),S&&a.jsxs(a.Fragment,{children:[!C&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-[99] pointer-events-none",children:a.jsx("div",{className:"absolute left-0 right-0 top-[5vh] bottom-0 bg-black bg-opacity-50"})}),a.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Detalles de la Venta"}),a.jsxs("p",{className:"text-gray-500",children:["ID: ",S.id]}),S.customerName&&a.jsxs("p",{className:"text-gray-700 text-sm mt-1",children:["Cliente: ",S.customerName]}),S.customerId&&a.jsxs("p",{className:"text-gray-500 text-xs",children:["ID Cliente: ",S.customerId]}),S.paymentMethods&&S.paymentMethods.some(F=>String(F.method)==="credit")&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-green-700 text-xs mt-1 font-semibold",children:"Saldo a favor aplicado en el pago"}),(()=>{const F=S.paymentMethods.find(ae=>String(ae.method)==="credit");return F&&F.amount>0?a.jsxs("p",{className:"text-green-700 text-xs font-medium",children:["Monto aplicado: ",V(F.amount)]}):null})(),S.paymentMethods.length>1&&a.jsx("p",{className:"text-purple-700 text-xs mt-1 font-semibold",children:"Pago mltiple: saldo a favor + otro mtodo"})]})]}),a.jsx("button",{onClick:()=>_(null),disabled:D,className:"text-gray-400 hover:text-gray-600 text-2xl disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),a.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Fecha:"}),a.jsx("p",{className:"font-medium",children:(()=>{const F=hh(S.createdAt);return F?F.toLocaleString():"-"})()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Mtodo(s) de Pago:"}),a.jsx("div",{className:"font-medium text-purple-700",children:S!=null&&S.paymentMethods&&S.paymentMethods.length>1?(()=>{const F=S.paymentMethods.map(ae=>dn(ae.method));if(S.paymentMethods.some(ae=>String(ae.method)==="credit")){const ae=F.filter(Se=>Se==="Saldo a favor"),me=F.filter(Se=>Se!=="Saldo a favor");return`Pagos mltiples: ${ae.join(" + ")}${me.length>0?" + "+me.join(" + "):""}`}return`Mltiples mtodos: ${F.join(" + ")}`})():lr(S)})]})]})}),a.jsx("div",{className:"mb-6",children:S.type==="layaway_payment"||S.type==="technical_service_payment"||S.type==="layaway_delivery"?a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:`font-medium mb-3 ${S.type==="layaway_payment"?"text-purple-700":S.type==="technical_service_payment"?"text-green-700":"text-blue-700"}`,children:S.type==="layaway_payment"?"Abono a plan separe":S.type==="technical_service_payment"?"Pago servicio tcnico":"Entrega de plan separe"}),S.type==="technical_service_payment"&&S.technicalServiceDetails&&a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[a.jsx("h5",{className:"font-medium text-green-800 mb-3",children:"Detalles del Servicio Tcnico"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[S.technicalServiceDetails.deviceBrandModel&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Dispositivo:"}),a.jsx("div",{className:"text-gray-900",children:S.technicalServiceDetails.deviceBrandModel})]}),S.technicalServiceDetails.deviceImei&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"IMEI:"}),a.jsx("div",{className:"text-gray-900 font-mono",children:S.technicalServiceDetails.deviceImei})]}),S.technicalServiceDetails.reportedIssue&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Problema reportado:"}),a.jsx("div",{className:"text-gray-900",children:S.technicalServiceDetails.reportedIssue})]}),S.technicalServiceDetails.technicianName&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Tcnico asignado:"}),a.jsx("div",{className:"text-gray-900",children:S.technicalServiceDetails.technicianName})]}),S.technicalServiceDetails.status&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Estado:"}),a.jsx("div",{className:`font-medium ${S.technicalServiceDetails.status==="completed"?"text-green-600":S.technicalServiceDetails.status==="active"?"text-blue-600":"text-gray-600"}`,children:S.technicalServiceDetails.status==="completed"?"Completado":S.technicalServiceDetails.status==="active"?"En proceso":S.technicalServiceDetails.status})]}),S.technicalServiceDetails.total!==void 0&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Costo total del servicio:"}),a.jsx("div",{className:"text-gray-900 font-semibold",children:V(S.technicalServiceDetails.total)})]}),S.technicalServiceDetails.remainingBalance!==void 0&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Saldo restante tras este pago:"}),a.jsx("div",{className:`font-semibold ${S.technicalServiceDetails.remainingBalance<=0?"text-green-600":"text-orange-600"}`,children:V(S.technicalServiceDetails.remainingBalance)})]}),S.technicalServiceDetails.estimatedCompletionDate&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Fecha estimada de entrega:"}),a.jsx("div",{className:"text-gray-900",children:new Date(S.technicalServiceDetails.estimatedCompletionDate).toLocaleDateString()})]})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Productos Vendidos"}),a.jsx("div",{className:"space-y-3",children:S.items.map((F,ae)=>a.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-gray-900",children:F.productName}),a.jsxs("div",{className:"text-sm text-gray-600",children:[F.quantity,"  ",V(F.salePrice??0)," = ",V(F.totalRevenue??0)]}),a.jsxs("div",{className:"text-xs text-green-600",children:["Ganancia: +",V(F.profit??0)," (Costo: ",V(F.totalCost??0),")"]})]}),a.jsx("button",{onClick:()=>Ae(S.id,F.productId,F.productName,F.quantity,F.salePrice),disabled:D,className:"ml-3 px-3 py-1 text-xs font-medium text-red-600 hover:text-red-700 bg-red-50 hover:bg-red-100 rounded-md border border-red-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Procesar devolucin",children:"Devolver"})]},ae))}),S.courtesyItems&&S.courtesyItems.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-3 mt-6 flex items-center",children:[a.jsx(ur,{className:"h-5 w-5 text-cyan-600 mr-2"}),"Cortesas"]}),a.jsx("div",{className:"space-y-3",children:S.courtesyItems.map((F,ae)=>a.jsx("div",{className:"flex justify-between items-center p-3 bg-cyan-50 rounded-lg border border-cyan-200",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-gray-900",children:F.productName}),a.jsxs("div",{className:"text-sm text-gray-600",children:[F.quantity,"  ",V(F.normalPrice??0)," = ",V(F.totalValue??0)]}),a.jsxs("div",{className:"text-xs text-red-600",children:["Costo real: -",V(F.totalCost??0)]}),F.reason&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1 italic",children:["Motivo: ",F.reason]})]})},ae))})]})]})}),a.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{children:V(S.subtotal??0)})]}),(S.discount??0)>0&&a.jsxs("div",{className:"flex justify-between text-orange-600",children:[a.jsx("span",{children:"Descuento:"}),a.jsxs("span",{children:["-",V(S.discount??0)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Costo Total:"}),a.jsx("span",{className:"text-red-600",children:V(S.totalCost??0)})]}),S.courtesyItems&&S.courtesyItems.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between text-cyan-600",children:[a.jsxs("span",{className:"flex items-center",children:[a.jsx(ur,{className:"h-3 w-3 mr-1"}),"Valor cortesas regaladas:"]}),a.jsx("span",{children:V(S.courtesyTotalValue??0)})]}),a.jsxs("div",{className:"flex justify-between text-red-600",children:[a.jsxs("span",{className:"flex items-center",children:[a.jsx(ur,{className:"h-3 w-3 mr-1"}),"Costo cortesas:"]}),a.jsxs("span",{children:["-",V(S.courtesyTotalCost??0)]})]}),a.jsxs("div",{className:"flex justify-between font-medium text-red-700 bg-red-50 px-2 py-1 rounded",children:[a.jsx("span",{children:"Costo Total Real (incluye cortesas):"}),a.jsx("span",{children:V(S.realTotalCost??0)})]})]}),(S.customerSurcharge??0)>0&&a.jsxs("div",{className:"flex justify-between text-orange-600",children:[a.jsx("span",{children:"Recargo por mtodo de pago:"}),a.jsxs("span",{children:["+",V(S.customerSurcharge??0)]})]}),a.jsxs("div",{className:"flex justify-between font-bold text-lg border-t pt-2",children:[a.jsx("span",{children:"Total Pagado por Cliente:"}),a.jsx("span",{className:"text-blue-600",children:V(S.finalTotal??S.total??0)})]}),(()=>{const F=S.courtesyItems&&S.courtesyItems.length>0,me=(F?S.realProfit??0:S.totalProfit??0)<0;return a.jsxs("div",{className:`flex justify-between font-bold ${me?"text-red-600":"text-green-600"}`,children:[a.jsx("span",{children:F?me?"Prdida Real:":"Ganancia Real:":"Ganancia Total:"}),S.type==="layaway_payment"||S.type==="technical_service_payment"?(()=>{const Se=S.total??0,Oe=S.totalCost??0,H=Se-Oe,Z=Oe>0?H/Oe*100:0;return a.jsxs("span",{className:S.type==="technical_service_payment"?"text-green-700":"text-purple-700",children:["+",V(H)," (",Z.toFixed(1),"%)"]})})():F?(()=>{const Se=S.realProfit??0,Oe=S.realTotalCost??1,H=Se/Oe*100,Z=Se<0;return a.jsxs("span",{className:Z?"text-red-600":"text-amber-600",children:[Z?"":"+",V(Se)," (",H.toFixed(1),"%)"]})})():a.jsxs("span",{children:["+",V(S.totalProfit??0)," (",(S.profitMargin??0).toFixed(1),"%)"]})]})})()]})}),a.jsxs("div",{className:"flex justify-between items-center mt-6",children:[a.jsxs("button",{onClick:()=>it(S),disabled:D,className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg shadow hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(rs,{className:"h-5 w-5"}),"Eliminar Venta"]}),a.jsxs("button",{className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>N(!0),disabled:D,children:[a.jsx(Pi,{className:"h-5 w-5"}),"Imprimir factura"]})]})]})})})]}),C&&a.jsx(sS,{sale:S,onClose:()=>N(!1)})]}),!be&&he.length===0&&a.jsxs("div",{className:"bg-white rounded-xl p-12 text-center shadow-sm border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(Cj,{className:"h-12 w-12 mx-auto"})}),r==="custom"&&(!s.startDate||!s.endDate)?a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Selecciona el rango de fechas"}),a.jsx("p",{className:"text-gray-500",children:"Para ver las ventas en un rango personalizado, debes seleccionar tanto la fecha de inicio como la fecha de fin."})]}):a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron ventas"}),a.jsx("p",{className:"text-gray-500",children:t||r!=="week"||d!=="all"||f!=="all"?"Intenta ajustar tus filtros de bsqueda.":"An no se han registrado ventas en el sistema."})]})]}),w&&a.jsxs("div",{className:"fixed inset-0 z-[101] flex items-center justify-center p-4",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50"}),a.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6 relative z-10",children:[D&&a.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 rounded-xl flex items-center justify-center z-10",children:a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(ks,{className:"h-8 w-8 text-blue-600 animate-spin mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Procesando devolucin..."})]})}),a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Procesar Devolucin"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Producto:"}),a.jsx("p",{className:"font-medium text-gray-900",children:w.productName})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Cantidad a devolver (mx: ",w.maxQuantity,")"]}),a.jsx("input",{type:"number",min:"1",max:w.maxQuantity,value:w.quantity,onChange:F=>E({...w,quantity:Math.min(parseInt(F.target.value)||1,w.maxQuantity)}),disabled:D,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asignar saldo a favor a cliente (opcional)"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar cliente por nombre, telfono...",value:w.customerSearch,onChange:F=>E({...w,customerSearch:F.target.value,selectedCustomerId:""}),disabled:D||K,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"}),w.customerSearch&&!w.selectedCustomerId&&a.jsx("div",{className:"absolute z-20 left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg max-h-40 overflow-y-auto mt-1",children:G.filter(F=>F.name.toLowerCase().includes(w.customerSearch.toLowerCase())||F.phone&&F.phone.includes(w.customerSearch)).length===0?a.jsx("div",{className:"p-3 text-gray-500 text-sm",children:"No hay clientes"}):G.filter(F=>F.name.toLowerCase().includes(w.customerSearch.toLowerCase())||F.phone&&F.phone.includes(w.customerSearch)).map(F=>a.jsxs("button",{type:"button",onMouseDown:()=>{E({...w,selectedCustomerId:F.id,customerSearch:F.name+(F.phone?` - ${F.phone}`:"")})},className:"w-full text-left px-4 py-2 hover:bg-blue-50 text-sm",disabled:D,children:[a.jsx("div",{className:"font-medium",children:F.name}),F.phone&&a.jsx("div",{className:"text-xs text-gray-500",children:F.phone}),a.jsxs("div",{className:"text-xs text-green-600",children:["Saldo actual: ",V(F.credit||0)]})]},F.id))})]}),w.selectedCustomerId&&a.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-sm text-blue-800",children:[a.jsx("strong",{children:"Cliente seleccionado:"})," ",(Sn=G.find(F=>F.id===w.selectedCustomerId))==null?void 0:Sn.name,a.jsx("br",{}),a.jsx("strong",{children:"Monto a agregar:"})," ",V(w.productSalePrice*w.quantity)]})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:" Importante:"})," Esta accin recalcular los totales de la venta y devolver ",w.quantity," unidad(es) al inventario.",w.selectedCustomerId&&a.jsxs("span",{children:[" ","Se agregarn ",V(w.productSalePrice*w.quantity)," al saldo a favor del cliente seleccionado."]})]})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>E(null),disabled:D,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),a.jsx("button",{onClick:mt,disabled:D,className:"flex-1 px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:D?a.jsxs(a.Fragment,{children:[a.jsx(ks,{className:"h-4 w-4 animate-spin"}),"Procesando..."]}):"Confirmar Devolucin"})]})]})]}),k&&a.jsxs("div",{className:"fixed inset-0 z-[102] flex items-center justify-center p-4",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50"}),a.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6 relative z-10",children:[D&&a.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 rounded-xl flex items-center justify-center z-10",children:a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(ks,{className:"h-8 w-8 text-blue-600 animate-spin mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Eliminando venta..."})]})}),a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"bg-red-100 p-2 rounded-full mr-3",children:a.jsx(rs,{className:"h-6 w-6 text-red-600"})}),a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Eliminar Venta"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Ests seguro de que deseas eliminar esta venta?"}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsxs("p",{className:"font-medium text-gray-900",children:["ID: ",k.saleId.substring(0,8),"..."]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Total: ",V(k.saleData.total??0)]}),(!k.saleData.type||k.saleData.type==="regular")&&a.jsxs("p",{className:"text-sm text-gray-600",children:["Productos: ",k.saleData.items.length," artculo",k.saleData.items.length!==1?"s":""]})]})]}),a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:a.jsxs("p",{className:"text-sm text-red-800",children:[a.jsx("strong",{children:" Atencin:"})," ",((Ar=k==null?void 0:k.saleData)==null?void 0:Ar.type)==="layaway_payment"||((hn=k==null?void 0:k.saleData)==null?void 0:hn.type)==="technical_service_payment"?`Esta accin no se puede deshacer. Se eliminar ${((Ir=k==null?void 0:k.saleData)==null?void 0:Ir.type)==="technical_service_payment"?"el pago del servicio tcnico":"el abono del plan separe"} y del historial de ventas.`:"Esta accin no se puede deshacer. Se restaurar el stock de todos los productos vendidos."]})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>T(null),disabled:D,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),a.jsx("button",{onClick:ut,disabled:D,className:"flex-1 px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:D?a.jsxs(a.Fragment,{children:[a.jsx(ks,{className:"h-4 w-4 animate-spin"}),"Eliminando..."]}):"Eliminar Venta"})]})]})]})]}),y==="cellphones"&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"rounded-xl p-4 border border-gray-100 shadow-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:" Estadsticas de Celulares"}),a.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full font-medium",children:"Mismo perodo"})]}),ne.loading?a.jsxs("div",{className:"flex items-center justify-center h-20",children:[a.jsx(ks,{className:"h-6 w-6 animate-spin text-blue-600"}),a.jsx("span",{className:"ml-2 text-gray-700",children:"Calculando estadsticas de celulares..."})]}):ne.error?a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:a.jsx("p",{className:"text-red-800 text-sm",children:ne.error})}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7 gap-4",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Sl,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Transacciones"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:ne.transactionCount})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Wt,{className:"w-3 h-3 text-emerald-600 group-hover:text-emerald-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Ventas Totales"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(ne.totalSales)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-orange-500/10 hover:-translate-y-0.5 hover:border-orange-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-orange-50 rounded flex items-center justify-center group-hover:bg-orange-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(CP,{className:"w-3 h-3 text-orange-600 group-hover:text-orange-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Descuentos"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-orange-900 transition-colors duration-300",children:V(ne.totalDiscounts)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-green-500/10 hover:-translate-y-0.5 hover:border-green-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-green-50 rounded flex items-center justify-center group-hover:bg-green-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ds,{className:"w-3 h-3 text-green-600 group-hover:text-green-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Ganancia Total"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-green-900 transition-colors duration-300",children:V(ne.totalProfit)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-red-500/10 hover:-translate-y-0.5 hover:border-red-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-red-50 rounded flex items-center justify-center group-hover:bg-red-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ea,{className:"w-3 h-3 text-red-600 group-hover:text-red-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Costo Total"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-red-900 transition-colors duration-300",children:V(ne.totalCost)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-purple-500/10 hover:-translate-y-0.5 hover:border-purple-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-purple-50 rounded flex items-center justify-center group-hover:bg-purple-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Rr,{className:"w-3 h-3 text-purple-600 group-hover:text-purple-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Promedio/Venta"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-purple-900 transition-colors duration-300",children:V(ne.averageTransaction)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-indigo-500/10 hover:-translate-y-0.5 hover:border-indigo-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-indigo-50 rounded flex items-center justify-center group-hover:bg-indigo-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ga,{className:"w-3 h-3 text-indigo-600 group-hover:text-indigo-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Margen Promedio"}),a.jsxs("p",{className:"text-base font-bold text-slate-900 group-hover:text-indigo-900 transition-colors duration-300",children:[ne.profitMargin.toFixed(1),"%"]})]})})]}),!ne.loading&&!ne.error&&ne.transactionCount===0&&a.jsx("div",{className:"text-center py-4",children:a.jsx("p",{className:"text-gray-600 text-sm",children:"No hay ventas de celulares en este perodo"})})]}),a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"relative md:col-span-2",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar celulares por modelo, cliente o ID...",value:t,onChange:F=>e(F.target.value),className:"w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsxs("select",{value:r,onChange:F=>ue(F.target.value),className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none text-sm",children:[a.jsx("option",{value:"today",children:"Hoy"}),a.jsx("option",{value:"week",children:"ltima semana"}),a.jsx("option",{value:"month",children:"ltimo mes"}),a.jsx("option",{value:"3months",children:"ltimos 3 meses"}),a.jsx("option",{value:"6months",children:"ltimos 6 meses"}),a.jsx("option",{value:"year",children:"ltimos 12 meses"}),a.jsx("option",{value:"custom",children:"Rango personalizado"})]})]}),a.jsxs("select",{value:d,onChange:F=>h(F.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"all",children:"Todos"}),a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]}),a.jsxs("select",{value:f,onChange:F=>m(F.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"all",children:"Vendedores"}),B.map(F=>a.jsx("option",{value:F.uid,children:F.displayName||F.email},F.uid))]}),a.jsxs("select",{value:`${x}-${v}`,onChange:F=>{const[ae,me]=F.target.value.split("-");b(ae),j(me)},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"date-desc",children:"Ms recientes"}),a.jsx("option",{value:"date-asc",children:"Ms antiguos"}),a.jsx("option",{value:"total-desc",children:"Mayor monto"}),a.jsx("option",{value:"total-asc",children:"Menor monto"}),a.jsx("option",{value:"profit-desc",children:"Mayor ganancia"}),a.jsx("option",{value:"profit-asc",children:"Menor ganancia"})]})]}),(r==="today"||r==="custom")&&a.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("input",{type:"checkbox",id:"enable-time-filter-cellphones",checked:c,onChange:F=>{u(F.target.checked),F.target.checked||l({startTime:"",endTime:""})},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-blue-300 rounded"}),a.jsx("label",{htmlFor:"enable-time-filter-cellphones",className:"text-sm font-medium text-gray-700",children:"Filtrar por horas especficas"})]}),c&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 text-sm font-medium text-blue-800",children:"Hora de Inicio:"}),a.jsxs("div",{className:"flex",children:[a.jsxs("select",{value:o.startTime?o.startTime.split(":")[0]:"",onChange:F=>{const ae=F.target.value,me=o.startTime?o.startTime.split(":")[1]:"00",Se=ae?`${ae}:${me}`:"";o.endTime&&Se>o.endTime?l(Oe=>({...Oe,startTime:Se,endTime:Se})):l(Oe=>({...Oe,startTime:Se}))},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-l-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",children:[a.jsx("option",{value:"",children:"Hora"}),Array.from({length:24},(F,ae)=>a.jsx("option",{value:ae.toString().padStart(2,"0"),children:ae.toString().padStart(2,"0")},ae))]}),a.jsx("div",{className:"flex items-center px-3 bg-gray-50 border-t border-b border-gray-300",children:a.jsx("span",{className:"text-gray-500",children:":"})}),a.jsxs("select",{value:o.startTime?o.startTime.split(":")[1]:"",onChange:F=>{const ae=F.target.value,me=o.startTime?o.startTime.split(":")[0]:"00",Se=ae!==""?`${me}:${ae}`:"";o.endTime&&Se>o.endTime?l(Oe=>({...Oe,startTime:Se,endTime:Se})):l(Oe=>({...Oe,startTime:Se}))},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-r-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",children:[a.jsx("option",{value:"",children:"Min"}),["00","15","30","45"].map(F=>a.jsx("option",{value:F,children:F},F))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 text-sm font-medium text-blue-800",children:"Hora de Fin:"}),a.jsxs("div",{className:"flex",children:[a.jsxs("select",{value:o.endTime?o.endTime.split(":")[0]:"",onChange:F=>{const ae=F.target.value,me=o.endTime?o.endTime.split(":")[1]:"00",Se=ae?`${ae}:${me}`:"";l(Oe=>({...Oe,endTime:Se}))},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-l-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",children:[a.jsx("option",{value:"",children:"Hora"}),Array.from({length:24},(F,ae)=>{const me=ae.toString().padStart(2,"0"),Se=o.startTime?me<o.startTime.split(":")[0]:!1;return a.jsx("option",{value:me,disabled:Se,children:me},ae)})]}),a.jsx("div",{className:"flex items-center px-3 bg-gray-50 border-t border-b border-gray-300",children:a.jsx("span",{className:"text-gray-500",children:":"})}),a.jsxs("select",{value:o.endTime?o.endTime.split(":")[1]:"",onChange:F=>{const ae=F.target.value,me=o.endTime?o.endTime.split(":")[0]:"00",Se=ae!==""?`${me}:${ae}`:"";l(Oe=>({...Oe,endTime:Se}))},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-r-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",children:[a.jsx("option",{value:"",children:"Min"}),["00","15","30","45"].map(F=>a.jsx("option",{value:F,children:F},F))]})]})]})]})]}),r==="custom"&&a.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(_0,{className:"h-5 w-5 text-blue-600 mr-2"}),a.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Seleccionar Rango de Fechas"})]}),(s.startDate||s.endDate)&&a.jsxs("button",{onClick:We,className:"text-blue-600 hover:text-blue-800 text-sm flex items-center",children:[a.jsx(ct,{className:"h-4 w-4 mr-1"}),"Limpiar"]})]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-1",children:"Fecha de Inicio"}),a.jsx("input",{type:"date",value:s.startDate,onChange:F=>se("startDate",F.target.value),max:s.endDate||new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",title:"Fecha de inicio (mximo 1 ao de rango)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-1",children:"Fecha de Fin"}),a.jsx("input",{type:"date",value:s.endDate,onChange:F=>se("endDate",F.target.value),min:s.startDate,max:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",title:"Fecha de fin (mximo 1 ao de rango)"})]})]})}),gt()&&a.jsxs("div",{className:"mt-3 p-2 bg-blue-100 rounded text-sm text-blue-800",children:[a.jsx("strong",{children:"Rango seleccionado:"})," ",gt()]}),a.jsx("div",{className:"mt-3 bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:" Nota:"})," Por rendimiento, el rango personalizado est limitado a un mximo de 1 ao."]})})]}),(t||r!=="month"||d!=="all"||f!=="all")&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-2 border-t border-gray-200",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Filtros activos:"}),t&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:['Bsqueda: "',t,'"',a.jsx("button",{onClick:()=>e(""),className:"ml-1 text-blue-600 hover:text-blue-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),r!=="month"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[r==="custom"?`Rango: ${gt()}`:r==="today"?"Hoy":r==="week"?"ltima semana":r==="3months"?"ltimos 3 meses":r==="6months"?"ltimos 6 meses":r==="year"?"ltimos 12 meses":"Personalizado",a.jsx("button",{onClick:()=>ue("month"),className:"ml-1 text-green-600 hover:text-green-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),d!=="all"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[dn(d),a.jsx("button",{onClick:()=>h("all"),className:"ml-1 text-purple-600 hover:text-purple-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),f!=="all"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:["Vendedor: ",((Hr=B.find(F=>F.uid===f))==null?void 0:Hr.displayName)||((kr=B.find(F=>F.uid===f))==null?void 0:kr.email)||"Desconocido",a.jsx("button",{onClick:()=>m("all"),className:"ml-1 text-indigo-600 hover:text-indigo-800",children:a.jsx(ct,{className:"h-3 w-3"})})]})]})]})}),be?a.jsx("div",{className:"flex justify-center items-center py-12",children:a.jsx("span",{className:"text-gray-500",children:"Cargando ventas de celulares..."})}):Ye?a.jsx("div",{className:"flex justify-center items-center py-12 text-red-600",children:Ye}):a.jsx("div",{className:"grid gap-3 sm:hidden",children:he.filter(F=>{var ae;return F.isLayaway||F.type==="layaway_payment"?!1:(ae=F.items)==null?void 0:ae.some(me=>{var Se,Oe,H,Z,ce,fe,Ne,Ve;return((Se=me.category)==null?void 0:Se.toLowerCase().includes("celular"))||((Oe=me.productName)==null?void 0:Oe.toLowerCase().includes("celular"))||((H=me.productName)==null?void 0:H.toLowerCase().includes("mvil"))||((Z=me.productName)==null?void 0:Z.toLowerCase().includes("smartphone"))||((ce=me.productName)==null?void 0:ce.toLowerCase().includes("iphone"))||((fe=me.productName)==null?void 0:fe.toLowerCase().includes("samsung"))||((Ne=me.productName)==null?void 0:Ne.toLowerCase().includes("xiaomi"))||((Ve=me.productName)==null?void 0:Ve.toLowerCase().includes("huawei"))})}).map(F=>a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Sl,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsxs("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:["Celulares #",F.id.substring(0,8)]}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:V(F.finalTotal??F.total??0)}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("div",{className:"text-xs text-slate-500",children:[(()=>{const ae=hh(F.createdAt);return ae?ae.toLocaleDateString():"-"})(),"  ",F.salesPersonName||"Sin vendedor"]}),a.jsxs("div",{className:"text-xs text-blue-600 font-medium",children:[F.items.filter(ae=>{var me,Se,Oe,H,Z,ce,fe,Ne;return((me=ae.category)==null?void 0:me.toLowerCase().includes("celular"))||((Se=ae.productName)==null?void 0:Se.toLowerCase().includes("celular"))||((Oe=ae.productName)==null?void 0:Oe.toLowerCase().includes("mvil"))||((H=ae.productName)==null?void 0:H.toLowerCase().includes("smartphone"))||((Z=ae.productName)==null?void 0:Z.toLowerCase().includes("iphone"))||((ce=ae.productName)==null?void 0:ce.toLowerCase().includes("samsung"))||((fe=ae.productName)==null?void 0:fe.toLowerCase().includes("xiaomi"))||((Ne=ae.productName)==null?void 0:Ne.toLowerCase().includes("huawei"))}).length," celular",F.items.filter(ae=>{var me,Se,Oe,H,Z,ce,fe,Ne;return((me=ae.category)==null?void 0:me.toLowerCase().includes("celular"))||((Se=ae.productName)==null?void 0:Se.toLowerCase().includes("celular"))||((Oe=ae.productName)==null?void 0:Oe.toLowerCase().includes("mvil"))||((H=ae.productName)==null?void 0:H.toLowerCase().includes("smartphone"))||((Z=ae.productName)==null?void 0:Z.toLowerCase().includes("iphone"))||((ce=ae.productName)==null?void 0:ce.toLowerCase().includes("samsung"))||((fe=ae.productName)==null?void 0:fe.toLowerCase().includes("xiaomi"))||((Ne=ae.productName)==null?void 0:Ne.toLowerCase().includes("huawei"))}).length!==1?"es":""," en venta"]}),a.jsxs("div",{className:"flex justify-center items-center space-x-3 text-xs",children:[a.jsxs("span",{className:"text-green-600 font-medium",children:["+",V(F.totalProfit??0)]}),a.jsxs("span",{className:"text-orange-600 font-medium",children:[(F.profitMargin??0).toFixed(1),"%"]})]}),a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${qr(F)}`,children:F.paymentMethods&&F.paymentMethods.length>1?"Mltiples":lr(F)}),a.jsxs("div",{className:"flex gap-1 justify-center mt-2",children:[a.jsxs("button",{onClick:()=>_(F),disabled:D,className:"group/btn bg-blue-50 hover:bg-blue-100 text-blue-600 hover:text-blue-700 px-2 py-1 rounded transition-all duration-300 ease-out text-xs font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105",title:"Ver detalles",children:[a.jsx(os,{className:"h-3 w-3 group-hover/btn:scale-110 transition-transform duration-300"}),"Ver"]}),a.jsxs("button",{onClick:()=>it(F),disabled:D,className:"group/btn bg-red-50 hover:bg-red-100 text-red-600 hover:text-red-700 px-2 py-1 rounded transition-all duration-300 ease-out text-xs font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105",title:"Eliminar venta",children:[a.jsx(rs,{className:"h-3 w-3 group-hover/btn:scale-110 transition-transform duration-300"}),"Eliminar"]})]})]})]})},F.id))}),be?a.jsx("div",{className:"hidden sm:flex justify-center items-center py-12",children:a.jsx("span",{className:"text-gray-500",children:"Cargando ventas de celulares..."})}):Ye?a.jsx("div",{className:"hidden sm:flex justify-center items-center py-12 text-red-600",children:Ye}):a.jsxs("div",{className:"hidden sm:block bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto w-full",children:a.jsxs("table",{className:"min-w-full w-full table-fixed",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("button",{onClick:()=>ke("date"),className:"flex items-center space-x-1 hover:text-gray-700",children:[a.jsx("span",{children:"Fecha"}),x==="date"&&(v==="desc"?a.jsx(Da,{className:"h-4 w-4"}):a.jsx(Is,{className:"h-4 w-4"}))]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Sl,{className:"h-4 w-4 text-blue-500"}),"Celulares"]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subtotal"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descuento"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("button",{onClick:()=>ke("total"),className:"flex items-center space-x-1 hover:text-gray-700",children:[a.jsx("span",{children:"Total"}),x==="total"&&(v==="desc"?a.jsx(Da,{className:"h-4 w-4"}):a.jsx(Is,{className:"h-4 w-4"}))]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("button",{onClick:()=>ke("profit"),className:"flex items-center space-x-1 hover:text-gray-700",children:[a.jsx("span",{children:"Ganancia"}),x==="profit"&&(v==="desc"?a.jsx(Da,{className:"h-4 w-4"}):a.jsx(Is,{className:"h-4 w-4"}))]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mtodo de Pago"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendedor"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:he.filter(F=>{var ae;return F.isLayaway||F.type==="layaway_payment"?!1:(ae=F.items)==null?void 0:ae.some(me=>{var Se,Oe,H,Z,ce,fe,Ne,Ve;return((Se=me.category)==null?void 0:Se.toLowerCase().includes("celular"))||((Oe=me.productName)==null?void 0:Oe.toLowerCase().includes("celular"))||((H=me.productName)==null?void 0:H.toLowerCase().includes("mvil"))||((Z=me.productName)==null?void 0:Z.toLowerCase().includes("smartphone"))||((ce=me.productName)==null?void 0:ce.toLowerCase().includes("iphone"))||((fe=me.productName)==null?void 0:fe.toLowerCase().includes("samsung"))||((Ne=me.productName)==null?void 0:Ne.toLowerCase().includes("xiaomi"))||((Ve=me.productName)==null?void 0:Ve.toLowerCase().includes("huawei"))})}).map(F=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx($i,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("div",{children:(()=>{const ae=hh(F.createdAt);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:ae?ae.toLocaleDateString():"-"}),a.jsx("div",{className:"text-sm text-gray-500",children:ae?ae.toLocaleTimeString():"-"})]})})()})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"text-sm text-gray-900",children:[F.items.filter(ae=>{var me,Se,Oe,H,Z,ce,fe,Ne;return((me=ae.category)==null?void 0:me.toLowerCase().includes("celular"))||((Se=ae.productName)==null?void 0:Se.toLowerCase().includes("celular"))||((Oe=ae.productName)==null?void 0:Oe.toLowerCase().includes("mvil"))||((H=ae.productName)==null?void 0:H.toLowerCase().includes("smartphone"))||((Z=ae.productName)==null?void 0:Z.toLowerCase().includes("iphone"))||((ce=ae.productName)==null?void 0:ce.toLowerCase().includes("samsung"))||((fe=ae.productName)==null?void 0:fe.toLowerCase().includes("xiaomi"))||((Ne=ae.productName)==null?void 0:Ne.toLowerCase().includes("huawei"))}).slice(0,2).map((ae,me)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Sl,{className:"h-3 w-3 text-blue-500"}),ae.quantity," ",ae.productName]},me)),F.items.filter(ae=>{var me,Se,Oe,H,Z,ce,fe,Ne;return((me=ae.category)==null?void 0:me.toLowerCase().includes("celular"))||((Se=ae.productName)==null?void 0:Se.toLowerCase().includes("celular"))||((Oe=ae.productName)==null?void 0:Oe.toLowerCase().includes("mvil"))||((H=ae.productName)==null?void 0:H.toLowerCase().includes("smartphone"))||((Z=ae.productName)==null?void 0:Z.toLowerCase().includes("iphone"))||((ce=ae.productName)==null?void 0:ce.toLowerCase().includes("samsung"))||((fe=ae.productName)==null?void 0:fe.toLowerCase().includes("xiaomi"))||((Ne=ae.productName)==null?void 0:Ne.toLowerCase().includes("huawei"))}).length>2&&a.jsxs("div",{className:"text-xs text-gray-500",children:["+",F.items.filter(ae=>{var me,Se,Oe,H,Z,ce,fe,Ne;return((me=ae.category)==null?void 0:me.toLowerCase().includes("celular"))||((Se=ae.productName)==null?void 0:Se.toLowerCase().includes("celular"))||((Oe=ae.productName)==null?void 0:Oe.toLowerCase().includes("mvil"))||((H=ae.productName)==null?void 0:H.toLowerCase().includes("smartphone"))||((Z=ae.productName)==null?void 0:Z.toLowerCase().includes("iphone"))||((ce=ae.productName)==null?void 0:ce.toLowerCase().includes("samsung"))||((fe=ae.productName)==null?void 0:fe.toLowerCase().includes("xiaomi"))||((Ne=ae.productName)==null?void 0:Ne.toLowerCase().includes("huawei"))}).length-2," celulares ms..."]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:V(F.subtotal??0)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(F.discount??0)>0?a.jsxs("div",{className:"text-sm font-medium text-orange-600",children:["-",V(F.discount??0)]}):a.jsx("div",{className:"text-sm text-gray-400",children:"-"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:V(F.finalTotal??F.total??0)})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsxs("div",{className:"text-sm font-medium text-green-600",children:["+",V(F.totalProfit??0)]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[(F.profitMargin??0).toFixed(1),"% margen"]})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${qr(F)}`,children:F.paymentMethods&&F.paymentMethods.length>1?"Pagos mltiples":lr(F)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Rr,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("span",{className:"text-sm text-gray-900",children:F.salesPersonName||"N/A"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>_(F),disabled:D,className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Ver detalles",children:a.jsx(os,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>it(F),disabled:D,className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Eliminar venta",children:a.jsx(rs,{className:"h-4 w-4"})})]})})]},F.id))})]})}),a.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200",children:[a.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[a.jsx("button",{onClick:()=>pe(1),disabled:ze===1,className:"relative inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Primera"}),a.jsx("button",{onClick:te,disabled:!Q,className:"relative inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),a.jsx("span",{className:"px-2 py-2 text-sm text-gray-600",children:ze}),a.jsx("button",{onClick:re,disabled:!U,className:"relative inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Siguiente"})]}),a.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[a.jsx("div",{children:a.jsxs("p",{className:"text-sm text-gray-700",children:["Pgina ",a.jsx("span",{className:"font-medium",children:ze})," -",a.jsx("span",{className:"text-blue-600 font-medium",children:" Solo ventas con celulares"})]})}),a.jsx("div",{children:a.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[a.jsx("button",{onClick:()=>pe(1),disabled:ze===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Primera"}),a.jsx("button",{onClick:te,disabled:!Q,className:"relative inline-flex items-center px-2 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),a.jsx("span",{className:"px-3 py-2 border-t border-b border-gray-300 bg-white text-sm text-gray-700",children:ze}),a.jsx("button",{onClick:re,disabled:!U,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Siguiente"})]})})]})]})]}),!be&&he.filter(F=>{var ae;return F.isLayaway||F.type==="layaway_payment"?!1:(ae=F.items)==null?void 0:ae.some(me=>{var Se,Oe,H,Z,ce,fe,Ne,Ve;return((Se=me.category)==null?void 0:Se.toLowerCase().includes("celular"))||((Oe=me.productName)==null?void 0:Oe.toLowerCase().includes("celular"))||((H=me.productName)==null?void 0:H.toLowerCase().includes("mvil"))||((Z=me.productName)==null?void 0:Z.toLowerCase().includes("smartphone"))||((ce=me.productName)==null?void 0:ce.toLowerCase().includes("iphone"))||((fe=me.productName)==null?void 0:fe.toLowerCase().includes("samsung"))||((Ne=me.productName)==null?void 0:Ne.toLowerCase().includes("xiaomi"))||((Ve=me.productName)==null?void 0:Ve.toLowerCase().includes("huawei"))})}).length===0&&a.jsxs("div",{className:"bg-white rounded-xl p-12 text-center shadow-sm border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(Sl,{className:"h-12 w-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay ventas de celulares"}),a.jsx("p",{className:"text-gray-500",children:t||r!=="week"||d!=="all"||f!=="all"?"No se encontraron ventas con celulares en los filtros seleccionados.":"An no se han registrado ventas con celulares en el sistema."})]})]}),P&&a.jsx("div",{className:"fixed top-4 right-4 z-[103] max-w-sm w-full",children:a.jsx("div",{className:`rounded-lg shadow-lg border-l-4 p-4 ${P.type==="success"?"bg-green-50 border-green-400":"bg-red-50 border-red-400"}`,children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:P.type==="success"?a.jsx(ai,{className:"h-5 w-5 text-green-400"}):a.jsx(Vf,{className:"h-5 w-5 text-red-400"})}),a.jsxs("div",{className:"ml-3 w-0 flex-1",children:[a.jsx("p",{className:`text-sm font-medium ${P.type==="success"?"text-green-800":"text-red-800"}`,children:P.title}),a.jsx("p",{className:`mt-1 text-sm ${P.type==="success"?"text-green-700":"text-red-700"}`,children:P.message})]}),a.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:a.jsx("button",{onClick:()=>O(null),className:`rounded-md inline-flex ${P.type==="success"?"text-green-400 hover:text-green-600":"text-red-400 hover:text-red-600"} focus:outline-none`,children:a.jsx(ct,{className:"h-4 w-4"})})})]})})})]})}function _s(t){if(!t)return null;if(typeof t.toDate=="function")return t.toDate();const e=new Date(t);return isNaN(e.getTime())?null:e}function kc(t){const[e,r,n]=t.split("-").map(Number);return new Date(e,r-1,n,0,0,0,0)}function NG(){Tj("technicalServices");const[t,e]=I.useState("services"),[r,n]=I.useState(""),[s,i]=I.useState("today"),[o,l]=I.useState({startDate:"",endDate:""}),[c,u]=I.useState("all"),[d,h]=I.useState("all"),[f,m]=I.useState("date"),[y,g]=I.useState("desc"),[x,b]=I.useState(1),[v,j]=I.useState(null),[S,_]=I.useState(!1),[C,N]=I.useState(new Set),[w,E]=I.useState(""),k=()=>{const U=new Date;let Q,re;switch(s){case"today":Q=new Date(U.getFullYear(),U.getMonth(),U.getDate()),re=new Date(U.getFullYear(),U.getMonth(),U.getDate(),23,59,59);break;case"yesterday":const te=new Date(U);te.setDate(te.getDate()-1),Q=new Date(te.getFullYear(),te.getMonth(),te.getDate()),re=new Date(te.getFullYear(),te.getMonth(),te.getDate(),23,59,59);break;case"thisWeek":Q=new Date(U),Q.setDate(U.getDate()-U.getDay()),Q.setHours(0,0,0,0),re=new Date(U.getFullYear(),U.getMonth(),U.getDate(),23,59,59);break;case"thisMonth":Q=new Date(U.getFullYear(),U.getMonth(),1),re=new Date(U.getFullYear(),U.getMonth(),U.getDate(),23,59,59);break;case"lastMonth":Q=new Date(U.getFullYear(),U.getMonth()-1,1),re=new Date(U.getFullYear(),U.getMonth(),0,23,59,59);break;case"custom":if(o.startDate&&o.endDate)Q=kc(o.startDate),re=kc(o.endDate),re.setHours(23,59,59);else return null;break;default:return null}return{startDate:Q,endDate:re,startDateFormatted:Q.toLocaleDateString("es-ES",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),endDateFormatted:re.toLocaleDateString("es-ES",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}},T=10,P=Xt(WM),O=Xt(kd),D=U=>{var qe,De;const Q=((qe=U.payments)==null?void 0:qe.reduce((ne,oe)=>ne+oe.amount,0))||0,re=((De=U.items)==null?void 0:De.reduce((ne,oe)=>ne+oe.totalCost,0))||0;let te=0,pe=0,xe=0,he=0;U.serviceCost!==void 0?(pe=U.serviceCost,te=U.laborCost||Math.max(0,U.serviceCost-re),xe=re,he=U.businessShare||te*.5):(te=U.laborCost||0,pe=re+te,xe=re,he=te);const Le=pe-Q;return{totalPaid:Q,realTotal:pe,realCost:xe,realProfit:he,remainingBalance:Le,partsCost:re,laborCost:te}},R=U=>{if(!U)return"Cliente no especificado";const Q=O.find(re=>re.id===U);return(Q==null?void 0:Q.name)||"Cliente desconocido"},B=U=>{const{remainingBalance:Q}=D(U);return Q<=.01?"paid":U.payments&&U.payments.length>0?"partial":"pending"},Y=U=>{const Q=new Set(C);Q.has(U)?Q.delete(U):Q.add(U),N(Q)},W=()=>{const U=new Date;let Q,re;switch(s){case"today":Q=new Date(U.getFullYear(),U.getMonth(),U.getDate()),re=new Date(U.getFullYear(),U.getMonth(),U.getDate(),23,59,59);break;case"yesterday":const pe=new Date(U);pe.setDate(pe.getDate()-1),Q=new Date(pe.getFullYear(),pe.getMonth(),pe.getDate()),re=new Date(pe.getFullYear(),pe.getMonth(),pe.getDate(),23,59,59);break;case"thisWeek":Q=new Date(U),Q.setDate(U.getDate()-U.getDay()),Q.setHours(0,0,0,0),re=new Date(U.getFullYear(),U.getMonth(),U.getDate(),23,59,59);break;case"thisMonth":Q=new Date(U.getFullYear(),U.getMonth(),1),re=new Date(U.getFullYear(),U.getMonth(),U.getDate(),23,59,59);break;case"lastMonth":Q=new Date(U.getFullYear(),U.getMonth()-1,1),re=new Date(U.getFullYear(),U.getMonth(),0,23,59,59);break;case"custom":if(o.startDate&&o.endDate)Q=kc(o.startDate),re=kc(o.endDate),re.setHours(23,59,59);else return[];break;default:return[]}const te=[];return P.forEach(pe=>{pe.payments&&pe.payments.forEach(xe=>{const he=_s(xe.paymentDate);he&&he>=Q&&he<=re&&te.push({...xe,serviceId:pe.id,customerName:R(pe.customerId)})})}),te.sort((pe,xe)=>new Date(xe.paymentDate).getTime()-new Date(pe.paymentDate).getTime())},L=I.useMemo(()=>{const U=W(),Q=U.reduce((xe,he)=>xe+he.amount,0),re=U.reduce((xe,he)=>(xe[he.paymentMethod]=(xe[he.paymentMethod]||0)+he.amount,xe),{}),te=U.length,pe=te>0?Q/te:0;return{totalCashReceived:Q,paymentsByMethod:re,totalPayments:te,averagePayment:pe,paymentsInRange:U}},[s,o,P,O]),X=U=>{const Q=_s(U);return Q?Q.toLocaleString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"America/Bogota"}):"Fecha invlida"},G=I.useMemo(()=>{let U=P.filter(Q=>{var qe,De,ne,oe,Ce;const re=r.toLowerCase();if(!(!r||((qe=Q.deviceDetails)==null?void 0:qe.toLowerCase().includes(re))||((De=Q.issue)==null?void 0:De.toLowerCase().includes(re))||R(Q.customerId).toLowerCase().includes(re)||Q.id.toLowerCase().includes(re)||((ne=Q.items)==null?void 0:ne.some(ke=>{var ue,se;return((ue=ke.partName)==null?void 0:ue.toLowerCase().includes(re))||((se=ke.partDescription)==null?void 0:se.toLowerCase().includes(re))}))||((oe=Q.deviceBrandModel)==null?void 0:oe.toLowerCase().includes(re))||((Ce=Q.notes)==null?void 0:Ce.toLowerCase().includes(re)))||c!=="all"&&Q.status!==c)return!1;if(d!=="all"){const ke=B(Q);if(d!==ke)return!1}let pe;if(c==="completed"?pe=_s(Q.completedAt)||_s(Q.createdAt):pe=_s(Q.createdAt),!pe)return!1;const xe=new Date,he=new Date(xe.getFullYear(),xe.getMonth(),xe.getDate()),Le=new Date(xe.getFullYear(),xe.getMonth(),xe.getDate(),23,59,59);switch(s){case"today":return pe>=he&&pe<=Le;case"yesterday":const ke=new Date(xe);ke.setDate(ke.getDate()-1);const ue=new Date(ke.getFullYear(),ke.getMonth(),ke.getDate()),se=new Date(ke.getFullYear(),ke.getMonth(),ke.getDate(),23,59,59);return pe>=ue&&pe<=se;case"thisWeek":const We=new Date(xe);return We.setDate(xe.getDate()-xe.getDay()),We.setHours(0,0,0,0),pe>=We;case"thisMonth":const Ae=new Date(xe.getFullYear(),xe.getMonth(),1);return pe>=Ae;case"lastMonth":const it=new Date(xe.getFullYear(),xe.getMonth()-1,1),ut=new Date(xe.getFullYear(),xe.getMonth(),0,23,59,59);return pe>=it&&pe<=ut;case"custom":if(o.startDate&&o.endDate){const mt=kc(o.startDate),pt=kc(o.endDate);return pt.setHours(23,59,59),pe>=mt&&pe<=pt}return!1;default:return!0}});return U.sort((Q,re)=>{let te=0;switch(f){case"date":let pe,xe;c==="completed"?(pe=_s(Q.completedAt)||_s(Q.createdAt),xe=_s(re.completedAt)||_s(re.createdAt)):(pe=_s(Q.createdAt),xe=_s(re.createdAt)),te=pe&&xe?pe.getTime()-xe.getTime():0;break;case"total":te=D(Q).realTotal-D(re).realTotal;break;case"profit":te=D(Q).realProfit-D(re).realProfit;break}return y==="desc"?-te:te}),U},[P,r,s,o,c,d,f,y,O]),K=G.length,q=Math.ceil(K/T),ie=(x-1)*T,ge=G.slice(ie,ie+T),be=I.useMemo(()=>{const U=G.filter(oe=>oe.status==="completed"),Q=G.filter(oe=>oe.status==="active"),re=G.reduce((oe,Ce)=>{const{totalPaid:ke}=D(Ce);return oe+ke},0),te=G.reduce((oe,Ce)=>{const{totalPaid:ke,realTotal:ue,realCost:se}=D(Ce),We=ue>0?ke/ue*se:0;return oe+We},0),pe=re-te,xe=U.length>0?U.reduce((oe,Ce)=>oe+D(Ce).realTotal,0)/U.length:0,he=re>0?pe/re*100:0,Le=G.filter(oe=>B(oe)==="pending").length,qe=G.filter(oe=>B(oe)==="partial").length,De=G.filter(oe=>B(oe)==="paid").length,ne=G.reduce((oe,Ce)=>{const{remainingBalance:ke}=D(Ce);return oe+Math.max(0,ke)},0);return{totalServices:G.length,completedServices:U.length,activeServices:Q.length,totalRevenue:re,totalProfit:pe,totalCost:te,averageService:xe,profitMargin:he,servicesWithPendingPayments:Le,servicesWithPartialPayments:qe,servicesFullyPaid:De,totalPendingAmount:ne}},[G]),Ye=U=>{switch(U){case"active":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},ze=U=>{switch(U){case"active":return"Activo";case"completed":return"Finalizado";case"cancelled":return"Cancelado";default:return U}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"mb-4 pt-4",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Centro de Servicios Tcnicos"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Administra el control de caja diario, pagos recibidos y seguimiento de servicios"})]})})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-300",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:[a.jsx("button",{onClick:()=>e("services"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(zl,{className:"h-4 w-4"}),a.jsx("span",{children:"Servicios"})]})}),a.jsx("button",{onClick:()=>e("cashflow"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="cashflow"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Wt,{className:"h-4 w-4"}),a.jsx("span",{children:"Flujo de Caja"})]})})]})}),a.jsxs("div",{className:"p-6",children:[t==="services"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(zl,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-0.5 group-hover:text-gray-700 transition-colors duration-300",children:"Total Servicios"}),a.jsx("p",{className:"text-base font-bold text-gray-900 group-hover:text-blue-900 transition-colors duration-300",children:be.totalServices})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-green-500/10 hover:-translate-y-0.5 hover:border-green-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-green-50 rounded flex items-center justify-center group-hover:bg-green-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Wt,{className:"w-3 h-3 text-green-600 group-hover:text-green-700"})}),a.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-0.5 group-hover:text-gray-700 transition-colors duration-300",children:"Ingresos"}),a.jsx("p",{className:"text-base font-bold text-gray-900 group-hover:text-green-900 transition-colors duration-300",children:V(be.totalRevenue)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ds,{className:"w-3 h-3 text-emerald-600 group-hover:text-emerald-700"})}),a.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-0.5 group-hover:text-gray-700 transition-colors duration-300",children:"Ganancia"}),a.jsx("p",{className:"text-base font-bold text-gray-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(be.totalProfit)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-purple-500/10 hover:-translate-y-0.5 hover:border-purple-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-purple-50 rounded flex items-center justify-center group-hover:bg-purple-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ga,{className:"w-3 h-3 text-purple-600 group-hover:text-purple-700"})}),a.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-0.5 group-hover:text-gray-700 transition-colors duration-300",children:"Margen"}),a.jsxs("p",{className:"text-base font-bold text-gray-900 group-hover:text-purple-900 transition-colors duration-300",children:[be.profitMargin.toFixed(1),"%"]})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-orange-500/10 hover:-translate-y-0.5 hover:border-orange-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-orange-50 rounded flex items-center justify-center group-hover:bg-orange-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Pi,{className:"w-3 h-3 text-orange-600 group-hover:text-orange-700"})}),a.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-0.5 group-hover:text-gray-700 transition-colors duration-300",children:"Por Cobrar"}),a.jsx("p",{className:"text-base font-bold text-gray-900 group-hover:text-orange-900 transition-colors duration-300",children:V(be.totalPendingAmount)})]})})]}),a.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-300",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Buscar"}),a.jsxs("div",{className:"relative",children:[a.jsx(da,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),a.jsx("input",{type:"text",value:r,onChange:U=>n(U.target.value),placeholder:"ID, cliente, dispositivo, problema, repuestos...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-300",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Perodo"}),a.jsxs("select",{value:s,onChange:U=>i(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"today",children:"Hoy"}),a.jsx("option",{value:"yesterday",children:"Ayer"}),a.jsx("option",{value:"thisWeek",children:"Esta semana"}),a.jsx("option",{value:"thisMonth",children:"Este mes"}),a.jsx("option",{value:"lastMonth",children:"Mes pasado"}),a.jsx("option",{value:"custom",children:"Personalizado"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado"}),a.jsxs("select",{value:c,onChange:U=>u(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"Todos"}),a.jsx("option",{value:"active",children:"Activos"}),a.jsx("option",{value:"completed",children:"Finalizados"}),a.jsx("option",{value:"cancelled",children:"Cancelados"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado de Pago"}),a.jsxs("select",{value:d,onChange:U=>h(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"Todos los pagos"}),a.jsx("option",{value:"paid",children:"Pagado completo"}),a.jsx("option",{value:"partial",children:"Pago parcial"}),a.jsx("option",{value:"pending",children:"Sin pagos"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ordenar por"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("select",{value:f,onChange:U=>m(U.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"date",children:"Fecha"}),a.jsx("option",{value:"total",children:"Total"}),a.jsx("option",{value:"profit",children:"Ganancia"})]}),a.jsx("button",{onClick:()=>g(y==="asc"?"desc":"asc"),className:"px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:y==="asc"?a.jsx(Is,{className:"h-4 w-4"}):a.jsx(Da,{className:"h-4 w-4"})})]})]})]}),w&&a.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("p",{className:"text-sm text-red-600",children:w})}),(()=>{const U=k();return U&&a.jsx("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xn,{className:"h-4 w-4 text-blue-600"}),a.jsxs("span",{className:"text-xs font-medium text-blue-900",children:["Mostrando servicios desde el ",a.jsx("strong",{children:U.startDateFormatted})," hasta el ",a.jsx("strong",{children:U.endDateFormatted})]})]})})})(),s==="custom"&&a.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha inicial"}),a.jsx("input",{type:"date",value:o.startDate,onChange:U=>{const Q=new Date,re=new Date(Q.getFullYear(),Q.getMonth()-6,Q.getDate());if(new Date(U.target.value)<re){E("La fecha inicial no puede ser mayor a 6 meses atrs"),setTimeout(()=>E(""),3e3);return}E(""),l({...o,startDate:U.target.value})},min:(()=>{const U=new Date;return new Date(U.getFullYear(),U.getMonth()-6,U.getDate()).toISOString().split("T")[0]})(),max:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha final"}),a.jsx("input",{type:"date",value:o.endDate,onChange:U=>{const Q=new Date,re=new Date(Q.getFullYear(),Q.getMonth()-6,Q.getDate()),te=new Date(U.target.value),pe=o.startDate?new Date(o.startDate):null;if(te<re){E("La fecha final no puede ser mayor a 6 meses atrs"),setTimeout(()=>E(""),3e3);return}if(pe&&te<pe){E("La fecha final no puede ser anterior a la fecha inicial"),setTimeout(()=>E(""),3e3);return}E(""),l({...o,endDate:U.target.value})},min:o.startDate||(()=>{const U=new Date;return new Date(U.getFullYear(),U.getMonth()-6,U.getDate()).toISOString().split("T")[0]})(),max:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),(c!=="all"||s!=="all")&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),a.jsx("span",{className:"text-sm text-blue-700 font-medium",children:c==="completed"?a.jsxs(a.Fragment,{children:["Mostrando servicios por ",a.jsx("strong",{children:"fecha de finalizacin"})," (cuando se completaron)"]}):c!=="all"?a.jsxs(a.Fragment,{children:["Mostrando servicios por ",a.jsx("strong",{children:"fecha de creacin"})," (cuando se registraron)"]}):a.jsxs(a.Fragment,{children:["Mostrando todos los servicios por ",a.jsx("strong",{children:"fecha de creacin"})]})})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-300 overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dispositivo"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado de Pago"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ganancia"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ge.map(U=>{var Q;return a.jsxs(ee.Fragment,{children:[a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-gray-500",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Creado:"}),a.jsx("div",{className:"mb-2",children:X(U.createdAt)}),U.status==="completed"&&U.completedAt&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-xs text-blue-500 mb-1",children:"Finalizado:"}),a.jsx("div",{className:"text-blue-600",children:X(U.completedAt)})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Rr,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("span",{className:"text-sm text-gray-900",children:R(U.customerId)})]})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900",children:U.deviceDetails||"No especificado"}),a.jsx("div",{className:"text-sm text-gray-500",children:U.issue?U.issue.substring(0,50)+(U.issue.length>50?"...":""):""})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ye(U.status)}`,children:ze(U.status)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(()=>{const re=B(U),{remainingBalance:te}=D(U);return a.jsxs("div",{children:[a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${re==="paid"?"bg-green-100 text-green-800":re==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:re==="paid"?"Pagado":re==="partial"?"Parcial":"Pendiente"}),te>0&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Debe: ",V(te)]})]})})()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:V(D(U).realTotal)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:a.jsx("div",{className:"text-sm font-medium text-green-600",children:V(D(U).realProfit)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:re=>{re.stopPropagation(),j(U),_(!0)},className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50 transition-colors",title:"Ver detalles",children:a.jsx(os,{className:"h-4 w-4"})}),a.jsx("button",{onClick:re=>{re.stopPropagation(),Y(U.id)},className:"text-gray-400 hover:text-gray-600 p-1 rounded hover:bg-gray-50 transition-colors",title:C.has(U.id)?"Ocultar pagos":"Ver pagos",children:C.has(U.id)?a.jsx(Is,{className:"h-4 w-4"}):a.jsx(Da,{className:"h-4 w-4"})})]})})]}),C.has(U.id)&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-6 py-4 bg-gray-50 border-t",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Historial de Pagos"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[((Q=U.payments)==null?void 0:Q.length)||0," pago(s) registrado(s)"]})]}),U.payments&&U.payments.length>0?a.jsxs("div",{className:"space-y-2",children:[U.payments.map(re=>a.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[re.paymentMethod==="efectivo"?a.jsx(Zh,{className:"h-4 w-4 text-green-600"}):re.paymentMethod==="transferencia"||re.paymentMethod==="tarjeta"?a.jsx(ef,{className:"h-4 w-4 text-blue-600"}):a.jsx(Wt,{className:"h-4 w-4 text-purple-600"}),a.jsx("span",{className:"text-sm font-medium capitalize",children:re.paymentMethod})]}),a.jsx("div",{className:"text-sm text-gray-600",children:X(re.paymentDate)}),re.notes&&a.jsx("div",{className:"text-xs text-gray-500 italic",children:re.notes})]}),a.jsx("div",{className:"text-sm font-semibold text-green-600",children:V(re.amount)})]},re.id)),a.jsxs("div",{className:"flex justify-between items-center bg-blue-50 p-3 rounded border-l-4 border-blue-400",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Total Pagado:"}),a.jsx("p",{className:"font-semibold text-green-600",children:V(D(U).totalPaid)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Pendiente:"}),a.jsx("p",{className:"font-semibold text-orange-600",children:V(Math.max(0,D(U).remainingBalance))})]})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[(D(U).totalPaid/D(U).realTotal*100).toFixed(1),"% completado"]})]})]}):a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(Pi,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),a.jsx("p",{children:"No hay pagos registrados para este servicio"})]})]})})})]},U.id)})})]})}),q>1&&a.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[a.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[a.jsx("button",{onClick:()=>b(Math.max(1,x-1)),disabled:x===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),a.jsx("button",{onClick:()=>b(Math.min(q,x+1)),disabled:x===q,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente"})]}),a.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[a.jsx("div",{children:a.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando"," ",a.jsx("span",{className:"font-medium",children:ie+1})," ","a"," ",a.jsx("span",{className:"font-medium",children:Math.min(ie+T,K)})," ","de"," ",a.jsx("span",{className:"font-medium",children:K})," ","servicios"]})}),a.jsx("div",{children:a.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:Array.from({length:q},(U,Q)=>Q+1).map(U=>a.jsx("button",{onClick:()=>b(U),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${U===x?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:U},U))})})]})]})]}),ge.length===0&&a.jsxs("div",{className:"bg-white rounded-xl p-12 text-center shadow-sm border border-gray-300",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(zl,{className:"h-12 w-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron servicios"}),a.jsx("p",{className:"text-gray-500",children:r||s!=="today"||c!=="all"?"Intenta ajustar tus filtros de bsqueda.":"No hay servicios tcnicos registrados."})]})]}),t==="cashflow"&&a.jsxs("div",{className:"space-y-6",children:[(()=>{const U=k();return U&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xn,{className:"h-5 w-5 text-green-600"}),a.jsxs("span",{className:"text-sm font-medium text-green-900",children:["Mostrando flujo de caja desde el ",a.jsx("strong",{children:U.startDateFormatted})," hasta el ",a.jsx("strong",{children:U.endDateFormatted})]})]})})})(),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Perodo"}),a.jsxs("select",{value:s,onChange:U=>i(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"today",children:"Hoy"}),a.jsx("option",{value:"yesterday",children:"Ayer"}),a.jsx("option",{value:"thisWeek",children:"Esta semana"}),a.jsx("option",{value:"thisMonth",children:"Este mes"}),a.jsx("option",{value:"lastMonth",children:"Mes pasado"}),a.jsx("option",{value:"custom",children:"Personalizado"})]})]}),w&&a.jsx("div",{className:"col-span-full p-3 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("p",{className:"text-sm text-red-600",children:w})}),s==="custom"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha inicial"}),a.jsx("input",{type:"date",value:o.startDate,onChange:U=>{const Q=new Date,re=new Date(Q.getFullYear(),Q.getMonth()-6,Q.getDate());if(new Date(U.target.value)<re){E("La fecha inicial no puede ser mayor a 6 meses atrs"),setTimeout(()=>E(""),3e3);return}E(""),l({...o,startDate:U.target.value})},min:(()=>{const U=new Date;return new Date(U.getFullYear(),U.getMonth()-6,U.getDate()).toISOString().split("T")[0]})(),max:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha final"}),a.jsx("input",{type:"date",value:o.endDate,onChange:U=>{const Q=new Date,re=new Date(Q.getFullYear(),Q.getMonth()-6,Q.getDate()),te=new Date(U.target.value),pe=o.startDate?new Date(o.startDate):null;if(te<re){E("La fecha final no puede ser mayor a 6 meses atrs"),setTimeout(()=>E(""),3e3);return}if(pe&&te<pe){E("La fecha final no puede ser anterior a la fecha inicial"),setTimeout(()=>E(""),3e3);return}E(""),l({...o,endDate:U.target.value})},min:o.startDate||(()=>{const U=new Date;return new Date(U.getFullYear(),U.getMonth()-6,U.getDate()).toISOString().split("T")[0]})(),max:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx(Wt,{className:"h-5 w-5 mr-2 text-blue-600"}),"Flujo de Caja - ",s==="today"?"Hoy":s==="yesterday"?"Ayer":s==="thisWeek"?"Esta Semana":s==="thisMonth"?"Este Mes":s==="lastMonth"?"Mes Pasado":s==="custom"?"Perodo Personalizado":"Perodo Seleccionado"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Dinero recibido en servicios tcnicos"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xl font-bold text-green-600",children:V(L.totalCashReceived)}),a.jsxs("p",{className:"text-sm text-gray-600",children:[L.totalPayments," pago(s)"]})]})]}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:Object.entries(L.paymentsByMethod).map(([U,Q])=>a.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[U==="efectivo"?a.jsx(Zh,{className:"h-4 w-4 text-green-600"}):U==="transferencia"||U==="tarjeta"?a.jsx(ef,{className:"h-4 w-4 text-blue-600"}):a.jsx(Wt,{className:"h-4 w-4 text-purple-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:U})]}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:V(Q)})]},U))}),L.paymentsInRange.length>0?a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Detalle de Pagos Recibidos"}),a.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:L.paymentsInRange.map(U=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[U.paymentMethod==="efectivo"?a.jsx(Zh,{className:"h-4 w-4 text-green-600"}):U.paymentMethod==="transferencia"||U.paymentMethod==="tarjeta"?a.jsx(ef,{className:"h-4 w-4 text-blue-600"}):a.jsx(Wt,{className:"h-4 w-4 text-purple-600"}),a.jsx("span",{className:"text-sm font-medium capitalize",children:U.paymentMethod})]}),a.jsx("div",{className:"text-sm text-gray-600",children:U.customerName}),a.jsx("div",{className:"text-xs text-gray-500",children:X(U.paymentDate)}),U.notes&&a.jsx("div",{className:"text-xs text-gray-400 italic",children:U.notes})]}),a.jsx("div",{className:"text-sm font-semibold text-green-600",children:V(U.amount)})]},`${U.serviceId}-${U.id}`))})]}):a.jsxs("div",{className:"bg-white rounded-lg p-8 border border-gray-200 text-center",children:[a.jsx(Pi,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay pagos en este perodo"}),a.jsx("p",{className:"text-gray-500",children:"No se registraron pagos para el perodo seleccionado"})]})]})]})]})]}),S&&v&&a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>_(!1)}),a.jsx("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",children:a.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Detalles del Servicio"}),a.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[a.jsxs("span",{className:"text-sm font-mono text-gray-600 bg-gray-100 px-2 py-1 rounded",children:["ID: ",v.id]}),a.jsx("button",{onClick:()=>navigator.clipboard.writeText(v.id),className:"text-gray-400 hover:text-gray-600 p-1",title:"Copiar ID",children:a.jsxs("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:[a.jsx("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),a.jsx("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"})]})})]})]}),a.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Cliente"}),a.jsx("p",{className:"text-sm text-gray-900",children:R(v.customerId)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Estado"}),a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ye(v.status)}`,children:ze(v.status)})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dispositivo"}),a.jsx("p",{className:"text-sm text-gray-900",children:v.deviceDetails||"No especificado"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Problema reportado"}),a.jsx("p",{className:"text-sm text-gray-900",children:v.issue||"No especificado"})]}),v.diagnosis&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Diagnstico"}),a.jsx("p",{className:"text-sm text-gray-900",children:v.diagnosis})]}),v.items&&v.items.length>0&&a.jsxs("div",{className:"pt-4 border-t",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-3",children:"Repuestos utilizados"}),a.jsx("div",{className:"space-y-2",children:v.items.map(U=>a.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.partName}),U.partDescription&&a.jsx("p",{className:"text-xs text-gray-600",children:U.partDescription}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Cantidad: ",U.quantity," | Costo unitario: ",V(U.partCost)]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-900",children:V(U.totalCost)}),a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${U.status==="instalado"?"bg-green-100 text-green-800":U.status==="en_tienda"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:U.status==="instalado"?"Instalado":U.status==="en_tienda"?"En tienda":"Solicitado"})]})]},U.id))})]}),v.courtesyItems&&v.courtesyItems.length>0&&a.jsxs("div",{className:"pt-4 border-t",children:[a.jsxs("p",{className:"text-sm font-medium text-gray-600 mb-3 flex items-center",children:[a.jsx(ur,{className:"h-4 w-4 text-cyan-600 mr-2"}),"Cortesas"]}),a.jsx("div",{className:"space-y-2",children:v.courtesyItems.map((U,Q)=>a.jsxs("div",{className:"flex justify-between items-center bg-cyan-50 p-3 rounded border border-cyan-200",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.productName}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Cantidad: ",U.quantity," | Valor: ",V(U.normalPrice)]}),U.reason&&a.jsxs("p",{className:"text-xs text-gray-600 italic mt-1",children:["Motivo: ",U.reason]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm font-semibold text-cyan-600",children:V(U.totalValue)}),a.jsxs("p",{className:"text-xs text-red-600",children:["Costo: -",V(U.totalCost)]})]})]},Q))})]}),a.jsxs("div",{className:"pt-4 border-t",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-3",children:"Resumen Financiero"}),(()=>{var oe;const{realTotal:U,realCost:Q,realProfit:re}=D(v),te=((oe=v.items)==null?void 0:oe.reduce((Ce,ke)=>Ce+ke.totalCost,0))||0,pe=v.laborCost||0,xe=v.courtesyItems&&v.courtesyItems.length>0,he=v.courtesyTotalValue||0,Le=v.courtesyTotalCost||0,qe=xe?re-Le:re,De=xe?Q+Le:Q,ne=qe<0;return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm bg-gray-50 p-3 rounded",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Repuestos:"}),a.jsx("p",{className:"font-medium",children:V(te)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Mano de Obra:"}),a.jsx("p",{className:"font-medium",children:V(pe)})]})]}),xe&&a.jsxs("div",{className:"bg-cyan-50 p-3 rounded border border-cyan-200 space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{className:"text-cyan-700 flex items-center",children:[a.jsx(ur,{className:"h-3 w-3 mr-1"}),"Valor cortesas regaladas:"]}),a.jsx("span",{className:"font-medium text-cyan-700",children:V(he)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{className:"text-red-600 flex items-center",children:[a.jsx(ur,{className:"h-3 w-3 mr-1"}),"Costo cortesas:"]}),a.jsxs("span",{className:"font-medium text-red-600",children:["-",V(Le)]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-2 border-t",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),a.jsx("p",{className:"text-lg font-bold text-gray-900",children:V(U)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:xe?"Costo Real":"Costo"}),a.jsx("p",{className:"text-lg font-semibold text-red-600",children:V(De)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:xe?ne?"Prdida Real":"Ganancia Real":"Ganancia"}),a.jsxs("p",{className:`text-lg font-bold ${ne?"text-red-600":"text-green-600"}`,children:[ne?"":"+",V(qe)]})]})]})]})})()]})]})]})})]})})]})}function _G({searchTerm:t="",dateFilter:e="today",customDateRange:r={startDate:"",endDate:""},sortBy:n="date",sortOrder:s="desc",itemsPerPage:i=10}){const[o,l]=I.useState([]),[c,u]=I.useState(!1),[d,h]=I.useState(null),[f,m]=I.useState(1),[y,g]=I.useState(!1),[x,b]=I.useState(!1),v=I.useCallback((w=null)=>{let E=yt(Pe,"purchases"),k=[];const T=new Date;let P=null,O=null;switch(e){case"today":{P=new Date(T.getFullYear(),T.getMonth(),T.getDate(),0,0,0,0),O=new Date(T.getFullYear(),T.getMonth(),T.getDate(),23,59,59,999);break}case"week":P=new Date(T.getTime()-7*24*60*60*1e3);break;case"month":P=new Date(T.getTime()-30*24*60*60*1e3);break;case"3months":P=new Date(T.getTime()-90*24*60*60*1e3);break;case"6months":P=new Date(T.getTime()-180*24*60*60*1e3);break;case"year":P=new Date(T.getTime()-365*24*60*60*1e3);break;case"custom":if(r.startDate&&r.endDate){const[R,B,Y]=r.startDate.split("-").map(Number);P=new Date(R,B-1,Y,0,0,0,0);const[W,L,X]=r.endDate.split("-").map(Number);O=new Date(W,L-1,X,23,59,59,999)}else return null;break}P&&k.push(or("createdAt",">=",P.toISOString())),O&&k.push(or("createdAt","<=",O.toISOString()));let D="createdAt";return n==="totalCost"&&(D="totalCost"),n==="totalItems"&&(D="totalItems"),k.push(dr(D,s)),t.trim()?k.push(oc(1e3)):(k.push(oc(i+1)),w&&k.push(Um(w))),Bt(E,...k)},[e,r,n,s,i,t]),j=I.useCallback(async w=>{if(e==="custom"&&(!r.startDate||!r.endDate)){console.log(" Skipping fetch compras - filtro personalizado sin fechas completas"),l([]),g(!1),b(w>1),u(!1);return}u(!0),h(null);try{if(!v(null)){l([]),g(!1),b(w>1),u(!1);return}if(t.trim()){const k=v(null);if(!k){l([]),g(!1),b(!1);return}const T=await Kt(k);console.log(" Bsqueda activa en compras - docs obtenidos:",T.docs.length);let P=T.docs.map(Y=>({id:Y.id,...Y.data()}));const O=t.toLowerCase();P=P.filter(Y=>Y.id.toLowerCase().includes(O)||Y.items.some(W=>W.productName.toLowerCase().includes(O))||Y.notes&&Y.notes.toLowerCase().includes(O)),console.log(" Resultados de bsqueda en compras:",P.length);const D=P.length,R=(w-1)*i,B=R+i;g(B<D),b(w>1),l(P.slice(R,B))}else{let k=null;for(let T=1;T<=w;T++){const P=v(k);if(!P){l([]),g(!1),b(w>1);return}const D=(await Kt(P)).docs;if(T===w){const R=Math.min(i,D.length),B=D.slice(0,R).map(Y=>({id:Y.id,...Y.data()}));l(B),g(D.length>i),b(w>1)}else D.length>0&&(k=D[Math.min(i-1,D.length-1)])}}}catch(E){console.error("Error fetching purchases:",E),h(E.message||"Error desconocido al cargar las compras"),l([])}finally{u(!1)}},[v,i,t,e,r]),S=I.useCallback(()=>{j(f)},[j,f]),_=I.useCallback(()=>{if(y){const w=f+1;m(w),j(w)}},[y,f,j]),C=I.useCallback(()=>{if(x){const w=f-1;m(w),j(w)}},[x,f,j]),N=I.useCallback(w=>{m(w),j(w)},[j]);return I.useEffect(()=>{if(e==="custom"&&(!r.startDate||!r.endDate)){console.log(" Limpiando tabla de compras inmediatamente - filtro personalizado sin fechas completas"),l([]),g(!1),b(!1),u(!1),m(1);return}(async()=>{console.log(" Cargando compras con filtros:",{dateFilter:e,customDateRange:r}),m(1),await j(1)})()},[e,r,n,s,t,i]),{purchases:o,loading:c,error:d,currentPage:f,hasNextPage:y,hasPrevPage:x,nextPage:_,prevPage:C,setPage:N,refetch:S}}function TP(t){const[e,r,n]=t.split("-").map(Number);return new Date(e,r-1,n,0,0,0,0)}function SG({searchTerm:t="",dateFilter:e="today",customDateRange:r={startDate:"",endDate:""}}){const[n,s]=I.useState({totalPurchases:0,totalCost:0,totalItems:0,averagePurchase:0,purchaseCount:0,loading:!0,error:null}),i=I.useCallback(async()=>{s(l=>({...l,loading:!0,error:null}));try{if(e==="custom"&&(!r.startDate||!r.endDate)){s({totalPurchases:0,totalCost:0,totalItems:0,averagePurchase:0,purchaseCount:0,loading:!1,error:null});return}let l=yt(Pe,"purchases"),c=[];const u=new Date;let d=null,h=null;switch(e){case"today":{d=new Date(u.getFullYear(),u.getMonth(),u.getDate(),0,0,0,0),h=new Date(u.getFullYear(),u.getMonth(),u.getDate(),23,59,59,999);break}case"week":d=new Date(u.getTime()-7*24*60*60*1e3);break;case"month":d=new Date(u.getTime()-30*24*60*60*1e3);break;case"3months":d=new Date(u.getTime()-90*24*60*60*1e3);break;case"6months":d=new Date(u.getTime()-180*24*60*60*1e3);break;case"year":d=new Date(u.getTime()-365*24*60*60*1e3);break;case"custom":r.startDate&&(d=TP(r.startDate)),r.endDate&&(h=TP(r.endDate),h.setHours(23,59,59,999));break}d&&c.push(or("createdAt",">=",d.toISOString())),h&&c.push(or("createdAt","<=",h.toISOString()));const f=c.length>0?Bt(l,...c):l,y=(await Kt(f)).docs.map(S=>({id:S.id,...S.data()}));let g=y;t.trim()&&(g=y.filter(S=>S.id.toLowerCase().includes(t.toLowerCase())||S.items.some(_=>_.productName.toLowerCase().includes(t.toLowerCase()))||S.notes&&S.notes.toLowerCase().includes(t.toLowerCase())));const x=g.reduce((S,_)=>S+(_.totalCost||0),0),b=g.reduce((S,_)=>S+(_.totalItems||0),0),v=g.length,j=v>0?x/v:0;s({totalPurchases:x,totalCost:x,totalItems:b,averagePurchase:j,purchaseCount:v,loading:!1,error:null})}catch(l){console.error("Error fetching purchase stats:",l),s(c=>({...c,loading:!1,error:l.message||"Error desconocido al cargar estadsticas de compras"}))}},[t,e,r]),o=I.useCallback(()=>{i()},[i]);return I.useEffect(()=>{e==="custom"&&(!r.startDate||!r.endDate)&&s({totalPurchases:0,totalCost:0,totalItems:0,averagePurchase:0,purchaseCount:0,loading:!1,error:null})},[e,r.startDate,r.endDate]),I.useEffect(()=>{i()},[i]),{...n,refetch:o}}function CG(){const[t,e]=I.useState(!1),[r,n]=I.useState(null);return{createReturn:async(u,d,h,f)=>{if(!u.id||d.length===0)return{success:!1,error:"Datos de devolucin invlidos"};e(!0),n(null);try{const m=us(Pe),y=`return_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,g=d.reduce((C,N)=>C+N.totalRefund,0),x=d.reduce((C,N)=>C+N.returnedQuantity,0),b={id:y,purchaseId:u.id,items:d,totalRefund:g,totalReturnedItems:x,reason:h,createdAt:new Date().toISOString(),notes:f},v=ht(Pe,"purchases",u.id),S=(u.totalReturned||0)+g,_=(u.totalCost||0)-S;m.update(v,{returns:DM(b),totalReturned:S,netCost:_,updatedAt:new Date().toISOString()});for(const C of d){const N=ht(Pe,"products",C.productId);m.update(N,{stock:ba(-C.returnedQuantity),updatedAt:new Date().toISOString()})}return await m.commit(),e(!1),{success:!0,returnId:y}}catch(m){const y=m instanceof Error?m.message:"Error al procesar devolucin";return n(y),e(!1),{success:!1,error:y}}},validateReturnItems:(u,d)=>{const h=[];if(!u.id)return h.push("Compra invlida"),{isValid:!1,errors:h};if(d.length===0)return h.push("Debe seleccionar al menos un producto para devolver"),{isValid:!1,errors:h};for(const f of d){const m=u.items.find(b=>b.productId===f.productId);if(!m){h.push(`Producto ${f.productName} no encontrado en la compra original`);continue}const g=(u.returns||[]).reduce((b,v)=>{const j=v.items.find(S=>S.productId===f.productId);return b+((j==null?void 0:j.returnedQuantity)||0)},0),x=m.quantity-g;f.returnedQuantity<=0?h.push(`La cantidad a devolver de ${f.productName} debe ser mayor a 0`):f.returnedQuantity>x&&h.push(`No se puede devolver ${f.returnedQuantity} unidades de ${f.productName}. Mximo disponible para devolucin: ${x}`),Math.abs(f.purchasePrice-m.purchasePrice)>.01&&h.push(`El precio de ${f.productName} no coincide con la compra original`)}return{isValid:h.length===0,errors:h}},getReturnableQuantity:(u,d)=>{const h=u.items.find(y=>y.productId===d);if(!h)return 0;const m=(u.returns||[]).reduce((y,g)=>{const x=g.items.find(b=>b.productId===d);return y+((x==null?void 0:x.returnedQuantity)||0)},0);return h.quantity-m},getTotalReturned:u=>u.totalReturned||0,getNetCost:u=>u.netCost||u.totalCost||0,loading:t,error:r}}function yb(t){if(!t)return null;if(typeof t.toDate=="function")return t.toDate();if(typeof t=="string"){const r=new Date(t);return isNaN(r.getTime())?null:r}const e=new Date(t);return isNaN(e.getTime())?null:e}function EG(){var Ce,ke,ue;const[t,e]=I.useState(""),[r,n]=I.useState("today"),[s,i]=I.useState({startDate:"",endDate:""}),[o,l]=I.useState("date"),[c,u]=I.useState("desc"),[d,h]=I.useState(!1),[f,m]=I.useState(null),[y,g]=I.useState(!1),[x,b]=I.useState([]),[v,j]=I.useState(""),[S,_]=I.useState(""),[C,N]=I.useState(null),w=10,{purchases:E,loading:k,error:T,currentPage:P,hasNextPage:O,hasPrevPage:D,nextPage:R,prevPage:B,setPage:Y,refetch:W}=_G({searchTerm:t,dateFilter:r,customDateRange:s,sortBy:o,sortOrder:c,itemsPerPage:w}),L=r==="custom"&&(!s.startDate||!s.endDate)?[]:E,X=SG({searchTerm:t,dateFilter:r,customDateRange:s}),{createReturn:G,validateReturnItems:K,getReturnableQuantity:q,getTotalReturned:ie,getNetCost:ge,loading:be,error:Ye}=CG(),ze=se=>{o===se?u(c==="asc"?"desc":"asc"):(l(se),u("desc")),W()},U=se=>{n(se),i(se!=="custom"?{startDate:"",endDate:""}:{startDate:"",endDate:""}),Y(1)},Q=(se,We)=>{const Ae={...s,[se]:We};if(Ae.startDate&&Ae.endDate){const it=te(Ae.startDate),ut=te(Ae.endDate);if((ut.getTime()-it.getTime())/(1e3*3600*24)>365)if(se==="endDate"){const gt=new Date(ut);gt.setFullYear(gt.getFullYear()-1),Ae.startDate=gt.toISOString().split("T")[0]}else{const gt=new Date(it);gt.setFullYear(gt.getFullYear()+1),Ae.endDate=gt.toISOString().split("T")[0]}}i(Ae),Y(1)},re=()=>{i({startDate:"",endDate:""}),n("today"),Y(1)};function te(se){const[We,Ae,it]=se.split("-").map(Number);return new Date(We,Ae-1,it,0,0,0,0)}const pe=()=>{if(r==="custom"&&(s.startDate||s.endDate)){const se=s.startDate?te(s.startDate).toLocaleDateString():"Inicio",We=s.endDate?te(s.endDate).toLocaleDateString():"Fin";return`${se} - ${We}`}return""},xe=()=>{const se=["Fecha","ID Compra","Productos","Costo Total","Total Items","Notas"],We=L.map(mt=>[new Date(mt.createdAt).toLocaleDateString(),mt.id,mt.items.map(pt=>`${sr(pt.quantity)}x ${pt.productName}`).join("; "),Cs(mt.totalCost??0),sr(mt.totalItems??0),mt.notes||""]),Ae=[se,...We].map(mt=>mt.map(pt=>`"${pt}"`).join(",")).join(`
`),it=new Blob([Ae],{type:"text/csv;charset=utf-8;"}),ut=document.createElement("a");if(ut.download!==void 0){const mt=URL.createObjectURL(it);ut.setAttribute("href",mt),ut.setAttribute("download",`historial-compras-${new Date().toISOString().split("T")[0]}.csv`),ut.style.visibility="hidden",document.body.appendChild(ut),ut.click(),document.body.removeChild(ut)}},he=se=>{m(se),g(!0);const We=se.items.map(Ae=>({productId:Ae.productId,productName:Ae.productName,returnedQuantity:0,originalQuantity:Ae.quantity,purchasePrice:Ae.purchasePrice,totalRefund:0,reason:""}));b(We),j(""),_("")},Le=()=>{g(!1),m(null),b([]),j(""),_("")},qe=(se,We)=>{if(!f)return;const Ae=q(f,se),it=Math.max(0,Math.min(We,Ae));b(ut=>ut.map(mt=>mt.productId===se?{...mt,returnedQuantity:it,totalRefund:it*mt.purchasePrice}:mt))},De=(se,We)=>{b(Ae=>Ae.map(it=>it.productId===se?{...it,reason:We}:it))},ne=async()=>{if(!f)return;const se=x.filter(it=>it.returnedQuantity>0);if(se.length===0){N({show:!0,type:"error",title:"Error",message:"Debe seleccionar al menos un producto para devolver"});return}const We=K(f,se);if(!We.isValid){N({show:!0,type:"error",title:"Error de validacin",message:We.errors.join(", ")});return}const Ae=await G(f,se,v,S);Ae.success?(N({show:!0,type:"success",title:"Devolucin procesada",message:`Se ha registrado la devolucin correctamente. Total: ${V(se.reduce((it,ut)=>it+ut.totalRefund,0))}`}),Le(),W(),setTimeout(()=>N(null),5e3)):N({show:!0,type:"error",title:"Error al procesar devolucin",message:Ae.error||"Ocurri un error inesperado"})},oe=se=>se.returns&&se.returns.length>0||!1;return T?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[a.jsx("div",{className:"text-red-600 mb-4",children:a.jsx(ga,{className:"w-12 h-12 mx-auto mb-4"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error al cargar el historial"}),a.jsx("p",{className:"text-gray-600 mb-4",children:T}),a.jsx("button",{onClick:W,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Reintentar"})]}):a.jsxs("div",{className:"space-y-6",children:[C&&a.jsx("div",{className:`fixed top-4 right-4 z-50 max-w-sm w-full ${C.type==="success"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"} border rounded-lg shadow-lg p-4`,children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:`flex-shrink-0 ${C.type==="success"?"text-green-600":"text-red-600"}`,children:C.type==="success"?a.jsx("div",{className:"w-5 h-5 rounded-full bg-green-100 flex items-center justify-center",children:a.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full"})}):a.jsx(ct,{className:"w-5 h-5"})}),a.jsxs("div",{className:"ml-3 flex-1",children:[a.jsx("h4",{className:`text-sm font-medium ${C.type==="success"?"text-green-800":"text-red-800"}`,children:C.title}),a.jsx("p",{className:`text-sm mt-1 ${C.type==="success"?"text-green-700":"text-red-700"}`,children:C.message})]}),a.jsx("button",{onClick:()=>N(null),className:`ml-3 flex-shrink-0 ${C.type==="success"?"text-green-400 hover:text-green-600":"text-red-400 hover:text-red-600"}`,children:a.jsx(ct,{className:"w-4 h-4"})})]})}),a.jsx("div",{className:"mb-4 pt-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestin de Compras"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Administra el historial y anlisis de transacciones de compras"})]}),a.jsxs("button",{onClick:xe,disabled:L.length===0,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(BM,{className:"w-4 h-4"}),a.jsx("span",{children:"Exportar CSV"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-purple-500/10 hover:-translate-y-0.5 hover:border-purple-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-purple-50 rounded flex items-center justify-center group-hover:bg-purple-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Wt,{className:"w-3 h-3 text-purple-600 group-hover:text-purple-700"})}),a.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-0.5 group-hover:text-gray-700 transition-colors duration-300",children:"Total Compras"}),a.jsx("p",{className:"text-base font-bold text-gray-900 group-hover:text-purple-900 transition-colors duration-300",children:X.loading?a.jsx(ks,{className:"w-4 h-4 animate-spin text-gray-400 mx-auto"}):V(X.totalPurchases)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ea,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-0.5 group-hover:text-gray-700 transition-colors duration-300",children:"Total Items"}),a.jsx("p",{className:"text-base font-bold text-gray-900 group-hover:text-blue-900 transition-colors duration-300",children:X.loading?a.jsx(ks,{className:"w-4 h-4 animate-spin text-gray-400 mx-auto"}):sr(X.totalItems)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-green-500/10 hover:-translate-y-0.5 hover:border-green-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-green-50 rounded flex items-center justify-center group-hover:bg-green-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ds,{className:"w-3 h-3 text-green-600 group-hover:text-green-700"})}),a.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-0.5 group-hover:text-gray-700 transition-colors duration-300",children:"Compra Promedio"}),a.jsx("p",{className:"text-base font-bold text-gray-900 group-hover:text-green-900 transition-colors duration-300",children:X.loading?a.jsx(ks,{className:"w-4 h-4 animate-spin text-gray-400 mx-auto"}):V(X.averagePurchase)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-orange-500/10 hover:-translate-y-0.5 hover:border-orange-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-orange-50 rounded flex items-center justify-center group-hover:bg-orange-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ga,{className:"w-3 h-3 text-orange-600 group-hover:text-orange-700"})}),a.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-0.5 group-hover:text-gray-700 transition-colors duration-300",children:"Transacciones"}),a.jsx("p",{className:"text-base font-bold text-gray-900 group-hover:text-orange-900 transition-colors duration-300",children:X.loading?a.jsx(ks,{className:"w-4 h-4 animate-spin text-gray-400 mx-auto"}):sr(X.purchaseCount)})]})})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Buscar por ID, producto o notas...",value:t,onChange:se=>e(se.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsxs("select",{value:r,onChange:se=>U(se.target.value),className:"pl-10 pr-8 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white",children:[a.jsx("option",{value:"today",children:"Hoy"}),a.jsx("option",{value:"week",children:"ltima semana"}),a.jsx("option",{value:"month",children:"ltimo mes"}),a.jsx("option",{value:"3months",children:"ltimos 3 meses"}),a.jsx("option",{value:"6months",children:"ltimos 6 meses"}),a.jsx("option",{value:"year",children:"ltimos 12 meses"}),a.jsx("option",{value:"custom",children:"Personalizado"})]})]}),r==="custom"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative",children:[a.jsx(_0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"date",value:s.startDate,onChange:se=>Q("startDate",se.target.value),max:s.endDate||new Date().toISOString().split("T")[0],className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",title:"Fecha de inicio (mximo 1 ao de rango)"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(_0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"date",value:s.endDate,onChange:se=>Q("endDate",se.target.value),min:s.startDate,max:new Date().toISOString().split("T")[0],className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",title:"Fecha de fin (mximo 1 ao de rango)"})]})]})]}),r==="custom"&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[pe()&&a.jsxs("span",{className:"text-sm text-gray-600",children:["Rango seleccionado: ",pe()]}),pe()&&a.jsxs("button",{onClick:re,className:"text-sm text-red-600 hover:text-red-700 flex items-center space-x-1",children:[a.jsx(ct,{className:"w-4 h-4"}),a.jsx("span",{children:"Limpiar"})]})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:" Nota:"})," Por rendimiento, el rango personalizado est limitado a un mximo de 1 ao."]})})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:se=>h(se.target.checked),className:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500 focus:ring-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Solo mostrar compras con devoluciones"})]}),d&&a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[a.jsx(gl,{className:"w-3 h-3 mr-1"}),"Filtro activo"]})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[L.filter(se=>oe(se)).length," de ",L.length," compras tienen devoluciones"]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden w-full",children:[a.jsx("div",{className:"overflow-x-auto w-full",children:a.jsxs("table",{className:"min-w-full w-full table-fixed divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ze("date"),children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx($i,{className:"w-4 h-4"}),a.jsx("span",{children:"Fecha"}),o==="date"&&(c==="desc"?a.jsx(Da,{className:"w-4 h-4"}):a.jsx(Is,{className:"w-4 h-4"}))]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(DW,{className:"w-4 h-4"}),a.jsx("span",{children:"ID"})]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(ea,{className:"w-4 h-4"}),a.jsx("span",{children:"Productos"})]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ze("totalCost"),children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Wt,{className:"w-4 h-4"}),a.jsx("span",{children:"Costo Total"}),o==="totalCost"&&(c==="desc"?a.jsx(Da,{className:"w-4 h-4"}):a.jsx(Is,{className:"w-4 h-4"}))]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ze("totalItems"),children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Jo,{className:"w-4 h-4"}),a.jsx("span",{children:"Items"}),o==="totalItems"&&(c==="desc"?a.jsx(Da,{className:"w-4 h-4"}):a.jsx(Is,{className:"w-4 h-4"}))]})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsx("span",{children:"Acciones"})})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-6 py-8 text-center",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx(ks,{className:"w-5 h-5 animate-spin text-blue-600"}),a.jsx("span",{className:"text-gray-600",children:"Cargando compras..."})]})})}):L.filter(se=>!d||oe(se)).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-6 py-8 text-center",children:a.jsx("div",{className:"text-gray-500",children:d?a.jsxs(a.Fragment,{children:[a.jsx(gl,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-lg font-medium mb-2",children:"No hay compras con devoluciones"}),a.jsx("p",{className:"text-sm",children:"No se encontraron compras con devoluciones en el perodo seleccionado."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Jo,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-lg font-medium mb-2",children:"No hay compras registradas"}),a.jsx("p",{className:"text-sm",children:"No se encontraron compras con los filtros aplicados."})]})})})}):L.filter(se=>!d||oe(se)).map(se=>{const We=yb(se.createdAt),Ae=oe(se),it=Ae?ie(se):0,ut=Ae?ge(se):se.totalCost||0;return a.jsxs("tr",{className:`${Ae?"bg-red-50 border-l-4 border-red-400 hover:bg-red-100":"hover:bg-gray-50"} transition-colors`,children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{children:We?We.toLocaleDateString():"Fecha invlida"}),Ae&&a.jsx("div",{className:"flex items-center",children:a.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"})})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{children:[se.id.slice(0,8),"..."]}),Ae&&a.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[a.jsx(gl,{className:"w-3 h-3 mr-1"}),"Devuelto"]})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.jsx("div",{className:"max-w-xs",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[Ae&&a.jsx("div",{className:"flex-shrink-0 mt-0.5",title:"Esta compra tiene devoluciones",children:a.jsx(is,{className:"w-4 h-4 text-red-500"})}),a.jsxs("div",{className:"flex-1",children:[se.items.slice(0,2).map((mt,pt)=>a.jsx("div",{className:"flex justify-between",children:a.jsxs("span",{className:"truncate",children:[sr(mt.quantity),"x ",mt.productName]})},pt)),se.items.length>2&&a.jsxs("div",{className:"text-gray-500 text-xs",children:["+",se.items.length-2," ms..."]})]})]})})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex flex-col space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:Ae?"text-gray-500 line-through":"text-gray-900",children:V(se.totalCost||0)}),Ae&&a.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-1.5 py-0.5 rounded",children:"Original"})]}),Ae&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"text-red-600 font-medium",children:["-",V(it)]}),a.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-1.5 py-0.5 rounded",children:"Devuelto"})]}),Ae&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-green-600 font-bold",children:V(ut)}),a.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-1.5 py-0.5 rounded",children:"Neto"})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{children:sr(se.totalItems||0)}),Ae&&a.jsx("div",{className:"text-xs text-red-600 bg-red-50 px-1.5 py-0.5 rounded",children:"Con devoluciones"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("button",{onClick:()=>m(se),className:"text-blue-600 hover:text-blue-900 font-medium flex items-center space-x-1",children:[a.jsx(os,{className:"w-4 h-4"}),a.jsx("span",{children:"Ver"})]}),!Ae&&a.jsxs("button",{onClick:()=>he(se),className:"text-orange-600 hover:text-orange-900 font-medium flex items-center space-x-1",title:"Registrar devolucin",children:[a.jsx(gl,{className:"w-4 h-4"}),a.jsx("span",{children:"Devolver"})]}),Ae&&a.jsxs("div",{className:"flex items-center space-x-1 text-red-600 bg-red-100 px-2 py-1 rounded-full",children:[a.jsx(gl,{className:"w-3 h-3"}),a.jsx("span",{className:"text-xs font-medium",children:"Procesado"})]})]})})]},se.id)})})]})}),!k&&L.filter(se=>!d||oe(se)).length>0&&a.jsxs("div",{className:"bg-white px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-gray-700",children:["Pgina ",P," - Mostrando ",L.filter(se=>!d||oe(se)).length," compras",d&&a.jsx("span",{className:"text-red-600 ml-2",children:"(solo con devoluciones)"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:B,disabled:!D,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),a.jsx("span",{className:"text-sm text-gray-500",children:P}),a.jsx("button",{onClick:R,disabled:!O,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente"})]})]})]}),f&&!y&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Detalles de Compra"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[!oe(f)&&a.jsxs("button",{onClick:()=>he(f),className:"flex items-center space-x-2 bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors",children:[a.jsx(gl,{className:"w-4 h-4"}),a.jsx("span",{children:"Procesar Devolucin"})]}),a.jsx("button",{onClick:()=>m(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"w-6 h-6"})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Informacin General"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"ID:"}),a.jsx("span",{className:"font-medium",children:f.id})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Fecha:"}),a.jsx("span",{className:"font-medium",children:((Ce=yb(f.createdAt))==null?void 0:Ce.toLocaleString())||"Fecha invlida"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Total Items:"}),a.jsx("span",{className:"font-medium",children:sr(f.totalItems||0)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Costo Total:"}),a.jsx("span",{className:"font-medium text-purple-600",children:V(f.totalCost||0)})]}),oe(f)&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Total Devuelto:"}),a.jsxs("span",{className:"font-medium text-red-600",children:["-",V(ie(f))]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Costo Neto:"}),a.jsx("span",{className:"font-medium text-green-600",children:V(ge(f))})]})]})]})]}),f.notes&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Notas"}),a.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded",children:f.notes})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Productos Comprados"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Producto"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Cantidad"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Precio Unitario"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),oe(f)&&a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Devuelto"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:f.items.map((se,We)=>{const Ae=(f.returns||[]).reduce((it,ut)=>{const mt=ut.items.find(pt=>pt.productId===se.productId);return it+((mt==null?void 0:mt.returnedQuantity)||0)},0);return a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:se.productName}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:sr(se.quantity)}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:V(se.purchasePrice)}),a.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:V(se.totalCost)}),oe(f)&&a.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:Ae>0?sr(Ae):"-"})]},We)})})]})})]}),oe(f)&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Historial de Devoluciones"}),a.jsx("div",{className:"space-y-4",children:(ke=f.returns)==null?void 0:ke.map((se,We)=>a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"text-sm font-medium text-red-800",children:["Devolucin #",We+1]}),a.jsx("span",{className:"text-xs text-red-600 ml-2",children:new Date(se.createdAt).toLocaleString()})]}),a.jsx("span",{className:"text-sm font-medium text-red-800",children:V(se.totalRefund)})]}),se.reason&&a.jsxs("p",{className:"text-sm text-red-700 mb-2",children:[a.jsx("strong",{children:"Motivo:"})," ",se.reason]}),a.jsx("div",{className:"space-y-1",children:se.items.map((Ae,it)=>a.jsxs("div",{className:"text-sm text-red-700",children:[" ",sr(Ae.returnedQuantity),"x ",Ae.productName,"(",V(Ae.totalRefund),")",Ae.reason&&a.jsxs("span",{className:"text-red-600",children:[" - ",Ae.reason]})]},it))}),se.notes&&a.jsxs("p",{className:"text-xs text-red-600 mt-2 italic",children:["Notas: ",se.notes]})]},We))})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Cerrar"})})]})})}),y&&f&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Procesar Devolucin"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Compra del ",(ue=yb(f.createdAt))==null?void 0:ue.toLocaleDateString()," - ID: ",f.id.slice(0,8),"..."]})]}),a.jsx("button",{onClick:Le,className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"w-6 h-6"})})]}),Ye&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(is,{className:"w-5 h-5 text-red-600 mr-2"}),a.jsx("span",{className:"text-red-800",children:Ye})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo General (Opcional)"}),a.jsx("input",{type:"text",value:v,onChange:se=>j(se.target.value),placeholder:"Ej: Producto defectuoso, cambio de proveedor...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notas Adicionales (Opcional)"}),a.jsx("input",{type:"text",value:S,onChange:se=>_(se.target.value),placeholder:"Notas adicionales...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Productos a Devolver"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Producto"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Comprado"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Disponible"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Cantidad a Devolver"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Precio Unit."}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Reembolso"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Motivo"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map((se,We)=>{const Ae=q(f,se.productId);return a.jsxs("tr",{className:se.returnedQuantity>0?"bg-orange-50":"",children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:se.productName}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:sr(se.originalQuantity)}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:sr(Ae)}),a.jsx("td",{className:"px-4 py-2",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>qe(se.productId,se.returnedQuantity-1),disabled:se.returnedQuantity<=0,className:"w-8 h-8 flex items-center justify-center bg-gray-200 text-gray-600 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsx(_x,{className:"w-4 h-4"})}),a.jsx("span",{className:"min-w-[60px] text-center text-sm font-medium",children:sr(se.returnedQuantity)}),a.jsx("button",{onClick:()=>qe(se.productId,se.returnedQuantity+1),disabled:se.returnedQuantity>=Ae,className:"w-8 h-8 flex items-center justify-center bg-gray-200 text-gray-600 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsx(wn,{className:"w-4 h-4"})})]})}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:V(se.purchasePrice)}),a.jsx("td",{className:"px-4 py-2 text-sm font-medium text-orange-600",children:V(se.totalRefund)}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"text",value:se.reason||"",onChange:it=>De(se.productId,it.target.value),placeholder:"Motivo especfico...",className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-orange-500 focus:border-transparent",disabled:se.returnedQuantity===0})})]},We)})})]})})]}),a.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-orange-800",children:"Total a Devolver:"}),a.jsx("span",{className:"ml-2 text-lg font-bold text-orange-600",children:V(x.reduce((se,We)=>se+We.totalRefund,0))})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-orange-800",children:"Items Seleccionados:"}),a.jsx("span",{className:"ml-2 text-lg font-bold text-orange-600",children:x.filter(se=>se.returnedQuantity>0).length})]})]})}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:Le,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Cancelar"}),a.jsxs("button",{onClick:ne,disabled:be||x.filter(se=>se.returnedQuantity>0).length===0,className:"flex items-center space-x-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[be&&a.jsx(ks,{className:"w-4 h-4 animate-spin"}),a.jsx(gl,{className:"w-4 h-4"}),a.jsx("span",{children:"Procesar Devolucin"})]})]})]})})})]})}function PG({searchTerm:t="",birthdayFilter:e="all",sortBy:r="name",sortOrder:n="asc",itemsPerPage:s=10}){const[i,o]=I.useState([]),[l,c]=I.useState(!1),[u,d]=I.useState(null),[h,f]=I.useState(null),[m,y]=I.useState(1),[g,x]=I.useState(!1),[b,v]=I.useState(!1),j=I.useCallback(T=>{const P=new Date,[,O,D]=T.split("-").map(Number);return P.getDate()===D&&P.getMonth()+1===O},[]),S=I.useCallback(T=>{const P=new Date,O=new Date(T),D=P.getFullYear(),R=new Date(D,O.getMonth(),O.getDate()),B=new Date(P);B.setDate(P.getDate()-(P.getDay()+6)%7);const Y=new Date(B);return Y.setDate(B.getDate()+6),R>=B&&R<=Y},[]),_=I.useCallback(T=>{const P=new Date,O=new Date(T);return P.getMonth()===O.getMonth()},[]),C=I.useCallback(async(T,P=null)=>{let O=yt(Pe,"customers"),D=[],R="name";return r==="createdAt"&&(R="createdAt"),D.push(dr(R,n)),D.push(oc(s+1)),P&&D.push(Um(P)),Bt(O,...D)},[r,n,s]),N=I.useCallback(T=>T.filter(P=>{if(t.trim()){const O=t.toLowerCase(),D=P.name.toLowerCase().includes(O),R=P.phone&&P.phone.toLowerCase().includes(O),B=P.email&&P.email.toLowerCase().includes(O);if(!D&&!R&&!B)return!1}if(e!=="all"){if(!P.birthDate)return!1;if(e==="today")return j(P.birthDate);if(e==="week")return S(P.birthDate);if(e==="month")return _(P.birthDate)}return!0}),[t,e,j,S,_]),w=I.useCallback(async T=>{c(!0),d(null);try{if(t.trim()||e!=="all"){let P=yt(Pe,"customers"),O=[],D="name";r==="createdAt"&&(D="createdAt"),O.push(dr(D,n));const R=Bt(P,...O);let Y=(await Kt(R)).docs.map(K=>({id:K.id,...K.data()}));Y=N(Y);const W=Math.ceil(Y.length/s),L=(T-1)*s,X=L+s,G=Y.slice(L,X);x(T<W),v(T>1),o(G),f(null)}else{let P=null,O=[],D=null;for(let B=1;B<=T;B++){const Y=await C(B,P),L=(await Kt(Y)).docs;B===T&&(O=L),D=L[L.length-1],P=D}let R=O.map(B=>({id:B.id,...B.data()}));x(R.length>s),v(T>1),R.length>s&&(R=R.slice(0,s)),o(R),f(D)}}catch(P){d(P.message||"Error al cargar clientes")}finally{c(!1)}},[C,s,N,t,e,r,n]);return I.useEffect(()=>{y(1),w(1)},[t,e,r,n,s,w]),{customers:i,loading:l,error:u,currentPage:m,hasNextPage:g,hasPrevPage:b,nextPage:()=>{g&&(y(T=>T+1),w(m+1))},prevPage:()=>{b&&m>1&&(y(T=>T-1),w(m-1))},setPage:T=>{y(T),w(T)},refetch:()=>w(m)}}function TG({customerId:t,dateFilter:e="allTime",startDate:r,endDate:n}){const[s,i]=I.useState({totalSales:0,totalProfit:0,transactionCount:0,averageTransaction:0,bestMonth:null,bestDay:null,monthlyData:[],yearlyData:[],allTimeRanking:0,loading:!0,error:null}),o=I.useCallback(()=>{const c=new Date;let u=null,d=null;switch(e){case"thisMonth":u=new Date(c.getFullYear(),c.getMonth(),1),d=new Date(c.getFullYear(),c.getMonth()+1,0,23,59,59,999);break;case"lastMonth":u=new Date(c.getFullYear(),c.getMonth()-1,1),d=new Date(c.getFullYear(),c.getMonth(),0,23,59,59,999);break;case"last3Months":u=new Date(c.getTime()-90*24*60*60*1e3),d=c;break;case"last6Months":u=new Date(c.getTime()-180*24*60*60*1e3),d=c;break;case"thisYear":u=new Date(c.getFullYear(),0,1),d=new Date(c.getFullYear(),11,31,23,59,59,999);break;case"lastYear":u=new Date(c.getFullYear()-1,0,1),d=new Date(c.getFullYear()-1,11,31,23,59,59,999);break}if(r&&n){const[h,f,m]=r.split("-").map(Number),[y,g,x]=n.split("-").map(Number);u=new Date(h,f-1,m,0,0,0,0),d=new Date(y,g-1,x,23,59,59,999)}return{start:u,end:d}},[e,r,n]),l=I.useCallback(async()=>{if(!t){i(c=>({...c,loading:!1}));return}i(c=>({...c,loading:!0,error:null}));try{const{start:c,end:u}=o();let d=[or("customerId","==",t)];c&&d.push(or("createdAt",">=",c.toISOString())),u&&d.push(or("createdAt","<=",u.toISOString()));const h=Bt(yt(Pe,"sales"),...d,dr("createdAt","desc")),m=(await Kt(h)).docs.map(D=>({id:D.id,...D.data()})),y=m.reduce((D,R)=>D+(R.total??0),0),g=m.reduce((D,R)=>D+(R.totalProfit??0),0),x=m.length,b=x>0?y/x:0,v=new Map,j=new Map;m.forEach(D=>{let R;if(typeof D.createdAt=="object"&&D.createdAt!==null&&"seconds"in D.createdAt?R=new Date(D.createdAt.seconds*1e3):R=new Date(D.createdAt),!isNaN(R.getTime())){const B=R.toISOString().split("T")[0],Y=`${R.getFullYear()}-${String(R.getMonth()+1).padStart(2,"0")}`;v.set(B,(v.get(B)||0)+(D.total??0)),j.set(Y,(j.get(Y)||0)+(D.total??0))}});let S=null;v.forEach((D,R)=>{(!S||D>S.amount)&&(S={date:R,amount:D})});let _=null;j.forEach((D,R)=>{(!_||D>_.amount)&&(_={month:R,amount:D})});const C=new Date,N=new Date(C.getFullYear(),C.getMonth()-11,1),w=Array.from(j.entries()).map(([D,R])=>{const[B,Y]=D.split("-").map(Number);if(new Date(B,Y-1)<N)return null;const L=m.filter(K=>{let q;return typeof K.createdAt=="object"&&K.createdAt!==null&&"seconds"in K.createdAt?q=new Date(K.createdAt.seconds*1e3):q=new Date(K.createdAt),`${q.getFullYear()}-${String(q.getMonth()+1).padStart(2,"0")}`===D}),X=L.reduce((K,q)=>K+(q.totalProfit??0),0),G=L.length;return{period:D,totalSales:R,totalProfit:X,transactionCount:G,averageTransaction:G>0?R/G:0}}).filter(D=>D!==null).sort((D,R)=>D.period.localeCompare(R.period)),E=C.getFullYear(),k=E-1,T=new Map;m.forEach(D=>{let R;if(typeof D.createdAt=="object"&&D.createdAt!==null&&"seconds"in D.createdAt?R=new Date(D.createdAt.seconds*1e3):R=new Date(D.createdAt),!isNaN(R.getTime())){const B=R.getFullYear();if(B===E||B===k){const Y=B.toString(),W=T.get(Y)||{total:0,profit:0,count:0};W.total+=D.total??0,W.profit+=D.totalProfit??0,W.count+=1,T.set(Y,W)}}});const P=Array.from(T.entries()).map(([D,R])=>({period:D,totalSales:R.total,totalProfit:R.profit,transactionCount:R.count,averageTransaction:R.count>0?R.total/R.count:0})).sort((D,R)=>D.period.localeCompare(R.period));i({totalSales:y,totalProfit:g,transactionCount:x,averageTransaction:b,bestMonth:_,bestDay:S,monthlyData:w,yearlyData:P,allTimeRanking:0,loading:!1,error:null})}catch(c){i(u=>({...u,loading:!1,error:c.message||"Error al cargar estadsticas del cliente"}))}},[t,o]);return I.useEffect(()=>{l()},[l]),{...s,refetch:l}}const AG=t=>t?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t):!0,IG=t=>{if(!t)return!0;const e=t.replace(/\D/g,"");return/^[3][0-9]{9}$/.test(e)},Fp=(t,e)=>t.length<=e,kG=t=>t.trim().length>0,vu=t=>t.trim().replace(/[<>]/g,"").substring(0,1e3),XM=t=>{const e=[];return kG(t.name)||e.push({field:"name",message:"El nombre es requerido"}),Fp(t.name,100)||e.push({field:"name",message:"El nombre no puede exceder 100 caracteres"}),t.email&&!AG(t.email)&&e.push({field:"email",message:"El formato del email no es vlido"}),t.email&&!Fp(t.email,254)&&e.push({field:"email",message:"El email no puede exceder 254 caracteres"}),t.phone&&!IG(t.phone)&&e.push({field:"phone",message:"El telfono debe tener 10 dgitos y empezar con 3 (ej: 3001234567)"}),t.address&&!Fp(t.address,500)&&e.push({field:"address",message:"La direccin no puede exceder 500 caracteres"}),t.notes&&!Fp(t.notes,1e3)&&e.push({field:"notes",message:"Las notas no pueden exceder 1000 caracteres"}),{isValid:e.length===0,errors:e}},JM=t=>{const e=t.replace(/\D/g,"");return e.length===10&&e.startsWith("3")?e:t.replace(/\D/g,"")},ZM=t=>t.toLowerCase().trim();function OG(){const t=Xt(kd),e=Xt(Sx),r=Xt(Gm),{showSuccess:n,showError:s,showWarning:i,showConfirm:o}=hi();ma();const[l,c]=I.useState(!1),[u,d]=I.useState(null),[h,f]=I.useState(""),[m,y]=I.useState(!1),[g,x]=I.useState([]),[b,v]=I.useState({}),[j,S]=I.useState("all"),[_,C]=I.useState("all"),[N,w]=I.useState("name"),[E,k]=I.useState("asc"),[T,P]=I.useState(!1),[O,D]=I.useState(null),R=10,B=I.useRef(null),Y=I.useCallback(he=>{const Le=new Date;return Le.setDate(Le.getDate()-30),r.filter(qe=>qe.customerId!==he?!1:new Date(qe.createdAt)>=Le).length},[r]),{customers:W,loading:L,error:X,currentPage:G,hasNextPage:K,hasPrevPage:q,nextPage:ie,prevPage:ge,setPage:be,refetch:Ye}=PG({searchTerm:h,birthdayFilter:j,sortBy:N,sortOrder:E,itemsPerPage:R}),ze=I.useMemo(()=>_==="all"?W:W.filter(he=>{const Le=Y(he.id);switch(_){case"high":return Le>=5;case"medium":return Le>=2&&Le<5;case"low":return Le===1;case"none":return Le===0;default:return!0}}),[W,Y,_]);I.useCallback(he=>{N===he?k(E==="asc"?"desc":"asc"):(w(he),k("asc"))},[N,E]);const U=I.useMemo(()=>({total:t.length,birthdaysToday:t.filter(he=>uh(he.birthDate||"")).length,withEmail:t.filter(he=>he.email).length,withPhone:t.filter(he=>he.phone).length}),[t]),Q=I.useCallback((he,Le)=>{v(qe=>({...qe,[he]:Le}))},[]),re=async he=>{var Le,qe;he.preventDefault(),y(!0),x([]);try{const De=new FormData(he.currentTarget),ne={name:vu(De.get("name")||""),phone:De.get("phone")||"",email:De.get("email")||"",address:vu(De.get("address")||""),birthDate:De.get("birthDate")||"",notes:vu(De.get("notes")||"")},oe={name:ne.name};ne.phone.trim()&&(oe.phone=JM(ne.phone.trim())),ne.email.trim()&&(oe.email=ZM(ne.email.trim())),ne.address.trim()&&(oe.address=ne.address.trim()),ne.birthDate.trim()&&(oe.birthDate=ne.birthDate.trim()),ne.notes.trim()&&(oe.notes=ne.notes.trim());const Ce=XM(oe);if(!Ce.isValid){x(Ce.errors),y(!1),s("Error de validacin","Por favor corrige los errores en el formulario");return}u?(await Mn.update(u.id,oe),(Le=B.current)==null||Le.reset(),d(null),c(!1),Ye(),n("Cliente actualizado",`El cliente "${oe.name}" se actualiz correctamente`)):(await Mn.add(oe),(qe=B.current)==null||qe.reset(),c(!1),Ye(),n("Cliente creado",`El cliente "${oe.name}" se cre correctamente`))}catch(De){let ne="Error desconocido al guardar el cliente";De instanceof Error&&(De.message.includes("permission-denied")?ne="No tienes permisos para guardar clientes. Verifica que ests logueado como administrador.":De.message.includes("network")?ne="Error de conexin. Verifica tu conexin a internet.":De.message.includes("quota-exceeded")?ne="Se ha excedido la cuota de Firebase. Intenta ms tarde.":ne=De.message),s("Error al guardar cliente",ne)}finally{y(!1)}},te=I.useCallback(async he=>{const Le=e.filter(qe=>qe.customerId===he.id&&qe.status==="active");if(Le.length>0){i("No se puede eliminar",`No se puede eliminar este cliente porque tiene ${Le.length} plan(es) separe activo(s).`);return}o("Confirmar eliminacin",`Ests seguro de que quieres eliminar al cliente "${he.name}"? Esta accin no se puede deshacer.`,async()=>{const qe=`delete-${he.id}`;Q(qe,!0);try{await Mn.delete(he.id),Ye(),n("Cliente eliminado",`El cliente "${he.name}" se elimin correctamente`)}catch(De){console.error("Error deleting customer:",De),s("Error al eliminar","No se pudo eliminar el cliente. Intntalo de nuevo.")}finally{Q(qe,!1)}})},[e,Ye,i,o,n,s,Q]),pe=he=>{d(he),c(!0)},xe=()=>{d(null),c(!1)};return I.useEffect(()=>{},[]),a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"mb-4 pt-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestin de Clientes"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Administra la base de datos de clientes y su informacin"})]}),a.jsx("div",{className:"flex gap-2",children:a.jsxs("button",{onClick:()=>c(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[a.jsx(qW,{className:"h-5 w-5"}),a.jsx("span",{children:"Agregar Cliente"})]})})]})}),!l&&!u&&a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("div",{className:"w-5 h-5 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(E0,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx(Vp,{className:"w-2 h-2 text-blue-500 opacity-60 group-hover:opacity-100 transition-opacity duration-300"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Total Clientes"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:U.total})]})]}),a.jsxs("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-green-500/10 hover:-translate-y-0.5 hover:border-green-300 transition-all duration-300 ease-out",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("div",{className:"w-5 h-5 bg-green-50 rounded flex items-center justify-center group-hover:bg-green-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ur,{className:"w-3 h-3 text-green-600 group-hover:text-green-700"})}),a.jsx(Vp,{className:"w-2 h-2 text-green-500 opacity-60 group-hover:opacity-100 transition-opacity duration-300"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Cumpleaos Hoy"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-green-900 transition-colors duration-300",children:U.birthdaysToday})]})]}),a.jsxs("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-purple-500/10 hover:-translate-y-0.5 hover:border-purple-300 transition-all duration-300 ease-out",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("div",{className:"w-5 h-5 bg-purple-50 rounded flex items-center justify-center group-hover:bg-purple-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(C0,{className:"w-3 h-3 text-purple-600 group-hover:text-purple-700"})}),a.jsx(Vp,{className:"w-2 h-2 text-purple-500 opacity-60 group-hover:opacity-100 transition-opacity duration-300"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Con Email"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-purple-900 transition-colors duration-300",children:U.withEmail})]})]}),a.jsxs("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-orange-500/10 hover:-translate-y-0.5 hover:border-orange-300 transition-all duration-300 ease-out",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("div",{className:"w-5 h-5 bg-orange-50 rounded flex items-center justify-center group-hover:bg-orange-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Pj,{className:"w-3 h-3 text-orange-600 group-hover:text-orange-700"})}),a.jsx(Vp,{className:"w-2 h-2 text-orange-500 opacity-60 group-hover:opacity-100 transition-opacity duration-300"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Con Telfono"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-orange-900 transition-colors duration-300",children:U.withPhone})]})]})]}),!l&&!u&&a.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:space-x-4 gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar clientes por nombre, telfono o email...",value:h,onChange:he=>f(he.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{htmlFor:"birthday-filter",className:"text-sm text-gray-700 font-medium",children:"Cumpleaos:"}),a.jsxs("select",{id:"birthday-filter",value:j,onChange:he=>S(he.target.value),className:"px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"all",children:"Todos"}),a.jsx("option",{value:"today",children:"Hoy"}),a.jsx("option",{value:"week",children:"Esta semana"}),a.jsx("option",{value:"month",children:"Este mes"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{htmlFor:"sales-filter",className:"text-sm text-gray-700 font-medium",children:"Ventas (30 das):"}),a.jsxs("select",{id:"sales-filter",value:_,onChange:he=>C(he.target.value),className:"px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"all",children:"Todos"}),a.jsx("option",{value:"high",children:"Altas (5+)"}),a.jsx("option",{value:"medium",children:"Medias (2-4)"}),a.jsx("option",{value:"low",children:"Bajas (1)"}),a.jsx("option",{value:"none",children:"Sin ventas (0)"})]})]})]})]})}),(l||u)&&a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:u?"Editar Cliente":"Agregar Nuevo Cliente"}),a.jsx("button",{onClick:xe,className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),g.length>0&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:a.jsxs("div",{className:"text-sm text-red-600",children:[a.jsx("p",{className:"font-medium mb-1",children:"Por favor corrige los siguientes errores:"}),a.jsx("ul",{className:"list-disc list-inside space-y-1",children:g.map((he,Le)=>a.jsx("li",{children:he.message},Le))})]})}),a.jsxs("form",{ref:B,onSubmit:re,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo *"}),a.jsx("input",{type:"text",name:"name",defaultValue:(u==null?void 0:u.name)||"",required:!0,maxLength:100,disabled:m,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 ${g.some(he=>he.field==="name")?"border-red-300 bg-red-50":"border-gray-300"}`})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),a.jsx("input",{type:"tel",name:"phone",defaultValue:(u==null?void 0:u.phone)||"",maxLength:10,disabled:m,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 ${g.some(he=>he.field==="phone")?"border-red-300 bg-red-50":"border-gray-300"}`})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",name:"email",defaultValue:(u==null?void 0:u.email)||"",placeholder:"cliente@ejemplo.com",maxLength:254,disabled:m,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 ${g.some(he=>he.field==="email")?"border-red-300 bg-red-50":"border-gray-300"}`})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Nacimiento"}),a.jsx("input",{type:"date",name:"birthDate",defaultValue:u!=null&&u.birthDate?$M(u.birthDate):"",max:new Date().toISOString().split("T")[0],disabled:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direccin"}),a.jsx("input",{type:"text",name:"address",defaultValue:(u==null?void 0:u.address)||"",disabled:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas"}),a.jsx("textarea",{name:"notes",rows:3,defaultValue:(u==null?void 0:u.notes)||"",disabled:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:xe,disabled:m,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[m&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:m?"Guardando...":u?"Actualizar Cliente":"Agregar Cliente"})]})]})]})]}),!l&&!u&&a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[L&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center",children:[a.jsx(ru,{className:"h-8 w-8 text-gray-400 animate-spin mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:"Cargando clientes..."})]}),!L&&ze.map(he=>{const Le=he.birthDate?Jh(he.birthDate):null,qe=he.birthDate?NP(he.birthDate):!1;return a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Rr,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-base font-semibold text-gray-900",children:he.name}),Le&&he.birthDate&&a.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(Xn,{className:"h-3 w-3 mr-1"}),Le," aos",qe&&a.jsx(ur,{className:"h-3 w-3 ml-2 text-orange-500"})]})]})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("button",{onClick:()=>{D(he),P(!0)},className:"text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-50 transition-colors",title:"Ver informacin del cliente",children:a.jsx(os,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>pe(he),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50 transition-colors",title:"Editar cliente",children:a.jsx(Hu,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>te(he),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50 transition-colors disabled:opacity-50",title:"Eliminar cliente",disabled:b[`delete-${he.id}`],children:b[`delete-${he.id}`]?a.jsx(ru,{className:"h-4 w-4 animate-spin"}):a.jsx(rs,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"space-y-1 text-sm",children:[he.phone&&a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx(Pj,{className:"h-3 w-3 mr-1"}),he.phone]}),he.email&&a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx(C0,{className:"h-3 w-3 mr-1"}),he.email]}),he.address&&a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx(zM,{className:"h-3 w-3 mr-1"}),he.address]})]})]},he.id)})]}),!l&&!u&&a.jsxs("div",{className:"hidden sm:block bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[L?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(ru,{className:"h-8 w-8 text-gray-400 animate-spin mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:"Cargando clientes..."})]}):X?a.jsx("div",{className:"p-8 text-center text-red-600",children:X}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cumpleaos"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ventas (30 das)"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Saldo a favor"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ze.map(he=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Rr,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:he.name}),he.notes&&a.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:he.notes})]})]})}),a.jsx("td",{className:`px-6 py-4 whitespace-nowrap ${uh(he.birthDate||"")?"bg-yellow-100 font-bold":""}`,children:a.jsx("div",{className:`text-sm flex items-center ${uh(he.birthDate||"")?"text-orange-700":"text-gray-900"}`,children:he.birthDate?a.jsxs(a.Fragment,{children:[(()=>{const Le=new Date(he.birthDate),qe=Le.getUTCDate(),De=Le.toLocaleString("es-ES",{month:"long",timeZone:"UTC"});return`${qe} de ${De}`})(),uh(he.birthDate||"")&&a.jsx("span",{className:"ml-2 flex items-center",title:"Hoy es su cumpleaos!",children:a.jsx(ur,{className:"h-4 w-4 text-orange-500"})}),!uh(he.birthDate||"")&&NP(he.birthDate||"")&&a.jsx("span",{className:"ml-2 flex items-center",title:"Cumpleaos pronto",children:a.jsx(ur,{className:"h-4 w-4 text-yellow-500"})})]}):a.jsx("span",{className:"text-gray-400",children:"-"})})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-semibold text-green-600",children:Y(he.id)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-bold text-blue-600",children:typeof he.credit=="number"?V(he.credit):V(0)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{D(he),P(!0)},className:"text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-50 transition-colors",title:"Ver informacin del cliente",children:a.jsx(os,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>pe(he),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50 transition-colors",title:"Editar cliente",children:a.jsx(Hu,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>te(he),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50 transition-colors disabled:opacity-50",title:"Eliminar cliente",disabled:b[`delete-${he.id}`],children:b[`delete-${he.id}`]?a.jsx(ru,{className:"h-4 w-4 animate-spin"}):a.jsx(rs,{className:"h-4 w-4"})})]})})]},he.id))})]})}),a.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200",children:[a.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[a.jsx("button",{onClick:()=>be(1),disabled:G===1,className:"relative inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Primera"}),a.jsx("button",{onClick:ge,disabled:!q,className:"relative inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),a.jsx("span",{className:"px-2 py-2 text-sm text-gray-600",children:G}),a.jsx("button",{onClick:ie,disabled:!K,className:"relative inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Siguiente"})]}),a.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[a.jsx("div",{children:a.jsxs("p",{className:"text-sm text-gray-700",children:["Pgina ",a.jsx("span",{className:"font-medium",children:G}),ze.length>0&&a.jsxs("span",{children:[" - Mostrando ",ze.length," cliente",ze.length!==1?"s":""]})]})}),a.jsx("div",{children:a.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[a.jsx("button",{onClick:()=>be(1),disabled:G===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Primera"}),a.jsx("button",{onClick:ge,disabled:!q,className:"relative inline-flex items-center px-2 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),a.jsx("span",{className:"px-3 py-2 border-t border-b border-gray-300 bg-white text-sm text-gray-700",children:G}),a.jsx("button",{onClick:ie,disabled:!K,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Siguiente"})]})})]})]})]}),u&&!l&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Detalles del Cliente"}),a.jsx("button",{onClick:xe,className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Nombre:"}),a.jsx("p",{className:"font-medium",children:u.name})]}),u.phone&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Telfono:"}),a.jsx("p",{className:"font-medium",children:u.phone})]}),u.email&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Email:"}),a.jsx("p",{className:"font-medium",children:u.email})]}),u.address&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Direccin:"}),a.jsx("p",{className:"font-medium",children:u.address})]}),u.birthDate&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Fecha de nacimiento:"}),a.jsxs("p",{className:"font-medium",children:[Nj(u.birthDate),Jh(u.birthDate)&&a.jsxs("span",{className:"text-gray-500 ml-2",children:["(",Jh(u.birthDate)," aos)"]})]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Saldo a favor:"}),a.jsx("p",{className:"font-medium text-blue-600",children:V(u.credit||0)})]}),u.notes&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Notas:"}),a.jsx("p",{className:"font-medium",children:u.notes})]})]})]})})}),!L&&ze.length===0&&a.jsxs("div",{className:"bg-white rounded-xl p-12 text-center shadow-sm border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(E0,{className:"h-12 w-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron clientes"}),a.jsx("p",{className:"text-gray-500",children:h||j!=="all"?"Intenta ajustar tus filtros de bsqueda.":"Comienza agregando tu primer cliente."})]}),T&&O&&a.jsx(DG,{customer:O,onClose:()=>{P(!1),D(null)},onCustomerUpdated:Ye})]})}function DG({customer:t,onClose:e,onCustomerUpdated:r}){const[n,s]=I.useState("info"),[i,o]=I.useState(!1),[l,c]=I.useState(t),[u,d]=I.useState(t),[h,f]=I.useState("allTime"),[m,y]=I.useState(!1),{showSuccess:g,showError:x}=hi();ee.useEffect(()=>{c(t),d(t)},[t]);const{totalSales:b,totalProfit:v,transactionCount:j,averageTransaction:S,bestMonth:_,bestDay:C,monthlyData:N,yearlyData:w,allTimeRanking:E,loading:k,error:T}=TG({customerId:t.id,dateFilter:h}),P=async()=>{y(!0);try{const R=XM(u);if(!R.isValid){x(R.errors[0].message);return}const B={...u,name:vu(u.name),phone:u.phone?JM(u.phone):"",email:u.email?ZM(u.email):"",address:u.address?vu(u.address):"",notes:u.notes?vu(u.notes):"",updatedAt:new Date().toISOString()};await Mn.update(t.id,B),c(B),g("Cliente actualizado correctamente"),o(!1),r&&r()}catch(R){x(R.message||"Error al actualizar el cliente")}finally{y(!1)}},O=R=>new Date(R).toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"}),D=R=>{const[B,Y]=R.split("-");return new Date(parseInt(B),parseInt(Y)-1).toLocaleDateString("es-CO",{year:"numeric",month:"long"})};return a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:e}),a.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:a.jsx(Rr,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:l.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Cliente desde ",Nj(l.createdAt)]})]})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsx("div",{className:"mt-6",children:a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx("button",{onClick:()=>s("info"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="info"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Rr,{className:"h-4 w-4"}),a.jsx("span",{children:"Informacin del Cliente"})]})}),a.jsx("button",{onClick:()=>s("stats"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="stats"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(os,{className:"h-4 w-4"}),a.jsx("span",{children:"Estadsticas de Ventas"})]})})]})})]}),a.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6",children:n==="info"?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex justify-end",children:i?a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>{o(!1),d(l)},className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancelar"}),a.jsx("button",{onClick:P,disabled:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",children:m?a.jsxs(a.Fragment,{children:[a.jsx(ru,{className:"h-4 w-4 mr-2 animate-spin"}),"Guardando..."]}):a.jsx(a.Fragment,{children:"Guardar Cambios"})})]}):a.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(Hu,{className:"h-4 w-4 mr-2"}),"Editar Informacin"]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre Completo *"}),i?a.jsx("input",{type:"text",value:u.name,onChange:R=>d({...u,name:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ingresa el nombre completo"}):a.jsx("p",{className:"text-gray-900 font-medium",children:l.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telfono"}),i?a.jsx("input",{type:"tel",value:u.phone||"",onChange:R=>d({...u,phone:R.target.value}),maxLength:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):a.jsx("p",{className:"text-gray-900 flex items-center",children:l.phone?a.jsxs(a.Fragment,{children:[a.jsx(Pj,{className:"h-4 w-4 mr-2 text-gray-400"}),l.phone]}):a.jsx("span",{className:"text-gray-500 italic",children:"No registrado"})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),i?a.jsx("input",{type:"email",value:u.email||"",onChange:R=>d({...u,email:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"ejemplo@correo.com"}):a.jsx("p",{className:"text-gray-900 flex items-center",children:l.email?a.jsxs(a.Fragment,{children:[a.jsx(C0,{className:"h-4 w-4 mr-2 text-gray-400"}),l.email]}):a.jsx("span",{className:"text-gray-500 italic",children:"No registrado"})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Nacimiento"}),i?a.jsx("input",{type:"date",value:u.birthDate?$M(u.birthDate):"",onChange:R=>d({...u,birthDate:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):a.jsx("p",{className:"text-gray-900 flex items-center",children:l.birthDate?a.jsxs(a.Fragment,{children:[a.jsx(Xn,{className:"h-4 w-4 mr-2 text-gray-400"}),Nj(l.birthDate),Jh(l.birthDate)&&a.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",Jh(l.birthDate)," aos)"]})]}):a.jsx("span",{className:"text-gray-500 italic",children:"No registrada"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Direccin"}),i?a.jsx("textarea",{value:u.address||"",onChange:R=>d({...u,address:R.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Direccin completa del cliente"}):a.jsx("p",{className:"text-gray-900 flex items-start",children:l.address?a.jsxs(a.Fragment,{children:[a.jsx(zM,{className:"h-4 w-4 mr-2 text-gray-400 mt-0.5 flex-shrink-0"}),l.address]}):a.jsx("span",{className:"text-gray-500 italic",children:"No registrada"})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notas"}),i?a.jsx("textarea",{value:u.notes||"",onChange:R=>d({...u,notes:R.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Notas adicionales sobre el cliente"}):a.jsx("p",{className:"text-gray-900",children:l.notes||a.jsx("span",{className:"text-gray-500 italic",children:"Sin notas adicionales"})})]}),a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-green-800",children:"Saldo a Favor"}),a.jsx("p",{className:"text-sm text-green-600",children:"Crdito disponible para compras"})]}),a.jsx("p",{className:"text-2xl font-bold text-green-900",children:V(l.credit||0)})]})})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2 sm:mb-0",children:"Estadsticas de Ventas"}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Perodo:"}),a.jsxs("select",{value:h,onChange:R=>f(R.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"allTime",children:"Todos los tiempos"}),a.jsx("option",{value:"thisYear",children:"Este ao"}),a.jsx("option",{value:"lastYear",children:"El ao pasado"}),a.jsx("option",{value:"last6Months",children:"ltimos 6 meses"}),a.jsx("option",{value:"last3Months",children:"ltimos 3 meses"}),a.jsx("option",{value:"thisMonth",children:"Este mes"}),a.jsx("option",{value:"lastMonth",children:"El mes pasado"})]})]})]}),k?a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsx(ru,{className:"h-8 w-8 animate-spin text-blue-600"})}):T?a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:a.jsx("p",{className:"text-red-800",children:T})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-xs font-medium text-blue-600 mb-1",children:"Total Ventas"}),a.jsx("p",{className:"text-lg font-bold text-blue-900",children:V(b)})]}),a.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-xs font-medium text-green-600 mb-1",children:"Ganancia"}),a.jsx("p",{className:"text-lg font-bold text-green-900",children:V(v)})]}),a.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-xs font-medium text-purple-600 mb-1",children:"Transacciones"}),a.jsx("p",{className:"text-lg font-bold text-purple-900",children:j})]}),a.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-xs font-medium text-orange-600 mb-1",children:"Promedio"}),a.jsx("p",{className:"text-lg font-bold text-orange-900",children:V(S)})]})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsx("div",{className:"flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium text-yellow-600",children:"Ranking General"}),a.jsxs("p",{className:"text-3xl font-bold text-yellow-900",children:["#",E]}),a.jsx("p",{className:"text-xs text-yellow-700",children:"Entre todos los clientes"})]})})}),(C||_)&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[C&&a.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:[a.jsxs("h4",{className:"font-medium text-indigo-800 mb-2 flex items-center",children:[a.jsx(Xn,{className:"h-4 w-4 mr-2"}),"Mejor Da"]}),a.jsx("p",{className:"text-sm text-indigo-700",children:O(C.date)}),a.jsx("p",{className:"text-xl font-bold text-indigo-900",children:V(C.amount)})]}),_&&a.jsxs("div",{className:"bg-pink-50 border border-pink-200 rounded-lg p-4",children:[a.jsxs("h4",{className:"font-medium text-pink-800 mb-2 flex items-center",children:[a.jsx(Xn,{className:"h-4 w-4 mr-2"}),"Mejor Mes"]}),a.jsx("p",{className:"text-sm text-pink-700",children:D(_.month)}),a.jsx("p",{className:"text-xl font-bold text-pink-900",children:V(_.amount)})]})]}),j===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(Rr,{className:"h-16 w-16 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sin ventas registradas"}),a.jsx("p",{className:"text-gray-500",children:"No hay ventas registradas para este cliente en el perodo seleccionado."})]})]})]})}),a.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse border-t border-gray-200",children:a.jsx("button",{type:"button",onClick:e,className:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cerrar"})})]})]})})}const Dh=rl("products/fetchProducts",async(t,{dispatch:e})=>{try{e(Jc(!0));const r=await La.getAll();e(vg(r))}catch(r){e(Ph(r.message||"Error al cargar productos"))}finally{e(Jc(!1))}}),gi=rl("layaways/fetchLayaways",async(t,{dispatch:e})=>{try{e(o0(!0));const r=await kn.getAll();e(bg(r))}catch(r){e(Yw(r.message||"Error al cargar layaways"))}finally{e(o0(!1))}}),MG=({products:t,isLoading:e,onClose:r,onAdd:n})=>{var T;const[s,i]=I.useState(""),[o,l]=I.useState(1),[c,u]=I.useState([]),[d,h]=I.useState(""),[f,m]=I.useState("dropdown"),[y,g]=I.useState(""),[x,b]=I.useState(!1),v=I.useRef(null),j=I.useRef(null);I.useEffect(()=>{f==="barcode"&&v.current&&v.current.focus()},[f]);const S=P=>{const O=t.find(D=>D.barcode===P&&D.stock>0);O?(i(O.id),h(""),g(""),C(O.id,1)):(h(""),g(""))},_=P=>{P.key==="Enter"&&d.trim()&&S(d.trim())},C=(P,O)=>{const D=t.find(B=>B.id===P);if(!D||O<=0||O>D.stock)return;const R=c.find(B=>B.productId===D.id);if(R){const B=R.quantity+O;if(B>D.stock)return;u(Y=>Y.map(W=>W.productId===D.id?{...W,quantity:B}:W))}else u(B=>[...B,{productId:D.id,productName:D.name,quantity:O,salePrice:D.salePrice,purchasePrice:D.purchasePrice}])},N=()=>{s&&(C(s,o),i(""),g(""),h(""),l(1))},w=P=>{u(O=>O.filter(D=>D.productId!==P))},E=(P,O)=>{const D=t.find(R=>R.id===P);!D||O<1||O>D.stock||u(R=>R.map(B=>B.productId===P?{...B,quantity:O}:B))},k=c.reduce((P,O)=>P+O.salePrice*O.quantity,0);return a.jsxs("div",{children:[a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 mb-2",children:[a.jsx("button",{onClick:()=>m("dropdown"),disabled:e,className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors disabled:opacity-50 ${f==="dropdown"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Lista de Productos"}),a.jsxs("button",{onClick:()=>m("barcode"),disabled:e,className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors flex items-center justify-center disabled:opacity-50 ${f==="barcode"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(qu,{className:"h-4 w-4 mr-1"})," Cdigo de Barras"]})]}),f==="dropdown"?a.jsx("div",{className:"relative w-full mb-2",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx("input",{ref:j,type:"text",placeholder:"Buscar producto...",value:y,onChange:P=>{g(P.target.value),b(!0)},onFocus:()=>b(!0),onBlur:()=>setTimeout(()=>b(!1),150),disabled:e,className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full disabled:opacity-50"}),x&&y&&a.jsx("div",{className:"absolute z-20 left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg max-h-56 overflow-y-auto mt-1",children:t.filter(P=>P.stock>0&&(P.name.toLowerCase().includes(y.toLowerCase())||P.referencia&&P.referencia.toLowerCase().includes(y.toLowerCase()))).length===0?a.jsx("div",{className:"p-3 text-gray-500 text-sm",children:"No hay productos"}):t.filter(P=>P.stock>0&&(P.name.toLowerCase().includes(y.toLowerCase())||P.referencia&&P.referencia.toLowerCase().includes(y.toLowerCase()))).map(P=>a.jsxs("button",{type:"button",onMouseDown:()=>{i(P.id),g(P.name),b(!1),setTimeout(()=>{var O;return(O=j.current)==null?void 0:O.blur()},0)},className:`w-full text-left px-4 py-2 hover:bg-blue-50 ${s===P.id?"bg-blue-100":""}`,children:[a.jsx("div",{className:"font-medium",children:P.name}),a.jsxs("div",{className:"text-sm text-gray-500",children:[P.referencia&&a.jsxs("span",{className:"mr-2",children:["Ref: ",P.referencia]}),V(P.salePrice),"  Stock: ",sr(P.stock)]})]},P.id))})]}),a.jsx("input",{type:"number",min:1,max:s&&((T=t.find(P=>P.id===s))==null?void 0:T.stock)||1,value:o,onChange:P=>l(Number(P.target.value)),disabled:e,className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),a.jsx("button",{onClick:N,disabled:!s||e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:a.jsx(wn,{className:"h-4 w-4"})})]})}):a.jsxs("div",{className:"space-y-2 mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(qu,{className:"h-5 w-5 text-gray-400"}),a.jsx("input",{ref:v,type:"text",placeholder:"Escanea o ingresa cdigo de barras...",value:d,onChange:P=>h(P.target.value),onKeyPress:_,disabled:e,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),a.jsx("button",{onClick:()=>S(d.trim()),disabled:!d.trim()||e,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar"})]}),a.jsx("p",{className:"text-xs text-gray-500",children:"Presiona Enter o haz clic en Agregar despus de escanear/ingresar el cdigo de barras"})]}),a.jsx("div",{className:"border border-gray-200 rounded-lg p-4 max-h-60 overflow-y-auto mb-4",children:c.length===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay productos agregados"}):a.jsx("div",{className:"space-y-2",children:c.map(P=>{var O;return a.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium",children:P.productName}),a.jsxs("div",{className:"text-sm text-gray-500",children:[(()=>{const D=t.find(R=>R.id===P.productId);return D!=null&&D.referencia?`Ref: ${D.referencia}  `:""})(),V(P.salePrice)," cada uno"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>E(P.productId,P.quantity-1),disabled:e||P.quantity<=1,className:"w-6 h-6 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center text-sm disabled:opacity-50",children:a.jsx(_x,{className:"h-4 w-4"})}),a.jsx("span",{className:"w-8 text-center text-sm font-medium",children:P.quantity}),a.jsx("button",{onClick:()=>E(P.productId,P.quantity+1),disabled:e||P.quantity>=(((O=t.find(D=>D.id===P.productId))==null?void 0:O.stock)||1),className:"w-6 h-6 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center text-sm disabled:opacity-50",children:a.jsx(wn,{className:"h-4 w-4"})}),a.jsx("span",{className:"font-medium w-20 text-right",children:V(P.salePrice*P.quantity)}),a.jsx("button",{onClick:()=>w(P.productId),disabled:e,className:"text-red-600 hover:text-red-800 w-6 h-6 flex items-center justify-center disabled:opacity-50",children:a.jsx(ct,{className:"h-4 w-4"})})]})]},P.productId)})})}),c.length>0&&a.jsx("div",{className:"border-t pt-4 space-y-3",children:a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Total a agregar:"}),a.jsx("span",{className:"font-bold text-blue-600",children:V(k)})]})}),a.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[a.jsx("button",{type:"button",onClick:r,disabled:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"button",onClick:()=>n(c),disabled:e||c.length===0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[a.jsx(Jo,{className:"h-4 w-4"}),a.jsx("span",{children:e?"Agregando...":"Agregar Productos"})]})]})]})},RG=({products:t,isLoading:e,onChange:r})=>{var k;const[n,s]=I.useState(""),[i,o]=I.useState(1),[l,c]=I.useState([]),[u,d]=I.useState(""),[h,f]=I.useState("dropdown"),[m,y]=I.useState(""),[g,x]=I.useState(!1),b=I.useRef(null),v=I.useRef(null);I.useEffect(()=>{r(l)},[l,r]),I.useEffect(()=>{h==="barcode"&&b.current&&b.current.focus()},[h]);const j=T=>{const P=t.find(O=>O.barcode===T&&O.stock>0);P?(s(P.id),d(""),y(""),_(P.id,1)):(d(""),y(""))},S=T=>{T.key==="Enter"&&u.trim()&&j(u.trim())},_=(T,P)=>{const O=t.find(R=>R.id===T);if(!O||P<=0||P>O.stock)return;const D=l.find(R=>R.productId===O.id);if(D){const R=D.quantity+P;if(R>O.stock)return;c(B=>B.map(Y=>Y.productId===O.id?{...Y,quantity:R}:Y))}else c(R=>[...R,{productId:O.id,productName:O.name,quantity:P,salePrice:O.salePrice,purchasePrice:O.purchasePrice}])},C=()=>{n&&(_(n,i),s(""),y(""),d(""),o(1))},N=T=>{c(P=>P.filter(O=>O.productId!==T))},w=(T,P)=>{const O=t.find(D=>D.id===T);!O||P<1||P>O.stock||c(D=>D.map(R=>R.productId===T?{...R,quantity:P}:R))},E=l.reduce((T,P)=>T+P.salePrice*P.quantity,0);return a.jsxs("div",{children:[a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 mb-2",children:[a.jsx("button",{onClick:()=>f("dropdown"),disabled:e,className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors disabled:opacity-50 ${h==="dropdown"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Lista de Productos"}),a.jsxs("button",{onClick:()=>f("barcode"),disabled:e,className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors flex items-center justify-center disabled:opacity-50 ${h==="barcode"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(qu,{className:"h-4 w-4 mr-1"})," Cdigo de Barras"]})]}),h==="dropdown"?a.jsx("div",{className:"relative w-full mb-2",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx("input",{ref:v,type:"text",placeholder:"Buscar producto...",value:m,onChange:T=>{y(T.target.value),x(!0)},onFocus:()=>x(!0),onBlur:()=>setTimeout(()=>x(!1),150),disabled:e,className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full disabled:opacity-50"}),g&&m&&a.jsx("div",{className:"absolute z-20 left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg max-h-56 overflow-y-auto mt-1",children:t.filter(T=>T.stock>0&&(T.name.toLowerCase().includes(m.toLowerCase())||T.referencia&&T.referencia.toLowerCase().includes(m.toLowerCase()))).length===0?a.jsx("div",{className:"p-3 text-gray-500 text-sm",children:"No hay productos"}):t.filter(T=>T.stock>0&&(T.name.toLowerCase().includes(m.toLowerCase())||T.referencia&&T.referencia.toLowerCase().includes(m.toLowerCase()))).map(T=>a.jsxs("button",{type:"button",onMouseDown:()=>{s(T.id),y(T.name),x(!1),setTimeout(()=>{var P;return(P=v.current)==null?void 0:P.blur()},0)},className:`w-full text-left px-4 py-2 hover:bg-blue-50 ${n===T.id?"bg-blue-100":""}`,children:[a.jsx("div",{className:"font-medium",children:T.name}),a.jsxs("div",{className:"text-sm text-gray-500",children:[T.referencia&&a.jsxs("span",{className:"mr-2",children:["Ref: ",T.referencia]}),V(T.salePrice),"  Stock: ",sr(T.stock)]})]},T.id))})]}),a.jsx("input",{type:"number",min:1,max:n&&((k=t.find(T=>T.id===n))==null?void 0:k.stock)||1,value:i,onChange:T=>o(Number(T.target.value)),disabled:e,className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),a.jsx("button",{onClick:C,disabled:!n||e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:a.jsx(wn,{className:"h-4 w-4"})})]})}):a.jsxs("div",{className:"space-y-2 mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(qu,{className:"h-5 w-5 text-gray-400"}),a.jsx("input",{ref:b,type:"text",placeholder:"Escanea o ingresa cdigo de barras...",value:u,onChange:T=>d(T.target.value),onKeyPress:S,disabled:e,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),a.jsx("button",{onClick:()=>j(u.trim()),disabled:!u.trim()||e,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar"})]}),a.jsx("p",{className:"text-xs text-gray-500",children:"Presiona Enter o haz clic en Agregar despus de escanear/ingresar el cdigo de barras"})]}),a.jsx("div",{className:"border border-gray-200 rounded-lg p-4 max-h-60 overflow-y-auto mb-4",children:l.length===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay productos agregados"}):a.jsx("div",{className:"space-y-2",children:l.map(T=>{var P;return a.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium",children:T.productName}),a.jsxs("div",{className:"text-sm text-gray-500",children:[(()=>{const O=t.find(D=>D.id===T.productId);return O!=null&&O.referencia?`Ref: ${O.referencia}  `:""})(),V(T.salePrice)," cada uno"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>w(T.productId,T.quantity-1),disabled:e||T.quantity<=1,className:"w-6 h-6 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center text-sm disabled:opacity-50",children:a.jsx(_x,{className:"h-4 w-4"})}),a.jsx("span",{className:"w-8 text-center text-sm font-medium",children:T.quantity}),a.jsx("button",{onClick:()=>w(T.productId,T.quantity+1),disabled:e||T.quantity>=(((P=t.find(O=>O.id===T.productId))==null?void 0:P.stock)||1),className:"w-6 h-6 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center text-sm disabled:opacity-50",children:a.jsx(wn,{className:"h-4 w-4"})}),a.jsx("span",{className:"font-medium w-20 text-right",children:V(T.salePrice*T.quantity)}),a.jsx("button",{onClick:()=>N(T.productId),disabled:e,className:"text-red-600 hover:text-red-800 w-6 h-6 flex items-center justify-center disabled:opacity-50",children:a.jsx(ct,{className:"h-4 w-4"})})]})]},T.productId)})})}),l.length>0&&a.jsx("div",{className:"border-t pt-4 space-y-3",children:a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{className:"font-bold text-blue-600",children:V(E)})]})})]})},eR=({customers:t,isLoading:e,onChange:r})=>{const[n,s]=I.useState(""),[i,o]=I.useState(!1),[l,c]=I.useState(null),u=I.useRef(null);I.useEffect(()=>{r(l)},[l,r]);const d=t.filter(h=>h.name.toLowerCase().includes(n.toLowerCase())||h.phone&&h.phone.includes(n)||h.email&&h.email.toLowerCase().includes(n.toLowerCase()));return a.jsxs("div",{className:"relative w-full",children:[a.jsx("input",{ref:u,type:"text",placeholder:"Buscar cliente por nombre, telfono o email...",value:l?l.name+(l.phone?` - ${l.phone}`:""):n,onChange:h=>{s(h.target.value),c(null),o(!0)},onFocus:()=>o(!0),onBlur:()=>setTimeout(()=>o(!1),150),disabled:e,className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full disabled:opacity-50",name:"customerComboBoxInput",autoComplete:"off"}),i&&n&&a.jsx("div",{className:"absolute z-20 left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg max-h-56 overflow-y-auto mt-1",children:d.length===0?a.jsx("div",{className:"p-3 text-gray-500 text-sm",children:"No hay clientes"}):d.map(h=>a.jsx("button",{type:"button",onMouseDown:()=>{c(h),s(""),o(!1),setTimeout(()=>{var f;return(f=u.current)==null?void 0:f.blur()},0)},className:`w-full text-left px-4 py-2 hover:bg-blue-50 ${(l==null?void 0:l.id)===h.id?"bg-blue-100":""}`,children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Rr,{className:"h-4 w-4 text-blue-500"}),h.name," ",h.phone&&`- ${h.phone}`]})},h.id))})]})};function $G(){var Se,Oe;const[t,e]=I.useState(0),[r,n]=I.useState(!1);I.useEffect(()=>{async function H(){try{const{salesService:Z}=await gn(async()=>{const{salesService:Ne}=await Promise.resolve().then(()=>Oa);return{salesService:Ne}},void 0),fe=(await Z.getAll()).reduce((Ne,Ve)=>Array.isArray(Ve.paymentMethods)?Ne+Ve.paymentMethods.filter(_e=>_e.method==="credit").reduce((_e,Xe)=>_e+Xe.amount,0):Ne,0);e(fe),n(!0)}catch{e(0),n(!0)}}H()},[]),I.useEffect(()=>{(async()=>{try{const Z=yt(Pe,"users"),fe=(await Kt(Z)).docs.map(Ne=>({...Ne.data(),uid:Ne.data().uid||Ne.id}));B(fe)}catch(Z){console.error("Error loading users:",Z)}})()},[]);const s=async H=>{if(!g)return;const Z=g.items.find(fe=>fe.id===H);if(!Z)return;const ce=Z.quantity-(Z.pickedUpQuantity||0);ce<=0||m("Confirmar eliminacin de producto",`Seguro que quieres eliminar "${Z.productName}" (${ce} unidades no recogidas) del plan separe? Las unidades sern devueltas al inventario y los totales recalculados.`,async()=>{v(!0);try{await La.updateStock(Z.productId,ce);const fe=g.items.filter(Te=>Te.id!==H),Ne=fe.reduce((Te,Fe)=>Te+Fe.totalRevenue,0),Ve=fe.reduce((Te,Fe)=>Te+Fe.totalCost,0),_e=Ne-Ve,Xe=g.payments.reduce((Te,Fe)=>Te+Fe.amount,0),ot=Math.max(0,Ne-Xe);await kn.update(g.id,{items:fe,totalAmount:Ne,totalCost:Ve,expectedProfit:_e,remainingBalance:ot,updatedAt:new Date().toISOString()}),se({...g,items:fe,totalAmount:Ne,totalCost:Ve,expectedProfit:_e,remainingBalance:ot,updatedAt:new Date().toISOString()}),h("Producto eliminado","El producto fue eliminado y las unidades devueltas al inventario."),l(Dh()),l(gi())}catch{f("Error","No se pudo eliminar el producto.")}finally{v(!1)}})},[i,o]=I.useState("active"),l=Hm();wc(),I.useEffect(()=>{(async()=>{try{if(i==="all"){const Z=await kn.getAll();l(gi.fulfilled(Z,"",void 0))}else{const ce=(await kn.getAll()).filter(fe=>fe.status===i);l(gi.fulfilled(ce,"",void 0))}}catch(Z){console.error("Error loading layaways:",Z)}})()},[i,l]);const c=Xt(Sx),u=Xt(ro),d=Xt(kd),{showSuccess:h,showError:f,showConfirm:m}=hi(),{appUser:y}=ma(),[g,x]=I.useState(null),[b,v]=I.useState(!1),[j,S]=I.useState(null),[_,C]=I.useState([]),[N,w]=I.useState(!1),[E,k]=I.useState(!1),[T,P]=I.useState(""),[O,D]=I.useState("all"),[R,B]=I.useState([]),Y=I.useRef(null),[W,L]=I.useState(!1),[X,G]=I.useState(null),[K,q]=I.useState(""),[ie,ge]=I.useState(!1),[be,Ye]=I.useState(""),[ze,U]=I.useState(!1),[Q,re]=I.useState([]),[te,pe]=I.useState("efectivo"),[xe,he]=I.useState(!1),[Le,qe]=I.useState(!1),[De,ne]=I.useState([]),[oe,Ce]=I.useState("efectivo"),ke=H=>{const Z=H.target.value,ce=jt(Z);isNaN(ce)?Z===""&&q(""):g&&ce>g.remainingBalance?q(Yt(g.remainingBalance)):q(Yt(ce))},ue=H=>{const Z=H.target.value,ce=jt(Z);isNaN(ce)?Z===""&&Ye(""):Ye(Yt(ce))};I.useEffect(()=>{W||(q(""),ne([]),qe(!1),ge(!1))},[W]),ee.useEffect(()=>{N||(Ye(""),re([]),U(!1),he(!1))},[N]),I.useEffect(()=>{if(g){const H=c.find(Z=>Z.id===g.id);H&&x(H)}},[c,g==null?void 0:g.id]);const se=H=>{g&&g.id===H.id&&x(H)},We=I.useMemo(()=>c.filter(H=>{var Ne,Ve;if(O!=="all"&&H.salesPersonId!==O)return!1;const Z=T.trim().toLowerCase();if(!Z)return!0;const ce=(Ne=H.customerName)==null?void 0:Ne.toLowerCase().includes(Z),fe=(Ve=H.items)==null?void 0:Ve.some(_e=>{var Xe;return(Xe=_e.productName)==null?void 0:Xe.toLowerCase().includes(Z)});return ce||fe}),[c,O,T]),Ae=async H=>{try{const ce=(await kn.getAll()).find(fe=>fe.id===H);ce&&se(ce)}catch{}},it=(H,Z)=>{switch(H){case"card":return Z*.0299+300;case"sistecredito":return Z*.02;case"addi":const ce=Z*.065,fe=ce*.19;return ce+fe;case"cash":default:return 0}},ut=(H,Z)=>{if(Z<=0)return;const ce=it(H,Z),fe={method:H,amount:Z,commission:ce};ne(Ne=>[...Ne,fe])},mt=H=>{ne(Z=>Z.filter((ce,fe)=>fe!==H))},pt=()=>{let H=De.reduce((Z,ce)=>Z+ce.amount,0);if(j&&ie&&j.credit>0&&g){const Z=Math.min(j.credit,g.remainingBalance-H);H+=Math.max(0,Z)}return H},gt=()=>g?Math.max(0,g.remainingBalance-pt()):0,lr=(H,Z)=>{if(Z<=0)return;const ce=it(H,Z),fe={method:H,amount:Z,commission:ce};re(Ne=>[...Ne,fe])},dn=H=>{re(Z=>Z.filter((ce,fe)=>fe!==H))},qr=()=>{const H=_.reduce((ce,fe)=>ce+fe.salePrice*fe.quantity,0);let Z=Q.reduce((ce,fe)=>ce+fe.amount,0);if(j&&xe&&j.credit>0){const ce=Math.min(j.credit,H-Z);Z+=Math.max(0,ce)}return Z},Tr=()=>{const H=_.reduce((Z,ce)=>Z+ce.salePrice*ce.quantity,0);return Math.max(0,H-qr())},Wa=async(H,Z,ce,fe,Ne="")=>{const Ve=ce.find(Ge=>Ge.method!=="credit"),_e=(Ve==null?void 0:Ve.method)||"efectivo",Xe={id:crypto.randomUUID(),amount:Z,paymentDate:new Date().toISOString(),paymentMethod:_e,paymentMethods:ce,notes:fe>0?Ne?`${Ne} (us ${V(fe)} de saldo a favor)`:`Us ${V(fe)} de saldo a favor`:Ne},ot=H.remainingBalance-Z,Te=ot===0?"completed":H.status;let Fe=H.items,It=[];Te==="completed"&&(Fe=H.items.map(Ge=>{const nt=Ge.quantity-(Ge.pickedUpQuantity||0);if(nt>0){It.push({...Ge,deliveredQuantity:nt});const Lt={id:crypto.randomUUID(),quantity:nt,date:new Date().toISOString(),notes:"Marcado automticamente como recogido al completar el pago"};return{...Ge,pickedUpQuantity:Ge.quantity,pickedUpHistory:[...Ge.pickedUpHistory||[],Lt]}}return Ge}));const xt=[...H.payments,Xe],Dt={payments:xt.map(Ge=>({...Ge,paymentMethod:["efectivo","transferencia","tarjeta","crdito"].includes(Ge.paymentMethod)?Ge.paymentMethod:"efectivo"})),remainingBalance:ot,status:Te};Te==="completed"&&(Dt.items=Fe),await kn.update(H.id,Dt),console.log(" Iniciando registro de abono en ventas:",{totalAmount:Z,layawayId:H.id});try{const{salesService:Ge}=await gn(async()=>{const{salesService:Or}=await Promise.resolve().then(()=>Oa);return{salesService:Or}},void 0),nt=H.totalAmount>0?Z/H.totalAmount:0;console.log(" Proporcin calculada:",{proportionalRevenue:nt,layawayTotal:H.totalAmount});const Ut={items:H.items.map(Or=>({productId:Or.productId,productName:Or.productName,quantity:0,purchasePrice:Or.productPurchasePrice,salePrice:Or.productSalePrice,totalCost:0,totalRevenue:Or.totalRevenue*nt,profit:0})),subtotal:Z,discount:0,tax:0,total:Z,totalCost:0,totalProfit:0,profitMargin:0,paymentMethod:_e,paymentMethods:ce,customerName:H.customerName,customerId:H.customerId,salesPersonId:y==null?void 0:y.uid,salesPersonName:(y==null?void 0:y.displayName)||(y==null?void 0:y.email)||"N/A",isLayaway:!0,layawayId:H.id,type:"layaway_payment",notes:`Abono plan separe - ${fe>0?`Saldo a favor usado: ${V(fe)}`:""}`};console.log(" Registrando venta con datos:",Ut),await Ge.add(Ut),console.log(" Abono registrado exitosamente en ventas")}catch(Ge){console.error(" Error registrando abono de plan separe:",Ge)}if(It.length>0)try{const{salesService:Ge}=await gn(async()=>{const{salesService:nt}=await Promise.resolve().then(()=>Oa);return{salesService:nt}},void 0);for(const nt of It){const Lt=nt.deliveredQuantity*nt.productSalePrice,Ut=nt.deliveredQuantity*nt.productPurchasePrice,Or=Lt-Ut,io=Lt>0?Or/Lt*100:0,oo={items:[{productId:nt.productId,productName:nt.productName,quantity:nt.deliveredQuantity,purchasePrice:nt.productPurchasePrice,salePrice:nt.productSalePrice,totalCost:Ut,totalRevenue:0,profit:Or}],subtotal:0,discount:0,tax:0,total:0,totalCost:Ut,totalProfit:Or,profitMargin:io,paymentMethod:"efectivo",paymentMethods:[{method:"efectivo",amount:0}],customerName:H.customerName,customerId:H.customerId,isLayaway:!0,layawayId:H.id,type:"layaway_delivery",notes:` Entrega plan separe: ${nt.deliveredQuantity} x ${nt.productName} (Valor: ${V(Lt)}) - Ganancia registrada`};await Ge.add(oo)}}catch(Ge){console.error("Error registrando ventas de entrega automtica:",Ge)}return{updatedLayaway:{...H,payments:xt.map(Ge=>({...Ge,paymentMethod:["efectivo","transferencia","tarjeta","crdito"].includes(Ge.paymentMethod)?Ge.paymentMethod:"efectivo"})),remainingBalance:ot,status:Te,items:Fe,updatedAt:new Date().toISOString()},newStatus:Te,creditUsed:fe}},_n=async H=>{H.preventDefault(),v(!0);try{const ce=new FormData(H.currentTarget).get("notes")||"",fe=j;if(!fe){f("Error de validacin","Debes seleccionar un cliente"),v(!1);return}if(_.length===0){f("Error de validacin","Debes seleccionar al menos un producto"),v(!1);return}let Ne,Ve=[],_e=0;if(ze){if(Q.length===0){f("Error de validacin","Debes agregar al menos un mtodo de pago"),v(!1);return}if(Ne=qr(),Ve=[...Q.map(Ge=>({method:Ge.method,amount:Ge.amount,commission:Ge.commission}))],xe&&fe&&fe.credit>0){const Ge=_.reduce((Lt,Ut)=>Lt+Ut.salePrice*Ut.quantity,0),nt=Math.min(fe.credit,Ge-Q.reduce((Lt,Ut)=>Lt+Ut.amount,0));nt>0&&(_e=nt,Ve.push({method:"credit",amount:_e}),Ne+=_e)}}else{const Ge=jt(be)||0;if(xe&&fe&&fe.credit>0){const nt=_.reduce((Lt,Ut)=>{const Or=Ut.salePrice*Ut.quantity;return Lt+Or},0);Ge>0,_e=Math.min(fe.credit,nt)}if(Ne=Ge+_e,Ne>0&&(_e>0&&Ve.push({method:"credit",amount:_e}),Ge>0)){const nt=it(te,Ge);Ve.push({method:te,amount:Ge,commission:nt})}}const Xe=[];let ot=0,Te=0;for(let Ge=0;Ge<_.length;Ge++){const nt=_[Ge],Lt=u.find(ul=>ul.id===nt.productId);if(!Lt||nt.quantity<=0||nt.quantity>Lt.stock){f("Error de stock",`Stock insuficiente para ${(Lt==null?void 0:Lt.name)||"producto"}`),v(!1);return}const Ut=nt.quantity*Lt.purchasePrice,Or=nt.quantity*Lt.salePrice,io=Or-Ut,oo={id:crypto.randomUUID(),productId:Lt.id,productName:Lt.name,productPurchasePrice:Lt.purchasePrice,productSalePrice:Lt.salePrice,quantity:nt.quantity,totalCost:Ut,totalRevenue:Or,profit:io,pickedUpQuantity:0,pickedUpHistory:[]};Xe.push(oo),ot+=Or,Te+=Ut}const Fe=ot-Te;if(Ne>ot){f("Error de validacin","El pago inicial no puede ser mayor al total"),v(!1);return}const It={items:Xe,totalAmount:ot,totalCost:Te,expectedProfit:Fe,customerId:fe.id,customerName:fe.name,customerPhone:fe.phone,customerEmail:fe.email,salesPersonId:y==null?void 0:y.uid,salesPersonName:(y==null?void 0:y.displayName)||(y==null?void 0:y.email),downPayment:0,remainingBalance:ot,payments:[],status:"active",notes:ce},xt=await kn.add(It);console.log("Layaway created with ID:",xt);const Dt={id:xt,...It,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};Ne>0&&(_e>0&&fe&&await Mn.update(fe.id,{credit:fe.credit-_e}),await Wa(Dt,Ne,Ve,_e,"Pago inicial")),w(!1),h("Plan separe creado",`Plan separe para ${fe.name} creado exitosamente por ${V(ot)}${Ne>0?`. Pago inicial de ${V(Ne)} registrado${_e>0?` (incluye ${V(_e)} de saldo a favor)`:""}.`:""}`),l(Dh()),l(gi())}catch(Z){console.error("Error creating layaway:",Z),f("Error al crear plan separe","No se pudo crear el plan separe. Intntalo de nuevo.")}finally{v(!1)}},Sn=async H=>{if(H.preventDefault(),!!g){v(!0);try{const Z=new FormData(H.currentTarget),ce=Z.get("notes")||"",fe=d.find(ot=>ot.id===g.customerId);let Ne,Ve=[],_e=0;if(Le){if(De.length===0){f("Error de validacin","Debes agregar al menos un mtodo de pago"),v(!1);return}if(Ne=pt(),Ve=[...De.map(ot=>({method:ot.method,amount:ot.amount,commission:ot.commission}))],ie&&fe&&fe.credit>0){const ot=Math.min(fe.credit,g.remainingBalance-De.reduce((Te,Fe)=>Te+Fe.amount,0));ot>0&&(_e=ot,Ve.push({method:"credit",amount:_e}),Ne+=_e)}if(Math.abs(Ne-g.remainingBalance)>.01){f("Pago incompleto",`El total de los pagos (${V(Ne)}) no coincide con el saldo pendiente (${V(g.remainingBalance)})`),v(!1);return}}else{const ot=jt(K),Te=Z.get("paymentMethod");if(ie&&fe&&fe.credit>0&&(_e=Math.min(fe.credit,g.remainingBalance)),Ne=ot+_e,Ne<=0||Ne>g.remainingBalance){f("Error de validacin","El monto del pago no es vlido"),v(!1);return}if(_e>0&&Ve.push({method:"credit",amount:_e}),ot>0){const Fe=it(Te,ot);Ve.push({method:Te,amount:ot,commission:Fe})}}_e>0&&fe&&await Mn.update(fe.id,{credit:fe.credit-_e});const Xe=await Wa(g,Ne,Ve,_e,ce);se(Xe.updatedLayaway),L(!1),h("Pago registrado",`Pago de ${V(Ne)} registrado exitosamente. ${_e>0?`Se us ${V(_e)} de saldo a favor. `:""}${Xe.newStatus==="completed"?"Plan separe completado! Todos los productos han sido marcados como recogidos automticamente.":`Saldo pendiente: ${V(Xe.updatedLayaway.remainingBalance)}`}`),setTimeout(()=>Ae(g.id),1e3),l(gi())}catch(Z){console.error("Error adding payment:",Z),f("Error al registrar pago","No se pudo registrar el pago. Intntalo de nuevo.")}finally{v(!1)}}},Ar=async H=>{if(H.preventDefault(),!X)return;const{item:Z,layaway:ce}=X;v(!0);try{const fe=new FormData(H.currentTarget),Ne=parseInt(fe.get("quantity")),Ve=fe.get("notes")||"",_e=Z.quantity-(Z.pickedUpQuantity||0);if(Ne<=0||Ne>_e){f("Error de validacin",`Solo puedes recoger entre 1 y ${sr(_e)} unidades`),v(!1);return}await kn.update(ce.id,{items:ce.items.map(Te=>{if(Te.id===Z.id){const Fe={id:crypto.randomUUID(),quantity:Ne,date:new Date().toISOString(),notes:Ve};return{...Te,pickedUpQuantity:(Te.pickedUpQuantity||0)+Ne,pickedUpHistory:[...Te.pickedUpHistory||[],Fe]}}return Te})});try{const{salesService:Te}=await gn(async()=>{const{salesService:nt}=await Promise.resolve().then(()=>Oa);return{salesService:nt}},void 0),Fe=Ne*Z.productSalePrice,It=Ne*Z.productPurchasePrice,xt=Fe-It,Dt=Fe>0?xt/Fe*100:0,Ge={items:[{productId:Z.productId,productName:Z.productName,quantity:Ne,purchasePrice:Z.productPurchasePrice,salePrice:Z.productSalePrice,totalCost:It,totalRevenue:0,profit:xt}],subtotal:0,discount:0,tax:0,total:0,totalCost:It,totalProfit:xt,profitMargin:Dt,paymentMethod:"efectivo",paymentMethods:[{method:"efectivo",amount:0}],customerName:ce.customerName,customerId:ce.customerId,isLayaway:!0,layawayId:ce.id,type:"layaway_delivery",notes:` Entrega plan separe: ${Ne} x ${Z.productName} (Valor: ${V(Fe)}) - Ganancia registrada${Ve?` - ${Ve}`:""}`};await Te.add(Ge)}catch(Te){console.error("Error registrando venta de entrega:",Te)}const Xe=ce.items.map(Te=>{if(Te.id===Z.id){const Fe={id:crypto.randomUUID(),quantity:Ne,date:new Date().toISOString(),notes:Ve};return{...Te,pickedUpQuantity:(Te.pickedUpQuantity||0)+Ne,pickedUpHistory:[...Te.pickedUpHistory||[],Fe]}}return Te}),ot={...ce,items:Xe,updatedAt:new Date().toISOString()};se(ot),G(null),h("Productos recogidos",`Se marcaron ${Ne} unidades de "${Z.productName}" como recogidas`),setTimeout(()=>Ae(ce.id),1e3)}catch(fe){console.error("Error marking as picked up:",fe),f("Error al marcar como recogido","No se pudo actualizar el estado. Intntalo de nuevo.")}finally{v(!1)}},hn=async H=>{if(!g)return;const Z=g.payments.find(ce=>ce.id===H);Z&&m("Confirmar cancelacin de pago",`Ests seguro de que quieres cancelar el pago de ${V(Z.amount)}? El saldo pendiente se actualizar automticamente y el abono ser eliminado del historial de ventas.`,async()=>{v(!0);try{const ce=g.payments.filter(Te=>Te.id!==H),fe=ce.reduce((Te,Fe)=>Te+Fe.amount,0),Ne=g.totalAmount-fe;let Ve=g.status,_e=g.items;g.status==="completed"&&Ne>0&&(Ve="active",_e=g.items.map(Te=>{var xt;const Fe=((xt=Te.pickedUpHistory)==null?void 0:xt.filter(Dt=>Dt.notes!=="Marcado automticamente como recogido al completar el pago"))||[],It=Fe.reduce((Dt,Ge)=>Dt+Ge.quantity,0);return{...Te,pickedUpQuantity:It,pickedUpHistory:Fe}}));const Xe={payments:ce,remainingBalance:Ne,status:Ve};Ve==="active"&&g.status==="completed"&&(Xe.items=_e),await kn.update(g.id,Xe);try{const{salesService:Te}=await gn(async()=>{const{salesService:xt}=await Promise.resolve().then(()=>Oa);return{salesService:xt}},void 0),It=(await Te.getAll()).find(xt=>xt.isLayaway&&xt.layawayId===g.id&&xt.total===Z.amount);It&&await Te.delete(It.id)}catch(Te){console.error("Error eliminando abono en ventas:",Te)}const ot={...g,payments:ce,remainingBalance:Ne,status:Ve,items:_e,updatedAt:new Date().toISOString()};se(ot),h("Pago cancelado",`El pago de ${V(Z.amount)} ha sido cancelado y el abono eliminado del historial de ventas. ${Ve==="active"&&g.status==="completed"?"El plan separe ha vuelto a estado activo y se han revertido las recogidas automticas.":`Nuevo saldo pendiente: ${V(Ne)}`}`),setTimeout(()=>Ae(g.id),1e3),l(gi())}catch(ce){console.error("Error cancelling payment:",ce),f("Error al cancelar pago","No se pudo cancelar el pago. Intntalo de nuevo.")}finally{v(!1)}})},Ir=async(H,Z)=>{var Ne;if(!g)return;const ce=g.items.find(Ve=>Ve.id===H);if(!ce)return;const fe=(Ne=ce.pickedUpHistory)==null?void 0:Ne.find(Ve=>Ve.id===Z);fe&&m("Confirmar reversin de recogida",`Ests seguro de que quieres revertir la recogida de ${fe.quantity} unidades de "${ce.productName}"? Estas unidades volvern a estar disponibles para recoger.`,async()=>{v(!0);try{const Ve=g.items.map(Fe=>{var It;if(Fe.id===H){const xt=((It=Fe.pickedUpHistory)==null?void 0:It.filter(Ge=>Ge.id!==Z))||[],Dt=xt.reduce((Ge,nt)=>Ge+nt.quantity,0);return{...Fe,pickedUpQuantity:Dt,pickedUpHistory:xt}}return Fe});let _e=g.status;const Xe=Ve.some(Fe=>(Fe.pickedUpQuantity||0)<Fe.quantity);g.status==="completed"&&Xe&&(_e="active");const ot={items:Ve,status:_e};await kn.update(g.id,ot);const Te={...g,items:Ve,status:_e,updatedAt:new Date().toISOString()};se(Te),h("Recogida revertida",`Se ha revertido la recogida de ${fe.quantity} unidades de "${ce.productName}". ${_e==="active"&&g.status==="completed"?"El plan separe ha vuelto a estado activo.":"Las unidades estn disponibles para recoger nuevamente."}`),setTimeout(()=>Ae(g.id),1e3),l(gi())}catch(Ve){console.error("Error reverting pickup:",Ve),f("Error al revertir recogida","No se pudo revertir la recogida. Intntalo de nuevo.")}finally{v(!1)}})},Hr=async H=>{const Z=H.items.map(Te=>{const Fe=Te.quantity-(Te.pickedUpQuantity||0);return{productId:Te.productId,productName:Te.productName,quantityToReturn:Fe}}).filter(Te=>Te.quantityToReturn>0),ce=Z.reduce((Te,Fe)=>Te+Fe.quantityToReturn,0),fe=H.payments.reduce((Te,Fe)=>Te+Fe.amount,0),Ne=H.items.reduce((Te,Fe)=>{const It=Fe.pickedUpQuantity||0;return Te+It*Fe.productSalePrice},0),Ve=Math.min(fe,Ne),_e=fe-Ve,Xe=ce>0?` Se devolvern ${ce} unidades al inventario.`:" Todos los productos ya han sido recogidos.";let ot="";fe>0&&(Ve>0&&_e>0?ot=` DINERO: ${V(Ve)} se contarn como ingresos reales (productos recogidos) y ${V(_e)} requieren manejo segn poltica del negocio.`:Ve>0&&_e===0?ot=` DINERO: ${V(Ve)} se contarn como ingresos reales por productos ya recogidos.`:_e>0&&(ot=` DINERO: ${V(_e)} requieren manejo segn poltica del negocio.`)),m("Confirmar cancelacin",`Ests seguro de que quieres cancelar el plan separe de ${H.customerName}?${Xe}${ot}`,async()=>{v(!0);try{for(const xt of Z)await La.updateStock(xt.productId,xt.quantityToReturn),console.log(` Devolviendo ${xt.quantityToReturn} unidades de ${xt.productName} al inventario`);if(_e>0){const xt=d.find(Dt=>Dt.id===H.customerId);if(xt){const Dt=(xt.credit||0)+_e;await Mn.update(xt.id,{credit:Dt})}}await kn.update(H.id,{status:"cancelled"});const Te={...H,status:"cancelled",updatedAt:new Date().toISOString()};se(Te);let Fe=`El plan separe de ${H.customerName} se cancel correctamente.`;ce>0&&(Fe+=` Se devolvieron ${ce} unidades al inventario.`),fe>0&&(Ve>0&&_e>0?Fe+=` IMPORTANTE: ${V(Ve)} se registraron como ingresos reales (productos recogidos) y ${V(_e)} fueron acreditados como saldo a favor del cliente.`:Ve>0&&_e===0?Fe+=` Los ${V(Ve)} pagados se registraron como ingresos reales por productos ya recogidos.`:_e>0&&(Fe+=` IMPORTANTE: ${V(_e)} fueron acreditados como saldo a favor del cliente.`)),h("Plan separe cancelado",Fe),l(Dh()),l(gi());const{fetchCustomers:It}=await gn(async()=>{const{fetchCustomers:xt}=await Promise.resolve().then(()=>wG);return{fetchCustomers:xt}},void 0);l(It()),setTimeout(()=>Ae(H.id),1e3)}catch(Te){console.error("Error cancelling layaway:",Te);let Fe="Error desconocido";typeof Te=="string"?Fe=Te:Te&&typeof Te=="object"&&(Fe=Te.message||Te.code||JSON.stringify(Te)),f("Error al cancelar",Fe)}finally{v(!1)}})},kr=H=>{switch(H){case"active":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},F=H=>{switch(H){case"active":return"Activo";case"completed":return"Completado";case"cancelled":return"Cancelado";default:return H}},ae=H=>{const ce=H.payments.reduce((_e,Xe)=>_e+Xe.amount,0)/H.totalAmount*100,fe=H.items.reduce((_e,Xe)=>_e+Xe.quantity,0),Ne=H.items.reduce((_e,Xe)=>_e+(Xe.pickedUpQuantity||0),0),Ve=fe>0?Ne/fe*100:0;return{paymentProgress:ce,pickupProgress:Ve}},me=I.useMemo(()=>{const H=c.filter(Te=>Te.status==="active"),Z=c.filter(Te=>Te.status==="completed"),ce=c.filter(Te=>Te.status==="cancelled"),fe=ce.reduce((Te,Fe)=>{const It=Fe.payments.reduce((Ge,nt)=>Ge+nt.amount,0),xt=Fe.items.reduce((Ge,nt)=>{const Ut=(nt.pickedUpQuantity||0)*nt.productSalePrice;return Ge+Ut},0),Dt=Math.min(It,xt);return Te+Dt},0),Ne=[...H,...Z].reduce((Te,Fe)=>{const It=Fe.payments.reduce((Ge,nt)=>Ge+nt.amount,0),xt=Fe.items.reduce((Ge,nt)=>{const Ut=(nt.pickedUpQuantity||0)*nt.productSalePrice;return Ge+Ut},0),Dt=Math.min(It,xt);return Te+Dt},0)+fe,Ve=[...H,...Z].reduce((Te,Fe)=>{const It=Fe.payments.reduce((Ge,nt)=>Ge+nt.amount,0),xt=Fe.items.reduce((Ge,nt)=>{const Ut=(nt.pickedUpQuantity||0)*nt.productSalePrice;return Ge+Ut},0),Dt=It-xt;return Te+Math.max(0,Dt)},0),_e=ce.reduce((Te,Fe)=>{const It=Fe.payments.reduce((Ge,nt)=>Ge+nt.amount,0),xt=Fe.items.reduce((Ge,nt)=>{const Ut=(nt.pickedUpQuantity||0)*nt.productSalePrice;return Ge+Ut},0),Dt=It-xt;return Te+Math.max(0,Dt)},0),Xe=H.reduce((Te,Fe)=>Te+Fe.remainingBalance,0),ot=H.reduce((Te,Fe)=>Te+Fe.expectedProfit,0);return{totalLayaways:c.length,activeLayaways:H.length,completedLayaways:Z.length,cancelledLayaways:ce.length,totalRevenue:Ne,pendingRevenue:Xe,expectedProfit:ot,pendingCustomerCredit:Math.max(0,_e-t),paidButNotPickedUp:Ve}},[c,t,r]);return a.jsxs("div",{className:"space-y-4 md:space-y-6 p-4 md:p-0",children:[a.jsx("div",{className:"mb-4 pt-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Plan Separe"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona los planes de separ y pagos diferidos"})]}),a.jsxs("button",{onClick:()=>w(!0),className:"bg-blue-600 text-white px-3 md:px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 text-sm md:text-base",children:[a.jsx(wn,{className:"h-4 w-4 md:h-5 md:w-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Nuevo Plan Separe"}),a.jsx("span",{className:"sm:hidden",children:"Nuevo"})]})]})}),!N&&a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4 items-stretch",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out flex flex-col justify-center py-3",children:a.jsxs("div",{className:"text-center w-full",children:[a.jsx("div",{className:"w-4 h-4 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Xn,{className:"w-3.5 h-3.5 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Total Planes"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:me.totalLayaways})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-orange-500/10 hover:-translate-y-0.5 hover:border-orange-300 transition-all duration-300 ease-out flex flex-col justify-center py-3",children:a.jsxs("div",{className:"text-center w-full",children:[a.jsx("div",{className:"w-4 h-4 mx-auto mb-1 bg-orange-50 rounded flex items-center justify-center group-hover:bg-orange-100 group-hover:scale-110 transition-all duration-300",children:a.jsx($i,{className:"w-3.5 h-3.5 text-orange-600 group-hover:text-orange-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Activos"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-orange-900 transition-colors duration-300",children:me.activeLayaways})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-green-500/10 hover:-translate-y-0.5 hover:border-green-300 transition-all duration-300 ease-out flex flex-col justify-center py-3",children:a.jsxs("div",{className:"text-center w-full",children:[a.jsx("div",{className:"w-4 h-4 mx-auto mb-1 bg-green-50 rounded flex items-center justify-center group-hover:bg-green-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ai,{className:"w-3.5 h-3.5 text-green-600 group-hover:text-green-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Completados"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-green-900 transition-colors duration-300",children:me.completedLayaways})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out flex flex-col justify-center py-3",children:a.jsxs("div",{className:"text-center w-full",children:[a.jsx("div",{className:"w-4 h-4 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Wt,{className:"w-3.5 h-3.5 text-emerald-600 group-hover:text-emerald-700"})}),a.jsx("span",{className:"text-xs px-1 py-0.5 rounded bg-emerald-100 text-emerald-600 group-hover:bg-emerald-200 group-hover:text-emerald-800 transition-all duration-300 mb-0.5 inline-block",children:"Real"}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Ingresos Reales"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(me.totalRevenue)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-purple-500/10 hover:-translate-y-0.5 hover:border-purple-300 transition-all duration-300 ease-out flex flex-col justify-center py-3",children:a.jsxs("div",{className:"text-center w-full",children:[a.jsx("div",{className:"w-4 h-4 mx-auto mb-1 bg-purple-50 rounded flex items-center justify-center group-hover:bg-purple-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(VW,{className:"w-3.5 h-3.5 text-purple-600 group-hover:text-purple-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Pendiente"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-purple-900 transition-colors duration-300",children:V(me.pendingRevenue)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-teal-500/10 hover:-translate-y-0.5 hover:border-teal-300 transition-all duration-300 ease-out flex flex-col justify-center py-3",children:a.jsxs("div",{className:"text-center w-full",children:[a.jsx("div",{className:"w-4 h-4 mx-auto mb-1 bg-teal-50 rounded flex items-center justify-center group-hover:bg-teal-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ds,{className:"w-3.5 h-3.5 text-teal-600 group-hover:text-teal-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Ganancia Esperada"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-teal-900 transition-colors duration-300",children:V(me.expectedProfit)})]})}),me.paidButNotPickedUp>0&&a.jsx("div",{className:"group relative bg-gradient-to-br from-yellow-50 to-orange-50 rounded-lg shadow-lg border border-yellow-200 p-2 hover:shadow-xl hover:shadow-yellow-500/20 hover:-translate-y-0.5 hover:border-yellow-300 transition-all duration-300 ease-out flex flex-col justify-center py-3",children:a.jsxs("div",{className:"text-center w-full",children:[a.jsx("div",{className:"w-4 h-4 mx-auto mb-1 bg-yellow-50 rounded flex items-center justify-center group-hover:bg-yellow-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Vf,{className:"w-3.5 h-3.5 text-yellow-600 group-hover:text-yellow-700"})}),a.jsx("span",{className:"text-xs px-1 py-0.5 rounded bg-yellow-100 text-yellow-600 animate-pulse group-hover:bg-yellow-200 group-hover:text-yellow-700 transition-all duration-300 mb-0.5 inline-block",children:"!"}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Pagado sin Recoger"}),a.jsx("p",{className:"text-base font-bold text-yellow-600 group-hover:text-yellow-800 transition-colors duration-300",children:V(me.paidButNotPickedUp)})]})}),r&&me.pendingCustomerCredit>0&&a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-blue-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-400 transition-all duration-300 ease-out flex flex-col justify-center py-3",children:a.jsxs("div",{className:"text-center w-full",children:[a.jsx("div",{className:"w-4 h-4 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Rr,{className:"w-3.5 h-3.5 text-blue-600 group-hover:text-blue-700"})}),a.jsx("span",{className:"text-xs px-1 py-0.5 rounded bg-blue-100 text-blue-600 group-hover:bg-blue-200 group-hover:text-blue-700 transition-all duration-300 mb-0.5 inline-block",children:"Disponible"}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Saldo a Favor"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:V(me.pendingCustomerCredit)})]})})]}),!N&&a.jsx("div",{className:"bg-white rounded-xl p-4 md:p-6 shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 md:gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 md:h-5 md:w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar por cliente...",value:T,onChange:H=>P(H.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("select",{value:i,onChange:H=>o(H.target.value),className:"px-3 md:px-4 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[140px] md:min-w-[160px]",children:[a.jsx("option",{value:"all",children:"Todos los estados"}),a.jsx("option",{value:"active",children:"Solo activos"}),a.jsx("option",{value:"completed",children:"Solo completados"}),a.jsx("option",{value:"cancelled",children:"Solo cancelados"})]}),a.jsxs("select",{value:O,onChange:H=>D(H.target.value),className:"px-3 md:px-4 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[140px] md:min-w-[180px]",children:[a.jsx("option",{value:"all",children:"Todos los vendedores"}),R.map(H=>a.jsx("option",{value:H.uid,children:H.displayName||H.email},H.uid))]})]})}),N&&a.jsxs("div",{className:"bg-white rounded-lg md:rounded-xl p-4 md:p-6 shadow-sm border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900",children:"Crear Nuevo Plan Separe"}),a.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600 p-1",children:a.jsx(ct,{className:"h-5 w-5 md:h-6 md:w-6"})})]}),a.jsxs("form",{ref:Y,onSubmit:_n,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente *"}),a.jsx(eR,{customers:d,isLoading:b,onChange:S})]}),a.jsxs("div",{className:"space-y-4",children:[j&&j.credit>0&&a.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"useCreditCreate",checked:xe,onChange:H=>he(H.target.checked),disabled:b}),a.jsxs("label",{htmlFor:"useCreditCreate",className:"text-sm text-gray-700",children:["Usar saldo a favor (",V(j.credit),")"]})]}),xe&&a.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Saldo disponible: ",V(j.credit)]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pago Inicial"}),a.jsxs("label",{className:"flex items-center text-sm",children:[a.jsx("input",{type:"checkbox",checked:ze,onChange:H=>{U(H.target.checked),H.target.checked||re([])},disabled:b,className:"mr-2 disabled:opacity-50"}),"Pagos mltiples"]})]}),ze?a.jsxs("div",{className:"space-y-3",children:[_.length>0&&a.jsx("div",{className:"p-2 bg-blue-50 rounded-lg text-sm",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Total productos:"}),a.jsx("span",{className:"font-medium",children:V(_.reduce((H,Z)=>H+Z.salePrice*Z.quantity,0))})]})}),Q.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Pagos agregados:"}),Q.map((H,Z)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-medium",children:H.method==="efectivo"?"Efectivo":H.method==="transferencia"?"Transferencia":H.method==="tarjeta"?"Tarjeta":H.method==="crdito"?"Crdito":H.method}),a.jsx("div",{className:"text-xs text-gray-600",children:V(H.amount)})]}),a.jsx("button",{type:"button",onClick:()=>dn(Z),disabled:b,className:"text-red-600 hover:text-red-800 p-1 disabled:opacity-50",children:a.jsx(ct,{className:"h-4 w-4"})})]},Z)),a.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[a.jsx("span",{children:"Total pagado:"}),a.jsx("span",{className:"font-medium",children:V(qr())})]}),_.length>0&&a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Restante:"}),a.jsx("span",{className:`font-medium ${Tr()>0?"text-orange-600":"text-green-600"}`,children:V(Tr())})]}),_.length===0&&Q.length>0&&a.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Selecciona productos para calcular el total restante"})]}),a.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Agregar pago:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:te,onChange:H=>pe(H.target.value),disabled:b,className:`px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 text-sm ${_.length>0?"flex-1":"w-full"}`,children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]}),_.length>0&&a.jsx("button",{type:"button",onClick:()=>{const H=Tr();H>0&&lr(te,H)},disabled:b||Tr()<=0,className:"px-3 py-2 bg-gray-600 text-white text-xs rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Todo"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"text",placeholder:"Monto",disabled:b,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",onChange:H=>{const Z=jt(H.target.value);if(_.length>0){const ce=Tr(),fe=Math.min(Z,ce);H.target.value=Yt(fe.toString())}else H.target.value=Yt(Z.toString())},onKeyDown:H=>{if(H.key==="Enter"){const Z=jt(H.currentTarget.value);Z>0&&(_.length===0||Z<=Tr())&&(lr(te,Z),H.currentTarget.value="")}}}),a.jsx("button",{type:"button",onClick:H=>{var fe;const Z=(fe=H.currentTarget.parentElement)==null?void 0:fe.querySelector("input"),ce=jt((Z==null?void 0:Z.value)||"0");ce>0&&(_.length===0||ce<=Tr())&&(lr(te,ce),Z&&(Z.value=""))},disabled:b,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar"})]})]})]})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto (COP)"}),a.jsx("input",{type:"text",value:be,onChange:ue,disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mtodo de Pago"}),a.jsxs("select",{value:te,onChange:H=>pe(H.target.value),disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Productos *"}),a.jsx(RG,{products:u,isLoading:b,onChange:C})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas (Opcional)"}),a.jsx("textarea",{name:"notes",rows:3,disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"Notas adicionales sobre el plan separe..."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>w(!1),disabled:b,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[b&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:b?"Creando...":"Crear Plan Separe"})]})]})]})]}),!N&&a.jsxs(a.Fragment,{children:[(i!=="active"||O!=="all"||T.trim())&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-sm text-blue-800 font-medium",children:"Filtros activos:"}),i!=="active"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Estado: ",i==="all"?"Todos":i==="completed"?"Completados":i==="cancelled"?"Cancelados":i,a.jsx("button",{onClick:()=>o("active"),className:"ml-1 text-blue-600 hover:text-blue-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),O!=="all"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:["Vendedor: ",((Se=R.find(H=>H.uid===O))==null?void 0:Se.displayName)||((Oe=R.find(H=>H.uid===O))==null?void 0:Oe.email)||"Desconocido",a.jsx("button",{onClick:()=>D("all"),className:"ml-1 text-indigo-600 hover:text-indigo-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),T.trim()&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:['Bsqueda: "',T,'"',a.jsx("button",{onClick:()=>P(""),className:"ml-1 text-green-600 hover:text-green-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),a.jsxs("span",{className:"text-sm text-blue-700",children:["(",We.length," planes encontrados)"]})]})}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:We.map(H=>{const{paymentProgress:Z,pickupProgress:ce}=ae(H);return a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Rr,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:H.customerName}),H.salesPersonName&&a.jsxs("p",{className:"text-sm text-gray-600",children:[" Vendedor: ",H.salesPersonName]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${kr(H.status)}`,children:F(H.status)})})]})]}),a.jsx("div",{className:"flex space-x-1",children:a.jsx("button",{onClick:()=>x(H),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50 transition-colors",title:"Ver detalles",children:a.jsx(os,{className:"h-5 w-5"})})})]}),a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Total:"}),a.jsx("span",{className:"font-medium",children:V(H.totalAmount)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Pagado:"}),a.jsx("span",{className:"font-medium text-green-600",children:V(H.payments.reduce((fe,Ne)=>fe+Ne.amount,0))})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Pendiente:"}),a.jsx("span",{className:"font-medium text-orange-600",children:V(H.remainingBalance)})]})]}),a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[a.jsx("span",{children:"Progreso de Pagos"}),a.jsxs("span",{children:[Z.toFixed(0),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${Z}%`}})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[a.jsx("span",{children:"Productos Recogidos"}),a.jsxs("span",{children:[ce.toFixed(0),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${ce}%`}})})]})]}),a.jsx("div",{className:"text-sm text-gray-600 mb-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(ea,{className:"h-4 w-4 mr-1"}),a.jsxs("span",{children:[H.items.length," producto(s)"]})]})}),H.status==="active"&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{onClick:()=>{x(H),L(!0)},className:"flex-1 bg-green-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors flex items-center justify-center space-x-1",children:[a.jsx(Wt,{className:"h-4 w-4"}),a.jsx("span",{children:"Pagar"})]}),a.jsx("button",{onClick:()=>Hr(H),className:"bg-red-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors",title:"Cancelar plan separe",children:a.jsx(ct,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mt-3 text-xs text-gray-400",children:["Creado: ",new Date(H.createdAt).toLocaleDateString()]})]},H.id)})}),g&&!E&&!W&&!X&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Plan Separe - ",g.customerName]}),a.jsx("div",{className:"flex items-center space-x-4 mt-2",children:a.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${kr(g.status)}`,children:F(g.status)})})]}),a.jsx("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),a.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Informacin del Cliente"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Nombre:"}),a.jsx("p",{className:"font-medium",children:g.customerName})]}),g.customerPhone&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Telfono:"}),a.jsx("p",{className:"font-medium",children:g.customerPhone})]}),g.customerEmail&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Email:"}),a.jsx("p",{className:"font-medium",children:g.customerEmail})]}),g.salesPersonName&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Vendedor:"}),a.jsx("p",{className:"font-medium",children:g.salesPersonName})]})]})]}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Resumen Financiero"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Total:"}),a.jsx("p",{className:"font-bold text-lg",children:V(g.totalAmount)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Pagado:"}),a.jsx("p",{className:"font-bold text-lg text-green-600",children:V(g.payments.reduce((H,Z)=>H+Z.amount,0))})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Pendiente:"}),a.jsx("p",{className:"font-bold text-lg text-orange-600",children:V(g.remainingBalance)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Ganancia Esperada:"}),a.jsx("p",{className:"font-bold text-lg text-emerald-600",children:V(g.expectedProfit)})]})]})]}),a.jsxs("div",{className:"mb-6 space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[a.jsx("span",{children:"Progreso de Pagos"}),a.jsxs("span",{children:[ae(g).paymentProgress.toFixed(1),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:a.jsx("div",{className:"bg-green-500 h-3 rounded-full transition-all duration-300",style:{width:`${ae(g).paymentProgress}%`}})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[a.jsx("span",{children:"Productos Recogidos"}),a.jsxs("span",{children:[ae(g).pickupProgress.toFixed(1),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:a.jsx("div",{className:"bg-blue-500 h-3 rounded-full transition-all duration-300",style:{width:`${ae(g).pickupProgress}%`}})})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Productos en el Plan"}),g.status==="active"&&a.jsxs("button",{onClick:()=>k(!0),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors flex items-center space-x-1",children:[a.jsx(wn,{className:"h-4 w-4"}),a.jsx("span",{children:"Agregar Productos"})]})]}),a.jsx("div",{className:"space-y-3",children:g.items.map(H=>{const Z=H.quantity-(H.pickedUpQuantity||0),ce=(H.pickedUpQuantity||0)/H.quantity*100;return a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium text-gray-900",children:H.productName}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[a.jsxs("span",{children:["Cantidad: ",H.quantity," | "]}),a.jsxs("span",{children:["Precio: ",V(H.productSalePrice)," c/u | "]}),a.jsxs("span",{children:["Total: ",V(H.totalRevenue)]})]})]}),g.status==="active"&&Z>0&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{onClick:()=>G({item:H,layaway:g}),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors flex items-center space-x-1",children:[a.jsx(ai,{className:"h-4 w-4"}),a.jsx("span",{children:"Recoger"})]}),a.jsxs("button",{onClick:()=>s(H.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors flex items-center space-x-1",title:"Eliminar y devolver al inventario",children:[a.jsx(ea,{className:"h-4 w-4"}),a.jsx("span",{children:"Devolver al inventario"})]})]})]}),a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[a.jsxs("span",{children:["Recogido: ",H.pickedUpQuantity||0," de ",H.quantity]}),a.jsxs("span",{children:[ce.toFixed(0),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${ce}%`}})})]}),H.pickedUpHistory&&H.pickedUpHistory.length>0&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[a.jsx("h6",{className:"text-xs font-medium text-gray-700 mb-2",children:"Historial de Recogidas:"}),a.jsx("div",{className:"space-y-1",children:H.pickedUpHistory.map(fe=>a.jsxs("div",{className:"text-xs text-gray-600 flex justify-between items-center",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("span",{children:[fe.quantity," unidades - ",new Date(fe.date).toLocaleDateString()]}),fe.notes&&a.jsxs("span",{className:"italic ml-2",children:['"',fe.notes,'"']})]}),g.status==="active"&&fe.notes!=="Marcado automticamente como recogido al completar el pago"&&a.jsx("button",{onClick:()=>Ir(H.id,fe.id),className:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 transition-colors ml-2",title:"Revertir recogida",children:a.jsx(ct,{className:"h-3 w-3"})})]},fe.id))})]})]},H.id)})})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Historial de Pagos"}),g.status==="active"&&g.remainingBalance>0&&a.jsxs("button",{onClick:()=>L(!0),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors flex items-center space-x-1",children:[a.jsx(Wt,{className:"h-4 w-4"}),a.jsx("span",{children:"Registrar Pago"})]})]}),g.payments.length===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No se han registrado pagos"}):a.jsx("div",{className:"space-y-2",children:g.payments.map(H=>a.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium",children:V(H.amount)}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("div",{children:new Date(H.paymentDate).toLocaleDateString()}),a.jsx("div",{children:H.paymentMethods&&H.paymentMethods.length>1?(()=>{const Z=H.paymentMethods.map(ce=>`${(()=>{switch(ce.method){case"efectivo":return"Efectivo";case"transferencia":return"Transferencia";case"tarjeta":return"Tarjeta";case"crdito":return"Crdito";case"credit":return"Saldo a favor";default:return ce.method}})()}: ${V(ce.amount)}`);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"font-medium text-purple-700",children:"Pagos mltiples:"}),Z.map((ce,fe)=>a.jsxs("div",{className:"text-xs text-gray-600 ml-2",children:[" ",ce]},fe))]})})():H.paymentMethod==="efectivo"?"Efectivo":H.paymentMethod==="transferencia"?"Transferencia":H.paymentMethod==="tarjeta"?"Tarjeta":"Crdito"})]}),H.notes&&a.jsxs("div",{className:"text-xs text-gray-500 italic",children:['"',H.notes,'"']})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ai,{className:"h-5 w-5 text-green-500"}),g.status==="active"&&a.jsx("button",{onClick:()=>hn(H.id),className:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 transition-colors",title:"Cancelar pago",children:a.jsx(ct,{className:"h-4 w-4"})})]})]},H.id))})]}),g.notes&&a.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Notas"}),a.jsx("p",{className:"text-sm text-gray-700",children:g.notes})]}),g.status==="active"&&a.jsx("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:a.jsx("button",{onClick:()=>Hr(g),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Cancelar Plan Separe"})}),g.status==="cancelled"&&a.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsxs("h4",{className:"font-medium text-red-800 mb-3 flex items-center",children:[a.jsx(is,{className:"h-5 w-5 mr-2"}),"Resumen de Cancelacin"]}),(()=>{const H=g.payments.reduce((_e,Xe)=>_e+Xe.amount,0),Z=g.items.filter(_e=>(_e.pickedUpQuantity||0)>0),ce=g.items.filter(_e=>_e.quantity-(_e.pickedUpQuantity||0)>0),fe=g.items.reduce((_e,Xe)=>{const ot=Xe.pickedUpQuantity||0;return _e+ot*Xe.productSalePrice},0),Ne=Math.min(H,fe),Ve=H-Ne;return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:" Estado de Productos"}),Z.length>0&&a.jsxs("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded",children:[a.jsx("h6",{className:"text-sm font-medium text-green-800 mb-2",children:" Productos Entregados al Cliente"}),a.jsx("div",{className:"space-y-1",children:Z.map(_e=>{const Xe=_e.pickedUpQuantity||0,ot=Xe*_e.productSalePrice;return a.jsxs("div",{className:"text-xs text-green-700",children:[" ",_e.productName,": ",Xe," unidades (",V(ot),")"]},`picked-${_e.id}`)})}),a.jsxs("div",{className:"text-sm font-medium text-green-800 mt-2 pt-2 border-t border-green-200",children:["Total entregado: ",V(fe)]})]}),ce.length>0&&a.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded",children:[a.jsx("h6",{className:"text-sm font-medium text-blue-800 mb-2",children:" Productos Devueltos al Inventario"}),a.jsx("div",{className:"space-y-1",children:ce.map(_e=>{const Xe=_e.quantity-(_e.pickedUpQuantity||0),ot=Xe*_e.productSalePrice;return a.jsxs("div",{className:"text-xs text-blue-700",children:[" ",_e.productName,": ",Xe," unidades (",V(ot),")"]},`returned-${_e.id}`)})})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:" Manejo del Dinero"}),Ne>0&&a.jsxs("div",{className:"mb-4 p-3 bg-emerald-50 border border-emerald-200 rounded",children:[a.jsx("h6",{className:"text-sm font-medium text-emerald-800 mb-2",children:" Ingresos Reales"}),a.jsx("div",{className:"text-lg font-bold text-emerald-700",children:V(Ne)}),a.jsx("div",{className:"text-xs text-emerald-600 mt-1",children:"Dinero por productos entregados"})]}),Ve>0&&a.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded",children:[a.jsx("h6",{className:"text-sm font-medium text-orange-800 mb-2",children:" Requiere Manejo"}),a.jsx("div",{className:"text-lg font-bold text-orange-700",children:V(Ve)}),a.jsx("div",{className:"text-xs text-orange-600 mt-1",children:"Dinero excedente (reembolso/crdito)"})]}),a.jsx("div",{className:"mt-4 p-3 bg-gray-50 border border-gray-200 rounded",children:a.jsxs("div",{className:"text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Total pagado:"}),a.jsx("span",{className:"font-medium",children:V(H)})]}),a.jsxs("div",{className:"flex justify-between text-emerald-600",children:[a.jsx("span",{children:" Ingresos reales:"}),a.jsx("span",{className:"font-medium",children:V(Ne)})]}),a.jsxs("div",{className:"flex justify-between text-orange-600",children:[a.jsx("span",{children:" Requiere manejo:"}),a.jsx("span",{className:"font-medium",children:V(Ve)})]})]})})]})]})})()]})]})})}),E&&g&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Agregar Productos al Plan Separe"}),a.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsx(MG,{products:u,isLoading:b,onClose:()=>k(!1),onAdd:async H=>{v(!0);try{for(const _e of H){const Xe=u.find(ot=>ot.id===_e.productId);if(!Xe||_e.quantity>Xe.stock){f("Stock insuficiente",`Stock insuficiente para ${(Xe==null?void 0:Xe.name)||"producto"}`),v(!1);return}}const Z=H.map(_e=>{const Xe=u.find(It=>It.id===_e.productId),ot=_e.quantity*Xe.purchasePrice,Te=_e.quantity*Xe.salePrice,Fe=Te-ot;return{id:crypto.randomUUID(),productId:Xe.id,productName:Xe.name,productPurchasePrice:Xe.purchasePrice,productSalePrice:Xe.salePrice,quantity:_e.quantity,totalCost:ot,totalRevenue:Te,profit:Fe,pickedUpQuantity:0,pickedUpHistory:[]}}),ce=Z.reduce((_e,Xe)=>_e+Xe.totalRevenue,0),fe=Z.reduce((_e,Xe)=>_e+Xe.totalCost,0),Ne=ce-fe;await kn.addProductsToLayaway(g.id,Z,ce);const Ve={...g,items:[...g.items,...Z],totalAmount:g.totalAmount+ce,totalCost:g.totalCost+fe,expectedProfit:g.expectedProfit+Ne,remainingBalance:g.remainingBalance+ce,updatedAt:new Date().toISOString()};se(Ve),k(!1),h("Productos agregados",`Se agregaron ${Z.length} producto(s) al plan separe por ${V(ce)}`),l(Dh()),l(gi()),setTimeout(()=>Ae(g.id),1e3)}catch{f("Error al agregar productos","No se pudieron agregar los productos. Intntalo de nuevo.")}finally{v(!1)}}})]})})}),W&&g&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Registrar Pago"}),a.jsx("button",{onClick:()=>L(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Saldo pendiente:"}),a.jsx("div",{className:"text-xl font-bold text-blue-600",children:V(g.remainingBalance)})]}),a.jsxs("form",{onSubmit:Sn,className:"space-y-4",children:[(()=>{const H=d.find(Z=>Z.id===g.customerId);return H&&H.credit>0?a.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"useCredit",checked:ie,onChange:Z=>ge(Z.target.checked),disabled:b}),a.jsxs("label",{htmlFor:"useCredit",className:"text-sm text-gray-700",children:["Usar saldo a favor (",V(H.credit),")"]})]}),ie&&a.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Se aplicar automticamente: ",V(Math.min(H.credit,g.remainingBalance))]})]}):null})(),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Mtodo de Pago"}),a.jsxs("label",{className:"flex items-center text-sm",children:[a.jsx("input",{type:"checkbox",checked:Le,onChange:H=>{qe(H.target.checked),H.target.checked||ne([])},disabled:b,className:"mr-2 disabled:opacity-50"}),"Pagos mltiples"]})]}),Le?a.jsxs("div",{className:"space-y-3",children:[De.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Pagos agregados:"}),De.map((H,Z)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-medium",children:H.method==="efectivo"?"Efectivo":H.method==="transferencia"?"Transferencia":H.method==="tarjeta"?"Tarjeta":H.method==="crdito"?"Crdito":H.method}),a.jsx("div",{className:"text-xs text-gray-600",children:V(H.amount)})]}),a.jsx("button",{type:"button",onClick:()=>mt(Z),disabled:b,className:"text-red-600 hover:text-red-800 p-1 disabled:opacity-50",children:a.jsx(ct,{className:"h-4 w-4"})})]},Z)),a.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[a.jsx("span",{children:"Total pagado:"}),a.jsx("span",{className:"font-medium",children:V(pt())})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Restante por pagar:"}),a.jsx("span",{className:`font-medium ${gt()>0?"text-red-600":"text-green-600"}`,children:V(gt())})]})]}),gt()>0&&a.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Agregar pago:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:oe,onChange:H=>Ce(H.target.value),disabled:b,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 text-sm",children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]}),a.jsx("button",{type:"button",onClick:()=>{const H=gt();H>0&&ut(oe,H)},disabled:b||gt()<=0,className:"px-3 py-2 bg-gray-600 text-white text-xs rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Todo"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"text",placeholder:"Monto",disabled:b,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",onChange:H=>{const Z=jt(H.target.value),ce=gt(),fe=Math.min(Z,ce);H.target.value=Yt(fe.toString())},onKeyDown:H=>{if(H.key==="Enter"){const Z=jt(H.currentTarget.value);Z>0&&Z<=gt()&&(ut(oe,Z),H.currentTarget.value="")}}}),a.jsx("button",{type:"button",onClick:H=>{var fe;const Z=(fe=H.currentTarget.parentElement)==null?void 0:fe.querySelector("input"),ce=jt((Z==null?void 0:Z.value)||"0");ce>0&&ce<=gt()&&(ut(oe,ce),Z&&(Z.value=""))},disabled:b,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar"})]})]})]})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto del Pago (COP) *"}),a.jsx("input",{type:"text",value:K,onChange:ke,placeholder:"0",required:!0,disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Saldo pendiente: ",V(g.remainingBalance)]})]}),a.jsx("div",{children:a.jsxs("select",{name:"paymentMethod",disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas (Opcional)"}),a.jsx("textarea",{name:"notes",rows:3,disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"Notas sobre el pago..."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>L(!1),disabled:b,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:b||!Le&&jt(K)<=0||Le&&(De.length===0||gt()>.01),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[b&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:b?"Registrando...":"Registrar Pago"})]})]})]})]})})}),X&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Marcar como Recogido"}),a.jsx("button",{onClick:()=>G(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"font-medium",children:X.item.productName}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Disponible para recoger: ",X.item.quantity-(X.item.pickedUpQuantity||0)," de ",X.item.quantity]})]}),a.jsxs("form",{onSubmit:Ar,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad a Recoger *"}),a.jsx("input",{type:"number",name:"quantity",min:"1",max:X.item.quantity-(X.item.pickedUpQuantity||0),defaultValue:"1",required:!0,disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas (Opcional)"}),a.jsx("textarea",{name:"notes",rows:3,disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"Notas sobre la recogida..."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>G(null),disabled:b,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:b,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[b&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:b?"Marcando...":"Marcar como Recogido"})]})]})]})]})})}),We.length===0&&a.jsxs("div",{className:"bg-white rounded-xl p-12 text-center shadow-sm border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(Xn,{className:"h-12 w-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron planes separe"}),a.jsx("p",{className:"text-gray-500",children:T||i!=="active"?"Intenta ajustar tus criterios de bsqueda.":"Comienza creando tu primer plan separe."})]})]})]})}const Ya=rl("technicalServices/fetchTechnicalServices",async(t,{dispatch:e})=>{try{e(Ou(!0));const r=await Fr.getAll();e(Wh(r))}catch(r){e(l0(r.message||"Error al cargar servicios tcnicos"))}finally{e(Ou(!1))}}),LG=rl("technicalServices/fetchTechnicalServicesByStatus",async(t,{dispatch:e})=>{try{e(Ou(!0));let r;t==="all"?r=await Fr.getAll():r=await Fr.getByStatus(t),e(Wh(r))}catch(r){e(l0(r.message||"Error al cargar servicios tcnicos"))}finally{e(Ou(!1))}});function VG(){var rr,ml,uo,ho;const[t,e]=I.useState(0),[r,n]=I.useState(!1);I.useEffect(()=>{async function $(){try{const{salesService:J}=await gn(async()=>{const{salesService:Ee}=await Promise.resolve().then(()=>Oa);return{salesService:Ee}},void 0),we=(await J.getAll()).reduce((Ee,Be)=>Array.isArray(Be.paymentMethods)?Ee+Be.paymentMethods.filter($e=>$e.method==="credit").reduce(($e,Je)=>$e+Je.amount,0):Ee,0);e(we),n(!0)}catch{e(0),n(!0)}}$()},[]),I.useEffect(()=>{const $=async()=>{try{const le=yt(Pe,"users"),Ee=(await Kt(le)).docs.map(Be=>({...Be.data(),uid:Be.data().uid||Be.id}));We(Ee)}catch(le){console.error("Error loading users:",le)}},J=async()=>{try{const le=yt(Pe,Ke.TECHNICIANS),Ee=(await Kt(le)).docs.map(Be=>({id:Be.id,...Be.data()}));it(Ee)}catch(le){console.error("Error loading technicians:",le)}};$(),J()},[]);const s=Hm();wc();const[i,o]=I.useState("active");I.useEffect(()=>{(async()=>{try{if(i==="all"){const J=await Fr.getAll();s(Ya.fulfilled(J,"",void 0))}else{const J=await Fr.getByStatus(i);s(Ya.fulfilled(J,"",void 0))}}catch(J){console.error("Error loading technical services:",J)}})()},[i,s]);const l=Xt(WM);Xt(ro);const c=Xt(kd),{showSuccess:u,showError:d,showConfirm:h}=hi(),{appUser:f}=ma(),[m,y]=I.useState(null),[g,x]=I.useState(!1),[b,v]=I.useState(null),[j,S]=I.useState({phone:"",address:""}),[_,C]=I.useState([]),[N,w]=I.useState(0),[E,k]=I.useState(!1),[T,P]=I.useState([]),[O,D]=I.useState(!1),[R,B]=I.useState(null),[Y,W]=I.useState(null),[L,X]=I.useState(""),[G,K]=I.useState(""),[q,ie]=I.useState(null),[ge,be]=I.useState(""),Ye=()=>{v(null),S({phone:"",address:""}),C([]),w(0),Sn("0"),Hr([]),hn(!1),me(!1),P([]),ut.current&&ut.current.reset()},[ze,U]=I.useState(!1),[Q,re]=I.useState(!1),[te,pe]=I.useState(null),[xe,he]=I.useState(null),[Le,qe]=I.useState(!1),[De,ne]=I.useState({deviceImei:"",deviceBrandModel:"",devicePassword:"",physicalCondition:"",reportedIssue:"",laborCost:0,serviceCost:0,notes:"",technicianId:""}),[oe,Ce]=I.useState(""),[ke,ue]=I.useState("all"),[se,We]=I.useState([]),[Ae,it]=I.useState([]),ut=I.useRef(null),[mt,pt]=I.useState(!1),[gt,lr]=I.useState(null),[dn,qr]=I.useState(""),[Tr,Wa]=I.useState(!1),[_n,Sn]=I.useState(""),[Ar,hn]=I.useState(!1),[Ir,Hr]=I.useState([]),[kr,F]=I.useState("efectivo"),[ae,me]=I.useState(!1),[Se,Oe]=I.useState(!1),[H,Z]=I.useState([]),[ce,fe]=I.useState("efectivo"),Ne=$=>{const J=$.target.value,le=jt(J);isNaN(le)?J===""&&qr(""):m&&le>vr(m).remainingBalance?qr(Yt(vr(m).remainingBalance)):qr(Yt(le))},Ve=$=>{const J=$.target.value,le=jt(J);isNaN(le)?J===""&&Sn(""):Sn(Yt(le))};I.useEffect(()=>{mt||(qr(""),Z([]),Oe(!1),Wa(!1))},[mt]),ee.useEffect(()=>{E||(Sn(""),Hr([]),hn(!1),me(!1))},[E]),I.useEffect(()=>{s(i==="all"?Ya():LG(i))},[s,i]),I.useEffect(()=>{if(m){const $=l.find(J=>J.id===m.id);$&&y($)}},[l,m==null?void 0:m.id]);const _e=$=>{m&&m.id===$.id&&y($)};ee.useEffect(()=>{m&&(ne({deviceImei:m.deviceImei||"",deviceBrandModel:m.deviceBrandModel||"",devicePassword:m.devicePassword||"",physicalCondition:m.physicalCondition||"",reportedIssue:m.reportedIssue||"",laborCost:m.laborCost||0,serviceCost:m.serviceCost||0,notes:m.notes||"",technicianId:m.technicianId||""}),qe(!1))},[m]);const Xe=()=>{D(!0)},ot=()=>{D(!1)},Te=$=>{P([...T,$])},Fe=$=>{const J=T.filter((le,we)=>we!==$);P(J)},It=I.useCallback($=>{v($),S({phone:($==null?void 0:$.phone)||"",address:($==null?void 0:$.address)||""})},[]),xt=$=>{const J=[],{remainingBalance:le}=vr($);le>.01?J.push(`Falta pagar ${V(le)}`):le<-.01&&J.push(`Sobrepago de ${V(Math.abs(le))} - requiere reajuste`);const we=$.items.filter(Ee=>Ee.status!=="instalado");return we.length>0&&J.push(`${we.length} repuesto${we.length>1?"s":""} sin instalar`),J},Dt=$=>xt($).length===0,Ge=async()=>{if(m){if(!Dt(m)){d("No se puede finalizar","El servicio debe estar pagado completamente y todos los repuestos deben estar instalados.");return}if(!(!m.technicianId&&!window.confirm(` Este servicio no tiene tcnico asignado.

Sin tcnico asignado, este servicio no aparecer en la liquidacin de tcnicos.

Deseas continuar y finalizar el servicio sin tcnico asignado?`)))try{x(!0),await Fr.update(m.id,{status:"completed",completedAt:Qe(),updatedAt:Qe(),completedBy:f==null?void 0:f.uid,completedByName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),statusChangedBy:f==null?void 0:f.uid,statusChangedByName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),statusChangedAt:Qe()});const $={...m,status:"completed",completedAt:Qe(),completedBy:f==null?void 0:f.uid,completedByName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),statusChangedBy:f==null?void 0:f.uid,statusChangedByName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),statusChangedAt:Qe()};_e($),m.technicianId?u("Servicio finalizado",`El servicio tcnico para ${m.customerName} se ha completado exitosamente y aparecer en la liquidacin de tcnicos.`):u("Servicio finalizado",`El servicio tcnico para ${m.customerName} se ha completado exitosamente (sin tcnico asignado).`),y(null),s(Ya())}catch($){console.error("Error completing service:",$),d("Error","No se pudo finalizar el servicio tcnico")}finally{x(!1)}}},nt=($,J)=>{if(!m)return;const le=m.items.find(we=>we.id===$);le&&(pe({id:$,name:J,item:le}),re(!0))},Lt=$=>{if(!$)return;const{remainingBalance:J}=vr($),le=Math.abs(J);le<=.01||(pe({id:"adjustment",name:"Reajuste de Sobrepago",item:{id:"adjustment",partName:"Reajuste de Sobrepago",quantity:1,partCost:le,totalCost:le,status:"instalado"}}),re(!0))},Ut=async()=>{if(!(!m||!te))try{if(x(!0),te.id==="adjustment"){const{remainingBalance:Je}=vr(m),at=Math.abs(Je);if(xe==="credit"){const st=c.find(Tt=>Tt.id===m.customerId);if(st){const{customersService:Tt}=await gn(async()=>{const{customersService:nr}=await Promise.resolve().then(()=>Oa);return{customersService:nr}},void 0);await Tt.update(st.id,{credit:(st.credit||0)+at,updatedAt:Qe()}),u("Saldo agregado",`Se agreg ${V(at)} al saldo a favor de ${st.name}`)}}else if(xe==="refund"){const st={id:crypto.randomUUID(),amount:-at,paymentDate:Qe(),paymentMethod:"efectivo",notes:"Reembolso por sobrepago en servicio tcnico"},Tt={...m,payments:[...m.payments,st],updatedAt:Qe()};await Fr.update(m.id,Tt),_e(Tt),y(Tt),u("Reembolso registrado",`Se registr un reembolso de ${V(at)} para el cliente`)}re(!1),pe(null),he(null),x(!1);return}const $=m.items.reduce((Je,at)=>Je+at.totalCost,0)+(m.laborCost||0),J=m.payments.reduce((Je,at)=>Je+at.amount,0),le=te.item.totalCost,we=$-le,Ee=J-we,Be=m.items.filter(Je=>Je.id!==te.id);let $e={...m,items:Be,totalAmount:m.totalAmount-le,totalCost:m.totalCost-le,remainingBalance:m.remainingBalance-le,updatedAt:Qe()};if(Ee>.01){if(xe==="credit"){const Je=c.find(at=>at.id===m.customerId);if(Je){const{customersService:at}=await gn(async()=>{const{customersService:st}=await Promise.resolve().then(()=>Oa);return{customersService:st}},void 0);await at.update(Je.id,{credit:(Je.credit||0)+Ee,updatedAt:Qe()}),u("Saldo agregado",`Se agreg ${V(Ee)} al saldo a favor de ${Je.name}`)}}else if(xe==="refund"){const Je={id:crypto.randomUUID(),amount:-Ee,paymentDate:Qe(),paymentMethod:"efectivo",notes:`Reembolso por eliminacin de repuesto: ${te.name}`};$e={...$e,payments:[...m.payments,Je]},u("Reembolso registrado",`Se registr un reembolso de ${V(Ee)} para el cliente`)}}await Fr.update(m.id,$e),_e($e),y($e),u("Repuesto eliminado",`Se elimin "${te.name}" por ${V(le)}`),s(Ya()),re(!1),pe(null),he(null)}catch($){console.error("Error deleting part:",$),d("Error","No se pudo eliminar el repuesto. Intntalo de nuevo.")}finally{x(!1)}},Or=async($,J)=>{if(m)try{const le=m.items.map(Ee=>{if(Ee.id===$){const Be={...Ee,status:J};return J==="instalado"&&Ee.status!=="instalado"&&(Be.installedAt=Qe()),Be.statusChangedBy=f==null?void 0:f.uid,Be.statusChangedByName=(f==null?void 0:f.displayName)||(f==null?void 0:f.email),Be.statusChangedAt=Qe(),Be}return Ee});await Fr.update(m.id,{items:le,updatedAt:Qe()});const we={...m,items:le};_e(we),u("Estado actualizado",`El repuesto ahora est en estado: ${J==="solicitado"?"Solicitado":J==="en_tienda"?"En tienda":"Instalado"}`)}catch(le){console.error("Error updating item status:",le),d("Error","No se pudo actualizar el estado del repuesto")}},io=async($,J)=>{if(b)try{await Mn.update(b.id,{phone:$,address:J,updatedAt:Qe()}),v({...b,phone:$,address:J})}catch(le){console.error("Error updating customer info:",le)}},oo=async()=>{if(m){x(!0);try{const $={deviceImei:De.deviceImei,deviceBrandModel:De.deviceBrandModel,devicePassword:De.devicePassword,physicalCondition:De.physicalCondition,reportedIssue:De.reportedIssue,laborCost:De.laborCost,serviceCost:De.serviceCost,notes:De.notes,technicianId:De.technicianId,customerPhone:j.phone,customerAddress:j.address,updatedAt:Qe()};await Fr.update(m.id,$);const J=c.find(we=>we.id===m.customerId);J&&(J.phone!==j.phone||J.address!==j.address)&&await io(j.phone,j.address);const le={...m,...$};_e(le),s(Ya()),qe(!1),u("Informacin actualizada","Los datos del servicio tcnico han sido actualizados correctamente.")}catch($){console.error("Error updating technical service details:",$),d("Error al actualizar","No se pudieron actualizar los datos. Intntalo de nuevo.")}finally{x(!1)}}},ul=I.useMemo(()=>l.filter($=>{var Be,$e;if(i!=="all"&&$.status!==i||ke!=="all"&&$.salesPersonId!==ke)return!1;const J=oe.trim().toLowerCase();if(!J)return!0;const le=$.id.toLowerCase().includes(J),we=(Be=$.customerName)==null?void 0:Be.toLowerCase().includes(J),Ee=($e=$.items)==null?void 0:$e.some(Je=>{var at;return(at=Je.partName)==null?void 0:at.toLowerCase().includes(J)});return le||we||Ee}),[l,i,ke,oe]),lo=async $=>{try{const le=(await Fr.getAll()).find(we=>we.id===$);le&&_e(le)}catch{}},dl=($,J)=>{switch($){case"card":return J*.0299+300;case"sistecredito":return J*.02;case"addi":const le=J*.065,we=le*.19;return le+we;case"cash":default:return 0}},hl=($,J)=>{if(J<=0)return;const le=dl($,J),we={method:$,amount:J,commission:le};Z(Ee=>[...Ee,we])},fl=$=>{Z(J=>J.filter((le,we)=>we!==$))},bs=()=>{let $=H.reduce((J,le)=>J+le.amount,0);if(b&&Tr&&b.credit>0&&m){const J=Math.min(b.credit,vr(m).remainingBalance-$);$+=Math.max(0,J)}return $},Pa=()=>m?Math.max(0,vr(m).remainingBalance-bs()):0,Gd=($,J)=>{if(J<=0)return;const le=dl($,J),we={method:$,amount:J,commission:le};Hr(Ee=>[...Ee,we])},ep=$=>{Hr(J=>J.filter((le,we)=>we!==$))},Cc=()=>{let $=Ir.reduce((J,le)=>J+le.amount,0);if(b&&ae&&b.credit>0){const J=Math.min(b.credit,N-$);$+=Math.max(0,J)}return $},qs=()=>Math.max(0,N-Cc()),Ec=async($,J,le,we,Ee="")=>{var Et;const Be=le.find(et=>et.method!=="credit"),$e=(Be==null?void 0:Be.method)||"efectivo",Je={id:crypto.randomUUID(),amount:J,paymentDate:Qe(),paymentMethod:$e,paymentMethods:le,notes:we>0?Ee?`${Ee} (us ${V(we)} de saldo a favor)`:`Us ${V(we)} de saldo a favor`:Ee,registeredBy:f==null?void 0:f.uid,registeredByName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),registeredAt:Qe()},at=$.remainingBalance-J,st=$.status,Tt=[...$.payments,Je],nr={payments:Tt.map(et=>({...et,paymentMethod:["efectivo","transferencia","tarjeta","crdito"].includes(et.paymentMethod)?et.paymentMethod:"efectivo"})),remainingBalance:at,status:st};await Fr.update($.id,nr);try{const{salesService:et}=await gn(async()=>{const{salesService:pa}=await Promise.resolve().then(()=>Oa);return{salesService:pa}},void 0),Wr=((Et=$.items)==null?void 0:Et.reduce((pa,ws)=>pa+ws.partCost*ws.quantity,0))||0,ar=$.laborCost||0,_r=$.total||Wr+ar,kt=(_r>0?ar/_r:0)*.5,ta=J*kt,Qr=J-ta,Qa=J>0?ta/J*100:0,ra={items:[],subtotal:J,discount:0,tax:0,total:J,finalTotal:J,totalCost:Qr,totalRevenue:J,totalProfit:ta,profitMargin:Qa,paymentMethod:$e,paymentMethods:le.map(pa=>({method:pa.method,amount:pa.amount,commission:pa.commission||0})),useMultiplePayments:le.length>1,totalCommissions:le.reduce((pa,ws)=>pa+(ws.commission||0),0),customerName:$.customerName,customerId:$.customerId,salesPersonId:f==null?void 0:f.uid,salesPersonName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),technicalServiceId:$.id,type:"technical_service_payment",notes:` Pago servicio tcnico: ${$.deviceBrandModel||"Dispositivo"} - Cliente: ${$.customerName}${Ee?` - ${Ee}`:""}`,technicalServiceDetails:{...$.deviceBrandModel&&{deviceBrandModel:$.deviceBrandModel},...$.deviceImei&&{deviceImei:$.deviceImei},...$.reportedIssue&&{reportedIssue:$.reportedIssue},...$.technicianName&&{technicianName:$.technicianName},...$.status&&{status:$.status},...$.total!==void 0&&{total:$.total},...$.remainingBalance!==void 0&&{remainingBalance:$.remainingBalance-J},...$.estimatedCompletionDate&&{estimatedCompletionDate:$.estimatedCompletionDate}},createdAt:Qe(),updatedAt:Qe()};await et.add(ra),console.log("Abono de servicio tcnico registrado como venta:",ra)}catch(et){console.error("Error registrando abono como venta:",et)}return{updatedTechnicalService:{...$,payments:Tt.map(et=>({...et,paymentMethod:["efectivo","transferencia","tarjeta","crdito"].includes(et.paymentMethod)?et.paymentMethod:"efectivo"})),remainingBalance:at,status:st,updatedAt:Qe()},newStatus:st,creditUsed:we}},Kd=async $=>{var J;$.preventDefault(),x(!0);try{const le=new FormData($.currentTarget),we=le.get("notes")||"",Ee=le.get("deviceImei")||"",Be=le.get("deviceBrandModel")||"",$e=le.get("devicePassword")||"",Je=le.get("physicalCondition")||"",at=le.get("reportedIssue")||"",st=le.get("serviceCost")||"0",Tt=jt(st),nr=le.get("assignedTechnician")||"",Et=nr&&((J=Ae.find(Mt=>Mt.id===nr))==null?void 0:J.name)||"",et=b;if(!et){d("Error de validacin","Debes seleccionar un cliente"),x(!1);return}const Wr=!nr,ar=_.length===0;if(Wr||ar){const Mt=[];if(Wr&&Mt.push("tcnico asignado"),ar&&Mt.push("repuestos"),!await new Promise(Dr=>{h("Confirmar creacin de servicio tcnico",`No has seleccionado ${Mt.join(" ni ")}. Ests seguro de que quieres continuar con la creacin del servicio tcnico?`,()=>Dr(!0),()=>Dr(!1))})){x(!1);return}}let _r,fr=[],kt=0;if(Ar){if(Ir.length===0){d("Error de validacin","Debes agregar al menos un mtodo de pago"),x(!1);return}if(_r=Cc(),fr=[...Ir.map(Mt=>({method:Mt.method,amount:Mt.amount,commission:Mt.commission}))],ae&&et&&et.credit>0){const Cr=_.reduce((na,Cn)=>na+Cn.partCost*Cn.quantity,0)+(ra||0),Dr=Math.min(et.credit,Cr-Ir.reduce((na,Cn)=>na+Cn.amount,0));Dr>0&&(kt=Dr,fr.push({method:"credit",amount:kt}),_r+=kt)}}else{const Mt=jt(_n)||0;if(ae&&et&&et.credit>0){const Dr=_.reduce((na,Cn)=>{const sp=Cn.partCost*Cn.quantity;return na+sp},0)+(ra||0);Mt>0,kt=Math.min(et.credit,Dr)}if(_r=Mt+kt,_r>0&&(kt>0&&fr.push({method:"credit",amount:kt}),Mt>0)){const Cr=dl(kr,Mt);fr.push({method:kr,amount:Mt,commission:Cr})}}const ta=[];let Qr=0,Qa=0;for(let Mt=0;Mt<_.length;Mt++){const Cr=_[Mt];if(Cr.quantity<=0||Cr.partCost<0){d("Error de validacin",`Cantidad y costo deben ser mayores a 0 para ${Cr.partName}`),x(!1);return}const Dr=Cr.quantity*Cr.partCost,na={id:crypto.randomUUID(),partName:Cr.partName,quantity:Cr.quantity,partCost:Cr.partCost,totalCost:Dr,status:"solicitado"};Cr.partDescription&&(na.partDescription=Cr.partDescription),ta.push(na),Qr+=Dr,Qa+=Dr}const ra=Math.max(0,Tt-Qa),pa=ra*.5,ws=ra*.5;Qr=Tt;const Sr=ws+(Qr-Qa-ra);if(_r>Qr){d("Error de validacin","El pago inicial no puede ser mayor al total"),x(!1);return}const rn={items:ta,totalAmount:Qr,totalCost:Qa,expectedProfit:Sr,customerId:et.id,customerName:et.name,downPayment:0,remainingBalance:Qr,payments:[],status:"active",serviceCost:Tt,laborCost:ra,technicianShare:pa,businessShare:ws};if(et.phone&&(rn.customerPhone=et.phone),et.address&&(rn.customerAddress=et.address),f!=null&&f.uid&&(rn.salesPersonId=f.uid),(f!=null&&f.displayName||f!=null&&f.email)&&(rn.salesPersonName=(f==null?void 0:f.displayName)||(f==null?void 0:f.email)),Ee&&(rn.deviceImei=Ee),Be&&(rn.deviceBrandModel=Be),$e&&(rn.devicePassword=$e),Je&&(rn.physicalCondition=Je),at&&(rn.reportedIssue=at),we&&(rn.notes=we),nr&&(rn.technicianId=nr),Et&&(rn.technicianName=Et),T.length>0){rn.courtesyItems=T;const Mt=T.reduce((Dr,na)=>Dr+na.totalValue,0),Cr=T.reduce((Dr,na)=>Dr+na.totalCost,0);rn.courtesyTotalValue=Mt,rn.courtesyTotalCost=Cr}const Pc=await Fr.add(rn);console.log("Technical service created with ID:",Pc),await s(Ya());const Xd={id:Pc,...rn,createdAt:Qe(),updatedAt:Qe()};if(_r>0&&(kt>0&&et&&await Mn.update(et.id,{credit:et.credit-kt}),await Ec(Xd,_r,fr,kt,"Pago inicial")),T.length>0){const Mt=T.map(async Cr=>{const Dr={saleId:Pc,customerId:et.id,customerName:et.name,salesPersonId:(f==null?void 0:f.uid)||"",salesPersonName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email)||"",item:Cr,reason:Cr.reason};return Nx.add(Dr)});await Promise.all(Mt)}if(j.phone||j.address){const Mt={updatedAt:Qe()};j.phone&&j.phone!==et.phone&&(Mt.phone=j.phone),j.address&&j.address!==et.address&&(Mt.address=j.address),Object.keys(Mt).length>1&&await Mn.update(et.id,Mt)}Ye(),k(!1),u("Servicio tcnico creado",`Servicio tcnico para ${et.name} creado exitosamente por ${V(Qr)}${_r>0?`. Pago inicial de ${V(_r)} registrado${kt>0?` (incluye ${V(kt)} de saldo a favor)`:""}.`:""}`),s(Dh()),s(Ya()),setTimeout(async()=>{try{const Mt=await Fr.getById(Pc);B(Mt)}catch(Mt){console.error("Error fetching service for print:",Mt),B(Xd)}},500)}catch(le){console.error("Error creating technical service:",le),d("Error al crear servicio tcnico","No se pudo crear el servicio tcnico. Intntalo de nuevo.")}finally{x(!1)}},tp=async $=>{if($.preventDefault(),!!m){x(!0);try{const J=new FormData($.currentTarget),le=J.get("notes")||"",we=c.find(at=>at.id===m.customerId);let Ee,Be=[],$e=0;if(Se){if(H.length===0){d("Error de validacin","Debes agregar al menos un mtodo de pago"),x(!1);return}if(Ee=bs(),Be=[...H.map(at=>({method:at.method,amount:at.amount,commission:at.commission}))],Tr&&we&&we.credit>0){const at=Math.min(we.credit,vr(m).remainingBalance-H.reduce((st,Tt)=>st+Tt.amount,0));at>0&&($e=at,Be.push({method:"credit",amount:$e}),Ee+=$e)}if(Math.abs(Ee-vr(m).remainingBalance)>.01){d("Pago incompleto",`El total de los pagos (${V(Ee)}) no coincide con el saldo pendiente (${V(vr(m).remainingBalance)})`),x(!1);return}}else{const at=jt(dn),st=J.get("paymentMethod");if(Tr&&we&&we.credit>0&&($e=Math.min(we.credit,vr(m).remainingBalance)),Ee=at+$e,Ee<=0||Ee>vr(m).remainingBalance){d("Error de validacin","El monto del pago no es vlido"),x(!1);return}if($e>0&&Be.push({method:"credit",amount:$e}),at>0){const Tt=dl(st,at);Be.push({method:st,amount:at,commission:Tt})}}$e>0&&we&&await Mn.update(we.id,{credit:we.credit-$e});const Je=await Ec(m,Ee,Be,$e,le);_e(Je.updatedTechnicalService),pt(!1),u("Pago registrado",`Pago de ${V(Ee)} registrado exitosamente. ${$e>0?`Se us ${V($e)} de saldo a favor. `:""}${Je.newStatus==="completed"?"Plan separe completado! Todos los productos han sido marcados como recogidos automticamente.":`Saldo pendiente: ${V(Je.updatedTechnicalService.remainingBalance)}`}`),setTimeout(()=>lo(m.id),1e3),s(Ya())}catch(J){console.error("Error adding payment:",J),d("Error al registrar pago","No se pudo registrar el pago. Intntalo de nuevo.")}finally{x(!1)}}},rp=async $=>{if($.preventDefault(),!gt)return;const{item:J,technicalService:le}=gt;x(!0);try{const we=new FormData($.currentTarget),Ee=parseInt(we.get("quantity")),Be=we.get("notes")||"",$e=J.quantity-(J.pickedUpQuantity||0);if(Ee<=0||Ee>$e){d("Error de validacin",`Solo puedes recoger entre 1 y ${sr($e)} unidades`),x(!1);return}await Fr.update(le.id,{items:le.items.map(st=>{if(st.id===J.id){const Tt={id:crypto.randomUUID(),quantity:Ee,date:Qe(),notes:Be};return{...st,pickedUpQuantity:(st.pickedUpQuantity||0)+Ee,pickedUpHistory:[...st.pickedUpHistory||[],Tt]}}return st})});try{const{salesService:st}=await gn(async()=>{const{salesService:ar}=await Promise.resolve().then(()=>Oa);return{salesService:ar}},void 0),Tt=Ee*J.productSalePrice,nr=Ee*J.productPurchasePrice,Et=Tt-nr,et=Tt>0?Et/Tt*100:0,Wr={items:[{productId:J.productId,productName:J.productName,quantity:Ee,purchasePrice:J.productPurchasePrice,salePrice:J.productSalePrice,totalCost:nr,totalRevenue:0,profit:Et}],subtotal:0,discount:0,tax:0,total:0,totalCost:nr,totalProfit:Et,profitMargin:et,paymentMethod:"efectivo",paymentMethods:[{method:"efectivo",amount:0}],customerName:le.customerName,customerId:le.customerId,isLayaway:!0,layawayId:le.id,type:"layaway_delivery",notes:` Entrega servicio tcnico: ${Ee} x ${J.productName} (Valor: ${V(Tt)}) - Ganancia registrada${Be?` - ${Be}`:""}`};await st.add(Wr)}catch(st){console.error("Error registrando venta de entrega:",st)}const Je=le.items.map(st=>{if(st.id===J.id){const Tt={id:crypto.randomUUID(),quantity:Ee,date:Qe(),notes:Be};return{...st,pickedUpQuantity:(st.pickedUpQuantity||0)+Ee,pickedUpHistory:[...st.pickedUpHistory||[],Tt]}}return st}),at={...le,items:Je,updatedAt:Qe()};_e(at),lr(null),u("Productos recogidos",`Se marcaron ${Ee} unidades de "${J.productName}" como recogidas`),setTimeout(()=>lo(le.id),1e3)}catch(we){console.error("Error marking as picked up:",we),d("Error al marcar como recogido","No se pudo actualizar el estado. Intntalo de nuevo.")}finally{x(!1)}},xv=async $=>{if(!m)return;const J=m.payments.find(le=>le.id===$);J&&h("Confirmar cancelacin de pago",`Ests seguro de que quieres cancelar el pago de ${V(J.amount)}? El saldo pendiente se actualizar automticamente y el abono ser eliminado del historial de ventas.`,async()=>{x(!0);try{const le=m.payments.filter(st=>st.id!==$),we=le.reduce((st,Tt)=>st+Tt.amount,0),Ee=m.totalAmount-we;let Be=m.status,$e=m.items;m.status==="completed"&&Ee>0&&(Be="active",$e=m.items.map(st=>{var Et;const Tt=((Et=st.pickedUpHistory)==null?void 0:Et.filter(et=>et.notes!=="Marcado automticamente como recogido al completar el pago"))||[],nr=Tt.reduce((et,Wr)=>et+Wr.quantity,0);return{...st,pickedUpQuantity:nr,pickedUpHistory:Tt}}));const Je={payments:le,remainingBalance:Ee,status:Be};Be==="active"&&m.status==="completed"&&(Je.items=$e),await Fr.update(m.id,Je);try{const{salesService:st}=await gn(async()=>{const{salesService:Et}=await Promise.resolve().then(()=>Oa);return{salesService:Et}},void 0),nr=(await st.getAll()).find(Et=>Et.type==="technical_service_payment"&&Et.technicalServiceId===m.id&&Et.total===J.amount);nr?(await st.delete(nr.id),console.log("Venta de abono de servicio tcnico eliminada:",nr.id)):console.warn("No se encontr la venta correspondiente al abono cancelado")}catch(st){console.error("Error eliminando abono en ventas:",st)}const at={...m,payments:le,remainingBalance:Ee,status:Be,items:$e,updatedAt:Qe()};_e(at),u("Pago cancelado",`El pago de ${V(J.amount)} ha sido cancelado y el abono eliminado del historial de ventas. ${Be==="active"&&m.status==="completed"?"El servicio tcnico ha vuelto a estado activo y se han revertido las recogidas automticas.":`Nuevo saldo pendiente: ${V(Ee)}`}`),setTimeout(()=>lo(m.id),1e3),s(Ya())}catch(le){console.error("Error cancelling payment:",le),d("Error al cancelar pago","No se pudo cancelar el pago. Intntalo de nuevo.")}finally{x(!1)}})},np=async $=>{$.payments.reduce((le,we)=>le+we.amount,0)>0?(W($),X(""),K("")):(ie($),be(""))},Qd=async($,J,le)=>{x(!0);try{await Fr.update($.id,{status:"cancelled",updatedAt:Qe(),cancelledBy:f==null?void 0:f.uid,cancelledByName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),statusChangedBy:f==null?void 0:f.uid,statusChangedByName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),statusChangedAt:Qe()}),J>0&&console.log(` Egreso por devolucin de cancelacin: ${V(J)}`),le>0&&console.log(` Penalizacin aplicada: ${V(le)} (dinero retenido del pago original)`);let we=`El servicio tcnico de ${$.customerName} se cancel correctamente.`;J>0&&(we+=` Se devolvieron ${V(J)} al cliente.`),le>0&&(we+=` Se cobraron ${V(le)} como penalizacin.`),u("Servicio tcnico cancelado",we),s(Ya()),W(null)}catch(we){console.error("Error cancelling technical service:",we),d("Error al cancelar servicio tcnico","No se pudo cancelar el servicio tcnico. Intntalo de nuevo.")}finally{x(!1)}},Yd=$=>{var Je;const J=c.find(at=>at.id===$.customerId),le=((Je=$.payments)==null?void 0:Je.reduce((at,st)=>at+st.amount,0))||0,we=$.items.reduce((at,st)=>at+st.totalCost,0)+($.laborCost||0),Ee=we-le,Be=`
      <html>
        <head>
          <title>Remisin</title>
          <style>
            @media print {
              @page { margin: 0 !important; size: 75mm auto !important; }
              * { margin: 0 !important; padding: 0 !important; box-sizing: border-box !important; }
              html, body {
                width: 75mm !important;
                min-width: 75mm !important;
                max-width: 75mm !important;
                margin: 0 !important;
                padding: 0 !important;
                background: #fff !important;
              }
              body, .remision-recibo {
                font-family: monospace, Arial, sans-serif !important;
                font-size: 14px !important;
                width: 75mm !important;
                margin: 0 !important;
                padding: 0 !important;
              }
              .remision-recibo {
                width: 75mm !important;
                margin: 0 !important;
                padding: 0 6mm 0 12mm !important;
              }
              .business-name {
                font-size: 24px !important;
                font-weight: bold !important;
                font-style: italic !important;
                letter-spacing: -1px !important;
                text-align: center !important;
                margin: 0 auto !important;
                display: block !important;
                color: #000 !important;
              }
              .header { text-align: center !important; }
              .business-info { text-align: center !important; font-size: 10px !important; line-height: 1.2 !important; margin-bottom: 1px !important; }
              .center { text-align: center !important; }
              .section { text-align: left !important; }
              .service-info { text-align: left !important; display: flex !important; justify-content: space-between !important; font-size: 10px !important; margin: 2mm 0 !important; }
              .financial-section { text-align: left !important; }
              .payment-info { text-align: left !important; display: flex !important; justify-content: space-between !important; margin: 2mm 0 !important; }
              .total { text-align: center !important; }
              .footer { text-align: center !important; }
              .flex-between { display: flex !important; justify-content: space-between !important; font-size: 11px !important; }
              h2 { text-align: center !important; font-size: 16px !important; margin: 8px 0 !important; font-weight: bold !important; }
            }
            body { width: 75mm; margin: 0; font-family: monospace, Arial, sans-serif; font-size: 14px; }
            .header { text-align: center; margin-bottom: 4mm; }
            .business-name { 
              font-size: 24px; 
              font-weight: bold; 
              font-style: italic; 
              letter-spacing: -1px; 
              text-align: center; 
              margin: 0 auto 8px auto; 
              display: block; 
              color: #000; 
            }
            .business-info { font-size: 10px; line-height: 1.2; text-align: center; margin-bottom: 1px; }
            .separator { border-top: 1px dashed #000; margin: 3mm 0; }
            .section { margin: 3mm 0; }
            .label { font-weight: 600; font-size: 10px; }
            .service-info { margin: 2mm 0; font-size: 10px; display: flex; justify-content: space-between; }
            .device-info { margin: 2mm 0; }
            .financial-section { margin: 4mm 0; padding: 2mm 0; }
            .total { font-weight: bold; font-size: 14px; margin: 2mm 0; text-align: center; }
            .payment-info { font-size: 13px; margin: 2mm 0; display: flex; justify-content: space-between; }
            .flex-between { display: flex; justify-content: space-between; font-size: 11px; }
            .footer { text-align: center; font-size: 11px; margin-top: 4mm; font-style: italic; }
            .center { text-align: center; }
            .remision-recibo { width: 75mm; margin: 0; padding: 0 6mm 0 12mm; }
            h2 { text-align: center; font-size: 16px; margin: 8px 0; font-weight: bold; }
          </style>
        </head>
        <body>
          <div class="remision-recibo">
          <div class="header">
            <div class="business-name">CELU MARIA</div>
            <div class="business-info">
              Reparacin de Dispositivos Mviles<br>
              Carrera 45 # 71a-17<br>
              Celular +57 3043884525<br>
              Instagram @celu.maria
            </div>
          </div>
          
          <div class="separator"></div>
          
          <h2 class="center" style="font-size: 16px; margin: 8px 0; font-weight: bold;">Remisin Cliente</h2>
          <div class="center" style="font-size: 15px; margin-bottom: 8px;">Fecha de impresin: ${new Date().toLocaleString()}</div>
          
          <div class="separator"></div>
          
          <div class="section">
            <div class="service-info"><span class="label">Servicio #:</span> <span>${$.id}</span></div>
            <div class="service-info"><span class="label">Fecha de ingreso:</span> <span>${new Date($.createdAt).toLocaleDateString("es-CO")}</span></div>
            <div class="service-info"><span class="label">Cliente:</span> <span>${(J==null?void 0:J.name)||"N/A"}</span></div>
            ${J!=null&&J.phone?`<div class="service-info"><span class="label">Telfono:</span> <span>${J.phone}</span></div>`:""}
          </div>
          
          <div class="separator"></div>
          
          <div class="section device-info">
            <div class="service-info"><span class="label">Dispositivo:</span> <span>${$.deviceBrandModel||"N/A"}</span></div>
            ${$.deviceImei?`<div class="service-info"><span class="label">IMEI:</span> <span>${$.deviceImei}</span></div>`:""}
            ${$.physicalCondition?`<div class="service-info"><span class="label">Estado fsico:</span> <span>${$.physicalCondition}</span></div>`:""}
            ${$.reportedIssue?`<div class="service-info"><span class="label">Problema:</span> <span>${$.reportedIssue.length>50?$.reportedIssue.substring(0,50)+"...":$.reportedIssue}</span></div>`:""}
          </div>
          
          <div class="separator"></div>
          
          <div class="financial-section">
            <div class="flex-between" style="font-weight: bold; margin-bottom: 4mm; font-size: 13px;">
              <span>TOTAL A PAGAR:</span>
              <span>${V(we)}</span>
            </div>
            
            <div class="separator"></div>
            
            <div class="payment-info">
              <span>Pagado:</span>
              <span>${V(le)}</span>
            </div>
            
            <div class="separator"></div>
            
            <div class="flex-between" style="font-weight: bold; margin-top: 4mm; font-size: 13px;">
              <span>SALDO PENDIENTE:</span>
              <span>${V(Ee)}</span>
            </div>
          </div>
          
          <div class="separator"></div>
          
          <div class="footer">
            <div>"Celu Mara tecnologa confiable, gente real, soluciones honestas!"</div>
            <div style="margin-top: 2mm;">Gracias por confiar en nosotros</div>
            <div style="margin-top: 1mm; font-weight: bold;">CONSERVE ESTE COMPROBANTE</div>
          </div>
          </div>
        </body>
      </html>
    `,$e=window.open("","_blank");$e&&($e.document.write(Be),$e.document.close(),$e.print(),$e.close())},ap=$=>{var Ee;const J=c.find(Be=>Be.id===$.customerId),le=`
      <html>
        <head>
          <title>Etiqueta Trabajo - ${$.id}</title>
          <style>
            @media print {
              @page { margin: 0; size: 58mm auto; }
              body { margin: 0; padding: 2mm; font-family: monospace; font-size: 9px; line-height: 1.1; }
            }
            body { font-family: monospace; font-size: 9px; line-height: 1.1; max-width: 54mm; }
            .header { text-align: center; margin-bottom: 2mm; font-weight: bold; }
            .separator { border-top: 1px dashed #000; margin: 2mm 0; }
            .section { margin: 1.5mm 0; }
            .label { font-weight: bold; }
            .notes { border: 1px solid #000; padding: 1mm; margin: 2mm 0; min-height: 10mm; }
          </style>
        </head>
        <body>
          <div class="header">ETIQUETA DE TRABAJO</div>
          
          <div class="section">
            <div><span class="label">ID:</span> ${$.id}</div>
            <div><span class="label">Fecha:</span> ${new Date($.createdAt).toLocaleDateString("es-CO")}</div>
            <div><span class="label">Cliente:</span> ${(J==null?void 0:J.name)||"N/A"}</div>
            ${J!=null&&J.phone?`<div><span class="label">Tel:</span> ${J.phone}</div>`:""}
          </div>
          
          <div class="separator"></div>
          
          <div class="section">
            <div><span class="label">Dispositivo:</span> ${$.deviceBrandModel||"N/A"}</div>
            ${$.deviceImei?`<div><span class="label">IMEI:</span> ${$.deviceImei}</div>`:""}
            ${$.devicePassword?`<div><span class="label">Clave:</span> ${$.devicePassword}</div>`:""}
            ${$.physicalCondition?`<div><span class="label">Estado:</span> ${$.physicalCondition}</div>`:""}
            ${$.reportedIssue?`<div><span class="label">Problema:</span> ${$.reportedIssue}</div>`:""}
          </div>
          
          ${$.notes?`
          <div class="separator"></div>
          <div class="section">
            <div class="label">Notas Adicionales:</div>
            <div class="notes">${$.notes}</div>
          </div>
          `:""}
          
          <div class="separator"></div>
          
          <div class="section">
            <div><span class="label">Total:</span> ${V($.totalAmount)}</div>
            <div><span class="label">Abono:</span> ${V(((Ee=$.payments)==null?void 0:Ee.reduce((Be,$e)=>Be+$e.amount,0))||0)}</div>
          </div>
        </body>
      </html>
    `,we=window.open("","_blank");we&&(we.document.write(le),we.document.close(),we.print(),we.close())},Hs=$=>{switch($){case"active":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Ga=$=>{switch($){case"active":return"Activo";case"completed":return"Finalizado";case"cancelled":return"Cancelado";default:return $}},vr=$=>{const J=$.payments.reduce((Ee,Be)=>Ee+Be.amount,0);let le=0;$.serviceCost!==void 0?le=$.serviceCost:le=$.items.reduce((Ee,Be)=>Ee+Be.totalCost,0)+($.laborCost||0);const we=le-J;return{totalPaid:J,realTotal:le,remainingBalance:we}},co=$=>{const{totalPaid:J,realTotal:le}=vr($);return{paymentProgress:le>0?J/le*100:0}},Ka=I.useMemo(()=>{const $=l.filter(Et=>Et.status==="active"),J=l.filter(Et=>Et.status==="completed"),le=l.filter(Et=>Et.status==="cancelled"),we=new Date;we.setMonth(we.getMonth()-2);const Ee=J.reduce((Et,et)=>{if(new Date(et.completedAt||et.updatedAt)>=we){const ar=et.payments.reduce((_r,fr)=>_r+fr.amount,0);return Et+ar}return Et},0),Be=$.reduce((Et,et)=>{const Wr=et.items.filter(ar=>ar.status!=="instalado").length;return Et+Wr},0),$e=le.reduce((Et,et)=>{const Wr=et.payments.reduce((fr,kt)=>fr+kt.amount,0),ar=et.items.reduce((fr,kt)=>{const Qr=(kt.pickedUpQuantity||0)*kt.productSalePrice;return fr+Qr},0),_r=Math.min(Wr,ar);return Et+_r},0),Je=[...$,...J].reduce((Et,et)=>{const Wr=et.payments.reduce((fr,kt)=>fr+kt.amount,0),ar=et.items.reduce((fr,kt)=>{const Qr=(kt.pickedUpQuantity||0)*kt.productSalePrice;return fr+Qr},0),_r=Math.min(Wr,ar);return Et+_r},0)+$e,at=[...$,...J].reduce((Et,et)=>{const Wr=et.payments.reduce((fr,kt)=>fr+kt.amount,0),ar=et.items.reduce((fr,kt)=>{const Qr=(kt.pickedUpQuantity||0)*kt.productSalePrice;return fr+Qr},0),_r=Wr-ar;return Et+Math.max(0,_r)},0),st=le.reduce((Et,et)=>{const Wr=et.payments.reduce((fr,kt)=>fr+kt.amount,0),ar=et.items.reduce((fr,kt)=>{const Qr=(kt.pickedUpQuantity||0)*kt.productSalePrice;return fr+Qr},0),_r=Wr-ar;return Et+Math.max(0,_r)},0),Tt=$.reduce((Et,et)=>Et+et.remainingBalance,0),nr=$.reduce((Et,et)=>Et+et.expectedProfit,0);return{totalTechnicalServices:l.length,activeTechnicalServices:$.length,completedTechnicalServices:J.length,cancelledLayaways:le.length,totalRevenue:Je,pendingRevenue:Tt,expectedProfit:nr,pendingCustomerCredit:Math.max(0,st-t),paidButNotPickedUp:at,totalCompletedRevenue:Ee,pendingParts:Be}},[l,t,r]);return a.jsxs("div",{className:"space-y-4 md:space-y-6 p-4 md:p-0",children:[a.jsx("div",{className:"mb-4 pt-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Servicio Tcnico"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona los servicios tcnicos y reparaciones"})]}),a.jsxs("button",{onClick:()=>k(!0),className:"bg-blue-600 text-white px-3 md:px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 text-sm md:text-base",children:[a.jsx(wn,{className:"h-4 w-4 md:h-5 md:w-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Nuevo Servicio Tcnico"}),a.jsx("span",{className:"sm:hidden",children:"Nuevo"})]})]})}),!E&&a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(zl,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Total Servicios"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:Ka.totalTechnicalServices})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-orange-500/10 hover:-translate-y-0.5 hover:border-orange-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-orange-50 rounded flex items-center justify-center group-hover:bg-orange-100 group-hover:scale-110 transition-all duration-300",children:a.jsx($i,{className:"w-3 h-3 text-orange-600 group-hover:text-orange-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Activos"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-orange-900 transition-colors duration-300",children:Ka.activeTechnicalServices})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-green-500/10 hover:-translate-y-0.5 hover:border-green-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-green-50 rounded flex items-center justify-center group-hover:bg-green-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ai,{className:"w-3 h-3 text-green-600 group-hover:text-green-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Finalizados"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-green-900 transition-colors duration-300",children:Ka.completedTechnicalServices})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Wt,{className:"w-3 h-3 text-emerald-600 group-hover:text-emerald-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Ingresos Totales"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(Ka.totalCompletedRevenue||0)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-amber-500/10 hover:-translate-y-0.5 hover:border-amber-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-amber-50 rounded flex items-center justify-center group-hover:bg-amber-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ea,{className:"w-3 h-3 text-amber-600 group-hover:text-amber-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Repuestos Pendientes"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-amber-900 transition-colors duration-300",children:Ka.pendingParts||0})]})}),Ka.paidButNotPickedUp>0&&a.jsx("div",{className:"group relative bg-gradient-to-br from-yellow-50 to-orange-50 rounded-lg shadow-lg border border-yellow-200 p-2 hover:shadow-xl hover:shadow-yellow-500/20 hover:-translate-y-0.5 hover:border-yellow-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-yellow-50 rounded flex items-center justify-center group-hover:bg-yellow-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Vf,{className:"w-3 h-3 text-yellow-600 group-hover:text-yellow-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Pagado sin Recoger"}),a.jsx("p",{className:"text-base font-bold text-yellow-600 group-hover:text-yellow-800 transition-colors duration-300",children:V(Ka.paidButNotPickedUp)})]})}),r&&Ka.pendingCustomerCredit>0&&a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-blue-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-400 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Rr,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Saldo a Favor"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:V(Ka.pendingCustomerCredit)})]})})]}),!E&&a.jsx("div",{className:"bg-white rounded-xl p-4 md:p-6 shadow-sm border border-gray-300",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 md:gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 md:h-5 md:w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar por ID, cliente o repuesto...",value:oe,onChange:$=>Ce($.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("select",{value:i,onChange:$=>o($.target.value),className:"px-3 md:px-4 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[140px] md:min-w-[160px]",children:[a.jsx("option",{value:"all",children:"Todos los estados"}),a.jsx("option",{value:"active",children:"Solo activos"}),a.jsx("option",{value:"completed",children:"Solo finalizados"}),a.jsx("option",{value:"cancelled",children:"Solo cancelados"})]}),a.jsxs("select",{value:ke,onChange:$=>ue($.target.value),className:"px-3 md:px-4 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[140px] md:min-w-[180px]",children:[a.jsx("option",{value:"all",children:"Todos los vendedores"}),se.map($=>a.jsx("option",{value:$.uid,children:$.displayName||$.email},$.uid))]})]})}),E&&a.jsxs("div",{className:"bg-white rounded-lg md:rounded-xl p-4 md:p-6 shadow-sm border border-gray-300",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900",children:"Crear Nuevo Servicio Tcnico"}),a.jsx("button",{onClick:()=>{Ye(),k(!1)},className:"text-gray-400 hover:text-gray-600 p-1",children:a.jsx(ct,{className:"h-5 w-5 md:h-6 md:w-6"})})]}),a.jsxs("form",{ref:ut,onSubmit:Kd,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente *"}),a.jsx(eR,{customers:c,isLoading:g,onChange:It})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"customerPhone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono del Cliente"}),a.jsx("input",{type:"text",id:"customerPhone",name:"customerPhone",value:j.phone,onChange:$=>S(J=>({...J,phone:$.target.value})),disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"customerAddress",className:"block text-sm font-medium text-gray-700 mb-1",children:"Direccin del Cliente"}),a.jsx("input",{type:"text",id:"customerAddress",name:"customerAddress",value:j.address,onChange:$=>S(J=>({...J,address:$.target.value})),disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"deviceImei",className:"block text-sm font-medium text-gray-700 mb-1",children:"IMEI del Dispositivo"}),a.jsx("input",{type:"text",id:"deviceImei",name:"deviceImei",disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"deviceBrandModel",className:"block text-sm font-medium text-gray-700 mb-1",children:"Marca y Referencia del Equipo"}),a.jsx("input",{type:"text",id:"deviceBrandModel",name:"deviceBrandModel",disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"devicePassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea del Equipo"}),a.jsx("input",{type:"text",id:"devicePassword",name:"devicePassword",disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"physicalCondition",className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado Fsico del Equipo al Recibir"}),a.jsx("textarea",{id:"physicalCondition",name:"physicalCondition",rows:2,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 resize-none"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"reportedIssue",className:"block text-sm font-medium text-gray-700 mb-1",children:"Falla Reportada *"}),a.jsx("textarea",{id:"reportedIssue",name:"reportedIssue",rows:3,disabled:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 resize-none"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"serviceCost",className:"block text-sm font-medium text-gray-700 mb-1",children:"Costo Servicio Tcnico *"}),a.jsx("input",{type:"text",inputMode:"numeric",id:"serviceCost",name:"serviceCost",value:Yt(N.toString()),disabled:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",onChange:$=>{const J=Yt($.target.value),le=jt(J);w(le),$.target.value=J}}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Valor total que pagar el cliente por el servicio"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"assignedTechnician",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tcnico Asignado"}),a.jsxs("select",{id:"assignedTechnician",name:"assignedTechnician",disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",children:[a.jsx("option",{value:"",children:"Seleccionar tcnico (opcional)"}),Ae.map($=>a.jsx("option",{value:$.id,children:$.name},$.id))]})]}),a.jsxs("div",{className:"space-y-4",children:[b&&b.credit>0&&a.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"useCreditCreate",checked:ae,onChange:$=>me($.target.checked),disabled:g}),a.jsxs("label",{htmlFor:"useCreditCreate",className:"text-sm text-gray-700",children:["Usar saldo a favor (",V(b.credit),")"]})]}),ae&&a.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Saldo disponible: ",V(b.credit)]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pago Inicial"}),a.jsxs("label",{className:"flex items-center text-sm",children:[a.jsx("input",{type:"checkbox",checked:Ar,onChange:$=>{hn($.target.checked),$.target.checked||Hr([])},disabled:g,className:"mr-2 disabled:opacity-50"}),"Pagos mltiples"]})]}),Ar?a.jsxs("div",{className:"space-y-3",children:[_.length>0&&a.jsx("div",{className:"p-2 bg-blue-50 rounded-lg text-sm",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Total productos:"}),a.jsx("span",{className:"font-medium",children:V(_.reduce(($,J)=>$+J.partCost*J.quantity,0))})]})}),Ir.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Pagos agregados:"}),Ir.map(($,J)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-medium",children:$.method==="efectivo"?"Efectivo":$.method==="transferencia"?"Transferencia":$.method==="tarjeta"?"Tarjeta":$.method==="crdito"?"Crdito":$.method}),a.jsx("div",{className:"text-xs text-gray-600",children:V($.amount)})]}),a.jsx("button",{type:"button",onClick:()=>ep(J),disabled:g,className:"text-red-600 hover:text-red-800 p-1 disabled:opacity-50",children:a.jsx(ct,{className:"h-4 w-4"})})]},J)),a.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[a.jsx("span",{children:"Total pagado:"}),a.jsx("span",{className:"font-medium",children:V(Cc())})]}),_.length>0&&a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Restante:"}),a.jsx("span",{className:`font-medium ${qs()>0?"text-orange-600":"text-green-600"}`,children:V(qs())})]}),_.length===0&&Ir.length>0&&a.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Selecciona productos para calcular el total restante"})]}),a.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Agregar pago:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:kr,onChange:$=>F($.target.value),disabled:g,className:`px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 text-sm ${_.length>0?"flex-1":"w-full"}`,children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]}),_.length>0&&a.jsx("button",{type:"button",onClick:()=>{const $=qs();$>0&&Gd(kr,$)},disabled:g||qs()<=0,className:"px-3 py-2 bg-gray-600 text-white text-xs rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Todo"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"text",disabled:g,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",onChange:$=>{const J=jt($.target.value);if(_.length>0){const le=qs(),we=Math.min(J,le);$.target.value=Yt(we.toString())}else $.target.value=Yt(J.toString())},onKeyDown:$=>{if($.key==="Enter"){const J=jt($.currentTarget.value);J>0&&(_.length===0||J<=qs())&&(Gd(kr,J),$.currentTarget.value="")}}}),a.jsx("button",{type:"button",onClick:$=>{var we;const J=(we=$.currentTarget.parentElement)==null?void 0:we.querySelector("input"),le=jt((J==null?void 0:J.value)||"0");le>0&&(_.length===0||le<=qs())&&(Gd(kr,le),J&&(J.value=""))},disabled:g,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar"})]})]})]})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto (COP)"}),a.jsx("input",{type:"text",value:_n,onChange:Ve,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mtodo de Pago"}),a.jsxs("select",{value:kr,onChange:$=>F($.target.value),disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Repuestos Necesarios"}),_.length>0&&a.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Repuestos agregados:"}),a.jsx("div",{className:"space-y-2",children:_.map(($,J)=>a.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{className:"font-medium",children:$.partName}),$.partDescription&&a.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["- ",$.partDescription]}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Cantidad: ",$.quantity,"  ",V($.partCost)," = ",V($.totalCost)]})]}),a.jsx("button",{type:"button",onClick:()=>{const le=_.filter((we,Ee)=>Ee!==J);C(le)},className:"text-red-600 hover:text-red-800 ml-2",disabled:g,children:a.jsx(ct,{className:"h-4 w-4"})})]},$.id))})]}),a.jsxs("div",{className:"p-3 border border-gray-300 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Agregar repuesto (opcional):"}),a.jsx("span",{className:"text-xs text-gray-500 italic",children:"Se puede crear el servicio sin repuestos para revisin inicial"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-2",children:[a.jsx("input",{type:"text",placeholder:"Nombre del repuesto",id:"partName",className:"px-2 py-1 border border-gray-300 rounded text-sm",disabled:g}),a.jsx("input",{type:"text",placeholder:"Descripcin (opcional)",id:"partDescription",className:"px-2 py-1 border border-gray-300 rounded text-sm",disabled:g}),a.jsx("input",{type:"number",placeholder:"Cantidad",id:"partQuantity",min:"1",defaultValue:"1",className:"px-2 py-1 border border-gray-300 rounded text-sm",disabled:g}),a.jsx("input",{type:"text",inputMode:"numeric",placeholder:"Costo unitario",id:"partCost",className:"px-2 py-1 border border-gray-300 rounded text-sm",disabled:g,onChange:$=>{const J=Yt($.target.value);$.target.value=J}})]}),a.jsxs("button",{type:"button",onClick:()=>{const $=document.getElementById("partName").value.trim(),J=document.getElementById("partDescription").value.trim(),le=parseInt(document.getElementById("partQuantity").value)||1,we=document.getElementById("partCost").value.trim(),Ee=jt(we);if(!$){d("Error","Ingresa el nombre del repuesto");return}if(Ee<=0){d("Error","Ingresa un costo vlido");return}const Be={id:crypto.randomUUID(),partName:$,partDescription:J||void 0,quantity:le,partCost:Ee,totalCost:le*Ee,status:"solicitado",addedBy:f==null?void 0:f.uid,addedByName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),addedAt:Qe()};C([..._,Be]),document.getElementById("partName").value="",document.getElementById("partDescription").value="",document.getElementById("partQuantity").value="1",document.getElementById("partCost").value=""},disabled:g,className:"mt-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors disabled:opacity-50",children:[a.jsx(wn,{className:"h-4 w-4 inline mr-1"}),"Agregar Repuesto (Opcional)"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas (Opcional)"}),a.jsx("textarea",{name:"notes",rows:3,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),T.length>0&&a.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded-lg p-4",children:[a.jsxs("h3",{className:"text-sm font-semibold text-cyan-700 mb-2 flex items-center space-x-2",children:[a.jsx(ur,{className:"h-4 w-4"}),a.jsxs("span",{children:["Cortesas (",T.length,")"]})]}),a.jsx("div",{className:"space-y-2",children:T.map(($,J)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-cyan-300",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-cyan-900",children:$.productName}),a.jsxs("div",{className:"text-xs text-cyan-600",children:["Valor: ",V($.normalPrice),"  ",$.quantity," = ",V($.totalValue)]}),$.reason&&a.jsx("div",{className:"text-xs text-cyan-500 italic mt-1",children:$.reason})]}),a.jsx("button",{type:"button",onClick:()=>Fe(J),className:"p-2 text-cyan-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar cortesa",children:a.jsx(ct,{className:"h-4 w-4"})})]},J))})]}),a.jsxs("button",{type:"button",onClick:Xe,disabled:g||!b,className:"w-full bg-cyan-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-cyan-700 transition-colors disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center space-x-2 mb-3",children:[a.jsx(ur,{className:"h-5 w-5"}),a.jsx("span",{children:"Aadir Cortesa"})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>{Ye(),k(!1)},disabled:g,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[g&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:g?"Creando...":"Crear Servicio Tcnico"})]})]})]})]}),!E&&a.jsxs(a.Fragment,{children:[(i!=="active"||ke!=="all"||oe.trim())&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-sm text-blue-800 font-medium",children:"Filtros activos:"}),i!=="active"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Estado: ",i==="all"?"Todos":i==="completed"?"Finalizados":i==="cancelled"?"Cancelados":i,a.jsx("button",{onClick:()=>o("active"),className:"ml-1 text-blue-600 hover:text-blue-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),ke!=="all"&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:["Vendedor: ",((rr=se.find($=>$.uid===ke))==null?void 0:rr.displayName)||((ml=se.find($=>$.uid===ke))==null?void 0:ml.email)||"Desconocido",a.jsx("button",{onClick:()=>ue("all"),className:"ml-1 text-indigo-600 hover:text-indigo-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),oe.trim()&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:['Bsqueda: "',oe,'"',a.jsx("button",{onClick:()=>Ce(""),className:"ml-1 text-green-600 hover:text-green-800",children:a.jsx(ct,{className:"h-3 w-3"})})]}),a.jsxs("span",{className:"text-sm text-blue-700",children:["(",ul.length," servicios encontrados)"]})]})}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:ul.map($=>{const{paymentProgress:J}=co($);return a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-300 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Rr,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:$.customerName})}),a.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[$.deviceBrandModel&&a.jsxs("div",{children:[" ",$.deviceBrandModel]}),$.salesPersonName&&a.jsxs("div",{children:[" ",$.salesPersonName]})]})]})]}),a.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Hs($.status)}`,children:Ga($.status)}),a.jsx("div",{className:"flex space-x-1",children:a.jsx("button",{onClick:()=>y($),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50 transition-colors",title:"Ver detalles",children:a.jsx(os,{className:"h-5 w-5"})})})]})]}),a.jsx("div",{className:"space-y-3 mb-4",children:(()=>{const{totalPaid:le,realTotal:we,remainingBalance:Ee}=vr($);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Total:"}),a.jsx("span",{className:"font-medium",children:V(we)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Pagado:"}),a.jsx("span",{className:"font-medium text-green-600",children:V(le)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Pendiente:"}),a.jsx("span",{className:"font-medium text-orange-600",children:V(Ee)})]})]})})()}),a.jsx("div",{className:"space-y-3 mb-4",children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[a.jsx("span",{children:"Progreso de Pagos"}),a.jsxs("span",{children:[(J||0).toFixed(0),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${J||0}%`}})})]})}),a.jsx("div",{className:"text-sm text-gray-600 mb-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(ea,{className:"h-4 w-4 mr-1"}),a.jsxs("span",{children:[$.items.length," producto(s)"]})]})}),$.status==="active"&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{onClick:()=>{y($),pt(!0)},className:"flex-1 bg-green-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors flex items-center justify-center space-x-1",children:[a.jsx(Wt,{className:"h-4 w-4"}),a.jsx("span",{children:"Pagar"})]}),a.jsx("button",{onClick:()=>np($),className:"bg-red-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors",title:"Cancelar servicio tcnico",children:a.jsx(ct,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 text-xs text-gray-400 flex items-center justify-between",children:[a.jsxs("div",{children:["Creado: ",new Date($.createdAt).toLocaleDateString()]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-xs font-mono text-gray-600 bg-gray-100 px-2 py-1 rounded",children:$.id}),a.jsx("button",{onClick:()=>navigator.clipboard.writeText($.id),className:"text-gray-400 hover:text-gray-600 p-1",title:"Copiar ID",children:a.jsxs("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:[a.jsx("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),a.jsx("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"})]})})]})]})]},$.id)})}),m&&!mt&&!gt&&!ze&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Servicio Tcnico - ",m.customerName]}),a.jsxs("p",{className:"text-sm text-gray-600 font-mono mt-1",children:["ID: ",m.id]}),a.jsx("div",{className:"flex items-center space-x-4 mt-2",children:a.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${Hs(m.status)}`,children:Ga(m.status)})})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("button",{onClick:()=>Yd(m),className:"flex items-center px-3 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors",title:"Imprimir remisin cliente",children:[a.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Remisin"]}),a.jsxs("button",{onClick:()=>ap(m),className:"flex items-center px-3 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors",title:"Imprimir etiqueta de trabajo",children:[a.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),"Etiqueta"]}),a.jsx("button",{onClick:()=>y(null),className:"text-gray-400 hover:text-gray-600 text-2xl ml-2",children:""})]})]}),a.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Informacin del Cliente y Dispositivo"}),!Le&&m.status!=="cancelled"&&a.jsx("button",{onClick:()=>{qe(!0),ne({deviceImei:m.deviceImei||"",deviceBrandModel:m.deviceBrandModel||"",devicePassword:m.devicePassword||"",physicalCondition:m.physicalCondition||"",reportedIssue:m.reportedIssue||"",laborCost:m.laborCost||0,serviceCost:m.serviceCost||0,notes:m.notes||"",technicianId:m.technicianId||""});const $=c.find(J=>J.id===m.customerId);S({phone:($==null?void 0:$.phone)||m.customerPhone||"",address:($==null?void 0:$.address)||m.customerAddress||""})},className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors",children:"Editar"}),Le&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:oo,disabled:g,className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors disabled:opacity-50",children:g?"Guardando...":"Guardar"}),a.jsx("button",{onClick:()=>{qe(!1),ne({deviceImei:m.deviceImei||"",deviceBrandModel:m.deviceBrandModel||"",devicePassword:m.devicePassword||"",physicalCondition:m.physicalCondition||"",reportedIssue:m.reportedIssue||"",laborCost:m.laborCost||0,serviceCost:m.serviceCost||0,notes:m.notes||"",technicianId:m.technicianId||""})},className:"bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700 transition-colors",children:"Cancelar"})]})]}),Le?a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2 mb-4",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Informacin del Cliente"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Nombre"}),a.jsx("input",{type:"text",value:m.customerName,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Telfono"}),a.jsx("input",{type:"text",value:j.phone,onChange:$=>S(J=>({...J,phone:$.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Direccin"}),a.jsx("input",{type:"text",value:j.address,onChange:$=>S(J=>({...J,address:$.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.jsx("div",{className:"md:col-span-2 mb-2",children:a.jsx("h5",{className:"text-sm font-medium text-gray-900",children:"Informacin del Dispositivo"})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IMEI del Dispositivo"}),a.jsx("input",{type:"text",value:De.deviceImei,onChange:$=>ne({...De,deviceImei:$.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marca y Referencia del Equipo"}),a.jsx("input",{type:"text",value:De.deviceBrandModel,onChange:$=>ne({...De,deviceBrandModel:$.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea del Equipo"}),a.jsx("input",{type:"text",value:De.devicePassword,onChange:$=>ne({...De,devicePassword:$.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Costo Total del Servicio Tcnico"}),a.jsx("input",{type:"text",value:Yt(De.serviceCost||0),onChange:$=>ne({...De,serviceCost:jt($.target.value)}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado Fsico del Equipo al Recibir"}),a.jsx("textarea",{value:De.physicalCondition,onChange:$=>ne({...De,physicalCondition:$.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Falla Reportada"}),a.jsx("textarea",{value:De.reportedIssue,onChange:$=>ne({...De,reportedIssue:$.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas Adicionales"}),a.jsx("textarea",{value:De.notes,onChange:$=>ne({...De,notes:$.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tcnico Asignado"}),a.jsxs("select",{value:De.technicianId,onChange:$=>ne({...De,technicianId:$.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Ningn tcnico asignado"}),Ae.map($=>a.jsx("option",{value:$.id,children:$.name},$.id))]})]})]}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4 p-3 bg-gray-100 rounded",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Nombre:"}),a.jsx("p",{className:"font-medium",children:m.customerName})]}),m.customerPhone&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Telfono:"}),a.jsx("p",{className:"font-medium",children:m.customerPhone})]}),m.customerAddress&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Direccin:"}),a.jsx("p",{className:"font-medium",children:m.customerAddress})]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IMEI del Dispositivo"}),a.jsx("p",{className:"font-medium text-gray-900",children:m.deviceImei||"No especificado"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marca y Referencia del Equipo"}),a.jsx("p",{className:"font-medium text-gray-900",children:m.deviceBrandModel||"No especificado"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea del Equipo"}),a.jsx("p",{className:"font-medium text-gray-900",children:m.devicePassword||"No especificado"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Costo Total del Servicio Tcnico"}),a.jsx("p",{className:"font-medium text-gray-900",children:V(m.serviceCost||0)})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado Fsico del Equipo al Recibir"}),a.jsx("p",{className:"font-medium text-gray-900 whitespace-pre-wrap",children:m.physicalCondition||"No especificado"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Falla Reportada"}),a.jsx("p",{className:"font-medium text-gray-900 whitespace-pre-wrap",children:m.reportedIssue||"No especificado"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas Adicionales"}),a.jsx("p",{className:"font-medium text-gray-900 whitespace-pre-wrap",children:m.notes||"No especificado"})]}),m.salesPersonName&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendedor"}),a.jsx("p",{className:"font-medium text-gray-900",children:m.salesPersonName})]}),m.technicianId&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tcnico Asignado"}),a.jsx("p",{className:"font-medium text-gray-900",children:((uo=Ae.find($=>$.id===m.technicianId))==null?void 0:uo.name)||"Tcnico no encontrado"})]})]})]}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Resumen Financiero"}),a.jsx("div",{className:"mb-4 p-3 bg-white rounded-lg border",children:a.jsx("div",{className:"space-y-2 text-sm",children:(()=>{const $=m.items.reduce(($e,Je)=>$e+Je.totalCost,0),J=m.serviceCost||0,le=Math.max(0,J-$),we=m.courtesyItems&&m.courtesyItems.length>0,Ee=m.courtesyTotalValue||0,Be=m.courtesyTotalCost||0;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Repuestos:"}),a.jsx("span",{children:V($)})]}),le>0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Mano de Obra:"}),a.jsx("span",{children:V(le)})]}),we&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between text-cyan-700 font-medium pt-2 border-t",children:[a.jsxs("span",{className:"flex items-center",children:[a.jsx(ur,{className:"h-3 w-3 mr-1"}),"Valor cortesas regaladas:"]}),a.jsx("span",{children:V(Ee)})]}),a.jsxs("div",{className:"flex justify-between text-red-600 font-medium",children:[a.jsxs("span",{className:"flex items-center",children:[a.jsx(ur,{className:"h-3 w-3 mr-1"}),"Costo cortesas:"]}),a.jsxs("span",{children:["-",V(Be)]})]})]}),a.jsx("hr",{className:"my-2"}),a.jsxs("div",{className:"flex justify-between font-bold",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:V(J)})]})]})})()})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("span",{className:"text-gray-600",children:"Total:"}),a.jsx("p",{className:"font-bold text-lg",children:V(vr(m).realTotal)})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("span",{className:"text-gray-600",children:"Pagado:"}),a.jsx("p",{className:"font-bold text-lg text-green-600",children:V(m.payments.reduce(($,J)=>$+J.amount,0))})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("span",{className:"text-gray-600",children:"Pendiente:"}),a.jsx("p",{className:"font-bold text-lg text-orange-600",children:V(vr(m).remainingBalance)})]})]})]}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[a.jsx("span",{children:"Progreso de Pagos"}),a.jsxs("span",{children:[(co(m).paymentProgress||0).toFixed(1),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:a.jsx("div",{className:"bg-green-500 h-3 rounded-full transition-all duration-300",style:{width:`${co(m).paymentProgress||0}%`}})})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Repuestos del Servicio"}),m.status!=="delivered"&&m.status!=="cancelled"&&a.jsxs("button",{onClick:()=>U(!0),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors flex items-center space-x-1",children:[a.jsx(wn,{className:"h-4 w-4"}),a.jsx("span",{children:"Agregar Repuesto"})]})]}),a.jsx("div",{className:"space-y-3",children:m.items.map($=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium text-gray-900",children:$.partName}),$.partDescription&&a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:$.partDescription}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[a.jsxs("span",{children:["Cantidad: ",$.quantity," | "]}),a.jsxs("span",{children:["Costo: ",V($.partCost)," c/u | "]}),a.jsxs("span",{children:["Total: ",V($.totalCost)]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("select",{value:$.status,onChange:J=>Or($.id,J.target.value),disabled:m.status!=="active"||g,className:`px-2 py-1 rounded-full text-xs font-medium border-0 focus:ring-2 focus:ring-blue-500 disabled:opacity-50 ${$.status==="solicitado"?"bg-yellow-100 text-yellow-800":$.status==="en_tienda"?"bg-blue-100 text-blue-800":$.status==="instalado"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:[a.jsx("option",{value:"solicitado",children:"Solicitado"}),a.jsx("option",{value:"en_tienda",children:"En tienda"}),a.jsx("option",{value:"instalado",children:"Instalado"})]}),m.status==="active"&&a.jsx("button",{onClick:()=>nt($.id,$.partName),disabled:g,className:"p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors disabled:opacity-50",title:"Eliminar repuesto",children:a.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),$.notes&&a.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded",children:a.jsxs("p",{className:"text-xs text-gray-600",children:[a.jsx("strong",{children:"Notas:"})," ",$.notes]})}),a.jsxs("div",{className:"mt-2 text-xs text-gray-400 space-y-1",children:[$.addedByName&&a.jsxs("div",{children:["Agregado por: ",$.addedByName,$.addedAt&&a.jsxs("span",{className:"ml-2",children:["el ",new Date($.addedAt).toLocaleDateString("es-CO")," a las ",new Date($.addedAt).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})]})]}),$.statusChangedByName&&$.statusChangedAt&&a.jsxs("div",{children:["Estado cambiado por: ",$.statusChangedByName,a.jsxs("span",{className:"ml-2",children:["el ",new Date($.statusChangedAt).toLocaleDateString("es-CO")," a las ",new Date($.statusChangedAt).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})]})]}),$.installedAt&&$.status==="instalado"&&a.jsxs("div",{children:["Instalado el ",new Date($.installedAt).toLocaleDateString("es-CO")," a las ",new Date($.installedAt).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})]})]})]},$.id))})]}),m.courtesyItems&&m.courtesyItems.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"flex justify-between items-center mb-3",children:a.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[a.jsx(ur,{className:"h-5 w-5 text-cyan-600 mr-2"}),"Cortesas"]})}),a.jsx("div",{className:"space-y-3",children:m.courtesyItems.map(($,J)=>a.jsx("div",{className:"border border-cyan-200 bg-cyan-50 rounded-lg p-4",children:a.jsx("div",{className:"flex justify-between items-start",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium text-gray-900",children:$.productName}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[a.jsxs("span",{children:["Cantidad: ",$.quantity," | "]}),a.jsxs("span",{children:["Valor: ",V($.normalPrice)," c/u | "]}),a.jsxs("span",{className:"text-cyan-700 font-medium",children:["Total regalado: ",V($.totalValue)]})]}),a.jsxs("div",{className:"text-sm text-red-600 mt-1",children:["Costo real: -",V($.totalCost)]}),$.reason&&a.jsx("div",{className:"mt-2 p-2 bg-white rounded",children:a.jsxs("p",{className:"text-xs text-gray-600",children:[a.jsx("strong",{children:"Motivo:"})," ",$.reason]})})]})})},J))})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Historial de Pagos"}),m.status==="active"&&vr(m).remainingBalance>0&&a.jsxs("button",{onClick:()=>pt(!0),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors flex items-center space-x-1",children:[a.jsx(Wt,{className:"h-4 w-4"}),a.jsx("span",{children:"Registrar Pago"})]})]}),m.payments.length===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No se han registrado pagos"}):a.jsx("div",{className:"space-y-2",children:m.payments.map($=>a.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium",children:V($.amount)}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("div",{children:new Date($.paymentDate).toLocaleDateString()}),a.jsx("div",{children:$.paymentMethods&&$.paymentMethods.length>1?(()=>{const J=$.paymentMethods.map(le=>`${(()=>{switch(le.method){case"efectivo":return"Efectivo";case"transferencia":return"Transferencia";case"tarjeta":return"Tarjeta";case"crdito":return"Crdito";case"credit":return"Saldo a favor";default:return le.method}})()}: ${V(le.amount)}`);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"font-medium text-purple-700",children:"Pagos mltiples:"}),J.map((le,we)=>a.jsxs("div",{className:"text-xs text-gray-600 ml-2",children:[" ",le]},we))]})})():$.paymentMethod==="efectivo"?"Efectivo":$.paymentMethod==="transferencia"?"Transferencia":$.paymentMethod==="tarjeta"?"Tarjeta":"Crdito"})]}),$.notes&&a.jsxs("div",{className:"text-xs text-gray-500 italic",children:['"',$.notes,'"']}),$.registeredByName&&a.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Registrado por: ",$.registeredByName,$.registeredAt&&a.jsxs("span",{className:"ml-2",children:["el ",new Date($.registeredAt).toLocaleDateString("es-CO")," a las ",new Date($.registeredAt).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ai,{className:"h-5 w-5 text-green-500"}),m.status==="active"&&a.jsx("button",{onClick:()=>xv($.id),className:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 transition-colors",title:"Cancelar pago",children:a.jsx(ct,{className:"h-4 w-4"})})]})]},$.id))})]}),m.notes&&a.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Notas"}),a.jsx("p",{className:"text-sm text-gray-700",children:m.notes})]}),m.status==="active"&&(()=>{const $=xt(m),J=$.length===0;return a.jsx("div",{className:`mb-4 p-3 rounded-lg border ${J?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"}`,children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:`flex-shrink-0 mr-2 ${J?"text-green-600":"text-yellow-600"}`,children:J?a.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):a.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:`text-sm font-medium ${J?"text-green-800":"text-yellow-800"}`,children:J?" Listo para finalizar":"Pendiente para finalizar"}),!J&&a.jsx("ul",{className:"mt-1 text-sm text-yellow-700",children:$.map((le,we)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx("span",{className:"mr-1",children:""}),le,le.includes("Sobrepago")&&le.includes("requiere reajuste")&&a.jsx("button",{onClick:()=>Lt(m),className:"ml-2 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Reajustar"})]},we))}),J&&a.jsx("p",{className:"text-sm text-green-700 mt-1",children:"El servicio est completamente pagado y todos los repuestos estn instalados."})]})]})})})(),m.status==="active"&&a.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[a.jsx("button",{onClick:Ge,disabled:!Dt(m)||g,className:`px-4 py-2 rounded-lg font-medium transition-colors ${Dt(m)&&!g?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,title:Dt(m)?"Finalizar servicio tcnico":"Para finalizar: complete el pago y marque todos los repuestos como instalados",children:g?"Finalizando...":"Finalizar Servicio Tcnico"}),a.jsx("button",{onClick:()=>np(m),disabled:g,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:"Cancelar Servicio Tcnico"})]}),m.status==="cancelled"&&a.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsxs("h4",{className:"font-medium text-red-800 mb-3 flex items-center",children:[a.jsx(is,{className:"h-5 w-5 mr-2"}),"Resumen de Cancelacin"]}),(()=>{const $=m.payments.reduce(($e,Je)=>$e+Je.amount,0),J=m.items.filter($e=>($e.pickedUpQuantity||0)>0),le=m.items.filter($e=>$e.quantity-($e.pickedUpQuantity||0)>0),we=m.items.reduce(($e,Je)=>{const at=Je.pickedUpQuantity||0;return $e+at*Je.productSalePrice},0),Ee=Math.min($,we),Be=$-Ee;return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:" Estado de Productos"}),J.length>0&&a.jsxs("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded",children:[a.jsx("h6",{className:"text-sm font-medium text-green-800 mb-2",children:" Productos Entregados al Cliente"}),a.jsx("div",{className:"space-y-1",children:J.map($e=>{const Je=$e.pickedUpQuantity||0,at=Je*$e.productSalePrice;return a.jsxs("div",{className:"text-xs text-green-700",children:[" ",$e.productName,": ",Je," unidades (",V(at),")"]},`picked-${$e.id}`)})}),a.jsxs("div",{className:"text-sm font-medium text-green-800 mt-2 pt-2 border-t border-green-200",children:["Total entregado: ",V(we)]})]}),le.length>0&&a.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded",children:[a.jsx("h6",{className:"text-sm font-medium text-blue-800 mb-2",children:" Productos Devueltos al Inventario"}),a.jsx("div",{className:"space-y-1",children:le.map($e=>{const Je=$e.quantity-($e.pickedUpQuantity||0),at=Je*$e.productSalePrice;return a.jsxs("div",{className:"text-xs text-blue-700",children:[" ",$e.productName,": ",Je," unidades (",V(at),")"]},`returned-${$e.id}`)})})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:" Manejo del Dinero"}),Ee>0&&a.jsxs("div",{className:"mb-4 p-3 bg-emerald-50 border border-emerald-200 rounded",children:[a.jsx("h6",{className:"text-sm font-medium text-emerald-800 mb-2",children:" Ingresos Reales"}),a.jsx("div",{className:"text-lg font-bold text-emerald-700",children:V(Ee)}),a.jsx("div",{className:"text-xs text-emerald-600 mt-1",children:"Dinero por productos entregados"})]}),Be>0&&a.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded",children:[a.jsx("h6",{className:"text-sm font-medium text-orange-800 mb-2",children:" Requiere Manejo"}),a.jsx("div",{className:"text-lg font-bold text-orange-700",children:V(Be)}),a.jsx("div",{className:"text-xs text-orange-600 mt-1",children:"Dinero excedente (reembolso/crdito)"})]}),a.jsx("div",{className:"mt-4 p-3 bg-gray-50 border border-gray-200 rounded",children:a.jsxs("div",{className:"text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Total pagado:"}),a.jsx("span",{className:"font-medium",children:V($)})]}),a.jsxs("div",{className:"flex justify-between text-emerald-600",children:[a.jsx("span",{children:" Ingresos reales:"}),a.jsx("span",{className:"font-medium",children:V(Ee)})]}),a.jsxs("div",{className:"flex justify-between text-orange-600",children:[a.jsx("span",{children:" Requiere manejo:"}),a.jsx("span",{className:"font-medium",children:V(Be)})]})]})})]})]})})()]}),a.jsxs("div",{className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsxs("h4",{className:"font-medium text-gray-800 mb-3 flex items-center",children:[a.jsx(Rr,{className:"h-5 w-5 mr-2"}),"Historial de Cambios"]}),a.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[m.salesPersonName&&a.jsxs("div",{children:[a.jsx("strong",{children:"Creado por:"})," ",m.salesPersonName,a.jsxs("span",{className:"ml-2 text-gray-400",children:["el ",new Date(m.createdAt).toLocaleDateString("es-CO")," a las ",new Date(m.createdAt).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})]})]}),m.statusChangedByName&&m.statusChangedAt&&a.jsxs("div",{children:[a.jsx("strong",{children:"ltimo cambio de estado por:"})," ",m.statusChangedByName,a.jsxs("span",{className:"ml-2 text-gray-400",children:["el ",new Date(m.statusChangedAt).toLocaleDateString("es-CO")," a las ",new Date(m.statusChangedAt).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})]})]}),m.completedByName&&m.completedAt&&a.jsxs("div",{children:[a.jsx("strong",{children:"Finalizado por:"})," ",m.completedByName,a.jsxs("span",{className:"ml-2 text-gray-400",children:["el ",new Date(m.completedAt).toLocaleDateString("es-CO")," a las ",new Date(m.completedAt).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})]})]}),m.cancelledByName&&m.status==="cancelled"&&a.jsxs("div",{children:[a.jsx("strong",{children:"Cancelado por:"})," ",m.cancelledByName,a.jsxs("span",{className:"ml-2 text-gray-400",children:["el ",new Date(m.statusChangedAt||m.updatedAt).toLocaleDateString("es-CO")," a las ",new Date(m.statusChangedAt||m.updatedAt).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})]})]})]})]})]})})}),ze&&m&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Agregar Repuesto"}),a.jsx("button",{onClick:()=>U(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsxs("form",{onSubmit:async $=>{$.preventDefault();const J=new FormData($.currentTarget),le=J.get("partName"),we=J.get("partDescription"),Ee=parseInt(J.get("quantity"))||1,Be=J.get("partCost"),$e=jt(Be);if(!le.trim()){d("Error","Ingresa el nombre del repuesto");return}if($e<=0){d("Error","Ingresa un costo vlido");return}const Je={id:crypto.randomUUID(),partName:le.trim(),...we.trim()&&{partDescription:we.trim()},quantity:Ee,partCost:$e,totalCost:Ee*$e,status:"solicitado",addedBy:f==null?void 0:f.uid,addedByName:(f==null?void 0:f.displayName)||(f==null?void 0:f.email),addedAt:Qe()};try{x(!0);const at=[...m.items,Je],st=Je.totalCost;await Fr.update(m.id,{items:at,totalAmount:m.totalAmount+st,totalCost:m.totalCost+st,remainingBalance:m.remainingBalance+st,updatedAt:Qe()});const Tt={...m,items:at,totalAmount:m.totalAmount+st,totalCost:m.totalCost+st,remainingBalance:m.remainingBalance+st,updatedAt:Qe()};_e(Tt),y(Tt),U(!1),u("Repuesto agregado",`Se agreg "${le}" por ${V(Je.totalCost)}`),s(Ya())}catch{d("Error","No se pudo agregar el repuesto. Intntalo de nuevo.")}finally{x(!1)}},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"partName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Repuesto *"}),a.jsx("input",{type:"text",id:"partName",name:"partName",disabled:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"partDescription",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin (Opcional)"}),a.jsx("input",{type:"text",id:"partDescription",name:"partDescription",disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"quantity",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad *"}),a.jsx("input",{type:"number",id:"quantity",name:"quantity",min:"1",defaultValue:"1",disabled:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"partCost",className:"block text-sm font-medium text-gray-700 mb-1",children:"Costo Unitario *"}),a.jsx("input",{type:"text",inputMode:"numeric",id:"partCost",name:"partCost",placeholder:"0",disabled:g,required:!0,onChange:$=>{const J=Yt($.target.value);$.target.value=J},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>U(!1),disabled:g,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-2",children:[g&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:g?"Agregando...":"Agregar Repuesto"})]})]})]})]})})}),mt&&m&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Registrar Pago"}),a.jsx("button",{onClick:()=>pt(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Saldo pendiente:"}),a.jsx("div",{className:"text-xl font-bold text-blue-600",children:V(vr(m).remainingBalance)})]}),a.jsxs("form",{onSubmit:tp,className:"space-y-4",children:[(()=>{const $=c.find(J=>J.id===m.customerId);return $&&$.credit>0?a.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"useCredit",checked:Tr,onChange:J=>Wa(J.target.checked),disabled:g}),a.jsxs("label",{htmlFor:"useCredit",className:"text-sm text-gray-700",children:["Usar saldo a favor (",V($.credit),")"]})]}),Tr&&a.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Se aplicar automticamente: ",V(Math.min($.credit,vr(m).remainingBalance))]})]}):null})(),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Mtodo de Pago"}),a.jsxs("label",{className:"flex items-center text-sm",children:[a.jsx("input",{type:"checkbox",checked:Se,onChange:$=>{Oe($.target.checked),$.target.checked||Z([])},disabled:g,className:"mr-2 disabled:opacity-50"}),"Pagos mltiples"]})]}),Se?a.jsxs("div",{className:"space-y-3",children:[H.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Pagos agregados:"}),H.map(($,J)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-medium",children:$.method==="efectivo"?"Efectivo":$.method==="transferencia"?"Transferencia":$.method==="tarjeta"?"Tarjeta":$.method==="crdito"?"Crdito":$.method}),a.jsx("div",{className:"text-xs text-gray-600",children:V($.amount)})]}),a.jsx("button",{type:"button",onClick:()=>fl(J),disabled:g,className:"text-red-600 hover:text-red-800 p-1 disabled:opacity-50",children:a.jsx(ct,{className:"h-4 w-4"})})]},J)),a.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[a.jsx("span",{children:"Total pagado:"}),a.jsx("span",{className:"font-medium",children:V(bs())})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Restante por pagar:"}),a.jsx("span",{className:`font-medium ${Pa()>0?"text-red-600":"text-green-600"}`,children:V(Pa())})]})]}),Pa()>0&&a.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Agregar pago:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:ce,onChange:$=>fe($.target.value),disabled:g,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 text-sm",children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]}),a.jsx("button",{type:"button",onClick:()=>{const $=Pa();$>0&&hl(ce,$)},disabled:g||Pa()<=0,className:"px-3 py-2 bg-gray-600 text-white text-xs rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Todo"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"text",placeholder:"Monto",disabled:g,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",onChange:$=>{const J=jt($.target.value),le=Pa(),we=Math.min(J,le);$.target.value=Yt(we.toString())},onKeyDown:$=>{if($.key==="Enter"){const J=jt($.currentTarget.value);J>0&&J<=Pa()&&(hl(ce,J),$.currentTarget.value="")}}}),a.jsx("button",{type:"button",onClick:$=>{var we;const J=(we=$.currentTarget.parentElement)==null?void 0:we.querySelector("input"),le=jt((J==null?void 0:J.value)||"0");le>0&&le<=Pa()&&(hl(ce,le),J&&(J.value=""))},disabled:g,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar"})]})]})]})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto del Pago (COP) *"}),a.jsx("input",{type:"text",value:dn,onChange:Ne,placeholder:"0",required:!0,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Saldo pendiente: ",V(vr(m).remainingBalance)]})]}),a.jsx("div",{children:a.jsxs("select",{name:"paymentMethod",disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",children:[a.jsx("option",{value:"efectivo",children:"Efectivo"}),a.jsx("option",{value:"transferencia",children:"Transferencia"}),a.jsx("option",{value:"tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"crdito",children:"Crdito"})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas (Opcional)"}),a.jsx("textarea",{name:"notes",rows:3,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"Notas sobre el pago..."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>pt(!1),disabled:g,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:g||!Se&&jt(dn)<=0||Se&&(H.length===0||Pa()>.01),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[g&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:g?"Registrando...":"Registrar Pago"})]})]})]})]})})}),gt&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Marcar como Recogido"}),a.jsx("button",{onClick:()=>lr(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"font-medium",children:gt.item.productName}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Disponible para recoger: ",gt.item.quantity-(gt.item.pickedUpQuantity||0)," de ",gt.item.quantity]})]}),a.jsxs("form",{onSubmit:rp,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad a Recoger *"}),a.jsx("input",{type:"number",name:"quantity",min:"1",max:gt.item.quantity-(gt.item.pickedUpQuantity||0),defaultValue:"1",required:!0,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas (Opcional)"}),a.jsx("textarea",{name:"notes",rows:3,disabled:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50",placeholder:"Notas sobre la recogida..."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>lr(null),disabled:g,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",disabled:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[g&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:g?"Marcando...":"Marcar como Recogido"})]})]})]})]})})}),ul.length===0&&a.jsxs("div",{className:"bg-white rounded-xl p-12 text-center shadow-sm border border-gray-300",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(Xn,{className:"h-12 w-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron servicios tcnicos"}),a.jsx("p",{className:"text-gray-500",children:oe||i!=="active"?"Intenta ajustar tus criterios de bsqueda.":"Comienza creando tu primer servicio tcnico."})]})]}),Q&&te&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-xl max-w-md w-full shadow-xl",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"flex-shrink-0 mr-3",children:te.id==="adjustment"?a.jsx("svg",{className:"h-10 w-10 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):a.jsx("svg",{className:"h-10 w-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:te.id==="adjustment"?"Reajustar Sobrepago":"Confirmar Eliminacin"}),a.jsx("p",{className:"text-sm text-gray-500",children:te.id==="adjustment"?"Selecciona cmo manejar el sobrepago":"Esta accin no se puede deshacer"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("p",{className:"text-gray-700 mb-4",children:te.id==="adjustment"?"Cmo deseas manejar el sobrepago detectado?":"Ests seguro de que quieres eliminar el siguiente repuesto?"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border",children:a.jsxs("div",{className:"text-sm",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:te.name}),te.id!=="adjustment"&&te.item.partDescription&&a.jsx("div",{className:"text-gray-600 mb-2",children:te.item.partDescription}),te.id==="adjustment"&&a.jsxs("div",{className:"text-gray-600 mb-2",children:["El cliente ha pagado ",V(te.item.totalCost)," ms de lo que cuesta el servicio."]}),a.jsx("div",{className:"space-y-1 text-gray-600",children:te.id!=="adjustment"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Cantidad:"}),a.jsxs("span",{className:"font-medium",children:[te.item.quantity," unidad(es)"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Costo unitario:"}),a.jsx("span",{className:"font-medium",children:V(te.item.partCost)})]}),a.jsxs("div",{className:"flex justify-between border-t pt-1",children:[a.jsx("span",{children:"Total a eliminar:"}),a.jsx("span",{className:"font-bold text-red-600",children:V(te.item.totalCost)})]})]}):a.jsxs("div",{className:"flex justify-between border-t pt-1",children:[a.jsx("span",{children:"Monto del sobrepago:"}),a.jsx("span",{className:"font-bold text-blue-600",children:V(te.item.totalCost)})]})})]})}),(()=>{if(!m||!te)return null;if(te.id==="adjustment")return a.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"Cmo deseas manejar este sobrepago?"}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"overpaymentAction",value:"credit",checked:xe==="credit",onChange:Be=>he(Be.target.value),className:"mr-2"}),a.jsx("span",{className:"text-sm text-blue-700",children:"Agregar al saldo a favor del cliente"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"overpaymentAction",value:"refund",checked:xe==="refund",onChange:Be=>he(Be.target.value),className:"mr-2"}),a.jsx("span",{className:"text-sm text-blue-700",children:"Registrar como reembolso (pago negativo)"})]})]})});const $=m.items.reduce((Be,$e)=>Be+$e.totalCost,0)+(m.laborCost||0),J=m.payments.reduce((Be,$e)=>Be+$e.amount,0),le=te.item.totalCost,we=$-le,Ee=J-we;return Ee>.01?a.jsxs("div",{className:"mt-4 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("svg",{className:"h-5 w-5 text-orange-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L5.314 16.5c-.77.833.192 2.5 1.732 2.5z"})}),a.jsx("h4",{className:"font-medium text-orange-800",children:"Sobrepago Detectado"})]}),a.jsxs("p",{className:"text-sm text-orange-700 mb-3",children:["El cliente ha pagado ",a.jsx("strong",{children:V(Ee)})," ms de lo que costar el servicio despus de eliminar este repuesto."]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-orange-800 mb-2",children:"Cmo deseas manejar este sobrepago?"}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"overpaymentAction",value:"credit",checked:xe==="credit",onChange:Be=>he(Be.target.value),className:"mr-2"}),a.jsxs("span",{className:"text-sm text-orange-700",children:["Agregar ",a.jsx("strong",{children:V(Ee)})," al saldo a favor del cliente"]})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"overpaymentAction",value:"refund",checked:xe==="refund",onChange:Be=>he(Be.target.value),className:"mr-2"}),a.jsxs("span",{className:"text-sm text-orange-700",children:["Registrar reembolso de ",a.jsx("strong",{children:V(Ee)})," (pago negativo)"]})]})]})]}):null})()]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>{re(!1),pe(null),he(null)},disabled:g,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),(()=>{if(!m||!te)return null;if(te.id==="adjustment"){const Je=xe!==null;return a.jsxs("button",{onClick:Ut,disabled:g||!Je,className:`px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 ${Je?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500"}`,title:Je?"":"Selecciona cmo manejar el sobrepago antes de continuar",children:[g&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:g?"Reajustando...":"Confirmar Reajuste"})]})}const $=m.items.reduce((Je,at)=>Je+at.totalCost,0)+(m.laborCost||0),J=m.payments.reduce((Je,at)=>Je+at.amount,0),le=te.item.totalCost,we=$-le,$e=!(J-we>.01)||xe!==null;return a.jsxs("button",{onClick:Ut,disabled:g||!$e,className:`px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 ${$e?"bg-red-600 text-white hover:bg-red-700":"bg-gray-300 text-gray-500"}`,title:$e?"":"Selecciona cmo manejar el sobrepago antes de continuar",children:[g&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:g?"Eliminando...":"Eliminar Repuesto"})]})})()]})]})})}),R&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Imprimir Documentos"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Cliente: ",a.jsx("strong",{children:((ho=c.find($=>$.id===R.customerId))==null?void 0:ho.name)||"N/A"})]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Servicio: ",a.jsxs("strong",{children:["#",R.id]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:()=>Yd(R),className:"w-full flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Remisin Cliente"]}),a.jsxs("button",{onClick:()=>ap(R),className:"w-full flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),"Etiqueta de Trabajo"]})]}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("button",{onClick:()=>B(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cerrar"})})]})}),Y&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Cancelar Servicio Tcnico"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Cliente: ",a.jsx("strong",{children:Y.customerName})]}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Total pagado: ",a.jsx("strong",{children:V(Y.payments.reduce(($,J)=>$+J.amount,0))})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto a devolver al cliente:"}),a.jsx("input",{type:"text",value:L,onChange:$=>X(Yt(jt($.target.value))),placeholder:"Ej: 20000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto a cobrar como penalizacin:"}),a.jsx("input",{type:"text",value:G,onChange:$=>K(Yt(jt($.target.value))),placeholder:"Ej: 15000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(()=>{const $=jt(L),J=jt(G),le=Y.payments.reduce((Be,$e)=>Be+$e.amount,0),we=$+J,Ee=we===le;return a.jsx("div",{className:`p-3 rounded-lg ${Ee?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:a.jsxs("p",{className:`text-sm ${Ee?"text-green-700":"text-red-700"}`,children:[a.jsx("strong",{children:"Verificacin:"}),a.jsx("br",{}),"Devolucin + Penalizacin = ",V(we),a.jsx("br",{}),"Total pagado = ",V(le),a.jsx("br",{}),Ee?" Los montos coinciden":" Los montos no coinciden"]})})})()]}),a.jsxs("div",{className:"mt-6 flex space-x-3",children:[a.jsx("button",{onClick:()=>{const $=jt(L),J=jt(G),le=Y.payments.reduce((we,Ee)=>we+Ee.amount,0);$+J===le?Qd(Y,$,J):alert("Los montos no coinciden con el total pagado")},disabled:(()=>{const $=jt(L),J=jt(G),le=Y.payments.reduce((we,Ee)=>we+Ee.amount,0);return $+J!==le})(),className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar Servicio"}),a.jsx("button",{onClick:()=>W(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cerrar"})]})]})}),q&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(Vf,{className:"h-6 w-6 text-orange-500 mr-3"}),a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Penalizacin por Cancelacin"})]}),a.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Cliente:"}),a.jsx("span",{className:"font-medium text-gray-900",children:q.customerName})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Servicio:"}),a.jsx("span",{className:"font-medium text-gray-900",children:q.deviceBrandModel||"Servicio tcnico"})]}),a.jsxs("div",{className:"flex justify-between text-gray-500",children:[a.jsx("span",{children:"Total pagado:"}),a.jsx("span",{className:"font-medium",children:"$0"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monto de penalizacin por cancelacin"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"$"}),a.jsx("input",{type:"text",value:ge,onChange:$=>{const J=$.target.value.replace(/[^0-9]/g,"");be(J)},placeholder:"15000",className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",autoFocus:!0})]}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Este monto ser cobrado al cliente como penalizacin por cancelar el servicio"})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>{ie(null),be("")},className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium rounded-lg hover:bg-gray-100 transition-colors",children:"Cancelar"}),a.jsx("button",{onClick:async()=>{const $=Number(ge);if(isNaN($)||$<0){alert("Por favor ingresa un monto vlido");return}await Qd(q,0,$),ie(null),be("")},disabled:!ge,className:"px-4 py-2 bg-orange-600 text-white font-medium rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar Servicio"})]})]})})}),O&&a.jsx(QM,{onClose:ot,onAdd:Te})]})}function tR(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=tR(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function At(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=tR(t))&&(n&&(n+=" "),n+=e);return n}var FG=Array.isArray,Ea=FG,BG=typeof dp=="object"&&dp&&dp.Object===Object&&dp,rR=BG,UG=rR,zG=typeof self=="object"&&self&&self.Object===Object&&self,qG=UG||zG||Function("return this")(),fi=qG,HG=fi,WG=HG.Symbol,Km=WG,AP=Km,nR=Object.prototype,GG=nR.hasOwnProperty,KG=nR.toString,fh=AP?AP.toStringTag:void 0;function QG(t){var e=GG.call(t,fh),r=t[fh];try{t[fh]=void 0;var n=!0}catch{}var s=KG.call(t);return n&&(e?t[fh]=r:delete t[fh]),s}var YG=QG,XG=Object.prototype,JG=XG.toString;function ZG(t){return JG.call(t)}var eK=ZG,IP=Km,tK=YG,rK=eK,nK="[object Null]",aK="[object Undefined]",kP=IP?IP.toStringTag:void 0;function sK(t){return t==null?t===void 0?aK:nK:kP&&kP in Object(t)?tK(t):rK(t)}var no=sK;function iK(t){return t!=null&&typeof t=="object"}var ao=iK,oK=no,lK=ao,cK="[object Symbol]";function uK(t){return typeof t=="symbol"||lK(t)&&oK(t)==cK}var Od=uK,dK=Ea,hK=Od,fK=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mK=/^\w*$/;function pK(t,e){if(dK(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||hK(t)?!0:mK.test(t)||!fK.test(t)||e!=null&&t in Object(e)}var iS=pK;function gK(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var il=gK;const Dd=er(il);var yK=no,xK=il,vK="[object AsyncFunction]",bK="[object Function]",wK="[object GeneratorFunction]",jK="[object Proxy]";function NK(t){if(!xK(t))return!1;var e=yK(t);return e==bK||e==wK||e==vK||e==jK}var oS=NK;const bt=er(oS);var _K=fi,SK=_K["__core-js_shared__"],CK=SK,xb=CK,OP=function(){var t=/[^.]+$/.exec(xb&&xb.keys&&xb.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function EK(t){return!!OP&&OP in t}var PK=EK,TK=Function.prototype,AK=TK.toString;function IK(t){if(t!=null){try{return AK.call(t)}catch{}try{return t+""}catch{}}return""}var aR=IK,kK=oS,OK=PK,DK=il,MK=aR,RK=/[\\^$.*+?()[\]{}|]/g,$K=/^\[object .+?Constructor\]$/,LK=Function.prototype,VK=Object.prototype,FK=LK.toString,BK=VK.hasOwnProperty,UK=RegExp("^"+FK.call(BK).replace(RK,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zK(t){if(!DK(t)||OK(t))return!1;var e=kK(t)?UK:$K;return e.test(MK(t))}var qK=zK;function HK(t,e){return t==null?void 0:t[e]}var WK=HK,GK=qK,KK=WK;function QK(t,e){var r=KK(t,e);return GK(r)?r:void 0}var jc=QK,YK=jc,XK=YK(Object,"create"),Cx=XK,DP=Cx;function JK(){this.__data__=DP?DP(null):{},this.size=0}var ZK=JK;function eQ(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var tQ=eQ,rQ=Cx,nQ="__lodash_hash_undefined__",aQ=Object.prototype,sQ=aQ.hasOwnProperty;function iQ(t){var e=this.__data__;if(rQ){var r=e[t];return r===nQ?void 0:r}return sQ.call(e,t)?e[t]:void 0}var oQ=iQ,lQ=Cx,cQ=Object.prototype,uQ=cQ.hasOwnProperty;function dQ(t){var e=this.__data__;return lQ?e[t]!==void 0:uQ.call(e,t)}var hQ=dQ,fQ=Cx,mQ="__lodash_hash_undefined__";function pQ(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=fQ&&e===void 0?mQ:e,this}var gQ=pQ,yQ=ZK,xQ=tQ,vQ=oQ,bQ=hQ,wQ=gQ;function Md(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Md.prototype.clear=yQ;Md.prototype.delete=xQ;Md.prototype.get=vQ;Md.prototype.has=bQ;Md.prototype.set=wQ;var jQ=Md;function NQ(){this.__data__=[],this.size=0}var _Q=NQ;function SQ(t,e){return t===e||t!==t&&e!==e}var lS=SQ,CQ=lS;function EQ(t,e){for(var r=t.length;r--;)if(CQ(t[r][0],e))return r;return-1}var Ex=EQ,PQ=Ex,TQ=Array.prototype,AQ=TQ.splice;function IQ(t){var e=this.__data__,r=PQ(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():AQ.call(e,r,1),--this.size,!0}var kQ=IQ,OQ=Ex;function DQ(t){var e=this.__data__,r=OQ(e,t);return r<0?void 0:e[r][1]}var MQ=DQ,RQ=Ex;function $Q(t){return RQ(this.__data__,t)>-1}var LQ=$Q,VQ=Ex;function FQ(t,e){var r=this.__data__,n=VQ(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var BQ=FQ,UQ=_Q,zQ=kQ,qQ=MQ,HQ=LQ,WQ=BQ;function Rd(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Rd.prototype.clear=UQ;Rd.prototype.delete=zQ;Rd.prototype.get=qQ;Rd.prototype.has=HQ;Rd.prototype.set=WQ;var Px=Rd,GQ=jc,KQ=fi,QQ=GQ(KQ,"Map"),cS=QQ,MP=jQ,YQ=Px,XQ=cS;function JQ(){this.size=0,this.__data__={hash:new MP,map:new(XQ||YQ),string:new MP}}var ZQ=JQ;function eY(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var tY=eY,rY=tY;function nY(t,e){var r=t.__data__;return rY(e)?r[typeof e=="string"?"string":"hash"]:r.map}var Tx=nY,aY=Tx;function sY(t){var e=aY(this,t).delete(t);return this.size-=e?1:0,e}var iY=sY,oY=Tx;function lY(t){return oY(this,t).get(t)}var cY=lY,uY=Tx;function dY(t){return uY(this,t).has(t)}var hY=dY,fY=Tx;function mY(t,e){var r=fY(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var pY=mY,gY=ZQ,yY=iY,xY=cY,vY=hY,bY=pY;function $d(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}$d.prototype.clear=gY;$d.prototype.delete=yY;$d.prototype.get=xY;$d.prototype.has=vY;$d.prototype.set=bY;var uS=$d,sR=uS,wY="Expected a function";function dS(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(wY);var r=function(){var n=arguments,s=e?e.apply(this,n):n[0],i=r.cache;if(i.has(s))return i.get(s);var o=t.apply(this,n);return r.cache=i.set(s,o)||i,o};return r.cache=new(dS.Cache||sR),r}dS.Cache=sR;var iR=dS;const jY=er(iR);var NY=iR,_Y=500;function SY(t){var e=NY(t,function(n){return r.size===_Y&&r.clear(),n}),r=e.cache;return e}var CY=SY,EY=CY,PY=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,TY=/\\(\\)?/g,AY=EY(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(PY,function(r,n,s,i){e.push(s?i.replace(TY,"$1"):n||r)}),e}),IY=AY;function kY(t,e){for(var r=-1,n=t==null?0:t.length,s=Array(n);++r<n;)s[r]=e(t[r],r,t);return s}var hS=kY,RP=Km,OY=hS,DY=Ea,MY=Od,RY=1/0,$P=RP?RP.prototype:void 0,LP=$P?$P.toString:void 0;function oR(t){if(typeof t=="string")return t;if(DY(t))return OY(t,oR)+"";if(MY(t))return LP?LP.call(t):"";var e=t+"";return e=="0"&&1/t==-RY?"-0":e}var $Y=oR,LY=$Y;function VY(t){return t==null?"":LY(t)}var lR=VY,FY=Ea,BY=iS,UY=IY,zY=lR;function qY(t,e){return FY(t)?t:BY(t,e)?[t]:UY(zY(t))}var cR=qY,HY=Od,WY=1/0;function GY(t){if(typeof t=="string"||HY(t))return t;var e=t+"";return e=="0"&&1/t==-WY?"-0":e}var Ax=GY,KY=cR,QY=Ax;function YY(t,e){e=KY(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[QY(e[r++])];return r&&r==n?t:void 0}var fS=YY,XY=fS;function JY(t,e,r){var n=t==null?void 0:XY(t,e);return n===void 0?r:n}var uR=JY;const Fa=er(uR);function ZY(t){return t==null}var eX=ZY;const Pt=er(eX);var tX=no,rX=Ea,nX=ao,aX="[object String]";function sX(t){return typeof t=="string"||!rX(t)&&nX(t)&&tX(t)==aX}var iX=sX;const lc=er(iX);var dR={exports:{}},tr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mS=Symbol.for("react.element"),pS=Symbol.for("react.portal"),Ix=Symbol.for("react.fragment"),kx=Symbol.for("react.strict_mode"),Ox=Symbol.for("react.profiler"),Dx=Symbol.for("react.provider"),Mx=Symbol.for("react.context"),oX=Symbol.for("react.server_context"),Rx=Symbol.for("react.forward_ref"),$x=Symbol.for("react.suspense"),Lx=Symbol.for("react.suspense_list"),Vx=Symbol.for("react.memo"),Fx=Symbol.for("react.lazy"),lX=Symbol.for("react.offscreen"),hR;hR=Symbol.for("react.module.reference");function xs(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case mS:switch(t=t.type,t){case Ix:case Ox:case kx:case $x:case Lx:return t;default:switch(t=t&&t.$$typeof,t){case oX:case Mx:case Rx:case Fx:case Vx:case Dx:return t;default:return e}}case pS:return e}}}tr.ContextConsumer=Mx;tr.ContextProvider=Dx;tr.Element=mS;tr.ForwardRef=Rx;tr.Fragment=Ix;tr.Lazy=Fx;tr.Memo=Vx;tr.Portal=pS;tr.Profiler=Ox;tr.StrictMode=kx;tr.Suspense=$x;tr.SuspenseList=Lx;tr.isAsyncMode=function(){return!1};tr.isConcurrentMode=function(){return!1};tr.isContextConsumer=function(t){return xs(t)===Mx};tr.isContextProvider=function(t){return xs(t)===Dx};tr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===mS};tr.isForwardRef=function(t){return xs(t)===Rx};tr.isFragment=function(t){return xs(t)===Ix};tr.isLazy=function(t){return xs(t)===Fx};tr.isMemo=function(t){return xs(t)===Vx};tr.isPortal=function(t){return xs(t)===pS};tr.isProfiler=function(t){return xs(t)===Ox};tr.isStrictMode=function(t){return xs(t)===kx};tr.isSuspense=function(t){return xs(t)===$x};tr.isSuspenseList=function(t){return xs(t)===Lx};tr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Ix||t===Ox||t===kx||t===$x||t===Lx||t===lX||typeof t=="object"&&t!==null&&(t.$$typeof===Fx||t.$$typeof===Vx||t.$$typeof===Dx||t.$$typeof===Mx||t.$$typeof===Rx||t.$$typeof===hR||t.getModuleId!==void 0)};tr.typeOf=xs;dR.exports=tr;var cX=dR.exports,uX=no,dX=ao,hX="[object Number]";function fX(t){return typeof t=="number"||dX(t)&&uX(t)==hX}var fR=fX;const mX=er(fR);var pX=fR;function gX(t){return pX(t)&&t!=+t}var yX=gX;const Ld=er(yX);var sa=function(e){return e===0?0:e>0?1:-1},Dl=function(e){return lc(e)&&e.indexOf("%")===e.length-1},Me=function(e){return mX(e)&&!Ld(e)},xX=function(e){return Pt(e)},cn=function(e){return Me(e)||lc(e)},vX=0,Vd=function(e){var r=++vX;return"".concat(e||"").concat(r)},ia=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Me(e)&&!lc(e))return n;var i;if(Dl(e)){var o=e.indexOf("%");i=r*parseFloat(e.slice(0,o))/100}else i=+e;return Ld(i)&&(i=n),s&&i>r&&(i=r),i},Co=function(e){if(!e)return null;var r=Object.keys(e);return r&&r.length?e[r[0]]:null},bX=function(e){if(!Array.isArray(e))return!1;for(var r=e.length,n={},s=0;s<r;s++)if(!n[e[s]])n[e[s]]=!0;else return!0;return!1},xa=function(e,r){return Me(e)&&Me(r)?function(n){return e+n*(r-e)}:function(){return r}};function P0(t,e,r){return!t||!t.length?null:t.find(function(n){return n&&(typeof e=="function"?e(n):Fa(n,e))===r})}var wX=function(e,r){return Me(e)&&Me(r)?e-r:lc(e)&&lc(r)?e.localeCompare(r):e instanceof Date&&r instanceof Date?e.getTime()-r.getTime():String(e).localeCompare(String(r))};function bu(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function Ij(t){"@babel/helpers - typeof";return Ij=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ij(t)}var jX=["viewBox","children"],NX=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],VP=["points","pathLength"],vb={svg:jX,polygon:VP,polyline:VP},gS=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],T0=function(e,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(I.isValidElement(e)&&(n=e.props),!Dd(n))return null;var s={};return Object.keys(n).forEach(function(i){gS.includes(i)&&(s[i]=r||function(o){return n[i](n,o)})}),s},_X=function(e,r,n){return function(s){return e(r,n,s),null}},cc=function(e,r,n){if(!Dd(e)||Ij(e)!=="object")return null;var s=null;return Object.keys(e).forEach(function(i){var o=e[i];gS.includes(i)&&typeof o=="function"&&(s||(s={}),s[i]=_X(o,r,n))}),s},SX=["children"],CX=["children"];function FP(t,e){if(t==null)return{};var r=EX(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function EX(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function kj(t){"@babel/helpers - typeof";return kj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kj(t)}var BP={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Li=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},UP=null,bb=null,yS=function t(e){if(e===UP&&Array.isArray(bb))return bb;var r=[];return I.Children.forEach(e,function(n){Pt(n)||(cX.isFragment(n)?r=r.concat(t(n.props.children)):r.push(n))}),bb=r,UP=e,r};function hs(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(function(s){return Li(s)}):n=[Li(e)],yS(t).forEach(function(s){var i=Fa(s,"type.displayName")||Fa(s,"type.name");n.indexOf(i)!==-1&&r.push(s)}),r}function ka(t,e){var r=hs(t,e);return r&&r[0]}var zP=function(e){if(!e||!e.props)return!1;var r=e.props,n=r.width,s=r.height;return!(!Me(n)||n<=0||!Me(s)||s<=0)},PX=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],TX=function(e){return e&&e.type&&lc(e.type)&&PX.indexOf(e.type)>=0},AX=function(e){return e&&kj(e)==="object"&&"clipDot"in e},IX=function(e,r,n,s){var i,o=(i=vb==null?void 0:vb[s])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!bt(e)&&(s&&o.includes(r)||NX.includes(r))||n&&gS.includes(r)},ft=function(e,r,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var s=e;if(I.isValidElement(e)&&(s=e.props),!Dd(s))return null;var i={};return Object.keys(s).forEach(function(o){var l;IX((l=s)===null||l===void 0?void 0:l[o],o,r,n)&&(i[o]=s[o])}),i},Oj=function t(e,r){if(e===r)return!0;var n=I.Children.count(e);if(n!==I.Children.count(r))return!1;if(n===0)return!0;if(n===1)return qP(Array.isArray(e)?e[0]:e,Array.isArray(r)?r[0]:r);for(var s=0;s<n;s++){var i=e[s],o=r[s];if(Array.isArray(i)||Array.isArray(o)){if(!t(i,o))return!1}else if(!qP(i,o))return!1}return!0},qP=function(e,r){if(Pt(e)&&Pt(r))return!0;if(!Pt(e)&&!Pt(r)){var n=e.props||{},s=n.children,i=FP(n,SX),o=r.props||{},l=o.children,c=FP(o,CX);return s&&l?bu(i,c)&&Oj(s,l):!s&&!l?bu(i,c):!1}return!1},HP=function(e,r){var n=[],s={};return yS(e).forEach(function(i,o){if(TX(i))n.push(i);else if(i){var l=Li(i.type),c=r[l]||{},u=c.handler,d=c.once;if(u&&(!d||!s[l])){var h=u(i,l,o);n.push(h),s[l]=!0}}}),n},kX=function(e){var r=e&&e.type;return r&&BP[r]?BP[r]:null},OX=function(e,r){return yS(r).indexOf(e)},DX=["children","width","height","viewBox","className","style","title","desc"];function Dj(){return Dj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Dj.apply(this,arguments)}function MX(t,e){if(t==null)return{};var r=RX(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function RX(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Mj(t){var e=t.children,r=t.width,n=t.height,s=t.viewBox,i=t.className,o=t.style,l=t.title,c=t.desc,u=MX(t,DX),d=s||{width:r,height:n,x:0,y:0},h=At("recharts-surface",i);return ee.createElement("svg",Dj({},ft(u,!0,"svg"),{className:h,width:r,height:n,style:o,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),ee.createElement("title",null,l),ee.createElement("desc",null,c),e)}var $X=["children","className"];function Rj(){return Rj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Rj.apply(this,arguments)}function LX(t,e){if(t==null)return{};var r=VX(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function VX(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var Ft=ee.forwardRef(function(t,e){var r=t.children,n=t.className,s=LX(t,$X),i=At("recharts-layer",n);return ee.createElement("g",Rj({className:i},ft(s,!0),{ref:e}),r)}),Ls=function(e,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i]};function FX(t,e,r){var n=-1,s=t.length;e<0&&(e=-e>s?0:s+e),r=r>s?s:r,r<0&&(r+=s),s=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(s);++n<s;)i[n]=t[n+e];return i}var BX=FX,UX=BX;function zX(t,e,r){var n=t.length;return r=r===void 0?n:r,!e&&r>=n?t:UX(t,e,r)}var qX=zX,HX="\\ud800-\\udfff",WX="\\u0300-\\u036f",GX="\\ufe20-\\ufe2f",KX="\\u20d0-\\u20ff",QX=WX+GX+KX,YX="\\ufe0e\\ufe0f",XX="\\u200d",JX=RegExp("["+XX+HX+QX+YX+"]");function ZX(t){return JX.test(t)}var mR=ZX;function eJ(t){return t.split("")}var tJ=eJ,pR="\\ud800-\\udfff",rJ="\\u0300-\\u036f",nJ="\\ufe20-\\ufe2f",aJ="\\u20d0-\\u20ff",sJ=rJ+nJ+aJ,iJ="\\ufe0e\\ufe0f",oJ="["+pR+"]",$j="["+sJ+"]",Lj="\\ud83c[\\udffb-\\udfff]",lJ="(?:"+$j+"|"+Lj+")",gR="[^"+pR+"]",yR="(?:\\ud83c[\\udde6-\\uddff]){2}",xR="[\\ud800-\\udbff][\\udc00-\\udfff]",cJ="\\u200d",vR=lJ+"?",bR="["+iJ+"]?",uJ="(?:"+cJ+"(?:"+[gR,yR,xR].join("|")+")"+bR+vR+")*",dJ=bR+vR+uJ,hJ="(?:"+[gR+$j+"?",$j,yR,xR,oJ].join("|")+")",fJ=RegExp(Lj+"(?="+Lj+")|"+hJ+dJ,"g");function mJ(t){return t.match(fJ)||[]}var pJ=mJ,gJ=tJ,yJ=mR,xJ=pJ;function vJ(t){return yJ(t)?xJ(t):gJ(t)}var bJ=vJ,wJ=qX,jJ=mR,NJ=bJ,_J=lR;function SJ(t){return function(e){e=_J(e);var r=jJ(e)?NJ(e):void 0,n=r?r[0]:e.charAt(0),s=r?wJ(r,1).join(""):e.slice(1);return n[t]()+s}}var CJ=SJ,EJ=CJ,PJ=EJ("toUpperCase"),TJ=PJ;const Bx=er(TJ);function pr(t){return function(){return t}}const wR=Math.cos,A0=Math.sin,zs=Math.sqrt,I0=Math.PI,Ux=2*I0,Vj=Math.PI,Fj=2*Vj,Cl=1e-6,AJ=Fj-Cl;function jR(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function IJ(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return jR;const r=10**e;return function(n){this._+=n[0];for(let s=1,i=n.length;s<i;++s)this._+=Math.round(arguments[s]*r)/r+n[s]}}class kJ{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?jR:IJ(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,s){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(e,r,n,s,i,o){this._append`C${+e},${+r},${+n},${+s},${this._x1=+i},${this._y1=+o}`}arcTo(e,r,n,s,i){if(e=+e,r=+r,n=+n,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=n-e,u=s-r,d=o-e,h=l-r,f=d*d+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(f>Cl)if(!(Math.abs(h*c-u*d)>Cl)||!i)this._append`L${this._x1=e},${this._y1=r}`;else{let m=n-o,y=s-l,g=c*c+u*u,x=m*m+y*y,b=Math.sqrt(g),v=Math.sqrt(f),j=i*Math.tan((Vj-Math.acos((g+f-x)/(2*b*v)))/2),S=j/v,_=j/b;Math.abs(S-1)>Cl&&this._append`L${e+S*d},${r+S*h}`,this._append`A${i},${i},0,0,${+(h*m>d*y)},${this._x1=e+_*c},${this._y1=r+_*u}`}}arc(e,r,n,s,i,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(s),c=n*Math.sin(s),u=e+l,d=r+c,h=1^o,f=o?s-i:i-s;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Cl||Math.abs(this._y1-d)>Cl)&&this._append`L${u},${d}`,n&&(f<0&&(f=f%Fj+Fj),f>AJ?this._append`A${n},${n},0,1,${h},${e-l},${r-c}A${n},${n},0,1,${h},${this._x1=u},${this._y1=d}`:f>Cl&&this._append`A${n},${n},0,${+(f>=Vj)},${h},${this._x1=e+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(e,r,n,s){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function xS(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new kJ(e)}function vS(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function NR(t){this._context=t}NR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function zx(t){return new NR(t)}function _R(t){return t[0]}function SR(t){return t[1]}function CR(t,e){var r=pr(!0),n=null,s=zx,i=null,o=xS(l);t=typeof t=="function"?t:t===void 0?_R:pr(t),e=typeof e=="function"?e:e===void 0?SR:pr(e);function l(c){var u,d=(c=vS(c)).length,h,f=!1,m;for(n==null&&(i=s(m=o())),u=0;u<=d;++u)!(u<d&&r(h=c[u],u,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+t(h,u,c),+e(h,u,c));if(m)return i=null,m+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:pr(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:pr(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:pr(!!c),l):r},l.curve=function(c){return arguments.length?(s=c,n!=null&&(i=s(n)),l):s},l.context=function(c){return arguments.length?(c==null?n=i=null:i=s(n=c),l):n},l}function Bp(t,e,r){var n=null,s=pr(!0),i=null,o=zx,l=null,c=xS(u);t=typeof t=="function"?t:t===void 0?_R:pr(+t),e=typeof e=="function"?e:pr(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?SR:pr(+r);function u(h){var f,m,y,g=(h=vS(h)).length,x,b=!1,v,j=new Array(g),S=new Array(g);for(i==null&&(l=o(v=c())),f=0;f<=g;++f){if(!(f<g&&s(x=h[f],f,h))===b)if(b=!b)m=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),y=f-1;y>=m;--y)l.point(j[y],S[y]);l.lineEnd(),l.areaEnd()}b&&(j[f]=+t(x,f,h),S[f]=+e(x,f,h),l.point(n?+n(x,f,h):j[f],r?+r(x,f,h):S[f]))}if(v)return l=null,v+""||null}function d(){return CR().defined(s).curve(o).context(i)}return u.x=function(h){return arguments.length?(t=typeof h=="function"?h:pr(+h),n=null,u):t},u.x0=function(h){return arguments.length?(t=typeof h=="function"?h:pr(+h),u):t},u.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:pr(+h),u):n},u.y=function(h){return arguments.length?(e=typeof h=="function"?h:pr(+h),r=null,u):e},u.y0=function(h){return arguments.length?(e=typeof h=="function"?h:pr(+h),u):e},u.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:pr(+h),u):r},u.lineX0=u.lineY0=function(){return d().x(t).y(e)},u.lineY1=function(){return d().x(t).y(r)},u.lineX1=function(){return d().x(n).y(e)},u.defined=function(h){return arguments.length?(s=typeof h=="function"?h:pr(!!h),u):s},u.curve=function(h){return arguments.length?(o=h,i!=null&&(l=o(i)),u):o},u.context=function(h){return arguments.length?(h==null?i=l=null:l=o(i=h),u):i},u}class ER{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function OJ(t){return new ER(t,!0)}function DJ(t){return new ER(t,!1)}const bS={draw(t,e){const r=zs(e/I0);t.moveTo(r,0),t.arc(0,0,r,0,Ux)}},MJ={draw(t,e){const r=zs(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},PR=zs(1/3),RJ=PR*2,$J={draw(t,e){const r=zs(e/RJ),n=r*PR;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},LJ={draw(t,e){const r=zs(e),n=-r/2;t.rect(n,n,r,r)}},VJ=.8908130915292852,TR=A0(I0/10)/A0(7*I0/10),FJ=A0(Ux/10)*TR,BJ=-wR(Ux/10)*TR,UJ={draw(t,e){const r=zs(e*VJ),n=FJ*r,s=BJ*r;t.moveTo(0,-r),t.lineTo(n,s);for(let i=1;i<5;++i){const o=Ux*i/5,l=wR(o),c=A0(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*s,c*n+l*s)}t.closePath()}},wb=zs(3),zJ={draw(t,e){const r=-zs(e/(wb*3));t.moveTo(0,r*2),t.lineTo(-wb*r,-r),t.lineTo(wb*r,-r),t.closePath()}},Xa=-.5,Ja=zs(3)/2,Bj=1/zs(12),qJ=(Bj/2+1)*3,HJ={draw(t,e){const r=zs(e/qJ),n=r/2,s=r*Bj,i=n,o=r*Bj+r,l=-i,c=o;t.moveTo(n,s),t.lineTo(i,o),t.lineTo(l,c),t.lineTo(Xa*n-Ja*s,Ja*n+Xa*s),t.lineTo(Xa*i-Ja*o,Ja*i+Xa*o),t.lineTo(Xa*l-Ja*c,Ja*l+Xa*c),t.lineTo(Xa*n+Ja*s,Xa*s-Ja*n),t.lineTo(Xa*i+Ja*o,Xa*o-Ja*i),t.lineTo(Xa*l+Ja*c,Xa*c-Ja*l),t.closePath()}};function WJ(t,e){let r=null,n=xS(s);t=typeof t=="function"?t:pr(t||bS),e=typeof e=="function"?e:pr(e===void 0?64:+e);function s(){let i;if(r||(r=i=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),i)return r=null,i+""||null}return s.type=function(i){return arguments.length?(t=typeof i=="function"?i:pr(i),s):t},s.size=function(i){return arguments.length?(e=typeof i=="function"?i:pr(+i),s):e},s.context=function(i){return arguments.length?(r=i??null,s):r},s}function k0(){}function O0(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function AR(t){this._context=t}AR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:O0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:O0(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function GJ(t){return new AR(t)}function IR(t){this._context=t}IR.prototype={areaStart:k0,areaEnd:k0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:O0(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function KJ(t){return new IR(t)}function kR(t){this._context=t}kR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:O0(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function QJ(t){return new kR(t)}function OR(t){this._context=t}OR.prototype={areaStart:k0,areaEnd:k0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function YJ(t){return new OR(t)}function WP(t){return t<0?-1:1}function GP(t,e,r){var n=t._x1-t._x0,s=e-t._x1,i=(t._y1-t._y0)/(n||s<0&&-0),o=(r-t._y1)/(s||n<0&&-0),l=(i*s+o*n)/(n+s);return(WP(i)+WP(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function KP(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function jb(t,e,r){var n=t._x0,s=t._y0,i=t._x1,o=t._y1,l=(i-n)/3;t._context.bezierCurveTo(n+l,s+l*e,i-l,o-l*r,i,o)}function D0(t){this._context=t}D0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jb(this,this._t0,KP(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,jb(this,KP(this,r=GP(this,t,e)),r);break;default:jb(this,this._t0,r=GP(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function DR(t){this._context=new MR(t)}(DR.prototype=Object.create(D0.prototype)).point=function(t,e){D0.prototype.point.call(this,e,t)};function MR(t){this._context=t}MR.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,s,i){this._context.bezierCurveTo(e,t,n,r,i,s)}};function XJ(t){return new D0(t)}function JJ(t){return new DR(t)}function RR(t){this._context=t}RR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=QP(t),s=QP(e),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],s[0][i],n[1][i],s[1][i],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function QP(t){var e,r=t.length-1,n,s=new Array(r),i=new Array(r),o=new Array(r);for(s[0]=0,i[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)s[e]=1,i[e]=4,o[e]=4*t[e]+2*t[e+1];for(s[r-1]=2,i[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=s[e]/i[e-1],i[e]-=n,o[e]-=n*o[e-1];for(s[r-1]=o[r-1]/i[r-1],e=r-2;e>=0;--e)s[e]=(o[e]-s[e+1])/i[e];for(i[r-1]=(t[r]+s[r-1])/2,e=0;e<r-1;++e)i[e]=2*t[e+1]-s[e+1];return[s,i]}function ZJ(t){return new RR(t)}function qx(t,e){this._context=t,this._t=e}qx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function eZ(t){return new qx(t,.5)}function tZ(t){return new qx(t,0)}function rZ(t){return new qx(t,1)}function Wu(t,e){if((o=t.length)>1)for(var r=1,n,s,i=t[e[0]],o,l=i.length;r<o;++r)for(s=i,i=t[e[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function Uj(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function nZ(t,e){return t[e]}function aZ(t){const e=[];return e.key=t,e}function sZ(){var t=pr([]),e=Uj,r=Wu,n=nZ;function s(i){var o=Array.from(t.apply(this,arguments),aZ),l,c=o.length,u=-1,d;for(const h of i)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(h,o[l].key,u,i)]).data=h;for(l=0,d=vS(e(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return s.keys=function(i){return arguments.length?(t=typeof i=="function"?i:pr(Array.from(i)),s):t},s.value=function(i){return arguments.length?(n=typeof i=="function"?i:pr(+i),s):n},s.order=function(i){return arguments.length?(e=i==null?Uj:typeof i=="function"?i:pr(Array.from(i)),s):e},s.offset=function(i){return arguments.length?(r=i??Wu,s):r},s}function iZ(t,e){if((n=t.length)>0){for(var r,n,s=0,i=t[0].length,o;s<i;++s){for(o=r=0;r<n;++r)o+=t[r][s][1]||0;if(o)for(r=0;r<n;++r)t[r][s][1]/=o}Wu(t,e)}}function oZ(t,e){if((s=t.length)>0){for(var r=0,n=t[e[0]],s,i=n.length;r<i;++r){for(var o=0,l=0;o<s;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}Wu(t,e)}}function lZ(t,e){if(!(!((o=t.length)>0)||!((i=(s=t[e[0]]).length)>0))){for(var r=0,n=1,s,i,o;n<i;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=t[e[l]],h=d[n][1]||0,f=d[n-1][1]||0,m=(h-f)/2,y=0;y<l;++y){var g=t[e[y]],x=g[n][1]||0,b=g[n-1][1]||0;m+=x-b}c+=h,u+=m*h}s[n-1][1]+=s[n-1][0]=r,c&&(r-=u/c)}s[n-1][1]+=s[n-1][0]=r,Wu(t,e)}}function Bf(t){"@babel/helpers - typeof";return Bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bf(t)}var cZ=["type","size","sizeType"];function zj(){return zj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zj.apply(this,arguments)}function YP(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function XP(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YP(Object(r),!0).forEach(function(n){uZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YP(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function uZ(t,e,r){return e=dZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dZ(t){var e=hZ(t,"string");return Bf(e)=="symbol"?e:e+""}function hZ(t,e){if(Bf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fZ(t,e){if(t==null)return{};var r=mZ(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function mZ(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var $R={symbolCircle:bS,symbolCross:MJ,symbolDiamond:$J,symbolSquare:LJ,symbolStar:UJ,symbolTriangle:zJ,symbolWye:HJ},pZ=Math.PI/180,gZ=function(e){var r="symbol".concat(Bx(e));return $R[r]||bS},yZ=function(e,r,n){if(r==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*pZ;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.pow(Math.tan(s),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},xZ=function(e,r){$R["symbol".concat(Bx(e))]=r},wS=function(e){var r=e.type,n=r===void 0?"circle":r,s=e.size,i=s===void 0?64:s,o=e.sizeType,l=o===void 0?"area":o,c=fZ(e,cZ),u=XP(XP({},c),{},{type:n,size:i,sizeType:l}),d=function(){var x=gZ(n),b=WJ().type(x).size(yZ(i,l,n));return b()},h=u.className,f=u.cx,m=u.cy,y=ft(u,!0);return f===+f&&m===+m&&i===+i?ee.createElement("path",zj({},y,{className:At("recharts-symbols",h),transform:"translate(".concat(f,", ").concat(m,")"),d:d()})):null};wS.registerSymbol=xZ;function Gu(t){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gu(t)}function qj(){return qj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qj.apply(this,arguments)}function JP(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function vZ(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JP(Object(r),!0).forEach(function(n){Uf(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JP(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wZ(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,VR(n.key),n)}}function jZ(t,e,r){return e&&wZ(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function NZ(t,e,r){return e=M0(e),_Z(t,LR()?Reflect.construct(e,r||[],M0(t).constructor):e.apply(t,r))}function _Z(t,e){if(e&&(Gu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SZ(t)}function SZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function LR(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LR=function(){return!!t})()}function M0(t){return M0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},M0(t)}function CZ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hj(t,e)}function Hj(t,e){return Hj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Hj(t,e)}function Uf(t,e,r){return e=VR(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VR(t){var e=EZ(t,"string");return Gu(e)=="symbol"?e:e+""}function EZ(t,e){if(Gu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Za=32,jS=function(t){function e(){return bZ(this,e),NZ(this,e,arguments)}return CZ(e,t),jZ(e,[{key:"renderIcon",value:function(n){var s=this.props.inactiveColor,i=Za/2,o=Za/6,l=Za/3,c=n.inactive?s:n.color;if(n.type==="plainline")return ee.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Za,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return ee.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(Za,"M").concat(2*l,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return ee.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Za/8,"h").concat(Za,"v").concat(Za*3/4,"h").concat(-Za,"z"),className:"recharts-legend-icon"});if(ee.isValidElement(n.legendIcon)){var u=vZ({},n);return delete u.legendIcon,ee.cloneElement(n.legendIcon,u)}return ee.createElement(wS,{fill:c,cx:i,cy:i,size:Za,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,s=this.props,i=s.payload,o=s.iconSize,l=s.layout,c=s.formatter,u=s.inactiveColor,d={x:0,y:0,width:Za,height:Za},h={display:l==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,y){var g=m.formatter||c,x=At(Uf(Uf({"recharts-legend-item":!0},"legend-item-".concat(y),!0),"inactive",m.inactive));if(m.type==="none")return null;var b=bt(m.value)?null:m.value;Ls(!bt(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var v=m.inactive?u:m.color;return ee.createElement("li",qj({className:x,style:h,key:"legend-item-".concat(y)},cc(n.props,m,y)),ee.createElement(Mj,{width:o,height:o,viewBox:d,style:f},n.renderIcon(m)),ee.createElement("span",{className:"recharts-legend-item-text",style:{color:v}},g?g(b,m,y):b))})}},{key:"render",value:function(){var n=this.props,s=n.payload,i=n.layout,o=n.align;if(!s||!s.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return ee.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(I.PureComponent);Uf(jS,"displayName","Legend");Uf(jS,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var PZ=Px;function TZ(){this.__data__=new PZ,this.size=0}var AZ=TZ;function IZ(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var kZ=IZ;function OZ(t){return this.__data__.get(t)}var DZ=OZ;function MZ(t){return this.__data__.has(t)}var RZ=MZ,$Z=Px,LZ=cS,VZ=uS,FZ=200;function BZ(t,e){var r=this.__data__;if(r instanceof $Z){var n=r.__data__;if(!LZ||n.length<FZ-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new VZ(n)}return r.set(t,e),this.size=r.size,this}var UZ=BZ,zZ=Px,qZ=AZ,HZ=kZ,WZ=DZ,GZ=RZ,KZ=UZ;function Fd(t){var e=this.__data__=new zZ(t);this.size=e.size}Fd.prototype.clear=qZ;Fd.prototype.delete=HZ;Fd.prototype.get=WZ;Fd.prototype.has=GZ;Fd.prototype.set=KZ;var FR=Fd,QZ="__lodash_hash_undefined__";function YZ(t){return this.__data__.set(t,QZ),this}var XZ=YZ;function JZ(t){return this.__data__.has(t)}var ZZ=JZ,eee=uS,tee=XZ,ree=ZZ;function R0(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new eee;++e<r;)this.add(t[e])}R0.prototype.add=R0.prototype.push=tee;R0.prototype.has=ree;var BR=R0;function nee(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var UR=nee;function aee(t,e){return t.has(e)}var zR=aee,see=BR,iee=UR,oee=zR,lee=1,cee=2;function uee(t,e,r,n,s,i){var o=r&lee,l=t.length,c=e.length;if(l!=c&&!(o&&c>l))return!1;var u=i.get(t),d=i.get(e);if(u&&d)return u==e&&d==t;var h=-1,f=!0,m=r&cee?new see:void 0;for(i.set(t,e),i.set(e,t);++h<l;){var y=t[h],g=e[h];if(n)var x=o?n(g,y,h,e,t,i):n(y,g,h,t,e,i);if(x!==void 0){if(x)continue;f=!1;break}if(m){if(!iee(e,function(b,v){if(!oee(m,v)&&(y===b||s(y,b,r,n,i)))return m.push(v)})){f=!1;break}}else if(!(y===g||s(y,g,r,n,i))){f=!1;break}}return i.delete(t),i.delete(e),f}var qR=uee,dee=fi,hee=dee.Uint8Array,fee=hee;function mee(t){var e=-1,r=Array(t.size);return t.forEach(function(n,s){r[++e]=[s,n]}),r}var pee=mee;function gee(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var NS=gee,ZP=Km,eT=fee,yee=lS,xee=qR,vee=pee,bee=NS,wee=1,jee=2,Nee="[object Boolean]",_ee="[object Date]",See="[object Error]",Cee="[object Map]",Eee="[object Number]",Pee="[object RegExp]",Tee="[object Set]",Aee="[object String]",Iee="[object Symbol]",kee="[object ArrayBuffer]",Oee="[object DataView]",tT=ZP?ZP.prototype:void 0,Nb=tT?tT.valueOf:void 0;function Dee(t,e,r,n,s,i,o){switch(r){case Oee:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case kee:return!(t.byteLength!=e.byteLength||!i(new eT(t),new eT(e)));case Nee:case _ee:case Eee:return yee(+t,+e);case See:return t.name==e.name&&t.message==e.message;case Pee:case Aee:return t==e+"";case Cee:var l=vee;case Tee:var c=n&wee;if(l||(l=bee),t.size!=e.size&&!c)return!1;var u=o.get(t);if(u)return u==e;n|=jee,o.set(t,e);var d=xee(l(t),l(e),n,s,i,o);return o.delete(t),d;case Iee:if(Nb)return Nb.call(t)==Nb.call(e)}return!1}var Mee=Dee;function Ree(t,e){for(var r=-1,n=e.length,s=t.length;++r<n;)t[s+r]=e[r];return t}var HR=Ree,$ee=HR,Lee=Ea;function Vee(t,e,r){var n=e(t);return Lee(t)?n:$ee(n,r(t))}var Fee=Vee;function Bee(t,e){for(var r=-1,n=t==null?0:t.length,s=0,i=[];++r<n;){var o=t[r];e(o,r,t)&&(i[s++]=o)}return i}var Uee=Bee;function zee(){return[]}var qee=zee,Hee=Uee,Wee=qee,Gee=Object.prototype,Kee=Gee.propertyIsEnumerable,rT=Object.getOwnPropertySymbols,Qee=rT?function(t){return t==null?[]:(t=Object(t),Hee(rT(t),function(e){return Kee.call(t,e)}))}:Wee,Yee=Qee;function Xee(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Jee=Xee,Zee=no,ete=ao,tte="[object Arguments]";function rte(t){return ete(t)&&Zee(t)==tte}var nte=rte,nT=nte,ate=ao,WR=Object.prototype,ste=WR.hasOwnProperty,ite=WR.propertyIsEnumerable,ote=nT(function(){return arguments}())?nT:function(t){return ate(t)&&ste.call(t,"callee")&&!ite.call(t,"callee")},_S=ote,$0={exports:{}};function lte(){return!1}var cte=lte;$0.exports;(function(t,e){var r=fi,n=cte,s=e&&!e.nodeType&&e,i=s&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===s,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;t.exports=u})($0,$0.exports);var GR=$0.exports,ute=9007199254740991,dte=/^(?:0|[1-9]\d*)$/;function hte(t,e){var r=typeof t;return e=e??ute,!!e&&(r=="number"||r!="symbol"&&dte.test(t))&&t>-1&&t%1==0&&t<e}var SS=hte,fte=9007199254740991;function mte(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=fte}var CS=mte,pte=no,gte=CS,yte=ao,xte="[object Arguments]",vte="[object Array]",bte="[object Boolean]",wte="[object Date]",jte="[object Error]",Nte="[object Function]",_te="[object Map]",Ste="[object Number]",Cte="[object Object]",Ete="[object RegExp]",Pte="[object Set]",Tte="[object String]",Ate="[object WeakMap]",Ite="[object ArrayBuffer]",kte="[object DataView]",Ote="[object Float32Array]",Dte="[object Float64Array]",Mte="[object Int8Array]",Rte="[object Int16Array]",$te="[object Int32Array]",Lte="[object Uint8Array]",Vte="[object Uint8ClampedArray]",Fte="[object Uint16Array]",Bte="[object Uint32Array]",wr={};wr[Ote]=wr[Dte]=wr[Mte]=wr[Rte]=wr[$te]=wr[Lte]=wr[Vte]=wr[Fte]=wr[Bte]=!0;wr[xte]=wr[vte]=wr[Ite]=wr[bte]=wr[kte]=wr[wte]=wr[jte]=wr[Nte]=wr[_te]=wr[Ste]=wr[Cte]=wr[Ete]=wr[Pte]=wr[Tte]=wr[Ate]=!1;function Ute(t){return yte(t)&&gte(t.length)&&!!wr[pte(t)]}var zte=Ute;function qte(t){return function(e){return t(e)}}var KR=qte,L0={exports:{}};L0.exports;(function(t,e){var r=rR,n=e&&!e.nodeType&&e,s=n&&!0&&t&&!t.nodeType&&t,i=s&&s.exports===n,o=i&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();t.exports=l})(L0,L0.exports);var Hte=L0.exports,Wte=zte,Gte=KR,aT=Hte,sT=aT&&aT.isTypedArray,Kte=sT?Gte(sT):Wte,QR=Kte,Qte=Jee,Yte=_S,Xte=Ea,Jte=GR,Zte=SS,ere=QR,tre=Object.prototype,rre=tre.hasOwnProperty;function nre(t,e){var r=Xte(t),n=!r&&Yte(t),s=!r&&!n&&Jte(t),i=!r&&!n&&!s&&ere(t),o=r||n||s||i,l=o?Qte(t.length,String):[],c=l.length;for(var u in t)(e||rre.call(t,u))&&!(o&&(u=="length"||s&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Zte(u,c)))&&l.push(u);return l}var are=nre,sre=Object.prototype;function ire(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||sre;return t===r}var ore=ire;function lre(t,e){return function(r){return t(e(r))}}var YR=lre,cre=YR,ure=cre(Object.keys,Object),dre=ure,hre=ore,fre=dre,mre=Object.prototype,pre=mre.hasOwnProperty;function gre(t){if(!hre(t))return fre(t);var e=[];for(var r in Object(t))pre.call(t,r)&&r!="constructor"&&e.push(r);return e}var yre=gre,xre=oS,vre=CS;function bre(t){return t!=null&&vre(t.length)&&!xre(t)}var Qm=bre,wre=are,jre=yre,Nre=Qm;function _re(t){return Nre(t)?wre(t):jre(t)}var Hx=_re,Sre=Fee,Cre=Yee,Ere=Hx;function Pre(t){return Sre(t,Ere,Cre)}var Tre=Pre,iT=Tre,Are=1,Ire=Object.prototype,kre=Ire.hasOwnProperty;function Ore(t,e,r,n,s,i){var o=r&Are,l=iT(t),c=l.length,u=iT(e),d=u.length;if(c!=d&&!o)return!1;for(var h=c;h--;){var f=l[h];if(!(o?f in e:kre.call(e,f)))return!1}var m=i.get(t),y=i.get(e);if(m&&y)return m==e&&y==t;var g=!0;i.set(t,e),i.set(e,t);for(var x=o;++h<c;){f=l[h];var b=t[f],v=e[f];if(n)var j=o?n(v,b,f,e,t,i):n(b,v,f,t,e,i);if(!(j===void 0?b===v||s(b,v,r,n,i):j)){g=!1;break}x||(x=f=="constructor")}if(g&&!x){var S=t.constructor,_=e.constructor;S!=_&&"constructor"in t&&"constructor"in e&&!(typeof S=="function"&&S instanceof S&&typeof _=="function"&&_ instanceof _)&&(g=!1)}return i.delete(t),i.delete(e),g}var Dre=Ore,Mre=jc,Rre=fi,$re=Mre(Rre,"DataView"),Lre=$re,Vre=jc,Fre=fi,Bre=Vre(Fre,"Promise"),Ure=Bre,zre=jc,qre=fi,Hre=zre(qre,"Set"),XR=Hre,Wre=jc,Gre=fi,Kre=Wre(Gre,"WeakMap"),Qre=Kre,Wj=Lre,Gj=cS,Kj=Ure,Qj=XR,Yj=Qre,JR=no,Bd=aR,oT="[object Map]",Yre="[object Object]",lT="[object Promise]",cT="[object Set]",uT="[object WeakMap]",dT="[object DataView]",Xre=Bd(Wj),Jre=Bd(Gj),Zre=Bd(Kj),ene=Bd(Qj),tne=Bd(Yj),El=JR;(Wj&&El(new Wj(new ArrayBuffer(1)))!=dT||Gj&&El(new Gj)!=oT||Kj&&El(Kj.resolve())!=lT||Qj&&El(new Qj)!=cT||Yj&&El(new Yj)!=uT)&&(El=function(t){var e=JR(t),r=e==Yre?t.constructor:void 0,n=r?Bd(r):"";if(n)switch(n){case Xre:return dT;case Jre:return oT;case Zre:return lT;case ene:return cT;case tne:return uT}return e});var rne=El,_b=FR,nne=qR,ane=Mee,sne=Dre,hT=rne,fT=Ea,mT=GR,ine=QR,one=1,pT="[object Arguments]",gT="[object Array]",Up="[object Object]",lne=Object.prototype,yT=lne.hasOwnProperty;function cne(t,e,r,n,s,i){var o=fT(t),l=fT(e),c=o?gT:hT(t),u=l?gT:hT(e);c=c==pT?Up:c,u=u==pT?Up:u;var d=c==Up,h=u==Up,f=c==u;if(f&&mT(t)){if(!mT(e))return!1;o=!0,d=!1}if(f&&!d)return i||(i=new _b),o||ine(t)?nne(t,e,r,n,s,i):ane(t,e,c,r,n,s,i);if(!(r&one)){var m=d&&yT.call(t,"__wrapped__"),y=h&&yT.call(e,"__wrapped__");if(m||y){var g=m?t.value():t,x=y?e.value():e;return i||(i=new _b),s(g,x,r,n,i)}}return f?(i||(i=new _b),sne(t,e,r,n,s,i)):!1}var une=cne,dne=une,xT=ao;function ZR(t,e,r,n,s){return t===e?!0:t==null||e==null||!xT(t)&&!xT(e)?t!==t&&e!==e:dne(t,e,r,n,ZR,s)}var ES=ZR,hne=FR,fne=ES,mne=1,pne=2;function gne(t,e,r,n){var s=r.length,i=s,o=!n;if(t==null)return!i;for(t=Object(t);s--;){var l=r[s];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++s<i;){l=r[s];var c=l[0],u=t[c],d=l[1];if(o&&l[2]){if(u===void 0&&!(c in t))return!1}else{var h=new hne;if(n)var f=n(u,d,c,t,e,h);if(!(f===void 0?fne(d,u,mne|pne,n,h):f))return!1}}return!0}var yne=gne,xne=il;function vne(t){return t===t&&!xne(t)}var e4=vne,bne=e4,wne=Hx;function jne(t){for(var e=wne(t),r=e.length;r--;){var n=e[r],s=t[n];e[r]=[n,s,bne(s)]}return e}var Nne=jne;function _ne(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var t4=_ne,Sne=yne,Cne=Nne,Ene=t4;function Pne(t){var e=Cne(t);return e.length==1&&e[0][2]?Ene(e[0][0],e[0][1]):function(r){return r===t||Sne(r,t,e)}}var Tne=Pne;function Ane(t,e){return t!=null&&e in Object(t)}var Ine=Ane,kne=cR,One=_S,Dne=Ea,Mne=SS,Rne=CS,$ne=Ax;function Lne(t,e,r){e=kne(e,t);for(var n=-1,s=e.length,i=!1;++n<s;){var o=$ne(e[n]);if(!(i=t!=null&&r(t,o)))break;t=t[o]}return i||++n!=s?i:(s=t==null?0:t.length,!!s&&Rne(s)&&Mne(o,s)&&(Dne(t)||One(t)))}var Vne=Lne,Fne=Ine,Bne=Vne;function Une(t,e){return t!=null&&Bne(t,e,Fne)}var zne=Une,qne=ES,Hne=uR,Wne=zne,Gne=iS,Kne=e4,Qne=t4,Yne=Ax,Xne=1,Jne=2;function Zne(t,e){return Gne(t)&&Kne(e)?Qne(Yne(t),e):function(r){var n=Hne(r,t);return n===void 0&&n===e?Wne(r,t):qne(e,n,Xne|Jne)}}var eae=Zne;function tae(t){return t}var Ud=tae;function rae(t){return function(e){return e==null?void 0:e[t]}}var nae=rae,aae=fS;function sae(t){return function(e){return aae(e,t)}}var iae=sae,oae=nae,lae=iae,cae=iS,uae=Ax;function dae(t){return cae(t)?oae(uae(t)):lae(t)}var hae=dae,fae=Tne,mae=eae,pae=Ud,gae=Ea,yae=hae;function xae(t){return typeof t=="function"?t:t==null?pae:typeof t=="object"?gae(t)?mae(t[0],t[1]):fae(t):yae(t)}var mi=xae;function vae(t,e,r,n){for(var s=t.length,i=r+(n?1:-1);n?i--:++i<s;)if(e(t[i],i,t))return i;return-1}var r4=vae;function bae(t){return t!==t}var wae=bae;function jae(t,e,r){for(var n=r-1,s=t.length;++n<s;)if(t[n]===e)return n;return-1}var Nae=jae,_ae=r4,Sae=wae,Cae=Nae;function Eae(t,e,r){return e===e?Cae(t,e,r):_ae(t,Sae,r)}var Pae=Eae,Tae=Pae;function Aae(t,e){var r=t==null?0:t.length;return!!r&&Tae(t,e,0)>-1}var Iae=Aae;function kae(t,e,r){for(var n=-1,s=t==null?0:t.length;++n<s;)if(r(e,t[n]))return!0;return!1}var Oae=kae;function Dae(){}var Mae=Dae,Sb=XR,Rae=Mae,$ae=NS,Lae=1/0,Vae=Sb&&1/$ae(new Sb([,-0]))[1]==Lae?function(t){return new Sb(t)}:Rae,Fae=Vae,Bae=BR,Uae=Iae,zae=Oae,qae=zR,Hae=Fae,Wae=NS,Gae=200;function Kae(t,e,r){var n=-1,s=Uae,i=t.length,o=!0,l=[],c=l;if(r)o=!1,s=zae;else if(i>=Gae){var u=e?null:Hae(t);if(u)return Wae(u);o=!1,s=qae,c=new Bae}else c=e?[]:l;e:for(;++n<i;){var d=t[n],h=e?e(d):d;if(d=r||d!==0?d:0,o&&h===h){for(var f=c.length;f--;)if(c[f]===h)continue e;e&&c.push(h),l.push(d)}else s(c,h,r)||(c!==l&&c.push(h),l.push(d))}return l}var Qae=Kae,Yae=mi,Xae=Qae;function Jae(t,e){return t&&t.length?Xae(t,Yae(e)):[]}var Zae=Jae;const vT=er(Zae);function n4(t,e,r){return e===!0?vT(t,r):bt(e)?vT(t,e):t}function Ku(t){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ku(t)}var ese=["ref"];function bT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function yi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bT(Object(r),!0).forEach(function(n){Wx(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tse(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wT(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s4(n.key),n)}}function rse(t,e,r){return e&&wT(t.prototype,e),r&&wT(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function nse(t,e,r){return e=V0(e),ase(t,a4()?Reflect.construct(e,r||[],V0(t).constructor):e.apply(t,r))}function ase(t,e){if(e&&(Ku(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sse(t)}function sse(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a4(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(a4=function(){return!!t})()}function V0(t){return V0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},V0(t)}function ise(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xj(t,e)}function Xj(t,e){return Xj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Xj(t,e)}function Wx(t,e,r){return e=s4(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s4(t){var e=ose(t,"string");return Ku(e)=="symbol"?e:e+""}function ose(t,e){if(Ku(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ku(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lse(t,e){if(t==null)return{};var r=cse(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function cse(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function use(t){return t.value}function dse(t,e){if(ee.isValidElement(t))return ee.cloneElement(t,e);if(typeof t=="function")return ee.createElement(t,e);e.ref;var r=lse(e,ese);return ee.createElement(jS,r)}var jT=1,wu=function(t){function e(){var r;tse(this,e);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return r=nse(this,e,[].concat(s)),Wx(r,"lastBoundingBox",{width:-1,height:-1}),r}return ise(e,t),rse(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,s=this.getBBox();s?(Math.abs(s.width-this.lastBoundingBox.width)>jT||Math.abs(s.height-this.lastBoundingBox.height)>jT)&&(this.lastBoundingBox.width=s.width,this.lastBoundingBox.height=s.height,n&&n(s)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?yi({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var s=this.props,i=s.layout,o=s.align,l=s.verticalAlign,c=s.margin,u=s.chartWidth,d=s.chartHeight,h,f;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();h={left:((u||0)-m.width)/2}}else h=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var y=this.getBBoxSnapshot();f={top:((d||0)-y.height)/2}}else f=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return yi(yi({},h),f)}},{key:"render",value:function(){var n=this,s=this.props,i=s.content,o=s.width,l=s.height,c=s.wrapperStyle,u=s.payloadUniqBy,d=s.payload,h=yi(yi({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return ee.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(m){n.wrapperNode=m}},dse(i,yi(yi({},this.props),{},{payload:n4(d,u,use)})))}}],[{key:"getWithHeight",value:function(n,s){var i=yi(yi({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&Me(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||s}:null}}])}(I.PureComponent);Wx(wu,"displayName","Legend");Wx(wu,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var NT=Km,hse=_S,fse=Ea,_T=NT?NT.isConcatSpreadable:void 0;function mse(t){return fse(t)||hse(t)||!!(_T&&t&&t[_T])}var pse=mse,gse=HR,yse=pse;function i4(t,e,r,n,s){var i=-1,o=t.length;for(r||(r=yse),s||(s=[]);++i<o;){var l=t[i];e>0&&r(l)?e>1?i4(l,e-1,r,n,s):gse(s,l):n||(s[s.length]=l)}return s}var o4=i4;function xse(t){return function(e,r,n){for(var s=-1,i=Object(e),o=n(e),l=o.length;l--;){var c=o[t?l:++s];if(r(i[c],c,i)===!1)break}return e}}var vse=xse,bse=vse,wse=bse(),jse=wse,Nse=jse,_se=Hx;function Sse(t,e){return t&&Nse(t,e,_se)}var l4=Sse,Cse=Qm;function Ese(t,e){return function(r,n){if(r==null)return r;if(!Cse(r))return t(r,n);for(var s=r.length,i=e?s:-1,o=Object(r);(e?i--:++i<s)&&n(o[i],i,o)!==!1;);return r}}var Pse=Ese,Tse=l4,Ase=Pse,Ise=Ase(Tse),PS=Ise,kse=PS,Ose=Qm;function Dse(t,e){var r=-1,n=Ose(t)?Array(t.length):[];return kse(t,function(s,i,o){n[++r]=e(s,i,o)}),n}var c4=Dse;function Mse(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}var Rse=Mse,ST=Od;function $se(t,e){if(t!==e){var r=t!==void 0,n=t===null,s=t===t,i=ST(t),o=e!==void 0,l=e===null,c=e===e,u=ST(e);if(!l&&!u&&!i&&t>e||i&&o&&c&&!l&&!u||n&&o&&c||!r&&c||!s)return 1;if(!n&&!i&&!u&&t<e||u&&r&&s&&!n&&!i||l&&r&&s||!o&&s||!c)return-1}return 0}var Lse=$se,Vse=Lse;function Fse(t,e,r){for(var n=-1,s=t.criteria,i=e.criteria,o=s.length,l=r.length;++n<o;){var c=Vse(s[n],i[n]);if(c){if(n>=l)return c;var u=r[n];return c*(u=="desc"?-1:1)}}return t.index-e.index}var Bse=Fse,Cb=hS,Use=fS,zse=mi,qse=c4,Hse=Rse,Wse=KR,Gse=Bse,Kse=Ud,Qse=Ea;function Yse(t,e,r){e.length?e=Cb(e,function(i){return Qse(i)?function(o){return Use(o,i.length===1?i[0]:i)}:i}):e=[Kse];var n=-1;e=Cb(e,Wse(zse));var s=qse(t,function(i,o,l){var c=Cb(e,function(u){return u(i)});return{criteria:c,index:++n,value:i}});return Hse(s,function(i,o){return Gse(i,o,r)})}var Xse=Yse;function Jse(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var Zse=Jse,eie=Zse,CT=Math.max;function tie(t,e,r){return e=CT(e===void 0?t.length-1:e,0),function(){for(var n=arguments,s=-1,i=CT(n.length-e,0),o=Array(i);++s<i;)o[s]=n[e+s];s=-1;for(var l=Array(e+1);++s<e;)l[s]=n[s];return l[e]=r(o),eie(t,this,l)}}var rie=tie;function nie(t){return function(){return t}}var aie=nie,sie=jc,iie=function(){try{var t=sie(Object,"defineProperty");return t({},"",{}),t}catch{}}(),u4=iie,oie=aie,ET=u4,lie=Ud,cie=ET?function(t,e){return ET(t,"toString",{configurable:!0,enumerable:!1,value:oie(e),writable:!0})}:lie,uie=cie,die=800,hie=16,fie=Date.now;function mie(t){var e=0,r=0;return function(){var n=fie(),s=hie-(n-r);if(r=n,s>0){if(++e>=die)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var pie=mie,gie=uie,yie=pie,xie=yie(gie),vie=xie,bie=Ud,wie=rie,jie=vie;function Nie(t,e){return jie(wie(t,e,bie),t+"")}var _ie=Nie,Sie=lS,Cie=Qm,Eie=SS,Pie=il;function Tie(t,e,r){if(!Pie(r))return!1;var n=typeof e;return(n=="number"?Cie(r)&&Eie(e,r.length):n=="string"&&e in r)?Sie(r[e],t):!1}var Gx=Tie,Aie=o4,Iie=Xse,kie=_ie,PT=Gx,Oie=kie(function(t,e){if(t==null)return[];var r=e.length;return r>1&&PT(t,e[0],e[1])?e=[]:r>2&&PT(e[0],e[1],e[2])&&(e=[e[0]]),Iie(t,Aie(e,1),[])}),Die=Oie;const TS=er(Die);function zf(t){"@babel/helpers - typeof";return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zf(t)}function Jj(){return Jj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jj.apply(this,arguments)}function Mie(t,e){return Vie(t)||Lie(t,e)||$ie(t,e)||Rie()}function Rie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ie(t,e){if(t){if(typeof t=="string")return TT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TT(t,e)}}function TT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Lie(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function Vie(t){if(Array.isArray(t))return t}function AT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Eb(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?AT(Object(r),!0).forEach(function(n){Fie(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):AT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Fie(t,e,r){return e=Bie(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bie(t){var e=Uie(t,"string");return zf(e)=="symbol"?e:e+""}function Uie(t,e){if(zf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zie(t){return Array.isArray(t)&&cn(t[0])&&cn(t[1])?t.join(" ~ "):t}var qie=function(e){var r=e.separator,n=r===void 0?" : ":r,s=e.contentStyle,i=s===void 0?{}:s,o=e.itemStyle,l=o===void 0?{}:o,c=e.labelStyle,u=c===void 0?{}:c,d=e.payload,h=e.formatter,f=e.itemSorter,m=e.wrapperClassName,y=e.labelClassName,g=e.label,x=e.labelFormatter,b=e.accessibilityLayer,v=b===void 0?!1:b,j=function(){if(d&&d.length){var P={padding:0,margin:0},O=(f?TS(d,f):d).map(function(D,R){if(D.type==="none")return null;var B=Eb({display:"block",paddingTop:4,paddingBottom:4,color:D.color||"#000"},l),Y=D.formatter||h||zie,W=D.value,L=D.name,X=W,G=L;if(Y&&X!=null&&G!=null){var K=Y(W,L,D,R,d);if(Array.isArray(K)){var q=Mie(K,2);X=q[0],G=q[1]}else X=K}return ee.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(R),style:B},cn(G)?ee.createElement("span",{className:"recharts-tooltip-item-name"},G):null,cn(G)?ee.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,ee.createElement("span",{className:"recharts-tooltip-item-value"},X),ee.createElement("span",{className:"recharts-tooltip-item-unit"},D.unit||""))});return ee.createElement("ul",{className:"recharts-tooltip-item-list",style:P},O)}return null},S=Eb({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),_=Eb({margin:0},u),C=!Pt(g),N=C?g:"",w=At("recharts-default-tooltip",m),E=At("recharts-tooltip-label",y);C&&x&&d!==void 0&&d!==null&&(N=x(g,d));var k=v?{role:"status","aria-live":"assertive"}:{};return ee.createElement("div",Jj({className:w,style:S},k),ee.createElement("p",{className:E,style:_},ee.isValidElement(N)?N:"".concat(N)),j())};function qf(t){"@babel/helpers - typeof";return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qf(t)}function zp(t,e,r){return e=Hie(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hie(t){var e=Wie(t,"string");return qf(e)=="symbol"?e:e+""}function Wie(t,e){if(qf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mh="recharts-tooltip-wrapper",Gie={visibility:"hidden"};function Kie(t){var e=t.coordinate,r=t.translateX,n=t.translateY;return At(mh,zp(zp(zp(zp({},"".concat(mh,"-right"),Me(r)&&e&&Me(e.x)&&r>=e.x),"".concat(mh,"-left"),Me(r)&&e&&Me(e.x)&&r<e.x),"".concat(mh,"-bottom"),Me(n)&&e&&Me(e.y)&&n>=e.y),"".concat(mh,"-top"),Me(n)&&e&&Me(e.y)&&n<e.y))}function IT(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.key,s=t.offsetTopLeft,i=t.position,o=t.reverseDirection,l=t.tooltipDimension,c=t.viewBox,u=t.viewBoxDimension;if(i&&Me(i[n]))return i[n];var d=r[n]-l-s,h=r[n]+s;if(e[n])return o[n]?d:h;if(o[n]){var f=d,m=c[n];return f<m?Math.max(h,c[n]):Math.max(d,c[n])}var y=h+l,g=c[n]+u;return y>g?Math.max(d,c[n]):Math.max(h,c[n])}function Qie(t){var e=t.translateX,r=t.translateY,n=t.useTranslate3d;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function Yie(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.offsetTopLeft,s=t.position,i=t.reverseDirection,o=t.tooltipBox,l=t.useTranslate3d,c=t.viewBox,u,d,h;return o.height>0&&o.width>0&&r?(d=IT({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:s,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),h=IT({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:s,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=Qie({translateX:d,translateY:h,useTranslate3d:l})):u=Gie,{cssProperties:u,cssClasses:Kie({translateX:d,translateY:h,coordinate:r})}}function Qu(t){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qu(t)}function kT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function OT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kT(Object(r),!0).forEach(function(n){e1(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xie(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h4(n.key),n)}}function Zie(t,e,r){return e&&Jie(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function eoe(t,e,r){return e=F0(e),toe(t,d4()?Reflect.construct(e,r||[],F0(t).constructor):e.apply(t,r))}function toe(t,e){if(e&&(Qu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return roe(t)}function roe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d4(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(d4=function(){return!!t})()}function F0(t){return F0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},F0(t)}function noe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zj(t,e)}function Zj(t,e){return Zj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Zj(t,e)}function e1(t,e,r){return e=h4(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h4(t){var e=aoe(t,"string");return Qu(e)=="symbol"?e:e+""}function aoe(t,e){if(Qu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var DT=1,soe=function(t){function e(){var r;Xie(this,e);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return r=eoe(this,e,[].concat(s)),e1(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),e1(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return noe(e,t),Zie(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>DT||Math.abs(n.height-this.state.lastBoundingBox.height)>DT)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,s;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,s=this.props,i=s.active,o=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,u=s.children,d=s.coordinate,h=s.hasPayload,f=s.isAnimationActive,m=s.offset,y=s.position,g=s.reverseDirection,x=s.useTranslate3d,b=s.viewBox,v=s.wrapperStyle,j=Yie({allowEscapeViewBox:o,coordinate:d,offsetTopLeft:m,position:y,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:x,viewBox:b}),S=j.cssClasses,_=j.cssProperties,C=OT(OT({transition:f&&i?"transform ".concat(l,"ms ").concat(c):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&h?"visible":"hidden",position:"absolute",top:0,left:0},v);return ee.createElement("div",{tabIndex:-1,className:S,style:C,ref:function(w){n.wrapperNode=w}},u)}}])}(I.PureComponent),ioe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},si={isSsr:ioe(),get:function(e){return si[e]},set:function(e,r){if(typeof e=="string")si[e]=r;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(s){si[s]=e[s]})}}};function Yu(t){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yu(t)}function MT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function RT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MT(Object(r),!0).forEach(function(n){AS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ooe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function loe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m4(n.key),n)}}function coe(t,e,r){return e&&loe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function uoe(t,e,r){return e=B0(e),doe(t,f4()?Reflect.construct(e,r||[],B0(t).constructor):e.apply(t,r))}function doe(t,e){if(e&&(Yu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hoe(t)}function hoe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f4(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f4=function(){return!!t})()}function B0(t){return B0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},B0(t)}function foe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&t1(t,e)}function t1(t,e){return t1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},t1(t,e)}function AS(t,e,r){return e=m4(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m4(t){var e=moe(t,"string");return Yu(e)=="symbol"?e:e+""}function moe(t,e){if(Yu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function poe(t){return t.dataKey}function goe(t,e){return ee.isValidElement(t)?ee.cloneElement(t,e):typeof t=="function"?ee.createElement(t,e):ee.createElement(qie,e)}var Dn=function(t){function e(){return ooe(this,e),uoe(this,e,arguments)}return foe(e,t),coe(e,[{key:"render",value:function(){var n=this,s=this.props,i=s.active,o=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,u=s.content,d=s.coordinate,h=s.filterNull,f=s.isAnimationActive,m=s.offset,y=s.payload,g=s.payloadUniqBy,x=s.position,b=s.reverseDirection,v=s.useTranslate3d,j=s.viewBox,S=s.wrapperStyle,_=y??[];h&&_.length&&(_=n4(y.filter(function(N){return N.value!=null&&(N.hide!==!0||n.props.includeHidden)}),g,poe));var C=_.length>0;return ee.createElement(soe,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:f,active:i,coordinate:d,hasPayload:C,offset:m,position:x,reverseDirection:b,useTranslate3d:v,viewBox:j,wrapperStyle:S},goe(u,RT(RT({},this.props),{},{payload:_})))}}])}(I.PureComponent);AS(Dn,"displayName","Tooltip");AS(Dn,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!si.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var yoe=fi,xoe=function(){return yoe.Date.now()},voe=xoe,boe=/\s/;function woe(t){for(var e=t.length;e--&&boe.test(t.charAt(e)););return e}var joe=woe,Noe=joe,_oe=/^\s+/;function Soe(t){return t&&t.slice(0,Noe(t)+1).replace(_oe,"")}var Coe=Soe,Eoe=Coe,$T=il,Poe=Od,LT=NaN,Toe=/^[-+]0x[0-9a-f]+$/i,Aoe=/^0b[01]+$/i,Ioe=/^0o[0-7]+$/i,koe=parseInt;function Ooe(t){if(typeof t=="number")return t;if(Poe(t))return LT;if($T(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=$T(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Eoe(t);var r=Aoe.test(t);return r||Ioe.test(t)?koe(t.slice(2),r?2:8):Toe.test(t)?LT:+t}var p4=Ooe,Doe=il,Pb=voe,VT=p4,Moe="Expected a function",Roe=Math.max,$oe=Math.min;function Loe(t,e,r){var n,s,i,o,l,c,u=0,d=!1,h=!1,f=!0;if(typeof t!="function")throw new TypeError(Moe);e=VT(e)||0,Doe(r)&&(d=!!r.leading,h="maxWait"in r,i=h?Roe(VT(r.maxWait)||0,e):i,f="trailing"in r?!!r.trailing:f);function m(C){var N=n,w=s;return n=s=void 0,u=C,o=t.apply(w,N),o}function y(C){return u=C,l=setTimeout(b,e),d?m(C):o}function g(C){var N=C-c,w=C-u,E=e-N;return h?$oe(E,i-w):E}function x(C){var N=C-c,w=C-u;return c===void 0||N>=e||N<0||h&&w>=i}function b(){var C=Pb();if(x(C))return v(C);l=setTimeout(b,g(C))}function v(C){return l=void 0,f&&n?m(C):(n=s=void 0,o)}function j(){l!==void 0&&clearTimeout(l),u=0,n=c=s=l=void 0}function S(){return l===void 0?o:v(Pb())}function _(){var C=Pb(),N=x(C);if(n=arguments,s=this,c=C,N){if(l===void 0)return y(c);if(h)return clearTimeout(l),l=setTimeout(b,e),m(c)}return l===void 0&&(l=setTimeout(b,e)),o}return _.cancel=j,_.flush=S,_}var Voe=Loe,Foe=Voe,Boe=il,Uoe="Expected a function";function zoe(t,e,r){var n=!0,s=!0;if(typeof t!="function")throw new TypeError(Uoe);return Boe(r)&&(n="leading"in r?!!r.leading:n,s="trailing"in r?!!r.trailing:s),Foe(t,e,{leading:n,maxWait:e,trailing:s})}var qoe=zoe;const g4=er(qoe);function Hf(t){"@babel/helpers - typeof";return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hf(t)}function FT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function qp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?FT(Object(r),!0).forEach(function(n){Hoe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):FT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Hoe(t,e,r){return e=Woe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Woe(t){var e=Goe(t,"string");return Hf(e)=="symbol"?e:e+""}function Goe(t,e){if(Hf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Koe(t,e){return Joe(t)||Xoe(t,e)||Yoe(t,e)||Qoe()}function Qoe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yoe(t,e){if(t){if(typeof t=="string")return BT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BT(t,e)}}function BT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Xoe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function Joe(t){if(Array.isArray(t))return t}var po=I.forwardRef(function(t,e){var r=t.aspect,n=t.initialDimension,s=n===void 0?{width:-1,height:-1}:n,i=t.width,o=i===void 0?"100%":i,l=t.height,c=l===void 0?"100%":l,u=t.minWidth,d=u===void 0?0:u,h=t.minHeight,f=t.maxHeight,m=t.children,y=t.debounce,g=y===void 0?0:y,x=t.id,b=t.className,v=t.onResize,j=t.style,S=j===void 0?{}:j,_=I.useRef(null),C=I.useRef();C.current=v,I.useImperativeHandle(e,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var N=I.useState({containerWidth:s.width,containerHeight:s.height}),w=Koe(N,2),E=w[0],k=w[1],T=I.useCallback(function(O,D){k(function(R){var B=Math.round(O),Y=Math.round(D);return R.containerWidth===B&&R.containerHeight===Y?R:{containerWidth:B,containerHeight:Y}})},[]);I.useEffect(function(){var O=function(L){var X,G=L[0].contentRect,K=G.width,q=G.height;T(K,q),(X=C.current)===null||X===void 0||X.call(C,K,q)};g>0&&(O=g4(O,g,{trailing:!0,leading:!1}));var D=new ResizeObserver(O),R=_.current.getBoundingClientRect(),B=R.width,Y=R.height;return T(B,Y),D.observe(_.current),function(){D.disconnect()}},[T,g]);var P=I.useMemo(function(){var O=E.containerWidth,D=E.containerHeight;if(O<0||D<0)return null;Ls(Dl(o)||Dl(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),Ls(!r||r>0,"The aspect(%s) must be greater than zero.",r);var R=Dl(o)?O:o,B=Dl(c)?D:c;r&&r>0&&(R?B=R/r:B&&(R=B*r),f&&B>f&&(B=f)),Ls(R>0||B>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,R,B,o,c,d,h,r);var Y=!Array.isArray(m)&&Li(m.type).endsWith("Chart");return ee.Children.map(m,function(W){return ee.isValidElement(W)?I.cloneElement(W,qp({width:R,height:B},Y?{style:qp({height:"100%",width:"100%",maxHeight:B,maxWidth:R},W.props.style)}:{})):W})},[r,m,c,f,h,d,E,o]);return ee.createElement("div",{id:x?"".concat(x):void 0,className:At("recharts-responsive-container",b),style:qp(qp({},S),{},{width:o,height:c,minWidth:d,minHeight:h,maxHeight:f}),ref:_},P)}),Eo=function(e){return null};Eo.displayName="Cell";function Wf(t){"@babel/helpers - typeof";return Wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wf(t)}function UT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function r1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?UT(Object(r),!0).forEach(function(n){Zoe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):UT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Zoe(t,e,r){return e=ele(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ele(t){var e=tle(t,"string");return Wf(e)=="symbol"?e:e+""}function tle(t,e){if(Wf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Oc={widthCache:{},cacheCount:0},rle=2e3,nle={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},zT="recharts_measurement_span";function ale(t){var e=r1({},t);return Object.keys(e).forEach(function(r){e[r]||delete e[r]}),e}var rf=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||si.isSsr)return{width:0,height:0};var n=ale(r),s=JSON.stringify({text:e,copyStyle:n});if(Oc.widthCache[s])return Oc.widthCache[s];try{var i=document.getElementById(zT);i||(i=document.createElement("span"),i.setAttribute("id",zT),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=r1(r1({},nle),n);Object.assign(i.style,o),i.textContent="".concat(e);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return Oc.widthCache[s]=c,++Oc.cacheCount>rle&&(Oc.cacheCount=0,Oc.widthCache={}),c}catch{return{width:0,height:0}}},sle=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Gf(t){"@babel/helpers - typeof";return Gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gf(t)}function U0(t,e){return cle(t)||lle(t,e)||ole(t,e)||ile()}function ile(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ole(t,e){if(t){if(typeof t=="string")return qT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qT(t,e)}}function qT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lle(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function cle(t){if(Array.isArray(t))return t}function ule(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HT(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hle(n.key),n)}}function dle(t,e,r){return e&&HT(t.prototype,e),r&&HT(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hle(t){var e=fle(t,"string");return Gf(e)=="symbol"?e:e+""}function fle(t,e){if(Gf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Gf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var WT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,GT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,mle=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ple=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,y4={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},gle=Object.keys(y4),nu="NaN";function yle(t,e){return t*y4[e]}var Hp=function(){function t(e,r){ule(this,t),this.num=e,this.unit=r,this.num=e,this.unit=r,Number.isNaN(e)&&(this.unit=""),r!==""&&!mle.test(r)&&(this.num=NaN,this.unit=""),gle.includes(r)&&(this.num=yle(e,r),this.unit="px")}return dle(t,[{key:"add",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,s=(n=ple.exec(r))!==null&&n!==void 0?n:[],i=U0(s,3),o=i[1],l=i[2];return new t(parseFloat(o),l??"")}}])}();function x4(t){if(t.includes(nu))return nu;for(var e=t;e.includes("*")||e.includes("/");){var r,n=(r=WT.exec(e))!==null&&r!==void 0?r:[],s=U0(n,4),i=s[1],o=s[2],l=s[3],c=Hp.parse(i??""),u=Hp.parse(l??""),d=o==="*"?c.multiply(u):c.divide(u);if(d.isNaN())return nu;e=e.replace(WT,d.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var h,f=(h=GT.exec(e))!==null&&h!==void 0?h:[],m=U0(f,4),y=m[1],g=m[2],x=m[3],b=Hp.parse(y??""),v=Hp.parse(x??""),j=g==="+"?b.add(v):b.subtract(v);if(j.isNaN())return nu;e=e.replace(GT,j.toString())}return e}var KT=/\(([^()]*)\)/;function xle(t){for(var e=t;e.includes("(");){var r=KT.exec(e),n=U0(r,2),s=n[1];e=e.replace(KT,x4(s))}return e}function vle(t){var e=t.replace(/\s+/g,"");return e=xle(e),e=x4(e),e}function ble(t){try{return vle(t)}catch{return nu}}function Tb(t){var e=ble(t.slice(5,-1));return e===nu?"":e}var wle=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],jle=["dx","dy","angle","className","breakAll"];function n1(){return n1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},n1.apply(this,arguments)}function QT(t,e){if(t==null)return{};var r=Nle(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Nle(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function YT(t,e){return Ele(t)||Cle(t,e)||Sle(t,e)||_le()}function _le(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sle(t,e){if(t){if(typeof t=="string")return XT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XT(t,e)}}function XT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Cle(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function Ele(t){if(Array.isArray(t))return t}var v4=/[ \f\n\r\t\v\u2028\u2029]+/,b4=function(e){var r=e.children,n=e.breakAll,s=e.style;try{var i=[];Pt(r)||(n?i=r.toString().split(""):i=r.toString().split(v4));var o=i.map(function(c){return{word:c,width:rf(c,s).width}}),l=n?0:rf("",s).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}},Ple=function(e,r,n,s,i){var o=e.maxLines,l=e.children,c=e.style,u=e.breakAll,d=Me(o),h=l,f=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R.reduce(function(B,Y){var W=Y.word,L=Y.width,X=B[B.length-1];if(X&&(s==null||i||X.width+L+n<Number(s)))X.words.push(W),X.width+=L+n;else{var G={words:[W],width:L};B.push(G)}return B},[])},m=f(r),y=function(R){return R.reduce(function(B,Y){return B.width>Y.width?B:Y})};if(!d)return m;for(var g="",x=function(R){var B=h.slice(0,R),Y=b4({breakAll:u,style:c,children:B+g}).wordsWithComputedWidth,W=f(Y),L=W.length>o||y(W).width>Number(s);return[L,W]},b=0,v=h.length-1,j=0,S;b<=v&&j<=h.length-1;){var _=Math.floor((b+v)/2),C=_-1,N=x(C),w=YT(N,2),E=w[0],k=w[1],T=x(_),P=YT(T,1),O=P[0];if(!E&&!O&&(b=_+1),E&&O&&(v=_-1),!E&&O){S=k;break}j++}return S||m},JT=function(e){var r=Pt(e)?[]:e.toString().split(v4);return[{words:r}]},Tle=function(e){var r=e.width,n=e.scaleToFit,s=e.children,i=e.style,o=e.breakAll,l=e.maxLines;if((r||n)&&!si.isSsr){var c,u,d=b4({breakAll:o,children:s,style:i});if(d){var h=d.wordsWithComputedWidth,f=d.spaceWidth;c=h,u=f}else return JT(s);return Ple({breakAll:o,children:s,maxLines:l,style:i},c,u,r,n)}return JT(s)},ZT="#808080",uc=function(e){var r=e.x,n=r===void 0?0:r,s=e.y,i=s===void 0?0:s,o=e.lineHeight,l=o===void 0?"1em":o,c=e.capHeight,u=c===void 0?"0.71em":c,d=e.scaleToFit,h=d===void 0?!1:d,f=e.textAnchor,m=f===void 0?"start":f,y=e.verticalAnchor,g=y===void 0?"end":y,x=e.fill,b=x===void 0?ZT:x,v=QT(e,wle),j=I.useMemo(function(){return Tle({breakAll:v.breakAll,children:v.children,maxLines:v.maxLines,scaleToFit:h,style:v.style,width:v.width})},[v.breakAll,v.children,v.maxLines,h,v.style,v.width]),S=v.dx,_=v.dy,C=v.angle,N=v.className,w=v.breakAll,E=QT(v,jle);if(!cn(n)||!cn(i))return null;var k=n+(Me(S)?S:0),T=i+(Me(_)?_:0),P;switch(g){case"start":P=Tb("calc(".concat(u,")"));break;case"middle":P=Tb("calc(".concat((j.length-1)/2," * -").concat(l," + (").concat(u," / 2))"));break;default:P=Tb("calc(".concat(j.length-1," * -").concat(l,")"));break}var O=[];if(h){var D=j[0].width,R=v.width;O.push("scale(".concat((Me(R)?R/D:1)/D,")"))}return C&&O.push("rotate(".concat(C,", ").concat(k,", ").concat(T,")")),O.length&&(E.transform=O.join(" ")),ee.createElement("text",n1({},ft(E,!0),{x:k,y:T,className:At("recharts-text",N),textAnchor:m,fill:b.includes("url")?ZT:b}),j.map(function(B,Y){var W=B.words.join(w?"":" ");return ee.createElement("tspan",{x:k,dy:Y===0?P:l,key:"".concat(W,"-").concat(Y)},W)}))};function qo(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ale(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function IS(t){let e,r,n;t.length!==2?(e=qo,r=(l,c)=>qo(t(l),c),n=(l,c)=>t(l)-c):(e=t===qo||t===Ale?t:Ile,r=t,n=t);function s(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const h=u+d>>>1;r(l[h],c)<0?u=h+1:d=h}while(u<d)}return u}function i(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const h=u+d>>>1;r(l[h],c)<=0?u=h+1:d=h}while(u<d)}return u}function o(l,c,u=0,d=l.length){const h=s(l,c,u,d-1);return h>u&&n(l[h-1],c)>-n(l[h],c)?h-1:h}return{left:s,center:o,right:i}}function Ile(){return 0}function w4(t){return t===null?NaN:+t}function*kle(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const Ole=IS(qo),Ym=Ole.right;IS(w4).center;class eA extends Map{constructor(e,r=Rle){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,s]of e)this.set(n,s)}get(e){return super.get(tA(this,e))}has(e){return super.has(tA(this,e))}set(e,r){return super.set(Dle(this,e),r)}delete(e){return super.delete(Mle(this,e))}}function tA({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function Dle({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function Mle({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function Rle(t){return t!==null&&typeof t=="object"?t.valueOf():t}function $le(t=qo){if(t===qo)return j4;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function j4(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const Lle=Math.sqrt(50),Vle=Math.sqrt(10),Fle=Math.sqrt(2);function z0(t,e,r){const n=(e-t)/Math.max(0,r),s=Math.floor(Math.log10(n)),i=n/Math.pow(10,s),o=i>=Lle?10:i>=Vle?5:i>=Fle?2:1;let l,c,u;return s<0?(u=Math.pow(10,-s)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,s)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=r&&r<2?z0(t,e,r*2):[l,c,u]}function a1(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[s,i,o]=n?z0(e,t,r):z0(t,e,r);if(!(i>=s))return[];const l=i-s+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(i-u)/-o;else for(let u=0;u<l;++u)c[u]=(i-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(s+u)/-o;else for(let u=0;u<l;++u)c[u]=(s+u)*o;return c}function s1(t,e,r){return e=+e,t=+t,r=+r,z0(t,e,r)[2]}function i1(t,e,r){e=+e,t=+t,r=+r;const n=e<t,s=n?s1(e,t,r):s1(t,e,r);return(n?-1:1)*(s<0?1/-s:s)}function rA(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function nA(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function N4(t,e,r=0,n=1/0,s){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(s=s===void 0?j4:$le(s);n>r;){if(n-r>600){const c=n-r+1,u=e-r+1,d=Math.log(c),h=.5*Math.exp(2*d/3),f=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),m=Math.max(r,Math.floor(e-u*h/c+f)),y=Math.min(n,Math.floor(e+(c-u)*h/c+f));N4(t,e,m,y,s)}const i=t[e];let o=r,l=n;for(ph(t,r,e),s(t[n],i)>0&&ph(t,r,n);o<l;){for(ph(t,o,l),++o,--l;s(t[o],i)<0;)++o;for(;s(t[l],i)>0;)--l}s(t[r],i)===0?ph(t,r,l):(++l,ph(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function ph(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function Ble(t,e,r){if(t=Float64Array.from(kle(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return nA(t);if(e>=1)return rA(t);var n,s=(n-1)*e,i=Math.floor(s),o=rA(N4(t,i).subarray(0,i+1)),l=nA(t.subarray(i+1));return o+(l-o)*(s-i)}}function Ule(t,e,r=w4){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,s=(n-1)*e,i=Math.floor(s),o=+r(t[i],i,t),l=+r(t[i+1],i+1,t);return o+(l-o)*(s-i)}}function zle(t,e,r){t=+t,e=+e,r=(s=arguments.length)<2?(e=t,t=0,1):s<3?1:+r;for(var n=-1,s=Math.max(0,Math.ceil((e-t)/r))|0,i=new Array(s);++n<s;)i[n]=t+n*r;return i}function vs(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function so(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const o1=Symbol("implicit");function kS(){var t=new eA,e=[],r=[],n=o1;function s(i){let o=t.get(i);if(o===void 0){if(n!==o1)return n;t.set(i,o=e.push(i)-1)}return r[o%r.length]}return s.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new eA;for(const o of i)t.has(o)||t.set(o,e.push(o)-1);return s},s.range=function(i){return arguments.length?(r=Array.from(i),s):r.slice()},s.unknown=function(i){return arguments.length?(n=i,s):n},s.copy=function(){return kS(e,r).unknown(n)},vs.apply(s,arguments),s}function Kf(){var t=kS().unknown(void 0),e=t.domain,r=t.range,n=0,s=1,i,o,l=!1,c=0,u=0,d=.5;delete t.unknown;function h(){var f=e().length,m=s<n,y=m?s:n,g=m?n:s;i=(g-y)/Math.max(1,f-c+u*2),l&&(i=Math.floor(i)),y+=(g-y-i*(f-c))*d,o=i*(1-c),l&&(y=Math.round(y),o=Math.round(o));var x=zle(f).map(function(b){return y+i*b});return r(m?x.reverse():x)}return t.domain=function(f){return arguments.length?(e(f),h()):e()},t.range=function(f){return arguments.length?([n,s]=f,n=+n,s=+s,h()):[n,s]},t.rangeRound=function(f){return[n,s]=f,n=+n,s=+s,l=!0,h()},t.bandwidth=function(){return o},t.step=function(){return i},t.round=function(f){return arguments.length?(l=!!f,h()):l},t.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),h()):c},t.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},t.paddingOuter=function(f){return arguments.length?(u=+f,h()):u},t.align=function(f){return arguments.length?(d=Math.max(0,Math.min(1,f)),h()):d},t.copy=function(){return Kf(e(),[n,s]).round(l).paddingInner(c).paddingOuter(u).align(d)},vs.apply(h(),arguments)}function _4(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return _4(e())},t}function nf(){return _4(Kf.apply(null,arguments).paddingInner(1))}function OS(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function S4(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Xm(){}var Qf=.7,q0=1/Qf,ju="\\s*([+-]?\\d+)\\s*",Yf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ii="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qle=/^#([0-9a-f]{3,8})$/,Hle=new RegExp(`^rgb\\(${ju},${ju},${ju}\\)$`),Wle=new RegExp(`^rgb\\(${ii},${ii},${ii}\\)$`),Gle=new RegExp(`^rgba\\(${ju},${ju},${ju},${Yf}\\)$`),Kle=new RegExp(`^rgba\\(${ii},${ii},${ii},${Yf}\\)$`),Qle=new RegExp(`^hsl\\(${Yf},${ii},${ii}\\)$`),Yle=new RegExp(`^hsla\\(${Yf},${ii},${ii},${Yf}\\)$`),aA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};OS(Xm,Xf,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:sA,formatHex:sA,formatHex8:Xle,formatHsl:Jle,formatRgb:iA,toString:iA});function sA(){return this.rgb().formatHex()}function Xle(){return this.rgb().formatHex8()}function Jle(){return C4(this).formatHsl()}function iA(){return this.rgb().formatRgb()}function Xf(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=qle.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?oA(e):r===3?new Na(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Wp(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Wp(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Hle.exec(t))?new Na(e[1],e[2],e[3],1):(e=Wle.exec(t))?new Na(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Gle.exec(t))?Wp(e[1],e[2],e[3],e[4]):(e=Kle.exec(t))?Wp(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Qle.exec(t))?uA(e[1],e[2]/100,e[3]/100,1):(e=Yle.exec(t))?uA(e[1],e[2]/100,e[3]/100,e[4]):aA.hasOwnProperty(t)?oA(aA[t]):t==="transparent"?new Na(NaN,NaN,NaN,0):null}function oA(t){return new Na(t>>16&255,t>>8&255,t&255,1)}function Wp(t,e,r,n){return n<=0&&(t=e=r=NaN),new Na(t,e,r,n)}function Zle(t){return t instanceof Xm||(t=Xf(t)),t?(t=t.rgb(),new Na(t.r,t.g,t.b,t.opacity)):new Na}function l1(t,e,r,n){return arguments.length===1?Zle(t):new Na(t,e,r,n??1)}function Na(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}OS(Na,l1,S4(Xm,{brighter(t){return t=t==null?q0:Math.pow(q0,t),new Na(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Qf:Math.pow(Qf,t),new Na(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Na(ql(this.r),ql(this.g),ql(this.b),H0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:lA,formatHex:lA,formatHex8:ece,formatRgb:cA,toString:cA}));function lA(){return`#${Ml(this.r)}${Ml(this.g)}${Ml(this.b)}`}function ece(){return`#${Ml(this.r)}${Ml(this.g)}${Ml(this.b)}${Ml((isNaN(this.opacity)?1:this.opacity)*255)}`}function cA(){const t=H0(this.opacity);return`${t===1?"rgb(":"rgba("}${ql(this.r)}, ${ql(this.g)}, ${ql(this.b)}${t===1?")":`, ${t})`}`}function H0(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ql(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ml(t){return t=ql(t),(t<16?"0":"")+t.toString(16)}function uA(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Ds(t,e,r,n)}function C4(t){if(t instanceof Ds)return new Ds(t.h,t.s,t.l,t.opacity);if(t instanceof Xm||(t=Xf(t)),!t)return new Ds;if(t instanceof Ds)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,s=Math.min(e,r,n),i=Math.max(e,r,n),o=NaN,l=i-s,c=(i+s)/2;return l?(e===i?o=(r-n)/l+(r<n)*6:r===i?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?i+s:2-i-s,o*=60):l=c>0&&c<1?0:o,new Ds(o,l,c,t.opacity)}function tce(t,e,r,n){return arguments.length===1?C4(t):new Ds(t,e,r,n??1)}function Ds(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}OS(Ds,tce,S4(Xm,{brighter(t){return t=t==null?q0:Math.pow(q0,t),new Ds(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Qf:Math.pow(Qf,t),new Ds(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,s=2*r-n;return new Na(Ab(t>=240?t-240:t+120,s,n),Ab(t,s,n),Ab(t<120?t+240:t-120,s,n),this.opacity)},clamp(){return new Ds(dA(this.h),Gp(this.s),Gp(this.l),H0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=H0(this.opacity);return`${t===1?"hsl(":"hsla("}${dA(this.h)}, ${Gp(this.s)*100}%, ${Gp(this.l)*100}%${t===1?")":`, ${t})`}`}}));function dA(t){return t=(t||0)%360,t<0?t+360:t}function Gp(t){return Math.max(0,Math.min(1,t||0))}function Ab(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const DS=t=>()=>t;function rce(t,e){return function(r){return t+r*e}}function nce(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function ace(t){return(t=+t)==1?E4:function(e,r){return r-e?nce(e,r,t):DS(isNaN(e)?r:e)}}function E4(t,e){var r=e-t;return r?rce(t,r):DS(isNaN(t)?e:t)}const hA=function t(e){var r=ace(e);function n(s,i){var o=r((s=l1(s)).r,(i=l1(i)).r),l=r(s.g,i.g),c=r(s.b,i.b),u=E4(s.opacity,i.opacity);return function(d){return s.r=o(d),s.g=l(d),s.b=c(d),s.opacity=u(d),s+""}}return n.gamma=t,n}(1);function sce(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),s;return function(i){for(s=0;s<r;++s)n[s]=t[s]*(1-i)+e[s]*i;return n}}function ice(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function oce(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,s=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)s[o]=zd(t[o],e[o]);for(;o<r;++o)i[o]=e[o];return function(l){for(o=0;o<n;++o)i[o]=s[o](l);return i}}function lce(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function W0(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function cce(t,e){var r={},n={},s;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in t?r[s]=zd(t[s],e[s]):n[s]=e[s];return function(i){for(s in r)n[s]=r[s](i);return n}}var c1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ib=new RegExp(c1.source,"g");function uce(t){return function(){return t}}function dce(t){return function(e){return t(e)+""}}function hce(t,e){var r=c1.lastIndex=Ib.lastIndex=0,n,s,i,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=c1.exec(t))&&(s=Ib.exec(e));)(i=s.index)>r&&(i=e.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(n=n[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,c.push({i:o,x:W0(n,s)})),r=Ib.lastIndex;return r<e.length&&(i=e.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?dce(c[0].x):uce(e):(e=c.length,function(u){for(var d=0,h;d<e;++d)l[(h=c[d]).i]=h.x(u);return l.join("")})}function zd(t,e){var r=typeof e,n;return e==null||r==="boolean"?DS(e):(r==="number"?W0:r==="string"?(n=Xf(e))?(e=n,hA):hce:e instanceof Xf?hA:e instanceof Date?lce:ice(e)?sce:Array.isArray(e)?oce:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?cce:W0)(t,e)}function MS(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function fce(t,e){e===void 0&&(e=t,t=zd);for(var r=0,n=e.length-1,s=e[0],i=new Array(n<0?0:n);r<n;)i[r]=t(s,s=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[l](o-l)}}function mce(t){return function(){return t}}function G0(t){return+t}var fA=[0,1];function oa(t){return t}function u1(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:mce(isNaN(e)?NaN:.5)}function pce(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function gce(t,e,r){var n=t[0],s=t[1],i=e[0],o=e[1];return s<n?(n=u1(s,n),i=r(o,i)):(n=u1(n,s),i=r(i,o)),function(l){return i(n(l))}}function yce(t,e,r){var n=Math.min(t.length,e.length)-1,s=new Array(n),i=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)s[o]=u1(t[o],t[o+1]),i[o]=r(e[o],e[o+1]);return function(l){var c=Ym(t,l,1,n)-1;return i[c](s[c](l))}}function Jm(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Kx(){var t=fA,e=fA,r=zd,n,s,i,o=oa,l,c,u;function d(){var f=Math.min(t.length,e.length);return o!==oa&&(o=pce(t[0],t[f-1])),l=f>2?yce:gce,c=u=null,h}function h(f){return f==null||isNaN(f=+f)?i:(c||(c=l(t.map(n),e,r)))(n(o(f)))}return h.invert=function(f){return o(s((u||(u=l(e,t.map(n),W0)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,G0),d()):t.slice()},h.range=function(f){return arguments.length?(e=Array.from(f),d()):e.slice()},h.rangeRound=function(f){return e=Array.from(f),r=MS,d()},h.clamp=function(f){return arguments.length?(o=f?!0:oa,d()):o!==oa},h.interpolate=function(f){return arguments.length?(r=f,d()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,m){return n=f,s=m,d()}}function RS(){return Kx()(oa,oa)}function xce(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function K0(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Xu(t){return t=K0(Math.abs(t)),t?t[1]:NaN}function vce(t,e){return function(r,n){for(var s=r.length,i=[],o=0,l=t[0],c=0;s>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(s-=l,s+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return i.reverse().join(e)}}function bce(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var wce=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Jf(t){if(!(e=wce.exec(t)))throw new Error("invalid format: "+t);var e;return new $S({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Jf.prototype=$S.prototype;function $S(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}$S.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function jce(t){e:for(var e=t.length,r=1,n=-1,s;r<e;++r)switch(t[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(s+1):t}var P4;function Nce(t,e){var r=K0(t,e);if(!r)return t+"";var n=r[0],s=r[1],i=s-(P4=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+K0(t,Math.max(0,e+i-1))[0]}function mA(t,e){var r=K0(t,e);if(!r)return t+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const pA={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:xce,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>mA(t*100,e),r:mA,s:Nce,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function gA(t){return t}var yA=Array.prototype.map,xA=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function _ce(t){var e=t.grouping===void 0||t.thousands===void 0?gA:vce(yA.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",s=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?gA:bce(yA.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(h){h=Jf(h);var f=h.fill,m=h.align,y=h.sign,g=h.symbol,x=h.zero,b=h.width,v=h.comma,j=h.precision,S=h.trim,_=h.type;_==="n"?(v=!0,_="g"):pA[_]||(j===void 0&&(j=12),S=!0,_="g"),(x||f==="0"&&m==="=")&&(x=!0,f="0",m="=");var C=g==="$"?r:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",N=g==="$"?n:/[%p]/.test(_)?o:"",w=pA[_],E=/[defgprs%]/.test(_);j=j===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,j)):Math.max(0,Math.min(20,j));function k(T){var P=C,O=N,D,R,B;if(_==="c")O=w(T)+O,T="";else{T=+T;var Y=T<0||1/T<0;if(T=isNaN(T)?c:w(Math.abs(T),j),S&&(T=jce(T)),Y&&+T==0&&y!=="+"&&(Y=!1),P=(Y?y==="("?y:l:y==="-"||y==="("?"":y)+P,O=(_==="s"?xA[8+P4/3]:"")+O+(Y&&y==="("?")":""),E){for(D=-1,R=T.length;++D<R;)if(B=T.charCodeAt(D),48>B||B>57){O=(B===46?s+T.slice(D+1):T.slice(D))+O,T=T.slice(0,D);break}}}v&&!x&&(T=e(T,1/0));var W=P.length+T.length+O.length,L=W<b?new Array(b-W+1).join(f):"";switch(v&&x&&(T=e(L+T,L.length?b-O.length:1/0),L=""),m){case"<":T=P+T+O+L;break;case"=":T=P+L+T+O;break;case"^":T=L.slice(0,W=L.length>>1)+P+T+O+L.slice(W);break;default:T=L+P+T+O;break}return i(T)}return k.toString=function(){return h+""},k}function d(h,f){var m=u((h=Jf(h),h.type="f",h)),y=Math.max(-8,Math.min(8,Math.floor(Xu(f)/3)))*3,g=Math.pow(10,-y),x=xA[8+y/3];return function(b){return m(g*b)+x}}return{format:u,formatPrefix:d}}var Kp,LS,T4;Sce({thousands:",",grouping:[3],currency:["$",""]});function Sce(t){return Kp=_ce(t),LS=Kp.format,T4=Kp.formatPrefix,Kp}function Cce(t){return Math.max(0,-Xu(Math.abs(t)))}function Ece(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Xu(e)/3)))*3-Xu(Math.abs(t)))}function Pce(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Xu(e)-Xu(t))+1}function A4(t,e,r,n){var s=i1(t,e,r),i;switch(n=Jf(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(i=Ece(s,o))&&(n.precision=i),T4(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=Pce(s,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=Cce(s))&&(n.precision=i-(n.type==="%")*2);break}}return LS(n)}function ol(t){var e=t.domain;return t.ticks=function(r){var n=e();return a1(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var s=e();return A4(s[0],s[s.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),s=0,i=n.length-1,o=n[s],l=n[i],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=s,s=i,i=u);d-- >0;){if(u=s1(o,l,r),u===c)return n[s]=o,n[i]=l,e(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function Q0(){var t=RS();return t.copy=function(){return Jm(t,Q0())},vs.apply(t,arguments),ol(t)}function I4(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,G0),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return I4(t).unknown(e)},t=arguments.length?Array.from(t,G0):[0,1],ol(r)}function k4(t,e){t=t.slice();var r=0,n=t.length-1,s=t[r],i=t[n],o;return i<s&&(o=r,r=n,n=o,o=s,s=i,i=o),t[r]=e.floor(s),t[n]=e.ceil(i),t}function vA(t){return Math.log(t)}function bA(t){return Math.exp(t)}function Tce(t){return-Math.log(-t)}function Ace(t){return-Math.exp(-t)}function Ice(t){return isFinite(t)?+("1e"+t):t<0?0:t}function kce(t){return t===10?Ice:t===Math.E?Math.exp:e=>Math.pow(t,e)}function Oce(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function wA(t){return(e,r)=>-t(-e,r)}function VS(t){const e=t(vA,bA),r=e.domain;let n=10,s,i;function o(){return s=Oce(n),i=kce(n),r()[0]<0?(s=wA(s),i=wA(i),t(Tce,Ace)):t(vA,bA),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const h=d<u;h&&([u,d]=[d,u]);let f=s(u),m=s(d),y,g;const x=l==null?10:+l;let b=[];if(!(n%1)&&m-f<x){if(f=Math.floor(f),m=Math.ceil(m),u>0){for(;f<=m;++f)for(y=1;y<n;++y)if(g=f<0?y/i(-f):y*i(f),!(g<u)){if(g>d)break;b.push(g)}}else for(;f<=m;++f)for(y=n-1;y>=1;--y)if(g=f>0?y/i(-f):y*i(f),!(g<u)){if(g>d)break;b.push(g)}b.length*2<x&&(b=a1(u,d,x))}else b=a1(f,m,Math.min(m-f,x)).map(i);return h?b.reverse():b},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Jf(c)).precision==null&&(c.trim=!0),c=LS(c)),l===1/0)return c;const u=Math.max(1,n*l/e.ticks().length);return d=>{let h=d/i(Math.round(s(d)));return h*n<n-.5&&(h*=n),h<=u?c(d):""}},e.nice=()=>r(k4(r(),{floor:l=>i(Math.floor(s(l))),ceil:l=>i(Math.ceil(s(l)))})),e}function O4(){const t=VS(Kx()).domain([1,10]);return t.copy=()=>Jm(t,O4()).base(t.base()),vs.apply(t,arguments),t}function jA(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function NA(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function FS(t){var e=1,r=t(jA(e),NA(e));return r.constant=function(n){return arguments.length?t(jA(e=+n),NA(e)):e},ol(r)}function D4(){var t=FS(Kx());return t.copy=function(){return Jm(t,D4()).constant(t.constant())},vs.apply(t,arguments)}function _A(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Dce(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Mce(t){return t<0?-t*t:t*t}function BS(t){var e=t(oa,oa),r=1;function n(){return r===1?t(oa,oa):r===.5?t(Dce,Mce):t(_A(r),_A(1/r))}return e.exponent=function(s){return arguments.length?(r=+s,n()):r},ol(e)}function US(){var t=BS(Kx());return t.copy=function(){return Jm(t,US()).exponent(t.exponent())},vs.apply(t,arguments),t}function Rce(){return US.apply(null,arguments).exponent(.5)}function SA(t){return Math.sign(t)*t*t}function $ce(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function M4(){var t=RS(),e=[0,1],r=!1,n;function s(i){var o=$ce(t(i));return isNaN(o)?n:r?Math.round(o):o}return s.invert=function(i){return t.invert(SA(i))},s.domain=function(i){return arguments.length?(t.domain(i),s):t.domain()},s.range=function(i){return arguments.length?(t.range((e=Array.from(i,G0)).map(SA)),s):e.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(r=!!i,s):r},s.clamp=function(i){return arguments.length?(t.clamp(i),s):t.clamp()},s.unknown=function(i){return arguments.length?(n=i,s):n},s.copy=function(){return M4(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},vs.apply(s,arguments),ol(s)}function R4(){var t=[],e=[],r=[],n;function s(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=Ule(t,o/l);return i}function i(o){return o==null||isNaN(o=+o)?n:e[Ym(r,o)]}return i.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},i.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(qo),s()},i.range=function(o){return arguments.length?(e=Array.from(o),s()):e.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return R4().domain(t).range(e).unknown(n)},vs.apply(i,arguments)}function $4(){var t=0,e=1,r=1,n=[.5],s=[0,1],i;function o(c){return c!=null&&c<=c?s[Ym(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,l()):s.slice()},o.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,n[0]]:u>=r?[n[r-1],e]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return $4().domain([t,e]).range(s).unknown(i)},vs.apply(ol(o),arguments)}function L4(){var t=[.5],e=[0,1],r,n=1;function s(i){return i!=null&&i<=i?e[Ym(t,i,0,n)]:r}return s.domain=function(i){return arguments.length?(t=Array.from(i),n=Math.min(t.length,e.length-1),s):t.slice()},s.range=function(i){return arguments.length?(e=Array.from(i),n=Math.min(t.length,e.length-1),s):e.slice()},s.invertExtent=function(i){var o=e.indexOf(i);return[t[o-1],t[o]]},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return L4().domain(t).range(e).unknown(r)},vs.apply(s,arguments)}const kb=new Date,Ob=new Date;function un(t,e,r,n){function s(i){return t(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=i=>(t(i=new Date(+i)),i),s.ceil=i=>(t(i=new Date(i-1)),e(i,1),t(i),i),s.round=i=>{const o=s(i),l=s.ceil(i);return i-o<l-i?o:l},s.offset=(i,o)=>(e(i=new Date(+i),o==null?1:Math.floor(o)),i),s.range=(i,o,l)=>{const c=[];if(i=s.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let u;do c.push(u=new Date(+i)),e(i,l),t(i);while(u<i&&i<o);return c},s.filter=i=>un(o=>{if(o>=o)for(;t(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!i(o););else for(;--l>=0;)for(;e(o,1),!i(o););}),r&&(s.count=(i,o)=>(kb.setTime(+i),Ob.setTime(+o),t(kb),t(Ob),Math.floor(r(kb,Ob))),s.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(n?o=>n(o)%i===0:o=>s.count(0,o)%i===0):s)),s}const Y0=un(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Y0.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?un(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Y0);Y0.range;const Ti=1e3,ls=Ti*60,Ai=ls*60,Yi=Ai*24,zS=Yi*7,CA=Yi*30,Db=Yi*365,Rl=un(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Ti)},(t,e)=>(e-t)/Ti,t=>t.getUTCSeconds());Rl.range;const qS=un(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ti)},(t,e)=>{t.setTime(+t+e*ls)},(t,e)=>(e-t)/ls,t=>t.getMinutes());qS.range;const HS=un(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*ls)},(t,e)=>(e-t)/ls,t=>t.getUTCMinutes());HS.range;const WS=un(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ti-t.getMinutes()*ls)},(t,e)=>{t.setTime(+t+e*Ai)},(t,e)=>(e-t)/Ai,t=>t.getHours());WS.range;const GS=un(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Ai)},(t,e)=>(e-t)/Ai,t=>t.getUTCHours());GS.range;const Zm=un(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ls)/Yi,t=>t.getDate()-1);Zm.range;const Qx=un(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Yi,t=>t.getUTCDate()-1);Qx.range;const V4=un(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Yi,t=>Math.floor(t/Yi));V4.range;function Nc(t){return un(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*ls)/zS)}const Yx=Nc(0),X0=Nc(1),Lce=Nc(2),Vce=Nc(3),Ju=Nc(4),Fce=Nc(5),Bce=Nc(6);Yx.range;X0.range;Lce.range;Vce.range;Ju.range;Fce.range;Bce.range;function _c(t){return un(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/zS)}const Xx=_c(0),J0=_c(1),Uce=_c(2),zce=_c(3),Zu=_c(4),qce=_c(5),Hce=_c(6);Xx.range;J0.range;Uce.range;zce.range;Zu.range;qce.range;Hce.range;const KS=un(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());KS.range;const QS=un(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());QS.range;const Xi=un(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Xi.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:un(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});Xi.range;const Ji=un(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Ji.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:un(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});Ji.range;function F4(t,e,r,n,s,i){const o=[[Rl,1,Ti],[Rl,5,5*Ti],[Rl,15,15*Ti],[Rl,30,30*Ti],[i,1,ls],[i,5,5*ls],[i,15,15*ls],[i,30,30*ls],[s,1,Ai],[s,3,3*Ai],[s,6,6*Ai],[s,12,12*Ai],[n,1,Yi],[n,2,2*Yi],[r,1,zS],[e,1,CA],[e,3,3*CA],[t,1,Db]];function l(u,d,h){const f=d<u;f&&([u,d]=[d,u]);const m=h&&typeof h.range=="function"?h:c(u,d,h),y=m?m.range(u,+d+1):[];return f?y.reverse():y}function c(u,d,h){const f=Math.abs(d-u)/h,m=IS(([,,x])=>x).right(o,f);if(m===o.length)return t.every(i1(u/Db,d/Db,h));if(m===0)return Y0.every(Math.max(i1(u,d,h),1));const[y,g]=o[f/o[m-1][2]<o[m][2]/f?m-1:m];return y.every(g)}return[l,c]}const[Wce,Gce]=F4(Ji,QS,Xx,V4,GS,HS),[Kce,Qce]=F4(Xi,KS,Yx,Zm,WS,qS);function Mb(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Rb(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function gh(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function Yce(t){var e=t.dateTime,r=t.date,n=t.time,s=t.periods,i=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,u=yh(s),d=xh(s),h=yh(i),f=xh(i),m=yh(o),y=xh(o),g=yh(l),x=xh(l),b=yh(c),v=xh(c),j={a:Y,A:W,b:L,B:X,c:null,d:kA,e:kA,f:vue,g:Tue,G:Iue,H:gue,I:yue,j:xue,L:B4,m:bue,M:wue,p:G,q:K,Q:MA,s:RA,S:jue,u:Nue,U:_ue,V:Sue,w:Cue,W:Eue,x:null,X:null,y:Pue,Y:Aue,Z:kue,"%":DA},S={a:q,A:ie,b:ge,B:be,c:null,d:OA,e:OA,f:Rue,g:Wue,G:Kue,H:Oue,I:Due,j:Mue,L:z4,m:$ue,M:Lue,p:Ye,q:ze,Q:MA,s:RA,S:Vue,u:Fue,U:Bue,V:Uue,w:zue,W:que,x:null,X:null,y:Hue,Y:Gue,Z:Que,"%":DA},_={a:k,A:T,b:P,B:O,c:D,d:AA,e:AA,f:hue,g:TA,G:PA,H:IA,I:IA,j:lue,L:due,m:oue,M:cue,p:E,q:iue,Q:mue,s:pue,S:uue,u:tue,U:rue,V:nue,w:eue,W:aue,x:R,X:B,y:TA,Y:PA,Z:sue,"%":fue};j.x=C(r,j),j.X=C(n,j),j.c=C(e,j),S.x=C(r,S),S.X=C(n,S),S.c=C(e,S);function C(U,Q){return function(re){var te=[],pe=-1,xe=0,he=U.length,Le,qe,De;for(re instanceof Date||(re=new Date(+re));++pe<he;)U.charCodeAt(pe)===37&&(te.push(U.slice(xe,pe)),(qe=EA[Le=U.charAt(++pe)])!=null?Le=U.charAt(++pe):qe=Le==="e"?" ":"0",(De=Q[Le])&&(Le=De(re,qe)),te.push(Le),xe=pe+1);return te.push(U.slice(xe,pe)),te.join("")}}function N(U,Q){return function(re){var te=gh(1900,void 0,1),pe=w(te,U,re+="",0),xe,he;if(pe!=re.length)return null;if("Q"in te)return new Date(te.Q);if("s"in te)return new Date(te.s*1e3+("L"in te?te.L:0));if(Q&&!("Z"in te)&&(te.Z=0),"p"in te&&(te.H=te.H%12+te.p*12),te.m===void 0&&(te.m="q"in te?te.q:0),"V"in te){if(te.V<1||te.V>53)return null;"w"in te||(te.w=1),"Z"in te?(xe=Rb(gh(te.y,0,1)),he=xe.getUTCDay(),xe=he>4||he===0?J0.ceil(xe):J0(xe),xe=Qx.offset(xe,(te.V-1)*7),te.y=xe.getUTCFullYear(),te.m=xe.getUTCMonth(),te.d=xe.getUTCDate()+(te.w+6)%7):(xe=Mb(gh(te.y,0,1)),he=xe.getDay(),xe=he>4||he===0?X0.ceil(xe):X0(xe),xe=Zm.offset(xe,(te.V-1)*7),te.y=xe.getFullYear(),te.m=xe.getMonth(),te.d=xe.getDate()+(te.w+6)%7)}else("W"in te||"U"in te)&&("w"in te||(te.w="u"in te?te.u%7:"W"in te?1:0),he="Z"in te?Rb(gh(te.y,0,1)).getUTCDay():Mb(gh(te.y,0,1)).getDay(),te.m=0,te.d="W"in te?(te.w+6)%7+te.W*7-(he+5)%7:te.w+te.U*7-(he+6)%7);return"Z"in te?(te.H+=te.Z/100|0,te.M+=te.Z%100,Rb(te)):Mb(te)}}function w(U,Q,re,te){for(var pe=0,xe=Q.length,he=re.length,Le,qe;pe<xe;){if(te>=he)return-1;if(Le=Q.charCodeAt(pe++),Le===37){if(Le=Q.charAt(pe++),qe=_[Le in EA?Q.charAt(pe++):Le],!qe||(te=qe(U,re,te))<0)return-1}else if(Le!=re.charCodeAt(te++))return-1}return te}function E(U,Q,re){var te=u.exec(Q.slice(re));return te?(U.p=d.get(te[0].toLowerCase()),re+te[0].length):-1}function k(U,Q,re){var te=m.exec(Q.slice(re));return te?(U.w=y.get(te[0].toLowerCase()),re+te[0].length):-1}function T(U,Q,re){var te=h.exec(Q.slice(re));return te?(U.w=f.get(te[0].toLowerCase()),re+te[0].length):-1}function P(U,Q,re){var te=b.exec(Q.slice(re));return te?(U.m=v.get(te[0].toLowerCase()),re+te[0].length):-1}function O(U,Q,re){var te=g.exec(Q.slice(re));return te?(U.m=x.get(te[0].toLowerCase()),re+te[0].length):-1}function D(U,Q,re){return w(U,e,Q,re)}function R(U,Q,re){return w(U,r,Q,re)}function B(U,Q,re){return w(U,n,Q,re)}function Y(U){return o[U.getDay()]}function W(U){return i[U.getDay()]}function L(U){return c[U.getMonth()]}function X(U){return l[U.getMonth()]}function G(U){return s[+(U.getHours()>=12)]}function K(U){return 1+~~(U.getMonth()/3)}function q(U){return o[U.getUTCDay()]}function ie(U){return i[U.getUTCDay()]}function ge(U){return c[U.getUTCMonth()]}function be(U){return l[U.getUTCMonth()]}function Ye(U){return s[+(U.getUTCHours()>=12)]}function ze(U){return 1+~~(U.getUTCMonth()/3)}return{format:function(U){var Q=C(U+="",j);return Q.toString=function(){return U},Q},parse:function(U){var Q=N(U+="",!1);return Q.toString=function(){return U},Q},utcFormat:function(U){var Q=C(U+="",S);return Q.toString=function(){return U},Q},utcParse:function(U){var Q=N(U+="",!0);return Q.toString=function(){return U},Q}}}var EA={"-":"",_:" ",0:"0"},Nn=/^\s*\d+/,Xce=/^%/,Jce=/[\\^$*+?|[\]().{}]/g;function Gt(t,e,r){var n=t<0?"-":"",s=(n?-t:t)+"",i=s.length;return n+(i<r?new Array(r-i+1).join(e)+s:s)}function Zce(t){return t.replace(Jce,"\\$&")}function yh(t){return new RegExp("^(?:"+t.map(Zce).join("|")+")","i")}function xh(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function eue(t,e,r){var n=Nn.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function tue(t,e,r){var n=Nn.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function rue(t,e,r){var n=Nn.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function nue(t,e,r){var n=Nn.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function aue(t,e,r){var n=Nn.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function PA(t,e,r){var n=Nn.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function TA(t,e,r){var n=Nn.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function sue(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function iue(t,e,r){var n=Nn.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function oue(t,e,r){var n=Nn.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function AA(t,e,r){var n=Nn.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function lue(t,e,r){var n=Nn.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function IA(t,e,r){var n=Nn.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function cue(t,e,r){var n=Nn.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function uue(t,e,r){var n=Nn.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function due(t,e,r){var n=Nn.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function hue(t,e,r){var n=Nn.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function fue(t,e,r){var n=Xce.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function mue(t,e,r){var n=Nn.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function pue(t,e,r){var n=Nn.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function kA(t,e){return Gt(t.getDate(),e,2)}function gue(t,e){return Gt(t.getHours(),e,2)}function yue(t,e){return Gt(t.getHours()%12||12,e,2)}function xue(t,e){return Gt(1+Zm.count(Xi(t),t),e,3)}function B4(t,e){return Gt(t.getMilliseconds(),e,3)}function vue(t,e){return B4(t,e)+"000"}function bue(t,e){return Gt(t.getMonth()+1,e,2)}function wue(t,e){return Gt(t.getMinutes(),e,2)}function jue(t,e){return Gt(t.getSeconds(),e,2)}function Nue(t){var e=t.getDay();return e===0?7:e}function _ue(t,e){return Gt(Yx.count(Xi(t)-1,t),e,2)}function U4(t){var e=t.getDay();return e>=4||e===0?Ju(t):Ju.ceil(t)}function Sue(t,e){return t=U4(t),Gt(Ju.count(Xi(t),t)+(Xi(t).getDay()===4),e,2)}function Cue(t){return t.getDay()}function Eue(t,e){return Gt(X0.count(Xi(t)-1,t),e,2)}function Pue(t,e){return Gt(t.getFullYear()%100,e,2)}function Tue(t,e){return t=U4(t),Gt(t.getFullYear()%100,e,2)}function Aue(t,e){return Gt(t.getFullYear()%1e4,e,4)}function Iue(t,e){var r=t.getDay();return t=r>=4||r===0?Ju(t):Ju.ceil(t),Gt(t.getFullYear()%1e4,e,4)}function kue(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Gt(e/60|0,"0",2)+Gt(e%60,"0",2)}function OA(t,e){return Gt(t.getUTCDate(),e,2)}function Oue(t,e){return Gt(t.getUTCHours(),e,2)}function Due(t,e){return Gt(t.getUTCHours()%12||12,e,2)}function Mue(t,e){return Gt(1+Qx.count(Ji(t),t),e,3)}function z4(t,e){return Gt(t.getUTCMilliseconds(),e,3)}function Rue(t,e){return z4(t,e)+"000"}function $ue(t,e){return Gt(t.getUTCMonth()+1,e,2)}function Lue(t,e){return Gt(t.getUTCMinutes(),e,2)}function Vue(t,e){return Gt(t.getUTCSeconds(),e,2)}function Fue(t){var e=t.getUTCDay();return e===0?7:e}function Bue(t,e){return Gt(Xx.count(Ji(t)-1,t),e,2)}function q4(t){var e=t.getUTCDay();return e>=4||e===0?Zu(t):Zu.ceil(t)}function Uue(t,e){return t=q4(t),Gt(Zu.count(Ji(t),t)+(Ji(t).getUTCDay()===4),e,2)}function zue(t){return t.getUTCDay()}function que(t,e){return Gt(J0.count(Ji(t)-1,t),e,2)}function Hue(t,e){return Gt(t.getUTCFullYear()%100,e,2)}function Wue(t,e){return t=q4(t),Gt(t.getUTCFullYear()%100,e,2)}function Gue(t,e){return Gt(t.getUTCFullYear()%1e4,e,4)}function Kue(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Zu(t):Zu.ceil(t),Gt(t.getUTCFullYear()%1e4,e,4)}function Que(){return"+0000"}function DA(){return"%"}function MA(t){return+t}function RA(t){return Math.floor(+t/1e3)}var Dc,H4,W4;Yue({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Yue(t){return Dc=Yce(t),H4=Dc.format,Dc.parse,W4=Dc.utcFormat,Dc.utcParse,Dc}function Xue(t){return new Date(t)}function Jue(t){return t instanceof Date?+t:+new Date(+t)}function YS(t,e,r,n,s,i,o,l,c,u){var d=RS(),h=d.invert,f=d.domain,m=u(".%L"),y=u(":%S"),g=u("%I:%M"),x=u("%I %p"),b=u("%a %d"),v=u("%b %d"),j=u("%B"),S=u("%Y");function _(C){return(c(C)<C?m:l(C)<C?y:o(C)<C?g:i(C)<C?x:n(C)<C?s(C)<C?b:v:r(C)<C?j:S)(C)}return d.invert=function(C){return new Date(h(C))},d.domain=function(C){return arguments.length?f(Array.from(C,Jue)):f().map(Xue)},d.ticks=function(C){var N=f();return t(N[0],N[N.length-1],C??10)},d.tickFormat=function(C,N){return N==null?_:u(N)},d.nice=function(C){var N=f();return(!C||typeof C.range!="function")&&(C=e(N[0],N[N.length-1],C??10)),C?f(k4(N,C)):d},d.copy=function(){return Jm(d,YS(t,e,r,n,s,i,o,l,c,u))},d}function Zue(){return vs.apply(YS(Kce,Qce,Xi,KS,Yx,Zm,WS,qS,Rl,H4).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ede(){return vs.apply(YS(Wce,Gce,Ji,QS,Xx,Qx,GS,HS,Rl,W4).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Jx(){var t=0,e=1,r,n,s,i,o=oa,l=!1,c;function u(h){return h==null||isNaN(h=+h)?c:o(s===0?.5:(h=(i(h)-r)*s,l?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([t,e]=h,r=i(t=+t),n=i(e=+e),s=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(h){return arguments.length?(l=!!h,u):l},u.interpolator=function(h){return arguments.length?(o=h,u):o};function d(h){return function(f){var m,y;return arguments.length?([m,y]=f,o=h(m,y),u):[o(0),o(1)]}}return u.range=d(zd),u.rangeRound=d(MS),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return i=h,r=h(t),n=h(e),s=r===n?0:1/(n-r),u}}function ll(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function G4(){var t=ol(Jx()(oa));return t.copy=function(){return ll(t,G4())},so.apply(t,arguments)}function K4(){var t=VS(Jx()).domain([1,10]);return t.copy=function(){return ll(t,K4()).base(t.base())},so.apply(t,arguments)}function Q4(){var t=FS(Jx());return t.copy=function(){return ll(t,Q4()).constant(t.constant())},so.apply(t,arguments)}function XS(){var t=BS(Jx());return t.copy=function(){return ll(t,XS()).exponent(t.exponent())},so.apply(t,arguments)}function tde(){return XS.apply(null,arguments).exponent(.5)}function Y4(){var t=[],e=oa;function r(n){if(n!=null&&!isNaN(n=+n))return e((Ym(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let s of n)s!=null&&!isNaN(s=+s)&&t.push(s);return t.sort(qo),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,s)=>e(s/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(s,i)=>Ble(t,i/n))},r.copy=function(){return Y4(e).domain(t)},so.apply(r,arguments)}function Zx(){var t=0,e=.5,r=1,n=1,s,i,o,l,c,u=oa,d,h=!1,f;function m(g){return isNaN(g=+g)?f:(g=.5+((g=+d(g))-i)*(n*g<n*i?l:c),u(h?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([t,e,r]=g,s=d(t=+t),i=d(e=+e),o=d(r=+r),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),n=i<s?-1:1,m):[t,e,r]},m.clamp=function(g){return arguments.length?(h=!!g,m):h},m.interpolator=function(g){return arguments.length?(u=g,m):u};function y(g){return function(x){var b,v,j;return arguments.length?([b,v,j]=x,u=fce(g,[b,v,j]),m):[u(0),u(.5),u(1)]}}return m.range=y(zd),m.rangeRound=y(MS),m.unknown=function(g){return arguments.length?(f=g,m):f},function(g){return d=g,s=g(t),i=g(e),o=g(r),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),n=i<s?-1:1,m}}function X4(){var t=ol(Zx()(oa));return t.copy=function(){return ll(t,X4())},so.apply(t,arguments)}function J4(){var t=VS(Zx()).domain([.1,1,10]);return t.copy=function(){return ll(t,J4()).base(t.base())},so.apply(t,arguments)}function Z4(){var t=FS(Zx());return t.copy=function(){return ll(t,Z4()).constant(t.constant())},so.apply(t,arguments)}function JS(){var t=BS(Zx());return t.copy=function(){return ll(t,JS()).exponent(t.exponent())},so.apply(t,arguments)}function rde(){return JS.apply(null,arguments).exponent(.5)}const $A=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Kf,scaleDiverging:X4,scaleDivergingLog:J4,scaleDivergingPow:JS,scaleDivergingSqrt:rde,scaleDivergingSymlog:Z4,scaleIdentity:I4,scaleImplicit:o1,scaleLinear:Q0,scaleLog:O4,scaleOrdinal:kS,scalePoint:nf,scalePow:US,scaleQuantile:R4,scaleQuantize:$4,scaleRadial:M4,scaleSequential:G4,scaleSequentialLog:K4,scaleSequentialPow:XS,scaleSequentialQuantile:Y4,scaleSequentialSqrt:tde,scaleSequentialSymlog:Q4,scaleSqrt:Rce,scaleSymlog:D4,scaleThreshold:L4,scaleTime:Zue,scaleUtc:ede,tickFormat:A4},Symbol.toStringTag,{value:"Module"}));var nde=Od;function ade(t,e,r){for(var n=-1,s=t.length;++n<s;){var i=t[n],o=e(i);if(o!=null&&(l===void 0?o===o&&!nde(o):r(o,l)))var l=o,c=i}return c}var ev=ade;function sde(t,e){return t>e}var e6=sde,ide=ev,ode=e6,lde=Ud;function cde(t){return t&&t.length?ide(t,lde,ode):void 0}var ude=cde;const Io=er(ude);function dde(t,e){return t<e}var t6=dde,hde=ev,fde=t6,mde=Ud;function pde(t){return t&&t.length?hde(t,mde,fde):void 0}var gde=pde;const tv=er(gde);var yde=hS,xde=mi,vde=c4,bde=Ea;function wde(t,e){var r=bde(t)?yde:vde;return r(t,xde(e))}var jde=wde,Nde=o4,_de=jde;function Sde(t,e){return Nde(_de(t,e),1)}var Cde=Sde;const Ede=er(Cde);var Pde=ES;function Tde(t,e){return Pde(t,e)}var Ade=Tde;const ed=er(Ade);var qd=1e9,Ide={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},e2,Pr=!0,gs="[DecimalError] ",Hl=gs+"Invalid argument: ",ZS=gs+"Exponent out of range: ",Hd=Math.floor,Pl=Math.pow,kde=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ma,mn=1e7,jr=7,r6=9007199254740991,Z0=Hd(r6/jr),rt={};rt.absoluteValue=rt.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};rt.comparedTo=rt.cmp=function(t){var e,r,n,s,i=this;if(t=new i.constructor(t),i.s!==t.s)return i.s||-t.s;if(i.e!==t.e)return i.e>t.e^i.s<0?1:-1;for(n=i.d.length,s=t.d.length,e=0,r=n<s?n:s;e<r;++e)if(i.d[e]!==t.d[e])return i.d[e]>t.d[e]^i.s<0?1:-1;return n===s?0:n>s^i.s<0?1:-1};rt.decimalPlaces=rt.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*jr;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};rt.dividedBy=rt.div=function(t){return Vi(this,new this.constructor(t))};rt.dividedToIntegerBy=rt.idiv=function(t){var e=this,r=e.constructor;return hr(Vi(e,new r(t),0,1),r.precision)};rt.equals=rt.eq=function(t){return!this.cmp(t)};rt.exponent=function(){return tn(this)};rt.greaterThan=rt.gt=function(t){return this.cmp(t)>0};rt.greaterThanOrEqualTo=rt.gte=function(t){return this.cmp(t)>=0};rt.isInteger=rt.isint=function(){return this.e>this.d.length-2};rt.isNegative=rt.isneg=function(){return this.s<0};rt.isPositive=rt.ispos=function(){return this.s>0};rt.isZero=function(){return this.s===0};rt.lessThan=rt.lt=function(t){return this.cmp(t)<0};rt.lessThanOrEqualTo=rt.lte=function(t){return this.cmp(t)<1};rt.logarithm=rt.log=function(t){var e,r=this,n=r.constructor,s=n.precision,i=s+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(Ma))throw Error(gs+"NaN");if(r.s<1)throw Error(gs+(r.s?"NaN":"-Infinity"));return r.eq(Ma)?new n(0):(Pr=!1,e=Vi(Zf(r,i),Zf(t,i),i),Pr=!0,hr(e,s))};rt.minus=rt.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?s6(e,t):n6(e,(t.s=-t.s,t))};rt.modulo=rt.mod=function(t){var e,r=this,n=r.constructor,s=n.precision;if(t=new n(t),!t.s)throw Error(gs+"NaN");return r.s?(Pr=!1,e=Vi(r,t,0,1).times(t),Pr=!0,r.minus(e)):hr(new n(r),s)};rt.naturalExponential=rt.exp=function(){return a6(this)};rt.naturalLogarithm=rt.ln=function(){return Zf(this)};rt.negated=rt.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};rt.plus=rt.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?n6(e,t):s6(e,(t.s=-t.s,t))};rt.precision=rt.sd=function(t){var e,r,n,s=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Hl+t);if(e=tn(s)+1,n=s.d.length-1,r=n*jr+1,n=s.d[n],n){for(;n%10==0;n/=10)r--;for(n=s.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};rt.squareRoot=rt.sqrt=function(){var t,e,r,n,s,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(gs+"NaN")}for(t=tn(l),Pr=!1,s=Math.sqrt(+l),s==0||s==1/0?(e=Ys(l.d),(e.length+t)%2==0&&(e+="0"),s=Math.sqrt(e),t=Hd((t+1)/2)-(t<0||t%2),s==1/0?e="5e"+t:(e=s.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(s.toString()),r=c.precision,s=o=r+3;;)if(i=n,n=i.plus(Vi(l,i,o+2)).times(.5),Ys(i.d).slice(0,o)===(e=Ys(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),s==o&&e=="4999"){if(hr(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(e!="9999")break;o+=4}return Pr=!0,hr(n,r)};rt.times=rt.mul=function(t){var e,r,n,s,i,o,l,c,u,d=this,h=d.constructor,f=d.d,m=(t=new h(t)).d;if(!d.s||!t.s)return new h(0);for(t.s*=d.s,r=d.e+t.e,c=f.length,u=m.length,c<u&&(i=f,f=m,m=i,o=c,c=u,u=o),i=[],o=c+u,n=o;n--;)i.push(0);for(n=u;--n>=0;){for(e=0,s=c+n;s>n;)l=i[s]+m[n]*f[s-n-1]+e,i[s--]=l%mn|0,e=l/mn|0;i[s]=(i[s]+e)%mn|0}for(;!i[--o];)i.pop();return e?++r:i.shift(),t.d=i,t.e=r,Pr?hr(t,h.precision):t};rt.toDecimalPlaces=rt.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(ui(t,0,qd),e===void 0?e=n.rounding:ui(e,0,8),hr(r,t+tn(r)+1,e))};rt.toExponential=function(t,e){var r,n=this,s=n.constructor;return t===void 0?r=dc(n,!0):(ui(t,0,qd),e===void 0?e=s.rounding:ui(e,0,8),n=hr(new s(n),t+1,e),r=dc(n,!0,t+1)),r};rt.toFixed=function(t,e){var r,n,s=this,i=s.constructor;return t===void 0?dc(s):(ui(t,0,qd),e===void 0?e=i.rounding:ui(e,0,8),n=hr(new i(s),t+tn(s)+1,e),r=dc(n.abs(),!1,t+tn(n)+1),s.isneg()&&!s.isZero()?"-"+r:r)};rt.toInteger=rt.toint=function(){var t=this,e=t.constructor;return hr(new e(t),tn(t)+1,e.rounding)};rt.toNumber=function(){return+this};rt.toPower=rt.pow=function(t){var e,r,n,s,i,o,l=this,c=l.constructor,u=12,d=+(t=new c(t));if(!t.s)return new c(Ma);if(l=new c(l),!l.s){if(t.s<1)throw Error(gs+"Infinity");return l}if(l.eq(Ma))return l;if(n=c.precision,t.eq(Ma))return hr(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,i=l.s,o){if((r=d<0?-d:d)<=r6){for(s=new c(Ma),e=Math.ceil(n/jr+4),Pr=!1;r%2&&(s=s.times(l),VA(s.d,e)),r=Hd(r/2),r!==0;)l=l.times(l),VA(l.d,e);return Pr=!0,t.s<0?new c(Ma).div(s):hr(s,n)}}else if(i<0)throw Error(gs+"NaN");return i=i<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,Pr=!1,s=t.times(Zf(l,n+u)),Pr=!0,s=a6(s),s.s=i,s};rt.toPrecision=function(t,e){var r,n,s=this,i=s.constructor;return t===void 0?(r=tn(s),n=dc(s,r<=i.toExpNeg||r>=i.toExpPos)):(ui(t,1,qd),e===void 0?e=i.rounding:ui(e,0,8),s=hr(new i(s),t,e),r=tn(s),n=dc(s,t<=r||r<=i.toExpNeg,t)),n};rt.toSignificantDigits=rt.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(ui(t,1,qd),e===void 0?e=n.rounding:ui(e,0,8)),hr(new n(r),t,e)};rt.toString=rt.valueOf=rt.val=rt.toJSON=rt[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=tn(t),r=t.constructor;return dc(t,e<=r.toExpNeg||e>=r.toExpPos)};function n6(t,e){var r,n,s,i,o,l,c,u,d=t.constructor,h=d.precision;if(!t.s||!e.s)return e.s||(e=new d(t)),Pr?hr(e,h):e;if(c=t.d,u=e.d,o=t.e,s=e.e,c=c.slice(),i=o-s,i){for(i<0?(n=c,i=-i,l=u.length):(n=u,s=o,l=c.length),o=Math.ceil(h/jr),l=o>l?o+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/mn|0,c[i]%=mn;for(r&&(c.unshift(r),++s),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=s,Pr?hr(e,h):e}function ui(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Hl+t)}function Ys(t){var e,r,n,s=t.length-1,i="",o=t[0];if(s>0){for(i+=o,e=1;e<s;e++)n=t[e]+"",r=jr-n.length,r&&(i+=vo(r)),i+=n;o=t[e],n=o+"",r=jr-n.length,r&&(i+=vo(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Vi=function(){function t(n,s){var i,o=0,l=n.length;for(n=n.slice();l--;)i=n[l]*s+o,n[l]=i%mn|0,o=i/mn|0;return o&&n.unshift(o),n}function e(n,s,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=s[l]){c=n[l]>s[l]?1:-1;break}return c}function r(n,s,i){for(var o=0;i--;)n[i]-=o,o=n[i]<s[i]?1:0,n[i]=o*mn+n[i]-s[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,i,o){var l,c,u,d,h,f,m,y,g,x,b,v,j,S,_,C,N,w,E=n.constructor,k=n.s==s.s?1:-1,T=n.d,P=s.d;if(!n.s)return new E(n);if(!s.s)throw Error(gs+"Division by zero");for(c=n.e-s.e,N=P.length,_=T.length,m=new E(k),y=m.d=[],u=0;P[u]==(T[u]||0);)++u;if(P[u]>(T[u]||0)&&--c,i==null?v=i=E.precision:o?v=i+(tn(n)-tn(s))+1:v=i,v<0)return new E(0);if(v=v/jr+2|0,u=0,N==1)for(d=0,P=P[0],v++;(u<_||d)&&v--;u++)j=d*mn+(T[u]||0),y[u]=j/P|0,d=j%P|0;else{for(d=mn/(P[0]+1)|0,d>1&&(P=t(P,d),T=t(T,d),N=P.length,_=T.length),S=N,g=T.slice(0,N),x=g.length;x<N;)g[x++]=0;w=P.slice(),w.unshift(0),C=P[0],P[1]>=mn/2&&++C;do d=0,l=e(P,g,N,x),l<0?(b=g[0],N!=x&&(b=b*mn+(g[1]||0)),d=b/C|0,d>1?(d>=mn&&(d=mn-1),h=t(P,d),f=h.length,x=g.length,l=e(h,g,f,x),l==1&&(d--,r(h,N<f?w:P,f))):(d==0&&(l=d=1),h=P.slice()),f=h.length,f<x&&h.unshift(0),r(g,h,x),l==-1&&(x=g.length,l=e(P,g,N,x),l<1&&(d++,r(g,N<x?w:P,x))),x=g.length):l===0&&(d++,g=[0]),y[u++]=d,l&&g[0]?g[x++]=T[S]||0:(g=[T[S]],x=1);while((S++<_||g[0]!==void 0)&&v--)}return y[0]||y.shift(),m.e=c,hr(m,o?i+tn(m)+1:i)}}();function a6(t,e){var r,n,s,i,o,l,c=0,u=0,d=t.constructor,h=d.precision;if(tn(t)>16)throw Error(ZS+tn(t));if(!t.s)return new d(Ma);for(e==null?(Pr=!1,l=h):l=e,o=new d(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(n=Math.log(Pl(2,u))/Math.LN10*2+5|0,l+=n,r=s=i=new d(Ma),d.precision=l;;){if(s=hr(s.times(t),l),r=r.times(++c),o=i.plus(Vi(s,r,l)),Ys(o.d).slice(0,l)===Ys(i.d).slice(0,l)){for(;u--;)i=hr(i.times(i),l);return d.precision=h,e==null?(Pr=!0,hr(i,h)):i}i=o}}function tn(t){for(var e=t.e*jr,r=t.d[0];r>=10;r/=10)e++;return e}function $b(t,e,r){if(e>t.LN10.sd())throw Pr=!0,r&&(t.precision=r),Error(gs+"LN10 precision limit exceeded");return hr(new t(t.LN10),e)}function vo(t){for(var e="";t--;)e+="0";return e}function Zf(t,e){var r,n,s,i,o,l,c,u,d,h=1,f=10,m=t,y=m.d,g=m.constructor,x=g.precision;if(m.s<1)throw Error(gs+(m.s?"NaN":"-Infinity"));if(m.eq(Ma))return new g(0);if(e==null?(Pr=!1,u=x):u=e,m.eq(10))return e==null&&(Pr=!0),$b(g,u);if(u+=f,g.precision=u,r=Ys(y),n=r.charAt(0),i=tn(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(t),r=Ys(m.d),n=r.charAt(0),h++;i=tn(m),n>1?(m=new g("0."+r),i++):m=new g(n+"."+r.slice(1))}else return c=$b(g,u+2,x).times(i+""),m=Zf(new g(n+"."+r.slice(1)),u-f).plus(c),g.precision=x,e==null?(Pr=!0,hr(m,x)):m;for(l=o=m=Vi(m.minus(Ma),m.plus(Ma),u),d=hr(m.times(m),u),s=3;;){if(o=hr(o.times(d),u),c=l.plus(Vi(o,new g(s),u)),Ys(c.d).slice(0,u)===Ys(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus($b(g,u+2,x).times(i+""))),l=Vi(l,new g(h),u),g.precision=x,e==null?(Pr=!0,hr(l,x)):l;l=c,s+=2}}function LA(t,e){var r,n,s;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(s=e.length;e.charCodeAt(s-1)===48;)--s;if(e=e.slice(n,s),e){if(s-=n,r=r-n-1,t.e=Hd(r/jr),t.d=[],n=(r+1)%jr,r<0&&(n+=jr),n<s){for(n&&t.d.push(+e.slice(0,n)),s-=jr;n<s;)t.d.push(+e.slice(n,n+=jr));e=e.slice(n),n=jr-e.length}else n-=s;for(;n--;)e+="0";if(t.d.push(+e),Pr&&(t.e>Z0||t.e<-Z0))throw Error(ZS+r)}else t.s=0,t.e=0,t.d=[0];return t}function hr(t,e,r){var n,s,i,o,l,c,u,d,h=t.d;for(o=1,i=h[0];i>=10;i/=10)o++;if(n=e-o,n<0)n+=jr,s=e,u=h[d=0];else{if(d=Math.ceil((n+1)/jr),i=h.length,d>=i)return t;for(u=i=h[d],o=1;i>=10;i/=10)o++;n%=jr,s=n-jr+o}if(r!==void 0&&(i=Pl(10,o-s-1),l=u/i%10|0,c=e<0||h[d+1]!==void 0||u%i,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?s>0?u/Pl(10,o-s):0:h[d-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return c?(i=tn(t),h.length=1,e=e-i-1,h[0]=Pl(10,(jr-e%jr)%jr),t.e=Hd(-e/jr)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=d,i=1,d--):(h.length=d+1,i=Pl(10,jr-n),h[d]=s>0?(u/Pl(10,o-s)%Pl(10,s)|0)*i:0),c)for(;;)if(d==0){(h[0]+=i)==mn&&(h[0]=1,++t.e);break}else{if(h[d]+=i,h[d]!=mn)break;h[d--]=0,i=1}for(n=h.length;h[--n]===0;)h.pop();if(Pr&&(t.e>Z0||t.e<-Z0))throw Error(ZS+tn(t));return t}function s6(t,e){var r,n,s,i,o,l,c,u,d,h,f=t.constructor,m=f.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new f(t),Pr?hr(e,m):e;if(c=t.d,h=e.d,n=e.e,u=t.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=h.length):(r=h,n=u,l=c.length),s=Math.max(Math.ceil(m/jr),l)+2,o>s&&(o=s,r.length=1),r.reverse(),s=o;s--;)r.push(0);r.reverse()}else{for(s=c.length,l=h.length,d=s<l,d&&(l=s),s=0;s<l;s++)if(c[s]!=h[s]){d=c[s]<h[s];break}o=0}for(d&&(r=c,c=h,h=r,e.s=-e.s),l=c.length,s=h.length-l;s>0;--s)c[l++]=0;for(s=h.length;s>o;){if(c[--s]<h[s]){for(i=s;i&&c[--i]===0;)c[i]=mn-1;--c[i],c[s]+=mn}c[s]-=h[s]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,Pr?hr(e,m):e):new f(0)}function dc(t,e,r){var n,s=tn(t),i=Ys(t.d),o=i.length;return e?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+vo(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(s<0?"e":"e+")+s):s<0?(i="0."+vo(-s-1)+i,r&&(n=r-o)>0&&(i+=vo(n))):s>=o?(i+=vo(s+1-o),r&&(n=r-s-1)>0&&(i=i+"."+vo(n))):((n=s+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(s+1===o&&(i+="."),i+=vo(n))),t.s<0?"-"+i:i}function VA(t,e){if(t.length>e)return t.length=e,!0}function i6(t){var e,r,n;function s(i){var o=this;if(!(o instanceof s))return new s(i);if(o.constructor=s,i instanceof s){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Hl+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return LA(o,i.toString())}else if(typeof i!="string")throw Error(Hl+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,kde.test(i))LA(o,i);else throw Error(Hl+i)}if(s.prototype=rt,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=i6,s.config=s.set=Ode,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return s.config(t),s}function Ode(t){if(!t||typeof t!="object")throw Error(gs+"Object expected");var e,r,n,s=["precision",1,qd,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<s.length;e+=3)if((n=t[r=s[e]])!==void 0)if(Hd(n)===n&&n>=s[e+1]&&n<=s[e+2])this[r]=n;else throw Error(Hl+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Hl+r+": "+n);return this}var e2=i6(Ide);Ma=new e2(1);const ir=e2;function Dde(t){return Lde(t)||$de(t)||Rde(t)||Mde()}function Mde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rde(t,e){if(t){if(typeof t=="string")return d1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d1(t,e)}}function $de(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Lde(t){if(Array.isArray(t))return d1(t)}function d1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Vde=function(e){return e},o6={"@@functional/placeholder":!0},l6=function(e){return e===o6},FA=function(e){return function r(){return arguments.length===0||arguments.length===1&&l6(arguments.length<=0?void 0:arguments[0])?r:e.apply(void 0,arguments)}},Fde=function t(e,r){return e===1?r:FA(function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];var o=s.filter(function(l){return l!==o6}).length;return o>=e?r.apply(void 0,s):t(e-o,FA(function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=s.map(function(h){return l6(h)?c.shift():h});return r.apply(void 0,Dde(d).concat(c))}))})},rv=function(e){return Fde(e.length,e)},h1=function(e,r){for(var n=[],s=e;s<r;++s)n[s-e]=s;return n},Bde=rv(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(r){return e[r]}).map(t)}),Ude=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return Vde;var s=r.reverse(),i=s[0],o=s.slice(1);return function(){return o.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},f1=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},c6=function(e){var r=null,n=null;return function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r&&i.every(function(l,c){return l===r[c]})||(r=i,n=e.apply(void 0,i)),n}};function zde(t){var e;return t===0?e=1:e=Math.floor(new ir(t).abs().log(10).toNumber())+1,e}function qde(t,e,r){for(var n=new ir(t),s=0,i=[];n.lt(e)&&s<1e5;)i.push(n.toNumber()),n=n.add(r),s++;return i}var Hde=rv(function(t,e,r){var n=+t,s=+e;return n+r*(s-n)}),Wde=rv(function(t,e,r){var n=e-+t;return n=n||1/0,(r-t)/n}),Gde=rv(function(t,e,r){var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});const nv={rangeStep:qde,getDigitCount:zde,interpolateNumber:Hde,uninterpolateNumber:Wde,uninterpolateTruncation:Gde};function m1(t){return Yde(t)||Qde(t)||u6(t)||Kde()}function Kde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qde(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Yde(t){if(Array.isArray(t))return p1(t)}function em(t,e){return Zde(t)||Jde(t,e)||u6(t,e)||Xde()}function Xde(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u6(t,e){if(t){if(typeof t=="string")return p1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p1(t,e)}}function p1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Jde(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],n=!0,s=!1,i=void 0;try{for(var o=t[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(e&&r.length===e));n=!0);}catch(c){s=!0,i=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(s)throw i}}return r}}function Zde(t){if(Array.isArray(t))return t}function d6(t){var e=em(t,2),r=e[0],n=e[1],s=r,i=n;return r>n&&(s=n,i=r),[s,i]}function h6(t,e,r){if(t.lte(0))return new ir(0);var n=nv.getDigitCount(t.toNumber()),s=new ir(10).pow(n),i=t.div(s),o=n!==1?.05:.1,l=new ir(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(s);return e?c:new ir(Math.ceil(c))}function ehe(t,e,r){var n=1,s=new ir(t);if(!s.isint()&&r){var i=Math.abs(t);i<1?(n=new ir(10).pow(nv.getDigitCount(t)-1),s=new ir(Math.floor(s.div(n).toNumber())).mul(n)):i>1&&(s=new ir(Math.floor(t)))}else t===0?s=new ir(Math.floor((e-1)/2)):r||(s=new ir(Math.floor(t)));var o=Math.floor((e-1)/2),l=Ude(Bde(function(c){return s.add(new ir(c-o).mul(n)).toNumber()}),h1);return l(0,e)}function f6(t,e,r,n){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(r-1)))return{step:new ir(0),tickMin:new ir(0),tickMax:new ir(0)};var i=h6(new ir(e).sub(t).div(r-1),n,s),o;t<=0&&e>=0?o=new ir(0):(o=new ir(t).add(e).div(2),o=o.sub(new ir(o).mod(i)));var l=Math.ceil(o.sub(t).div(i).toNumber()),c=Math.ceil(new ir(e).sub(o).div(i).toNumber()),u=l+c+1;return u>r?f6(t,e,r,n,s+1):(u<r&&(c=e>0?c+(r-u):c,l=e>0?l:l+(r-u)),{step:i,tickMin:o.sub(new ir(l).mul(i)),tickMax:o.add(new ir(c).mul(i))})}function the(t){var e=em(t,2),r=e[0],n=e[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(s,2),l=d6([r,n]),c=em(l,2),u=c[0],d=c[1];if(u===-1/0||d===1/0){var h=d===1/0?[u].concat(m1(h1(0,s-1).map(function(){return 1/0}))):[].concat(m1(h1(0,s-1).map(function(){return-1/0})),[d]);return r>n?f1(h):h}if(u===d)return ehe(u,s,i);var f=f6(u,d,o,i),m=f.step,y=f.tickMin,g=f.tickMax,x=nv.rangeStep(y,g.add(new ir(.1).mul(m)),m);return r>n?f1(x):x}function rhe(t,e){var r=em(t,2),n=r[0],s=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=d6([n,s]),l=em(o,2),c=l[0],u=l[1];if(c===-1/0||u===1/0)return[n,s];if(c===u)return[c];var d=Math.max(e,2),h=h6(new ir(u).sub(c).div(d-1),i,0),f=[].concat(m1(nv.rangeStep(new ir(c),new ir(u).sub(new ir(.99).mul(h)),h)),[u]);return n>s?f1(f):f}var nhe=c6(the),ahe=c6(rhe),she="Invariant failed";function hc(t,e){throw new Error(she)}var ihe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function td(t){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},td(t)}function ey(){return ey=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ey.apply(this,arguments)}function ohe(t,e){return dhe(t)||uhe(t,e)||che(t,e)||lhe()}function lhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function che(t,e){if(t){if(typeof t=="string")return BA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BA(t,e)}}function BA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function uhe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function dhe(t){if(Array.isArray(t))return t}function hhe(t,e){if(t==null)return{};var r=fhe(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function fhe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function mhe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function phe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g6(n.key),n)}}function ghe(t,e,r){return e&&phe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function yhe(t,e,r){return e=ty(e),xhe(t,m6()?Reflect.construct(e,r||[],ty(t).constructor):e.apply(t,r))}function xhe(t,e){if(e&&(td(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vhe(t)}function vhe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(m6=function(){return!!t})()}function ty(t){return ty=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ty(t)}function bhe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g1(t,e)}function g1(t,e){return g1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},g1(t,e)}function p6(t,e,r){return e=g6(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g6(t){var e=whe(t,"string");return td(e)=="symbol"?e:e+""}function whe(t,e){if(td(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(td(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var av=function(t){function e(){return mhe(this,e),yhe(this,e,arguments)}return bhe(e,t),ghe(e,[{key:"render",value:function(){var n=this.props,s=n.offset,i=n.layout,o=n.width,l=n.dataKey,c=n.data,u=n.dataPointFormatter,d=n.xAxis,h=n.yAxis,f=hhe(n,ihe),m=ft(f,!1);this.props.direction==="x"&&d.type!=="number"&&hc();var y=c.map(function(g){var x=u(g,l),b=x.x,v=x.y,j=x.value,S=x.errorVal;if(!S)return null;var _=[],C,N;if(Array.isArray(S)){var w=ohe(S,2);C=w[0],N=w[1]}else C=N=S;if(i==="vertical"){var E=d.scale,k=v+s,T=k+o,P=k-o,O=E(j-C),D=E(j+N);_.push({x1:D,y1:T,x2:D,y2:P}),_.push({x1:O,y1:k,x2:D,y2:k}),_.push({x1:O,y1:T,x2:O,y2:P})}else if(i==="horizontal"){var R=h.scale,B=b+s,Y=B-o,W=B+o,L=R(j-C),X=R(j+N);_.push({x1:Y,y1:X,x2:W,y2:X}),_.push({x1:B,y1:L,x2:B,y2:X}),_.push({x1:Y,y1:L,x2:W,y2:L})}return ee.createElement(Ft,ey({className:"recharts-errorBar",key:"bar-".concat(_.map(function(G){return"".concat(G.x1,"-").concat(G.x2,"-").concat(G.y1,"-").concat(G.y2)}))},m),_.map(function(G){return ee.createElement("line",ey({},G,{key:"line-".concat(G.x1,"-").concat(G.x2,"-").concat(G.y1,"-").concat(G.y2)}))}))});return ee.createElement(Ft,{className:"recharts-errorBars"},y)}}])}(ee.Component);p6(av,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});p6(av,"displayName","ErrorBar");function tm(t){"@babel/helpers - typeof";return tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tm(t)}function UA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function yl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?UA(Object(r),!0).forEach(function(n){jhe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):UA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jhe(t,e,r){return e=Nhe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nhe(t){var e=_he(t,"string");return tm(e)=="symbol"?e:e+""}function _he(t,e){if(tm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(tm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var y6=function(e){var r=e.children,n=e.formattedGraphicalItems,s=e.legendWidth,i=e.legendContent,o=ka(r,wu);if(!o)return null;var l=wu.defaultProps,c=l!==void 0?yl(yl({},l),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:i==="children"?u=(n||[]).reduce(function(d,h){var f=h.item,m=h.props,y=m.sectors||m.data||[];return d.concat(y.map(function(g){return{type:o.props.iconType||f.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):u=(n||[]).map(function(d){var h=d.item,f=h.type.defaultProps,m=f!==void 0?yl(yl({},f),h.props):{},y=m.dataKey,g=m.name,x=m.legendType,b=m.hide;return{inactive:b,dataKey:y,type:c.iconType||x||"square",color:t2(h),value:g||y,payload:m}}),yl(yl(yl({},c),wu.getWithHeight(o,s)),{},{payload:u,item:o})};function rm(t){"@babel/helpers - typeof";return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rm(t)}function zA(t){return Phe(t)||Ehe(t)||Che(t)||She()}function She(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Che(t,e){if(t){if(typeof t=="string")return y1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y1(t,e)}}function Ehe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Phe(t){if(Array.isArray(t))return y1(t)}function y1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Ur(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qA(Object(r),!0).forEach(function(n){Nu(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nu(t,e,r){return e=The(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function The(t){var e=Ahe(t,"string");return rm(e)=="symbol"?e:e+""}function Ahe(t,e){if(rm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function on(t,e,r){return Pt(t)||Pt(e)?r:cn(e)?Fa(t,e,r):bt(e)?e(t):r}function af(t,e,r,n){var s=Ede(t,function(l){return on(l,e)});if(r==="number"){var i=s.filter(function(l){return Me(l)||parseFloat(l)});return i.length?[tv(i),Io(i)]:[1/0,-1/0]}var o=n?s.filter(function(l){return!Pt(l)}):s;return o.map(function(l){return cn(l)||l instanceof Date?l:""})}var Ihe=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,u=0;u<l;u++){var d=u>0?s[u-1].coordinate:s[l-1].coordinate,h=s[u].coordinate,f=u>=l-1?s[0].coordinate:s[u+1].coordinate,m=void 0;if(sa(h-d)!==sa(f-h)){var y=[];if(sa(f-h)===sa(c[1]-c[0])){m=f;var g=h+c[1]-c[0];y[0]=Math.min(g,(g+d)/2),y[1]=Math.max(g,(g+d)/2)}else{m=d;var x=f+c[1]-c[0];y[0]=Math.min(h,(x+h)/2),y[1]=Math.max(h,(x+h)/2)}var b=[Math.min(h,(m+h)/2),Math.max(h,(m+h)/2)];if(e>b[0]&&e<=b[1]||e>=y[0]&&e<=y[1]){o=s[u].index;break}}else{var v=Math.min(d,f),j=Math.max(d,f);if(e>(v+h)/2&&e<=(j+h)/2){o=s[u].index;break}}}else for(var S=0;S<l;S++)if(S===0&&e<=(n[S].coordinate+n[S+1].coordinate)/2||S>0&&S<l-1&&e>(n[S].coordinate+n[S-1].coordinate)/2&&e<=(n[S].coordinate+n[S+1].coordinate)/2||S===l-1&&e>(n[S].coordinate+n[S-1].coordinate)/2){o=n[S].index;break}return o},t2=function(e){var r,n=e,s=n.type.displayName,i=(r=e.type)!==null&&r!==void 0&&r.defaultProps?Ur(Ur({},e.type.defaultProps),e.props):e.props,o=i.stroke,l=i.fill,c;switch(s){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},khe=function(e){var r=e.barSize,n=e.totalSize,s=e.stackGroups,i=s===void 0?{}:s;if(!i)return{};for(var o={},l=Object.keys(i),c=0,u=l.length;c<u;c++)for(var d=i[l[c]].stackGroups,h=Object.keys(d),f=0,m=h.length;f<m;f++){var y=d[h[f]],g=y.items,x=y.cateAxisId,b=g.filter(function(N){return Li(N.type).indexOf("Bar")>=0});if(b&&b.length){var v=b[0].type.defaultProps,j=v!==void 0?Ur(Ur({},v),b[0].props):b[0].props,S=j.barSize,_=j[x];o[_]||(o[_]=[]);var C=Pt(S)?r:S;o[_].push({item:b[0],stackList:b.slice(1),barSize:Pt(C)?void 0:ia(C,n,0)})}}return o},Ohe=function(e){var r=e.barGap,n=e.barCategoryGap,s=e.bandSize,i=e.sizeList,o=i===void 0?[]:i,l=e.maxBarSize,c=o.length;if(c<1)return null;var u=ia(r,s,0,!0),d,h=[];if(o[0].barSize===+o[0].barSize){var f=!1,m=s/c,y=o.reduce(function(S,_){return S+_.barSize||0},0);y+=(c-1)*u,y>=s&&(y-=(c-1)*u,u=0),y>=s&&m>0&&(f=!0,m*=.9,y=c*m);var g=(s-y)/2>>0,x={offset:g-u,size:0};d=o.reduce(function(S,_){var C={item:_.item,position:{offset:x.offset+x.size+u,size:f?m:_.barSize}},N=[].concat(zA(S),[C]);return x=N[N.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(w){N.push({item:w,position:x})}),N},h)}else{var b=ia(n,s,0,!0);s-2*b-(c-1)*u<=0&&(u=0);var v=(s-2*b-(c-1)*u)/c;v>1&&(v>>=0);var j=l===+l?Math.min(v,l):v;d=o.reduce(function(S,_,C){var N=[].concat(zA(S),[{item:_.item,position:{offset:b+(v+u)*C+(v-j)/2,size:j}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(w){N.push({item:w,position:N[N.length-1].position})}),N},h)}return d},Dhe=function(e,r,n,s){var i=n.children,o=n.width,l=n.margin,c=o-(l.left||0)-(l.right||0),u=y6({children:i,legendWidth:c});if(u){var d=s||{},h=d.width,f=d.height,m=u.align,y=u.verticalAlign,g=u.layout;if((g==="vertical"||g==="horizontal"&&y==="middle")&&m!=="center"&&Me(e[m]))return Ur(Ur({},e),{},Nu({},m,e[m]+(h||0)));if((g==="horizontal"||g==="vertical"&&m==="center")&&y!=="middle"&&Me(e[y]))return Ur(Ur({},e),{},Nu({},y,e[y]+(f||0)))}return e},Mhe=function(e,r,n){return Pt(r)?!0:e==="horizontal"?r==="yAxis":e==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},x6=function(e,r,n,s,i){var o=r.props.children,l=hs(o,av).filter(function(u){return Mhe(s,i,u.props.direction)});if(l&&l.length){var c=l.map(function(u){return u.props.dataKey});return e.reduce(function(u,d){var h=on(d,n);if(Pt(h))return u;var f=Array.isArray(h)?[tv(h),Io(h)]:[h,h],m=c.reduce(function(y,g){var x=on(d,g,0),b=f[0]-Math.abs(Array.isArray(x)?x[0]:x),v=f[1]+Math.abs(Array.isArray(x)?x[1]:x);return[Math.min(b,y[0]),Math.max(v,y[1])]},[1/0,-1/0]);return[Math.min(m[0],u[0]),Math.max(m[1],u[1])]},[1/0,-1/0])}return null},Rhe=function(e,r,n,s,i){var o=r.map(function(l){return x6(e,l,n,i,s)}).filter(function(l){return!Pt(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},v6=function(e,r,n,s,i){var o=r.map(function(c){var u=c.props.dataKey;return n==="number"&&u&&x6(e,c,u,s)||af(e,u,n,i)});if(n==="number")return o.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,u){for(var d=0,h=u.length;d<h;d++)l[u[d]]||(l[u[d]]=!0,c.push(u[d]));return c},[])},b6=function(e,r){return e==="horizontal"&&r==="xAxis"||e==="vertical"&&r==="yAxis"||e==="centric"&&r==="angleAxis"||e==="radial"&&r==="radiusAxis"},w6=function(e,r,n,s){if(s)return e.map(function(c){return c.coordinate});var i,o,l=e.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(o=!0),c.coordinate});return i||l.push(r),o||l.push(n),l},Ii=function(e,r,n){if(!e)return null;var s=e.scale,i=e.duplicateDomain,o=e.type,l=e.range,c=e.realScaleType==="scaleBand"?s.bandwidth()/2:2,u=(r||n)&&o==="category"&&s.bandwidth?s.bandwidth()/c:0;if(u=e.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?sa(l[0]-l[1])*2*u:u,r&&(e.ticks||e.niceTicks)){var d=(e.ticks||e.niceTicks).map(function(h){var f=i?i.indexOf(h):h;return{coordinate:s(f)+u,value:h,offset:u}});return d.filter(function(h){return!Ld(h.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(h,f){return{coordinate:s(h)+u,value:h,index:f,offset:u}}):s.ticks&&!n?s.ticks(e.tickCount).map(function(h){return{coordinate:s(h)+u,value:h,offset:u}}):s.domain().map(function(h,f){return{coordinate:s(h)+u,value:i?i[h]:h,index:f,offset:u}})},Lb=new WeakMap,Qp=function(e,r){if(typeof r!="function")return e;Lb.has(e)||Lb.set(e,new WeakMap);var n=Lb.get(e);if(n.has(r))return n.get(r);var s=function(){e.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,s),s},j6=function(e,r,n){var s=e.scale,i=e.type,o=e.layout,l=e.axisType;if(s==="auto")return o==="radial"&&l==="radiusAxis"?{scale:Kf(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:Q0(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:nf(),realScaleType:"point"}:i==="category"?{scale:Kf(),realScaleType:"band"}:{scale:Q0(),realScaleType:"linear"};if(lc(s)){var c="scale".concat(Bx(s));return{scale:($A[c]||nf)(),realScaleType:$A[c]?c:"point"}}return bt(s)?{scale:s}:{scale:nf(),realScaleType:"point"}},HA=1e-4,N6=function(e){var r=e.domain();if(!(!r||r.length<=2)){var n=r.length,s=e.range(),i=Math.min(s[0],s[1])-HA,o=Math.max(s[0],s[1])+HA,l=e(r[0]),c=e(r[n-1]);(l<i||l>o||c<i||c>o)&&e.domain([r[0],r[n-1]])}},$he=function(e,r){if(!e)return null;for(var n=0,s=e.length;n<s;n++)if(e[n].item===r)return e[n].position;return null},Lhe=function(e,r){if(!r||r.length!==2||!Me(r[0])||!Me(r[1]))return e;var n=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]),i=[e[0],e[1]];return(!Me(e[0])||e[0]<n)&&(i[0]=n),(!Me(e[1])||e[1]>s)&&(i[1]=s),i[0]>s&&(i[0]=s),i[1]<n&&(i[1]=n),i},Vhe=function(e){var r=e.length;if(!(r<=0))for(var n=0,s=e[0].length;n<s;++n)for(var i=0,o=0,l=0;l<r;++l){var c=Ld(e[l][n][1])?e[l][n][0]:e[l][n][1];c>=0?(e[l][n][0]=i,e[l][n][1]=i+c,i=e[l][n][1]):(e[l][n][0]=o,e[l][n][1]=o+c,o=e[l][n][1])}},Fhe=function(e){var r=e.length;if(!(r<=0))for(var n=0,s=e[0].length;n<s;++n)for(var i=0,o=0;o<r;++o){var l=Ld(e[o][n][1])?e[o][n][0]:e[o][n][1];l>=0?(e[o][n][0]=i,e[o][n][1]=i+l,i=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},Bhe={sign:Vhe,expand:iZ,none:Wu,silhouette:oZ,wiggle:lZ,positive:Fhe},Uhe=function(e,r,n){var s=r.map(function(l){return l.props.dataKey}),i=Bhe[n],o=sZ().keys(s).value(function(l,c){return+on(l,c,0)}).order(Uj).offset(i);return o(e)},zhe=function(e,r,n,s,i,o){if(!e)return null;var l=o?r.reverse():r,c={},u=l.reduce(function(h,f){var m,y=(m=f.type)!==null&&m!==void 0&&m.defaultProps?Ur(Ur({},f.type.defaultProps),f.props):f.props,g=y.stackId,x=y.hide;if(x)return h;var b=y[n],v=h[b]||{hasStack:!1,stackGroups:{}};if(cn(g)){var j=v.stackGroups[g]||{numericAxisId:n,cateAxisId:s,items:[]};j.items.push(f),v.hasStack=!0,v.stackGroups[g]=j}else v.stackGroups[Vd("_stackId_")]={numericAxisId:n,cateAxisId:s,items:[f]};return Ur(Ur({},h),{},Nu({},b,v))},c),d={};return Object.keys(u).reduce(function(h,f){var m=u[f];if(m.hasStack){var y={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(g,x){var b=m.stackGroups[x];return Ur(Ur({},g),{},Nu({},x,{numericAxisId:n,cateAxisId:s,items:b.items,stackedData:Uhe(e,b.items,i)}))},y)}return Ur(Ur({},h),{},Nu({},f,m))},d)},_6=function(e,r){var n=r.realScaleType,s=r.type,i=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&s==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=e.domain();if(!u.length)return null;var d=nhe(u,i,l);return e.domain([tv(d),Io(d)]),{niceTicks:d}}if(i&&s==="number"){var h=e.domain(),f=ahe(h,i,l);return{niceTicks:f}}return null};function WA(t){var e=t.axis,r=t.ticks,n=t.bandSize,s=t.entry,i=t.index,o=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!Pt(s[e.dataKey])){var l=P0(r,"value",s[e.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=on(s,Pt(o)?e.dataKey:o);return Pt(c)?null:e.scale(c)}var GA=function(e){var r=e.axis,n=e.ticks,s=e.offset,i=e.bandSize,o=e.entry,l=e.index;if(r.type==="category")return n[l]?n[l].coordinate+s:null;var c=on(o,r.dataKey,r.domain[l]);return Pt(c)?null:r.scale(c)-i/2+s},qhe=function(e){var r=e.numericAxis,n=r.scale.domain();if(r.type==="number"){var s=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return s<=0&&i>=0?0:i<0?i:s}return n[0]},Hhe=function(e,r){var n,s=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Ur(Ur({},e.type.defaultProps),e.props):e.props,i=s.stackId;if(cn(i)){var o=r[i];if(o){var l=o.items.indexOf(e);return l>=0?o.stackedData[l]:null}}return null},Whe=function(e){return e.reduce(function(r,n){return[tv(n.concat([r[0]]).filter(Me)),Io(n.concat([r[1]]).filter(Me))]},[1/0,-1/0])},S6=function(e,r,n){return Object.keys(e).reduce(function(s,i){var o=e[i],l=o.stackedData,c=l.reduce(function(u,d){var h=Whe(d.slice(r,n+1));return[Math.min(u[0],h[0]),Math.max(u[1],h[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]).map(function(s){return s===1/0||s===-1/0?0:s})},KA=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,QA=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,x1=function(e,r,n){if(bt(e))return e(r,n);if(!Array.isArray(e))return r;var s=[];if(Me(e[0]))s[0]=n?e[0]:Math.min(e[0],r[0]);else if(KA.test(e[0])){var i=+KA.exec(e[0])[1];s[0]=r[0]-i}else bt(e[0])?s[0]=e[0](r[0]):s[0]=r[0];if(Me(e[1]))s[1]=n?e[1]:Math.max(e[1],r[1]);else if(QA.test(e[1])){var o=+QA.exec(e[1])[1];s[1]=r[1]+o}else bt(e[1])?s[1]=e[1](r[1]):s[1]=r[1];return s},ry=function(e,r,n){if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!n||s>0)return s}if(e&&r&&r.length>=2){for(var i=TS(r,function(h){return h.coordinate}),o=1/0,l=1,c=i.length;l<c;l++){var u=i[l],d=i[l-1];o=Math.min((u.coordinate||0)-(d.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},YA=function(e,r,n){return!e||!e.length||ed(e,Fa(n,"type.defaultProps.domain"))?r:e},C6=function(e,r){var n=e.type.defaultProps?Ur(Ur({},e.type.defaultProps),e.props):e.props,s=n.dataKey,i=n.name,o=n.unit,l=n.formatter,c=n.tooltipType,u=n.chartType,d=n.hide;return Ur(Ur({},ft(e,!1)),{},{dataKey:s,unit:o,formatter:l,name:i||s,color:t2(e),value:on(r,s),type:c,payload:r,chartType:u,hide:d})};function nm(t){"@babel/helpers - typeof";return nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nm(t)}function XA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function vi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XA(Object(r),!0).forEach(function(n){E6(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function E6(t,e,r){return e=Ghe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ghe(t){var e=Khe(t,"string");return nm(e)=="symbol"?e:e+""}function Khe(t,e){if(nm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qhe(t,e){return Zhe(t)||Jhe(t,e)||Xhe(t,e)||Yhe()}function Yhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xhe(t,e){if(t){if(typeof t=="string")return JA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JA(t,e)}}function JA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Jhe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function Zhe(t){if(Array.isArray(t))return t}var ny=Math.PI/180,efe=function(e){return e*180/Math.PI},xr=function(e,r,n,s){return{x:e+Math.cos(-ny*s)*n,y:r+Math.sin(-ny*s)*n}},P6=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},tfe=function(e,r,n,s,i){var o=e.width,l=e.height,c=e.startAngle,u=e.endAngle,d=ia(e.cx,o,o/2),h=ia(e.cy,l,l/2),f=P6(o,l,n),m=ia(e.innerRadius,f,0),y=ia(e.outerRadius,f,f*.8),g=Object.keys(r);return g.reduce(function(x,b){var v=r[b],j=v.domain,S=v.reversed,_;if(Pt(v.range))s==="angleAxis"?_=[c,u]:s==="radiusAxis"&&(_=[m,y]),S&&(_=[_[1],_[0]]);else{_=v.range;var C=_,N=Qhe(C,2);c=N[0],u=N[1]}var w=j6(v,i),E=w.realScaleType,k=w.scale;k.domain(j).range(_),N6(k);var T=_6(k,vi(vi({},v),{},{realScaleType:E})),P=vi(vi(vi({},v),T),{},{range:_,radius:y,realScaleType:E,scale:k,cx:d,cy:h,innerRadius:m,outerRadius:y,startAngle:c,endAngle:u});return vi(vi({},x),{},E6({},b,P))},{})},rfe=function(e,r){var n=e.x,s=e.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(s-o,2))},nfe=function(e,r){var n=e.x,s=e.y,i=r.cx,o=r.cy,l=rfe({x:n,y:s},{x:i,y:o});if(l<=0)return{radius:l};var c=(n-i)/l,u=Math.acos(c);return s>o&&(u=2*Math.PI-u),{radius:l,angle:efe(u),angleInRadian:u}},afe=function(e){var r=e.startAngle,n=e.endAngle,s=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(s,i);return{startAngle:r-o*360,endAngle:n-o*360}},sfe=function(e,r){var n=r.startAngle,s=r.endAngle,i=Math.floor(n/360),o=Math.floor(s/360),l=Math.min(i,o);return e+l*360},ZA=function(e,r){var n=e.x,s=e.y,i=nfe({x:n,y:s},r),o=i.radius,l=i.angle,c=r.innerRadius,u=r.outerRadius;if(o<c||o>u)return!1;if(o===0)return!0;var d=afe(r),h=d.startAngle,f=d.endAngle,m=l,y;if(h<=f){for(;m>f;)m-=360;for(;m<h;)m+=360;y=m>=h&&m<=f}else{for(;m>h;)m-=360;for(;m<f;)m+=360;y=m>=f&&m<=h}return y?vi(vi({},r),{},{radius:o,angle:sfe(m,r)}):null},T6=function(e){return!I.isValidElement(e)&&!bt(e)&&typeof e!="boolean"?e.className:""};function am(t){"@babel/helpers - typeof";return am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},am(t)}var ife=["offset"];function ofe(t){return dfe(t)||ufe(t)||cfe(t)||lfe()}function lfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cfe(t,e){if(t){if(typeof t=="string")return v1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v1(t,e)}}function ufe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dfe(t){if(Array.isArray(t))return v1(t)}function v1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function hfe(t,e){if(t==null)return{};var r=ffe(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ffe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function eI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function an(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eI(Object(r),!0).forEach(function(n){mfe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mfe(t,e,r){return e=pfe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pfe(t){var e=gfe(t,"string");return am(e)=="symbol"?e:e+""}function gfe(t,e){if(am(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(am(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sm(){return sm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sm.apply(this,arguments)}var yfe=function(e){var r=e.value,n=e.formatter,s=Pt(e.children)?r:e.children;return bt(n)?n(s):s},xfe=function(e,r){var n=sa(r-e),s=Math.min(Math.abs(r-e),360);return n*s},vfe=function(e,r,n){var s=e.position,i=e.viewBox,o=e.offset,l=e.className,c=i,u=c.cx,d=c.cy,h=c.innerRadius,f=c.outerRadius,m=c.startAngle,y=c.endAngle,g=c.clockWise,x=(h+f)/2,b=xfe(m,y),v=b>=0?1:-1,j,S;s==="insideStart"?(j=m+v*o,S=g):s==="insideEnd"?(j=y-v*o,S=!g):s==="end"&&(j=y+v*o,S=g),S=b<=0?S:!S;var _=xr(u,d,x,j),C=xr(u,d,x,j+(S?1:-1)*359),N="M".concat(_.x,",").concat(_.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(S?0:1,`,
    `).concat(C.x,",").concat(C.y),w=Pt(e.id)?Vd("recharts-radial-line-"):e.id;return ee.createElement("text",sm({},n,{dominantBaseline:"central",className:At("recharts-radial-bar-label",l)}),ee.createElement("defs",null,ee.createElement("path",{id:w,d:N})),ee.createElement("textPath",{xlinkHref:"#".concat(w)},r))},bfe=function(e){var r=e.viewBox,n=e.offset,s=e.position,i=r,o=i.cx,l=i.cy,c=i.innerRadius,u=i.outerRadius,d=i.startAngle,h=i.endAngle,f=(d+h)/2;if(s==="outside"){var m=xr(o,l,u+n,f),y=m.x,g=m.y;return{x:y,y:g,textAnchor:y>=o?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var x=(c+u)/2,b=xr(o,l,x,f),v=b.x,j=b.y;return{x:v,y:j,textAnchor:"middle",verticalAnchor:"middle"}},wfe=function(e){var r=e.viewBox,n=e.parentViewBox,s=e.offset,i=e.position,o=r,l=o.x,c=o.y,u=o.width,d=o.height,h=d>=0?1:-1,f=h*s,m=h>0?"end":"start",y=h>0?"start":"end",g=u>=0?1:-1,x=g*s,b=g>0?"end":"start",v=g>0?"start":"end";if(i==="top"){var j={x:l+u/2,y:c-h*s,textAnchor:"middle",verticalAnchor:m};return an(an({},j),n?{height:Math.max(c-n.y,0),width:u}:{})}if(i==="bottom"){var S={x:l+u/2,y:c+d+f,textAnchor:"middle",verticalAnchor:y};return an(an({},S),n?{height:Math.max(n.y+n.height-(c+d),0),width:u}:{})}if(i==="left"){var _={x:l-x,y:c+d/2,textAnchor:b,verticalAnchor:"middle"};return an(an({},_),n?{width:Math.max(_.x-n.x,0),height:d}:{})}if(i==="right"){var C={x:l+u+x,y:c+d/2,textAnchor:v,verticalAnchor:"middle"};return an(an({},C),n?{width:Math.max(n.x+n.width-C.x,0),height:d}:{})}var N=n?{width:u,height:d}:{};return i==="insideLeft"?an({x:l+x,y:c+d/2,textAnchor:v,verticalAnchor:"middle"},N):i==="insideRight"?an({x:l+u-x,y:c+d/2,textAnchor:b,verticalAnchor:"middle"},N):i==="insideTop"?an({x:l+u/2,y:c+f,textAnchor:"middle",verticalAnchor:y},N):i==="insideBottom"?an({x:l+u/2,y:c+d-f,textAnchor:"middle",verticalAnchor:m},N):i==="insideTopLeft"?an({x:l+x,y:c+f,textAnchor:v,verticalAnchor:y},N):i==="insideTopRight"?an({x:l+u-x,y:c+f,textAnchor:b,verticalAnchor:y},N):i==="insideBottomLeft"?an({x:l+x,y:c+d-f,textAnchor:v,verticalAnchor:m},N):i==="insideBottomRight"?an({x:l+u-x,y:c+d-f,textAnchor:b,verticalAnchor:m},N):Dd(i)&&(Me(i.x)||Dl(i.x))&&(Me(i.y)||Dl(i.y))?an({x:l+ia(i.x,u),y:c+ia(i.y,d),textAnchor:"end",verticalAnchor:"end"},N):an({x:l+u/2,y:c+d/2,textAnchor:"middle",verticalAnchor:"middle"},N)},jfe=function(e){return"cx"in e&&Me(e.cx)};function yn(t){var e=t.offset,r=e===void 0?5:e,n=hfe(t,ife),s=an({offset:r},n),i=s.viewBox,o=s.position,l=s.value,c=s.children,u=s.content,d=s.className,h=d===void 0?"":d,f=s.textBreakAll;if(!i||Pt(l)&&Pt(c)&&!I.isValidElement(u)&&!bt(u))return null;if(I.isValidElement(u))return I.cloneElement(u,s);var m;if(bt(u)){if(m=I.createElement(u,s),I.isValidElement(m))return m}else m=yfe(s);var y=jfe(i),g=ft(s,!0);if(y&&(o==="insideStart"||o==="insideEnd"||o==="end"))return vfe(s,m,g);var x=y?bfe(s):wfe(s);return ee.createElement(uc,sm({className:At("recharts-label",h)},g,x,{breakAll:f}),m)}yn.displayName="Label";var A6=function(e){var r=e.cx,n=e.cy,s=e.angle,i=e.startAngle,o=e.endAngle,l=e.r,c=e.radius,u=e.innerRadius,d=e.outerRadius,h=e.x,f=e.y,m=e.top,y=e.left,g=e.width,x=e.height,b=e.clockWise,v=e.labelViewBox;if(v)return v;if(Me(g)&&Me(x)){if(Me(h)&&Me(f))return{x:h,y:f,width:g,height:x};if(Me(m)&&Me(y))return{x:m,y,width:g,height:x}}return Me(h)&&Me(f)?{x:h,y:f,width:0,height:0}:Me(r)&&Me(n)?{cx:r,cy:n,startAngle:i||s||0,endAngle:o||s||0,innerRadius:u||0,outerRadius:d||c||l||0,clockWise:b}:e.viewBox?e.viewBox:{}},Nfe=function(e,r){return e?e===!0?ee.createElement(yn,{key:"label-implicit",viewBox:r}):cn(e)?ee.createElement(yn,{key:"label-implicit",viewBox:r,value:e}):I.isValidElement(e)?e.type===yn?I.cloneElement(e,{key:"label-implicit",viewBox:r}):ee.createElement(yn,{key:"label-implicit",content:e,viewBox:r}):bt(e)?ee.createElement(yn,{key:"label-implicit",content:e,viewBox:r}):Dd(e)?ee.createElement(yn,sm({viewBox:r},e,{key:"label-implicit"})):null:null},_fe=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var s=e.children,i=A6(e),o=hs(s,yn).map(function(c,u){return I.cloneElement(c,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return o;var l=Nfe(e.label,r||i);return[l].concat(ofe(o))};yn.parseViewBox=A6;yn.renderCallByParent=_fe;function Sfe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var Cfe=Sfe;const Efe=er(Cfe);function im(t){"@babel/helpers - typeof";return im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},im(t)}var Pfe=["valueAccessor"],Tfe=["data","dataKey","clockWise","id","textBreakAll"];function Afe(t){return Dfe(t)||Ofe(t)||kfe(t)||Ife()}function Ife(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kfe(t,e){if(t){if(typeof t=="string")return b1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b1(t,e)}}function Ofe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Dfe(t){if(Array.isArray(t))return b1(t)}function b1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ay(){return ay=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ay.apply(this,arguments)}function tI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function rI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tI(Object(r),!0).forEach(function(n){Mfe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Mfe(t,e,r){return e=Rfe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rfe(t){var e=$fe(t,"string");return im(e)=="symbol"?e:e+""}function $fe(t,e){if(im(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(im(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nI(t,e){if(t==null)return{};var r=Lfe(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Lfe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var Vfe=function(e){return Array.isArray(e.value)?Efe(e.value):e.value};function Fi(t){var e=t.valueAccessor,r=e===void 0?Vfe:e,n=nI(t,Pfe),s=n.data,i=n.dataKey,o=n.clockWise,l=n.id,c=n.textBreakAll,u=nI(n,Tfe);return!s||!s.length?null:ee.createElement(Ft,{className:"recharts-label-list"},s.map(function(d,h){var f=Pt(i)?r(d,h):on(d&&d.payload,i),m=Pt(l)?{}:{id:"".concat(l,"-").concat(h)};return ee.createElement(yn,ay({},ft(d,!0),u,m,{parentViewBox:d.parentViewBox,value:f,textBreakAll:c,viewBox:yn.parseViewBox(Pt(o)?d:rI(rI({},d),{},{clockWise:o})),key:"label-".concat(h),index:h}))}))}Fi.displayName="LabelList";function Ffe(t,e){return t?t===!0?ee.createElement(Fi,{key:"labelList-implicit",data:e}):ee.isValidElement(t)||bt(t)?ee.createElement(Fi,{key:"labelList-implicit",data:e,content:t}):Dd(t)?ee.createElement(Fi,ay({data:e},t,{key:"labelList-implicit"})):null:null}function Bfe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var n=t.children,s=hs(n,Fi).map(function(o,l){return I.cloneElement(o,{data:e,key:"labelList-".concat(l)})});if(!r)return s;var i=Ffe(t.label,e);return[i].concat(Afe(s))}Fi.renderCallByParent=Bfe;function om(t){"@babel/helpers - typeof";return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},om(t)}function w1(){return w1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},w1.apply(this,arguments)}function aI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function sI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aI(Object(r),!0).forEach(function(n){Ufe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ufe(t,e,r){return e=zfe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zfe(t){var e=qfe(t,"string");return om(e)=="symbol"?e:e+""}function qfe(t,e){if(om(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(om(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hfe=function(e,r){var n=sa(r-e),s=Math.min(Math.abs(r-e),359.999);return n*s},Yp=function(e){var r=e.cx,n=e.cy,s=e.radius,i=e.angle,o=e.sign,l=e.isExternal,c=e.cornerRadius,u=e.cornerIsExternal,d=c*(l?1:-1)+s,h=Math.asin(c/d)/ny,f=u?i:i+o*h,m=xr(r,n,d,f),y=xr(r,n,s,f),g=u?i-o*h:i,x=xr(r,n,d*Math.cos(h*ny),g);return{center:m,circleTangency:y,lineTangency:x,theta:h}},I6=function(e){var r=e.cx,n=e.cy,s=e.innerRadius,i=e.outerRadius,o=e.startAngle,l=e.endAngle,c=Hfe(o,l),u=o+c,d=xr(r,n,i,o),h=xr(r,n,i,u),f="M ".concat(d.x,",").concat(d.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>u),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(s>0){var m=xr(r,n,s,o),y=xr(r,n,s,u);f+="L ".concat(y.x,",").concat(y.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=u),`,
            `).concat(m.x,",").concat(m.y," Z")}else f+="L ".concat(r,",").concat(n," Z");return f},Wfe=function(e){var r=e.cx,n=e.cy,s=e.innerRadius,i=e.outerRadius,o=e.cornerRadius,l=e.forceCornerRadius,c=e.cornerIsExternal,u=e.startAngle,d=e.endAngle,h=sa(d-u),f=Yp({cx:r,cy:n,radius:i,angle:u,sign:h,cornerRadius:o,cornerIsExternal:c}),m=f.circleTangency,y=f.lineTangency,g=f.theta,x=Yp({cx:r,cy:n,radius:i,angle:d,sign:-h,cornerRadius:o,cornerIsExternal:c}),b=x.circleTangency,v=x.lineTangency,j=x.theta,S=c?Math.abs(u-d):Math.abs(u-d)-g-j;if(S<0)return l?"M ".concat(y.x,",").concat(y.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):I6({cx:r,cy:n,innerRadius:s,outerRadius:i,startAngle:u,endAngle:d});var _="M ".concat(y.x,",").concat(y.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(S>180),",").concat(+(h<0),",").concat(b.x,",").concat(b.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(v.x,",").concat(v.y,`
  `);if(s>0){var C=Yp({cx:r,cy:n,radius:s,angle:u,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),N=C.circleTangency,w=C.lineTangency,E=C.theta,k=Yp({cx:r,cy:n,radius:s,angle:d,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),T=k.circleTangency,P=k.lineTangency,O=k.theta,D=c?Math.abs(u-d):Math.abs(u-d)-E-O;if(D<0&&o===0)return"".concat(_,"L").concat(r,",").concat(n,"Z");_+="L".concat(P.x,",").concat(P.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(T.x,",").concat(T.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(D>180),",").concat(+(h>0),",").concat(N.x,",").concat(N.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(w.x,",").concat(w.y,"Z")}else _+="L".concat(r,",").concat(n,"Z");return _},Gfe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},k6=function(e){var r=sI(sI({},Gfe),e),n=r.cx,s=r.cy,i=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,h=r.endAngle,f=r.className;if(o<i||d===h)return null;var m=At("recharts-sector",f),y=o-i,g=ia(l,y,0,!0),x;return g>0&&Math.abs(d-h)<360?x=Wfe({cx:n,cy:s,innerRadius:i,outerRadius:o,cornerRadius:Math.min(g,y/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:d,endAngle:h}):x=I6({cx:n,cy:s,innerRadius:i,outerRadius:o,startAngle:d,endAngle:h}),ee.createElement("path",w1({},ft(r,!0),{className:m,d:x,role:"img"}))};function lm(t){"@babel/helpers - typeof";return lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lm(t)}function j1(){return j1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},j1.apply(this,arguments)}function iI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function oI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iI(Object(r),!0).forEach(function(n){Kfe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Kfe(t,e,r){return e=Qfe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qfe(t){var e=Yfe(t,"string");return lm(e)=="symbol"?e:e+""}function Yfe(t,e){if(lm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(lm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lI={curveBasisClosed:KJ,curveBasisOpen:QJ,curveBasis:GJ,curveBumpX:OJ,curveBumpY:DJ,curveLinearClosed:YJ,curveLinear:zx,curveMonotoneX:XJ,curveMonotoneY:JJ,curveNatural:ZJ,curveStep:eZ,curveStepAfter:rZ,curveStepBefore:tZ},Xp=function(e){return e.x===+e.x&&e.y===+e.y},vh=function(e){return e.x},bh=function(e){return e.y},Xfe=function(e,r){if(bt(e))return e;var n="curve".concat(Bx(e));return(n==="curveMonotone"||n==="curveBump")&&r?lI["".concat(n).concat(r==="vertical"?"Y":"X")]:lI[n]||zx},Jfe=function(e){var r=e.type,n=r===void 0?"linear":r,s=e.points,i=s===void 0?[]:s,o=e.baseLine,l=e.layout,c=e.connectNulls,u=c===void 0?!1:c,d=Xfe(n,l),h=u?i.filter(function(g){return Xp(g)}):i,f;if(Array.isArray(o)){var m=u?o.filter(function(g){return Xp(g)}):o,y=h.map(function(g,x){return oI(oI({},g),{},{base:m[x]})});return l==="vertical"?f=Bp().y(bh).x1(vh).x0(function(g){return g.base.x}):f=Bp().x(vh).y1(bh).y0(function(g){return g.base.y}),f.defined(Xp).curve(d),f(y)}return l==="vertical"&&Me(o)?f=Bp().y(bh).x1(vh).x0(o):Me(o)?f=Bp().x(vh).y1(bh).y0(o):f=CR().x(vh).y(bh),f.defined(Xp).curve(d),f(h)},_u=function(e){var r=e.className,n=e.points,s=e.path,i=e.pathRef;if((!n||!n.length)&&!s)return null;var o=n&&n.length?Jfe(e):s;return I.createElement("path",j1({},ft(e,!1),T0(e),{className:At("recharts-curve",r),d:o,ref:i}))},O6={exports:{}},Zfe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",eme=Zfe,tme=eme;function D6(){}function M6(){}M6.resetWarningCache=D6;var rme=function(){function t(n,s,i,o,l,c){if(c!==tme){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:M6,resetWarningCache:D6};return r.PropTypes=r,r};O6.exports=rme();var nme=O6.exports;const Qt=er(nme);var ame=Object.getOwnPropertyNames,sme=Object.getOwnPropertySymbols,ime=Object.prototype.hasOwnProperty;function cI(t,e){return function(n,s,i){return t(n,s,i)&&e(n,s,i)}}function Jp(t){return function(r,n,s){if(!r||!n||typeof r!="object"||typeof n!="object")return t(r,n,s);var i=s.cache,o=i.get(r),l=i.get(n);if(o&&l)return o===n&&l===r;i.set(r,n),i.set(n,r);var c=t(r,n,s);return i.delete(r),i.delete(n),c}}function uI(t){return ame(t).concat(sme(t))}var ome=Object.hasOwn||function(t,e){return ime.call(t,e)};function Sc(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var lme="__v",cme="__o",ume="_owner",dI=Object.getOwnPropertyDescriptor,hI=Object.keys;function dme(t,e,r){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function hme(t,e){return Sc(t.getTime(),e.getTime())}function fme(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function mme(t,e){return t===e}function fI(t,e,r){var n=t.size;if(n!==e.size)return!1;if(!n)return!0;for(var s=new Array(n),i=t.entries(),o,l,c=0;(o=i.next())&&!o.done;){for(var u=e.entries(),d=!1,h=0;(l=u.next())&&!l.done;){if(s[h]){h++;continue}var f=o.value,m=l.value;if(r.equals(f[0],m[0],c,h,t,e,r)&&r.equals(f[1],m[1],f[0],m[0],t,e,r)){d=s[h]=!0;break}h++}if(!d)return!1;c++}return!0}var pme=Sc;function gme(t,e,r){var n=hI(t),s=n.length;if(hI(e).length!==s)return!1;for(;s-- >0;)if(!R6(t,e,r,n[s]))return!1;return!0}function wh(t,e,r){var n=uI(t),s=n.length;if(uI(e).length!==s)return!1;for(var i,o,l;s-- >0;)if(i=n[s],!R6(t,e,r,i)||(o=dI(t,i),l=dI(e,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function yme(t,e){return Sc(t.valueOf(),e.valueOf())}function xme(t,e){return t.source===e.source&&t.flags===e.flags}function mI(t,e,r){var n=t.size;if(n!==e.size)return!1;if(!n)return!0;for(var s=new Array(n),i=t.values(),o,l;(o=i.next())&&!o.done;){for(var c=e.values(),u=!1,d=0;(l=c.next())&&!l.done;){if(!s[d]&&r.equals(o.value,l.value,o.value,l.value,t,e,r)){u=s[d]=!0;break}d++}if(!u)return!1}return!0}function vme(t,e){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function bme(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function R6(t,e,r,n){return(n===ume||n===cme||n===lme)&&(t.$$typeof||e.$$typeof)?!0:ome(e,n)&&r.equals(t[n],e[n],n,n,t,e,r)}var wme="[object Arguments]",jme="[object Boolean]",Nme="[object Date]",_me="[object Error]",Sme="[object Map]",Cme="[object Number]",Eme="[object Object]",Pme="[object RegExp]",Tme="[object Set]",Ame="[object String]",Ime="[object URL]",kme=Array.isArray,pI=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,gI=Object.assign,Ome=Object.prototype.toString.call.bind(Object.prototype.toString);function Dme(t){var e=t.areArraysEqual,r=t.areDatesEqual,n=t.areErrorsEqual,s=t.areFunctionsEqual,i=t.areMapsEqual,o=t.areNumbersEqual,l=t.areObjectsEqual,c=t.arePrimitiveWrappersEqual,u=t.areRegExpsEqual,d=t.areSetsEqual,h=t.areTypedArraysEqual,f=t.areUrlsEqual;return function(y,g,x){if(y===g)return!0;if(y==null||g==null)return!1;var b=typeof y;if(b!==typeof g)return!1;if(b!=="object")return b==="number"?o(y,g,x):b==="function"?s(y,g,x):!1;var v=y.constructor;if(v!==g.constructor)return!1;if(v===Object)return l(y,g,x);if(kme(y))return e(y,g,x);if(pI!=null&&pI(y))return h(y,g,x);if(v===Date)return r(y,g,x);if(v===RegExp)return u(y,g,x);if(v===Map)return i(y,g,x);if(v===Set)return d(y,g,x);var j=Ome(y);return j===Nme?r(y,g,x):j===Pme?u(y,g,x):j===Sme?i(y,g,x):j===Tme?d(y,g,x):j===Eme?typeof y.then!="function"&&typeof g.then!="function"&&l(y,g,x):j===Ime?f(y,g,x):j===_me?n(y,g,x):j===wme?l(y,g,x):j===jme||j===Cme||j===Ame?c(y,g,x):!1}}function Mme(t){var e=t.circular,r=t.createCustomConfig,n=t.strict,s={areArraysEqual:n?wh:dme,areDatesEqual:hme,areErrorsEqual:fme,areFunctionsEqual:mme,areMapsEqual:n?cI(fI,wh):fI,areNumbersEqual:pme,areObjectsEqual:n?wh:gme,arePrimitiveWrappersEqual:yme,areRegExpsEqual:xme,areSetsEqual:n?cI(mI,wh):mI,areTypedArraysEqual:n?wh:vme,areUrlsEqual:bme};if(r&&(s=gI({},s,r(s))),e){var i=Jp(s.areArraysEqual),o=Jp(s.areMapsEqual),l=Jp(s.areObjectsEqual),c=Jp(s.areSetsEqual);s=gI({},s,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return s}function Rme(t){return function(e,r,n,s,i,o,l){return t(e,r,l)}}function $me(t){var e=t.circular,r=t.comparator,n=t.createState,s=t.equals,i=t.strict;if(n)return function(c,u){var d=n(),h=d.cache,f=h===void 0?e?new WeakMap:void 0:h,m=d.meta;return r(c,u,{cache:f,equals:s,meta:m,strict:i})};if(e)return function(c,u){return r(c,u,{cache:new WeakMap,equals:s,meta:void 0,strict:i})};var o={cache:void 0,equals:s,meta:void 0,strict:i};return function(c,u){return r(c,u,o)}}var Lme=cl();cl({strict:!0});cl({circular:!0});cl({circular:!0,strict:!0});cl({createInternalComparator:function(){return Sc}});cl({strict:!0,createInternalComparator:function(){return Sc}});cl({circular:!0,createInternalComparator:function(){return Sc}});cl({circular:!0,createInternalComparator:function(){return Sc},strict:!0});function cl(t){t===void 0&&(t={});var e=t.circular,r=e===void 0?!1:e,n=t.createInternalComparator,s=t.createState,i=t.strict,o=i===void 0?!1:i,l=Mme(t),c=Dme(l),u=n?n(c):Rme(c);return $me({circular:r,comparator:c,createState:s,equals:u,strict:o})}function Vme(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function yI(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function s(i){r<0&&(r=i),i-r>e?(t(i),r=-1):Vme(s)};requestAnimationFrame(n)}function N1(t){"@babel/helpers - typeof";return N1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N1(t)}function Fme(t){return qme(t)||zme(t)||Ume(t)||Bme()}function Bme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ume(t,e){if(t){if(typeof t=="string")return xI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xI(t,e)}}function xI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zme(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qme(t){if(Array.isArray(t))return t}function Hme(){var t={},e=function(){return null},r=!1,n=function s(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,l=Fme(o),c=l[0],u=l.slice(1);if(typeof c=="number"){yI(s.bind(null,u),c);return}s(c),yI(s.bind(null,u));return}N1(i)==="object"&&(t=i,e(t)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return e=i,function(){e=function(){return null}}}}}function cm(t){"@babel/helpers - typeof";return cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cm(t)}function vI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function bI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vI(Object(r),!0).forEach(function(n){$6(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $6(t,e,r){return e=Wme(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wme(t){var e=Gme(t,"string");return cm(e)==="symbol"?e:String(e)}function Gme(t,e){if(cm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Kme=function(e,r){return[Object.keys(e),Object.keys(r)].reduce(function(n,s){return n.filter(function(i){return s.includes(i)})})},Qme=function(e){return e},Yme=function(e){return e.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},sf=function(e,r){return Object.keys(r).reduce(function(n,s){return bI(bI({},n),{},$6({},s,e(s,r[s])))},{})},wI=function(e,r,n){return e.map(function(s){return"".concat(Yme(s)," ").concat(r,"ms ").concat(n)}).join(",")};function Xme(t,e){return epe(t)||Zme(t,e)||L6(t,e)||Jme()}function Jme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zme(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function epe(t){if(Array.isArray(t))return t}function tpe(t){return ape(t)||npe(t)||L6(t)||rpe()}function rpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L6(t,e){if(t){if(typeof t=="string")return _1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _1(t,e)}}function npe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ape(t){if(Array.isArray(t))return _1(t)}function _1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var sy=1e-4,V6=function(e,r){return[0,3*e,3*r-6*e,3*e-3*r+1]},F6=function(e,r){return e.map(function(n,s){return n*Math.pow(r,s)}).reduce(function(n,s){return n+s})},jI=function(e,r){return function(n){var s=V6(e,r);return F6(s,n)}},spe=function(e,r){return function(n){var s=V6(e,r),i=[].concat(tpe(s.map(function(o,l){return o*l}).slice(1)),[0]);return F6(i,n)}},NI=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var s=r[0],i=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":s=0,i=0,o=1,l=1;break;case"ease":s=.25,i=.1,o=.25,l=1;break;case"ease-in":s=.42,i=0,o=1,l=1;break;case"ease-out":s=.42,i=0,o=.58,l=1;break;case"ease-in-out":s=0,i=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(x){return parseFloat(x)}),d=Xme(u,4);s=d[0],i=d[1],o=d[2],l=d[3]}}}var h=jI(s,o),f=jI(i,l),m=spe(s,o),y=function(b){return b>1?1:b<0?0:b},g=function(b){for(var v=b>1?1:b,j=v,S=0;S<8;++S){var _=h(j)-v,C=m(j);if(Math.abs(_-v)<sy||C<sy)return f(j);j=y(j-_/C)}return f(j)};return g.isStepper=!1,g},ipe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.stiff,n=r===void 0?100:r,s=e.damping,i=s===void 0?8:s,o=e.dt,l=o===void 0?17:o,c=function(d,h,f){var m=-(d-h)*n,y=f*i,g=f+(m-y)*l/1e3,x=f*l/1e3+d;return Math.abs(x-h)<sy&&Math.abs(g)<sy?[h,0]:[x,g]};return c.isStepper=!0,c.dt=l,c},ope=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var s=r[0];if(typeof s=="string")switch(s){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return NI(s);case"spring":return ipe();default:if(s.split("(")[0]==="cubic-bezier")return NI(s)}return typeof s=="function"?s:null};function um(t){"@babel/helpers - typeof";return um=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},um(t)}function _I(t){return upe(t)||cpe(t)||B6(t)||lpe()}function lpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cpe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function upe(t){if(Array.isArray(t))return C1(t)}function SI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function An(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SI(Object(r),!0).forEach(function(n){S1(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function S1(t,e,r){return e=dpe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dpe(t){var e=hpe(t,"string");return um(e)==="symbol"?e:String(e)}function hpe(t,e){if(um(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(um(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fpe(t,e){return gpe(t)||ppe(t,e)||B6(t,e)||mpe()}function mpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B6(t,e){if(t){if(typeof t=="string")return C1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C1(t,e)}}function C1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ppe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function gpe(t){if(Array.isArray(t))return t}var iy=function(e,r,n){return e+(r-e)*n},E1=function(e){var r=e.from,n=e.to;return r!==n},ype=function t(e,r,n){var s=sf(function(i,o){if(E1(o)){var l=e(o.from,o.to,o.velocity),c=fpe(l,2),u=c[0],d=c[1];return An(An({},o),{},{from:u,velocity:d})}return o},r);return n<1?sf(function(i,o){return E1(o)?An(An({},o),{},{velocity:iy(o.velocity,s[i].velocity,n),from:iy(o.from,s[i].from,n)}):o},r):t(e,s,n-1)};const xpe=function(t,e,r,n,s){var i=Kme(t,e),o=i.reduce(function(x,b){return An(An({},x),{},S1({},b,[t[b],e[b]]))},{}),l=i.reduce(function(x,b){return An(An({},x),{},S1({},b,{from:t[b],velocity:0,to:e[b]}))},{}),c=-1,u,d,h=function(){return null},f=function(){return sf(function(b,v){return v.from},l)},m=function(){return!Object.values(l).filter(E1).length},y=function(b){u||(u=b);var v=b-u,j=v/r.dt;l=ype(r,l,j),s(An(An(An({},t),e),f())),u=b,m()||(c=requestAnimationFrame(h))},g=function(b){d||(d=b);var v=(b-d)/n,j=sf(function(_,C){return iy.apply(void 0,_I(C).concat([r(v)]))},o);if(s(An(An(An({},t),e),j)),v<1)c=requestAnimationFrame(h);else{var S=sf(function(_,C){return iy.apply(void 0,_I(C).concat([r(1)]))},o);s(An(An(An({},t),e),S))}};return h=r.isStepper?y:g,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(c)}}};function rd(t){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rd(t)}var vpe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function bpe(t,e){if(t==null)return{};var r=wpe(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function wpe(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function Vb(t){return Spe(t)||_pe(t)||Npe(t)||jpe()}function jpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Npe(t,e){if(t){if(typeof t=="string")return P1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P1(t,e)}}function _pe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Spe(t){if(Array.isArray(t))return P1(t)}function P1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function CI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Ss(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CI(Object(r),!0).forEach(function(n){Mh(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Mh(t,e,r){return e=U6(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cpe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Epe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,U6(n.key),n)}}function Ppe(t,e,r){return e&&Epe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function U6(t){var e=Tpe(t,"string");return rd(e)==="symbol"?e:String(e)}function Tpe(t,e){if(rd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ape(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T1(t,e)}function T1(t,e){return T1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},T1(t,e)}function Ipe(t){var e=kpe();return function(){var n=oy(t),s;if(e){var i=oy(this).constructor;s=Reflect.construct(n,arguments,i)}else s=n.apply(this,arguments);return A1(this,s)}}function A1(t,e){if(e&&(rd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I1(t)}function I1(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oy(t){return oy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oy(t)}var di=function(t){Ape(r,t);var e=Ipe(r);function r(n,s){var i;Cpe(this,r),i=e.call(this,n,s);var o=i.props,l=o.isActive,c=o.attributeName,u=o.from,d=o.to,h=o.steps,f=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(I1(i)),i.changeStyle=i.changeStyle.bind(I1(i)),!l||m<=0)return i.state={style:{}},typeof f=="function"&&(i.state={style:d}),A1(i);if(h&&h.length)i.state={style:h[0].style};else if(u){if(typeof f=="function")return i.state={style:u},A1(i);i.state={style:c?Mh({},c,u):u}}else i.state={style:{}};return i}return Ppe(r,[{key:"componentDidMount",value:function(){var s=this.props,i=s.isActive,o=s.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(s){var i=this.props,o=i.isActive,l=i.canBegin,c=i.attributeName,u=i.shouldReAnimate,d=i.to,h=i.from,f=this.state.style;if(l){if(!o){var m={style:c?Mh({},c,d):d};this.state&&f&&(c&&f[c]!==d||!c&&f!==d)&&this.setState(m);return}if(!(Lme(s.to,d)&&s.canBegin&&s.isActive)){var y=!s.canBegin||!s.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=y||u?h:s.to;if(this.state&&f){var x={style:c?Mh({},c,g):g};(c&&f[c]!==g||!c&&f!==g)&&this.setState(x)}this.runAnimation(Ss(Ss({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),s&&s()}},{key:"handleStyleChange",value:function(s){this.changeStyle(s)}},{key:"changeStyle",value:function(s){this.mounted&&this.setState({style:s})}},{key:"runJSAnimation",value:function(s){var i=this,o=s.from,l=s.to,c=s.duration,u=s.easing,d=s.begin,h=s.onAnimationEnd,f=s.onAnimationStart,m=xpe(o,l,ope(u),c,this.changeStyle),y=function(){i.stopJSAnimation=m()};this.manager.start([f,d,y,c,h])}},{key:"runStepAnimation",value:function(s){var i=this,o=s.steps,l=s.begin,c=s.onAnimationStart,u=o[0],d=u.style,h=u.duration,f=h===void 0?0:h,m=function(g,x,b){if(b===0)return g;var v=x.duration,j=x.easing,S=j===void 0?"ease":j,_=x.style,C=x.properties,N=x.onAnimationEnd,w=b>0?o[b-1]:x,E=C||Object.keys(_);if(typeof S=="function"||S==="spring")return[].concat(Vb(g),[i.runJSAnimation.bind(i,{from:w.style,to:_,duration:v,easing:S}),v]);var k=wI(E,v,S),T=Ss(Ss(Ss({},w.style),_),{},{transition:k});return[].concat(Vb(g),[T,v,N]).filter(Qme)};return this.manager.start([c].concat(Vb(o.reduce(m,[d,Math.max(f,l)])),[s.onAnimationEnd]))}},{key:"runAnimation",value:function(s){this.manager||(this.manager=Hme());var i=s.begin,o=s.duration,l=s.attributeName,c=s.to,u=s.easing,d=s.onAnimationStart,h=s.onAnimationEnd,f=s.steps,m=s.children,y=this.manager;if(this.unSubscribe=y.subscribe(this.handleStyleChange),typeof u=="function"||typeof m=="function"||u==="spring"){this.runJSAnimation(s);return}if(f.length>1){this.runStepAnimation(s);return}var g=l?Mh({},l,c):c,x=wI(Object.keys(g),o,u);y.start([d,i,Ss(Ss({},g),{},{transition:x}),o,h])}},{key:"render",value:function(){var s=this.props,i=s.children;s.begin;var o=s.duration;s.attributeName,s.easing;var l=s.isActive;s.steps,s.from,s.to,s.canBegin,s.onAnimationEnd,s.shouldReAnimate,s.onAnimationReStart;var c=bpe(s,vpe),u=I.Children.count(i),d=this.state.style;if(typeof i=="function")return i(d);if(!l||u===0||o<=0)return i;var h=function(m){var y=m.props,g=y.style,x=g===void 0?{}:g,b=y.className,v=I.cloneElement(m,Ss(Ss({},c),{},{style:Ss(Ss({},x),d),className:b}));return v};return u===1?h(I.Children.only(i)):ee.createElement("div",null,I.Children.map(i,function(f){return h(f)}))}}]),r}(I.PureComponent);di.displayName="Animate";di.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};di.propTypes={from:Qt.oneOfType([Qt.object,Qt.string]),to:Qt.oneOfType([Qt.object,Qt.string]),attributeName:Qt.string,duration:Qt.number,begin:Qt.number,easing:Qt.oneOfType([Qt.string,Qt.func]),steps:Qt.arrayOf(Qt.shape({duration:Qt.number.isRequired,style:Qt.object.isRequired,easing:Qt.oneOfType([Qt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Qt.func]),properties:Qt.arrayOf("string"),onAnimationEnd:Qt.func})),children:Qt.oneOfType([Qt.node,Qt.func]),isActive:Qt.bool,canBegin:Qt.bool,onAnimationEnd:Qt.func,shouldReAnimate:Qt.bool,onAnimationStart:Qt.func,onAnimationReStart:Qt.func};function dm(t){"@babel/helpers - typeof";return dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dm(t)}function ly(){return ly=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ly.apply(this,arguments)}function Ope(t,e){return $pe(t)||Rpe(t,e)||Mpe(t,e)||Dpe()}function Dpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mpe(t,e){if(t){if(typeof t=="string")return EI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EI(t,e)}}function EI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Rpe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function $pe(t){if(Array.isArray(t))return t}function PI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function TI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PI(Object(r),!0).forEach(function(n){Lpe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lpe(t,e,r){return e=Vpe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vpe(t){var e=Fpe(t,"string");return dm(e)=="symbol"?e:e+""}function Fpe(t,e){if(dm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var AI=function(e,r,n,s,i){var o=Math.min(Math.abs(n)/2,Math.abs(s)/2),l=s>=0?1:-1,c=n>=0?1:-1,u=s>=0&&n>=0||s<0&&n<0?1:0,d;if(o>0&&i instanceof Array){for(var h=[0,0,0,0],f=0,m=4;f<m;f++)h[f]=i[f]>o?o:i[f];d="M".concat(e,",").concat(r+l*h[0]),h[0]>0&&(d+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(u,",").concat(e+c*h[0],",").concat(r)),d+="L ".concat(e+n-c*h[1],",").concat(r),h[1]>0&&(d+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(u,`,
        `).concat(e+n,",").concat(r+l*h[1])),d+="L ".concat(e+n,",").concat(r+s-l*h[2]),h[2]>0&&(d+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(u,`,
        `).concat(e+n-c*h[2],",").concat(r+s)),d+="L ".concat(e+c*h[3],",").concat(r+s),h[3]>0&&(d+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(u,`,
        `).concat(e,",").concat(r+s-l*h[3])),d+="Z"}else if(o>0&&i===+i&&i>0){var y=Math.min(o,i);d="M ".concat(e,",").concat(r+l*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(e+c*y,",").concat(r,`
            L `).concat(e+n-c*y,",").concat(r,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(e+n,",").concat(r+l*y,`
            L `).concat(e+n,",").concat(r+s-l*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(e+n-c*y,",").concat(r+s,`
            L `).concat(e+c*y,",").concat(r+s,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(e,",").concat(r+s-l*y," Z")}else d="M ".concat(e,",").concat(r," h ").concat(n," v ").concat(s," h ").concat(-n," Z");return d},Bpe=function(e,r){if(!e||!r)return!1;var n=e.x,s=e.y,i=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var u=Math.min(i,i+l),d=Math.max(i,i+l),h=Math.min(o,o+c),f=Math.max(o,o+c);return n>=u&&n<=d&&s>=h&&s<=f}return!1},Upe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},r2=function(e){var r=TI(TI({},Upe),e),n=I.useRef(),s=I.useState(-1),i=Ope(s,2),o=i[0],l=i[1];I.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var S=n.current.getTotalLength();S&&l(S)}catch{}},[]);var c=r.x,u=r.y,d=r.width,h=r.height,f=r.radius,m=r.className,y=r.animationEasing,g=r.animationDuration,x=r.animationBegin,b=r.isAnimationActive,v=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||h!==+h||d===0||h===0)return null;var j=At("recharts-rectangle",m);return v?ee.createElement(di,{canBegin:o>0,from:{width:d,height:h,x:c,y:u},to:{width:d,height:h,x:c,y:u},duration:g,animationEasing:y,isActive:v},function(S){var _=S.width,C=S.height,N=S.x,w=S.y;return ee.createElement(di,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:g,isActive:b,easing:y},ee.createElement("path",ly({},ft(r,!0),{className:j,d:AI(N,w,_,C,f),ref:n})))}):ee.createElement("path",ly({},ft(r,!0),{className:j,d:AI(c,u,d,h,f)}))},zpe=["points","className","baseLinePoints","connectNulls"];function au(){return au=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},au.apply(this,arguments)}function qpe(t,e){if(t==null)return{};var r=Hpe(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Hpe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function II(t){return Qpe(t)||Kpe(t)||Gpe(t)||Wpe()}function Wpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gpe(t,e){if(t){if(typeof t=="string")return k1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k1(t,e)}}function Kpe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Qpe(t){if(Array.isArray(t))return k1(t)}function k1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var kI=function(e){return e&&e.x===+e.x&&e.y===+e.y},Ype=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return e.forEach(function(n){kI(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),kI(e[0])&&r[r.length-1].push(e[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},of=function(e,r){var n=Ype(e);r&&(n=[n.reduce(function(i,o){return[].concat(II(i),II(o))},[])]);var s=n.map(function(i){return i.reduce(function(o,l,c){return"".concat(o).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(s,"Z"):s},Xpe=function(e,r,n){var s=of(e,n);return"".concat(s.slice(-1)==="Z"?s.slice(0,-1):s,"L").concat(of(r.reverse(),n).slice(1))},Jpe=function(e){var r=e.points,n=e.className,s=e.baseLinePoints,i=e.connectNulls,o=qpe(e,zpe);if(!r||!r.length)return null;var l=At("recharts-polygon",n);if(s&&s.length){var c=o.stroke&&o.stroke!=="none",u=Xpe(r,s,i);return ee.createElement("g",{className:l},ee.createElement("path",au({},ft(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:u})),c?ee.createElement("path",au({},ft(o,!0),{fill:"none",d:of(r,i)})):null,c?ee.createElement("path",au({},ft(o,!0),{fill:"none",d:of(s,i)})):null)}var d=of(r,i);return ee.createElement("path",au({},ft(o,!0),{fill:d.slice(-1)==="Z"?o.fill:"none",className:l,d}))};function O1(){return O1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},O1.apply(this,arguments)}var sv=function(e){var r=e.cx,n=e.cy,s=e.r,i=e.className,o=At("recharts-dot",i);return r===+r&&n===+n&&s===+s?I.createElement("circle",O1({},ft(e,!1),T0(e),{className:o,cx:r,cy:n,r:s})):null};function hm(t){"@babel/helpers - typeof";return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hm(t)}var Zpe=["x","y","top","left","width","height","className"];function D1(){return D1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},D1.apply(this,arguments)}function OI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function ege(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OI(Object(r),!0).forEach(function(n){tge(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tge(t,e,r){return e=rge(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rge(t){var e=nge(t,"string");return hm(e)=="symbol"?e:e+""}function nge(t,e){if(hm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function age(t,e){if(t==null)return{};var r=sge(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function sge(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var ige=function(e,r,n,s,i,o){return"M".concat(e,",").concat(i,"v").concat(s,"M").concat(o,",").concat(r,"h").concat(n)},oge=function(e){var r=e.x,n=r===void 0?0:r,s=e.y,i=s===void 0?0:s,o=e.top,l=o===void 0?0:o,c=e.left,u=c===void 0?0:c,d=e.width,h=d===void 0?0:d,f=e.height,m=f===void 0?0:f,y=e.className,g=age(e,Zpe),x=ege({x:n,y:i,top:l,left:u,width:h,height:m},g);return!Me(n)||!Me(i)||!Me(h)||!Me(m)||!Me(l)||!Me(u)?null:ee.createElement("path",D1({},ft(x,!0),{className:At("recharts-cross",y),d:ige(n,i,h,m,l,u)}))},lge=ev,cge=e6,uge=mi;function dge(t,e){return t&&t.length?lge(t,uge(e),cge):void 0}var hge=dge;const fge=er(hge);var mge=ev,pge=mi,gge=t6;function yge(t,e){return t&&t.length?mge(t,pge(e),gge):void 0}var xge=yge;const vge=er(xge);var bge=["cx","cy","angle","ticks","axisLine"],wge=["ticks","tick","angle","tickFormatter","stroke"];function nd(t){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nd(t)}function lf(){return lf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},lf.apply(this,arguments)}function DI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function xl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DI(Object(r),!0).forEach(function(n){iv(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function MI(t,e){if(t==null)return{};var r=jge(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function jge(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Nge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,q6(n.key),n)}}function _ge(t,e,r){return e&&RI(t.prototype,e),r&&RI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sge(t,e,r){return e=cy(e),Cge(t,z6()?Reflect.construct(e,r||[],cy(t).constructor):e.apply(t,r))}function Cge(t,e){if(e&&(nd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ege(t)}function Ege(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(z6=function(){return!!t})()}function cy(t){return cy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cy(t)}function Pge(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M1(t,e)}function M1(t,e){return M1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},M1(t,e)}function iv(t,e,r){return e=q6(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function q6(t){var e=Tge(t,"string");return nd(e)=="symbol"?e:e+""}function Tge(t,e){if(nd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ov=function(t){function e(){return Nge(this,e),Sge(this,e,arguments)}return Pge(e,t),_ge(e,[{key:"getTickValueCoord",value:function(n){var s=n.coordinate,i=this.props,o=i.angle,l=i.cx,c=i.cy;return xr(l,c,s,o)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,s;switch(n){case"left":s="end";break;case"right":s="start";break;default:s="middle";break}return s}},{key:"getViewBox",value:function(){var n=this.props,s=n.cx,i=n.cy,o=n.angle,l=n.ticks,c=fge(l,function(d){return d.coordinate||0}),u=vge(l,function(d){return d.coordinate||0});return{cx:s,cy:i,startAngle:o,endAngle:o,innerRadius:u.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,s=n.cx,i=n.cy,o=n.angle,l=n.ticks,c=n.axisLine,u=MI(n,bge),d=l.reduce(function(y,g){return[Math.min(y[0],g.coordinate),Math.max(y[1],g.coordinate)]},[1/0,-1/0]),h=xr(s,i,d[0],o),f=xr(s,i,d[1],o),m=xl(xl(xl({},ft(u,!1)),{},{fill:"none"},ft(c,!1)),{},{x1:h.x,y1:h.y,x2:f.x,y2:f.y});return ee.createElement("line",lf({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var n=this,s=this.props,i=s.ticks,o=s.tick,l=s.angle,c=s.tickFormatter,u=s.stroke,d=MI(s,wge),h=this.getTickTextAnchor(),f=ft(d,!1),m=ft(o,!1),y=i.map(function(g,x){var b=n.getTickValueCoord(g),v=xl(xl(xl(xl({textAnchor:h,transform:"rotate(".concat(90-l,", ").concat(b.x,", ").concat(b.y,")")},f),{},{stroke:"none",fill:u},m),{},{index:x},b),{},{payload:g});return ee.createElement(Ft,lf({className:At("recharts-polar-radius-axis-tick",T6(o)),key:"tick-".concat(g.coordinate)},cc(n.props,g,x)),e.renderTickItem(o,v,c?c(g.value,x):g.value))});return ee.createElement(Ft,{className:"recharts-polar-radius-axis-ticks"},y)}},{key:"render",value:function(){var n=this.props,s=n.ticks,i=n.axisLine,o=n.tick;return!s||!s.length?null:ee.createElement(Ft,{className:At("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),o&&this.renderTicks(),yn.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,s,i){var o;return ee.isValidElement(n)?o=ee.cloneElement(n,s):bt(n)?o=n(s):o=ee.createElement(uc,lf({},s,{className:"recharts-polar-radius-axis-tick-value"}),i),o}}])}(I.PureComponent);iv(ov,"displayName","PolarRadiusAxis");iv(ov,"axisType","radiusAxis");iv(ov,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function ad(t){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ad(t)}function Tl(){return Tl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Tl.apply(this,arguments)}function $I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function vl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$I(Object(r),!0).forEach(function(n){lv(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$I(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Age(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W6(n.key),n)}}function Ige(t,e,r){return e&&LI(t.prototype,e),r&&LI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kge(t,e,r){return e=uy(e),Oge(t,H6()?Reflect.construct(e,r||[],uy(t).constructor):e.apply(t,r))}function Oge(t,e){if(e&&(ad(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dge(t)}function Dge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(H6=function(){return!!t})()}function uy(t){return uy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uy(t)}function Mge(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R1(t,e)}function R1(t,e){return R1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},R1(t,e)}function lv(t,e,r){return e=W6(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W6(t){var e=Rge(t,"string");return ad(e)=="symbol"?e:e+""}function Rge(t,e){if(ad(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ad(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $ge=Math.PI/180,VI=1e-5,cv=function(t){function e(){return Age(this,e),kge(this,e,arguments)}return Mge(e,t),Ige(e,[{key:"getTickLineCoord",value:function(n){var s=this.props,i=s.cx,o=s.cy,l=s.radius,c=s.orientation,u=s.tickSize,d=u||8,h=xr(i,o,l,n.coordinate),f=xr(i,o,l+(c==="inner"?-1:1)*d,n.coordinate);return{x1:h.x,y1:h.y,x2:f.x,y2:f.y}}},{key:"getTickTextAnchor",value:function(n){var s=this.props.orientation,i=Math.cos(-n.coordinate*$ge),o;return i>VI?o=s==="outer"?"start":"end":i<-VI?o=s==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var n=this.props,s=n.cx,i=n.cy,o=n.radius,l=n.axisLine,c=n.axisLineType,u=vl(vl({},ft(this.props,!1)),{},{fill:"none"},ft(l,!1));if(c==="circle")return ee.createElement(sv,Tl({className:"recharts-polar-angle-axis-line"},u,{cx:s,cy:i,r:o}));var d=this.props.ticks,h=d.map(function(f){return xr(s,i,o,f.coordinate)});return ee.createElement(Jpe,Tl({className:"recharts-polar-angle-axis-line"},u,{points:h}))}},{key:"renderTicks",value:function(){var n=this,s=this.props,i=s.ticks,o=s.tick,l=s.tickLine,c=s.tickFormatter,u=s.stroke,d=ft(this.props,!1),h=ft(o,!1),f=vl(vl({},d),{},{fill:"none"},ft(l,!1)),m=i.map(function(y,g){var x=n.getTickLineCoord(y),b=n.getTickTextAnchor(y),v=vl(vl(vl({textAnchor:b},d),{},{stroke:"none",fill:u},h),{},{index:g,payload:y,x:x.x2,y:x.y2});return ee.createElement(Ft,Tl({className:At("recharts-polar-angle-axis-tick",T6(o)),key:"tick-".concat(y.coordinate)},cc(n.props,y,g)),l&&ee.createElement("line",Tl({className:"recharts-polar-angle-axis-tick-line"},f,x)),o&&e.renderTickItem(o,v,c?c(y.value,g):y.value))});return ee.createElement(Ft,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var n=this.props,s=n.ticks,i=n.radius,o=n.axisLine;return i<=0||!s||!s.length?null:ee.createElement(Ft,{className:At("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,s,i){var o;return ee.isValidElement(n)?o=ee.cloneElement(n,s):bt(n)?o=n(s):o=ee.createElement(uc,Tl({},s,{className:"recharts-polar-angle-axis-tick-value"}),i),o}}])}(I.PureComponent);lv(cv,"displayName","PolarAngleAxis");lv(cv,"axisType","angleAxis");lv(cv,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var Lge=YR,Vge=Lge(Object.getPrototypeOf,Object),Fge=Vge,Bge=no,Uge=Fge,zge=ao,qge="[object Object]",Hge=Function.prototype,Wge=Object.prototype,G6=Hge.toString,Gge=Wge.hasOwnProperty,Kge=G6.call(Object);function Qge(t){if(!zge(t)||Bge(t)!=qge)return!1;var e=Uge(t);if(e===null)return!0;var r=Gge.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&G6.call(r)==Kge}var Yge=Qge;const Xge=er(Yge);var Jge=no,Zge=ao,e0e="[object Boolean]";function t0e(t){return t===!0||t===!1||Zge(t)&&Jge(t)==e0e}var r0e=t0e;const n0e=er(r0e);function fm(t){"@babel/helpers - typeof";return fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fm(t)}function dy(){return dy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dy.apply(this,arguments)}function a0e(t,e){return l0e(t)||o0e(t,e)||i0e(t,e)||s0e()}function s0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i0e(t,e){if(t){if(typeof t=="string")return FI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FI(t,e)}}function FI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o0e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function l0e(t){if(Array.isArray(t))return t}function BI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function UI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?BI(Object(r),!0).forEach(function(n){c0e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function c0e(t,e,r){return e=u0e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u0e(t){var e=d0e(t,"string");return fm(e)=="symbol"?e:e+""}function d0e(t,e){if(fm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zI=function(e,r,n,s,i){var o=n-s,l;return l="M ".concat(e,",").concat(r),l+="L ".concat(e+n,",").concat(r),l+="L ".concat(e+n-o/2,",").concat(r+i),l+="L ".concat(e+n-o/2-s,",").concat(r+i),l+="L ".concat(e,",").concat(r," Z"),l},h0e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},f0e=function(e){var r=UI(UI({},h0e),e),n=I.useRef(),s=I.useState(-1),i=a0e(s,2),o=i[0],l=i[1];I.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var j=n.current.getTotalLength();j&&l(j)}catch{}},[]);var c=r.x,u=r.y,d=r.upperWidth,h=r.lowerWidth,f=r.height,m=r.className,y=r.animationEasing,g=r.animationDuration,x=r.animationBegin,b=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||h!==+h||f!==+f||d===0&&h===0||f===0)return null;var v=At("recharts-trapezoid",m);return b?ee.createElement(di,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:f,x:c,y:u},to:{upperWidth:d,lowerWidth:h,height:f,x:c,y:u},duration:g,animationEasing:y,isActive:b},function(j){var S=j.upperWidth,_=j.lowerWidth,C=j.height,N=j.x,w=j.y;return ee.createElement(di,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:g,easing:y},ee.createElement("path",dy({},ft(r,!0),{className:v,d:zI(N,w,S,_,C),ref:n})))}):ee.createElement("g",null,ee.createElement("path",dy({},ft(r,!0),{className:v,d:zI(c,u,d,h,f)})))},m0e=["option","shapeType","propTransformer","activeClassName","isActive"];function mm(t){"@babel/helpers - typeof";return mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mm(t)}function p0e(t,e){if(t==null)return{};var r=g0e(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function g0e(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function qI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function hy(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qI(Object(r),!0).forEach(function(n){y0e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function y0e(t,e,r){return e=x0e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x0e(t){var e=v0e(t,"string");return mm(e)=="symbol"?e:e+""}function v0e(t,e){if(mm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(mm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b0e(t,e){return hy(hy({},e),t)}function w0e(t,e){return t==="symbols"}function HI(t){var e=t.shapeType,r=t.elementProps;switch(e){case"rectangle":return ee.createElement(r2,r);case"trapezoid":return ee.createElement(f0e,r);case"sector":return ee.createElement(k6,r);case"symbols":if(w0e(e))return ee.createElement(wS,r);break;default:return null}}function j0e(t){return I.isValidElement(t)?t.props:t}function K6(t){var e=t.option,r=t.shapeType,n=t.propTransformer,s=n===void 0?b0e:n,i=t.activeClassName,o=i===void 0?"recharts-active-shape":i,l=t.isActive,c=p0e(t,m0e),u;if(I.isValidElement(e))u=I.cloneElement(e,hy(hy({},c),j0e(e)));else if(bt(e))u=e(c);else if(Xge(e)&&!n0e(e)){var d=s(e,c);u=ee.createElement(HI,{shapeType:r,elementProps:d})}else{var h=c;u=ee.createElement(HI,{shapeType:r,elementProps:h})}return l?ee.createElement(Ft,{className:o},u):u}function uv(t,e){return e!=null&&"trapezoids"in t.props}function dv(t,e){return e!=null&&"sectors"in t.props}function pm(t,e){return e!=null&&"points"in t.props}function N0e(t,e){var r,n,s=t.x===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.x)||t.x===e.x,i=t.y===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.y)||t.y===e.y;return s&&i}function _0e(t,e){var r=t.endAngle===e.endAngle,n=t.startAngle===e.startAngle;return r&&n}function S0e(t,e){var r=t.x===e.x,n=t.y===e.y,s=t.z===e.z;return r&&n&&s}function C0e(t,e){var r;return uv(t,e)?r=N0e:dv(t,e)?r=_0e:pm(t,e)&&(r=S0e),r}function E0e(t,e){var r;return uv(t,e)?r="trapezoids":dv(t,e)?r="sectors":pm(t,e)&&(r="points"),r}function P0e(t,e){if(uv(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(dv(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return pm(t,e)?e.payload:{}}function T0e(t){var e=t.activeTooltipItem,r=t.graphicalItem,n=t.itemData,s=E0e(r,e),i=P0e(r,e),o=n.filter(function(c,u){var d=ed(i,c),h=r.props[s].filter(function(y){var g=C0e(r,e);return g(y,e)}),f=r.props[s].indexOf(h[h.length-1]),m=u===f;return d&&m}),l=n.indexOf(o[o.length-1]);return l}var Ag;function sd(t){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sd(t)}function su(){return su=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},su.apply(this,arguments)}function WI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function mr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WI(Object(r),!0).forEach(function(n){ns(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function A0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Y6(n.key),n)}}function I0e(t,e,r){return e&&GI(t.prototype,e),r&&GI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function k0e(t,e,r){return e=fy(e),O0e(t,Q6()?Reflect.construct(e,r||[],fy(t).constructor):e.apply(t,r))}function O0e(t,e){if(e&&(sd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D0e(t)}function D0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Q6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q6=function(){return!!t})()}function fy(t){return fy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fy(t)}function M0e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$1(t,e)}function $1(t,e){return $1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},$1(t,e)}function ns(t,e,r){return e=Y6(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y6(t){var e=R0e(t,"string");return sd(e)=="symbol"?e:e+""}function R0e(t,e){if(sd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vs=function(t){function e(r){var n;return A0e(this,e),n=k0e(this,e,[r]),ns(n,"pieRef",null),ns(n,"sectorRefs",[]),ns(n,"id",Vd("recharts-pie-")),ns(n,"handleAnimationEnd",function(){var s=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),bt(s)&&s()}),ns(n,"handleAnimationStart",function(){var s=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),bt(s)&&s()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return M0e(e,t),I0e(e,[{key:"isActiveIndex",value:function(n){var s=this.props.activeIndex;return Array.isArray(s)?s.indexOf(n)!==-1:n===s}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.label,l=i.labelLine,c=i.dataKey,u=i.valueKey,d=ft(this.props,!1),h=ft(o,!1),f=ft(l,!1),m=o&&o.offsetRadius||20,y=n.map(function(g,x){var b=(g.startAngle+g.endAngle)/2,v=xr(g.cx,g.cy,g.outerRadius+m,b),j=mr(mr(mr(mr({},d),g),{},{stroke:"none"},h),{},{index:x,textAnchor:e.getTextAnchor(v.x,g.cx)},v),S=mr(mr(mr(mr({},d),g),{},{fill:"none",stroke:g.fill},f),{},{index:x,points:[xr(g.cx,g.cy,g.outerRadius,b),v]}),_=c;return Pt(c)&&Pt(u)?_="value":Pt(c)&&(_=u),ee.createElement(Ft,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(x)},l&&e.renderLabelLineItem(l,S,"line"),e.renderLabelItem(o,j,on(g,_)))});return ee.createElement(Ft,{className:"recharts-pie-labels"},y)}},{key:"renderSectorsStatically",value:function(n){var s=this,i=this.props,o=i.activeShape,l=i.blendStroke,c=i.inactiveShape;return n.map(function(u,d){if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&n.length!==1)return null;var h=s.isActiveIndex(d),f=c&&s.hasActiveIndex()?c:null,m=h?o:f,y=mr(mr({},u),{},{stroke:l?u.fill:u.stroke,tabIndex:-1});return ee.createElement(Ft,su({ref:function(x){x&&!s.sectorRefs.includes(x)&&s.sectorRefs.push(x)},tabIndex:-1,className:"recharts-pie-sector"},cc(s.props,u,d),{key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(d)}),ee.createElement(K6,su({option:m,isActive:h,shapeType:"sector"},y)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,s=this.props,i=s.sectors,o=s.isAnimationActive,l=s.animationBegin,c=s.animationDuration,u=s.animationEasing,d=s.animationId,h=this.state,f=h.prevSectors,m=h.prevIsAnimationActive;return ee.createElement(di,{begin:l,duration:c,isActive:o,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(y){var g=y.t,x=[],b=i&&i[0],v=b.startAngle;return i.forEach(function(j,S){var _=f&&f[S],C=S>0?Fa(j,"paddingAngle",0):0;if(_){var N=xa(_.endAngle-_.startAngle,j.endAngle-j.startAngle),w=mr(mr({},j),{},{startAngle:v+C,endAngle:v+N(g)+C});x.push(w),v=w.endAngle}else{var E=j.endAngle,k=j.startAngle,T=xa(0,E-k),P=T(g),O=mr(mr({},j),{},{startAngle:v+C,endAngle:v+P+C});x.push(O),v=O.endAngle}}),ee.createElement(Ft,null,n.renderSectorsStatically(x))})}},{key:"attachKeyboardHandlers",value:function(n){var s=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var o=++s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[o].focus(),s.setState({sectorToFocus:o});break}case"ArrowRight":{var l=--s.state.sectorToFocus<0?s.sectorRefs.length-1:s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[l].focus(),s.setState({sectorToFocus:l});break}case"Escape":{s.sectorRefs[s.state.sectorToFocus].blur(),s.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,s=n.sectors,i=n.isAnimationActive,o=this.state.prevSectors;return i&&s&&s.length&&(!o||!ed(o,s))?this.renderSectorsWithAnimation():this.renderSectorsStatically(s)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,s=this.props,i=s.hide,o=s.sectors,l=s.className,c=s.label,u=s.cx,d=s.cy,h=s.innerRadius,f=s.outerRadius,m=s.isAnimationActive,y=this.state.isAnimationFinished;if(i||!o||!o.length||!Me(u)||!Me(d)||!Me(h)||!Me(f))return null;var g=At("recharts-pie",l);return ee.createElement(Ft,{tabIndex:this.props.rootTabIndex,className:g,ref:function(b){n.pieRef=b}},this.renderSectors(),c&&this.renderLabels(o),yn.renderCallByParent(this.props,null,!1),(!m||y)&&Fi.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return s.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:s.curSectors,isAnimationFinished:!0}:n.sectors!==s.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,s){return n>s?"start":n<s?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,s,i){if(ee.isValidElement(n))return ee.cloneElement(n,s);if(bt(n))return n(s);var o=At("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return ee.createElement(_u,su({},s,{key:i,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(n,s,i){if(ee.isValidElement(n))return ee.cloneElement(n,s);var o=i;if(bt(n)&&(o=n(s),ee.isValidElement(o)))return o;var l=At("recharts-pie-label-text",typeof n!="boolean"&&!bt(n)?n.className:"");return ee.createElement(uc,su({},s,{alignmentBaseline:"middle",className:l}),o)}}])}(I.PureComponent);Ag=Vs;ns(Vs,"displayName","Pie");ns(Vs,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!si.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});ns(Vs,"parseDeltaAngle",function(t,e){var r=sa(e-t),n=Math.min(Math.abs(e-t),360);return r*n});ns(Vs,"getRealPieData",function(t){var e=t.data,r=t.children,n=ft(t,!1),s=hs(r,Eo);return e&&e.length?e.map(function(i,o){return mr(mr(mr({payload:i},n),i),s&&s[o]&&s[o].props)}):s&&s.length?s.map(function(i){return mr(mr({},n),i.props)}):[]});ns(Vs,"parseCoordinateOfPie",function(t,e){var r=e.top,n=e.left,s=e.width,i=e.height,o=P6(s,i),l=n+ia(t.cx,s,s/2),c=r+ia(t.cy,i,i/2),u=ia(t.innerRadius,o,0),d=ia(t.outerRadius,o,o*.8),h=t.maxRadius||Math.sqrt(s*s+i*i)/2;return{cx:l,cy:c,innerRadius:u,outerRadius:d,maxRadius:h}});ns(Vs,"getComposedData",function(t){var e=t.item,r=t.offset,n=e.type.defaultProps!==void 0?mr(mr({},e.type.defaultProps),e.props):e.props,s=Ag.getRealPieData(n);if(!s||!s.length)return null;var i=n.cornerRadius,o=n.startAngle,l=n.endAngle,c=n.paddingAngle,u=n.dataKey,d=n.nameKey,h=n.valueKey,f=n.tooltipType,m=Math.abs(n.minAngle),y=Ag.parseCoordinateOfPie(n,r),g=Ag.parseDeltaAngle(o,l),x=Math.abs(g),b=u;Pt(u)&&Pt(h)?(Ls(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),b="value"):Pt(u)&&(Ls(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),b=h);var v=s.filter(function(w){return on(w,b,0)!==0}).length,j=(x>=360?v:v-1)*c,S=x-v*m-j,_=s.reduce(function(w,E){var k=on(E,b,0);return w+(Me(k)?k:0)},0),C;if(_>0){var N;C=s.map(function(w,E){var k=on(w,b,0),T=on(w,d,E),P=(Me(k)?k:0)/_,O;E?O=N.endAngle+sa(g)*c*(k!==0?1:0):O=o;var D=O+sa(g)*((k!==0?m:0)+P*S),R=(O+D)/2,B=(y.innerRadius+y.outerRadius)/2,Y=[{name:T,value:k,payload:w,dataKey:b,type:f}],W=xr(y.cx,y.cy,B,R);return N=mr(mr(mr({percent:P,cornerRadius:i,name:T,tooltipPayload:Y,midAngle:R,middleRadius:B,tooltipPosition:W},w),y),{},{value:on(w,b),startAngle:O,endAngle:D,payload:w,paddingAngle:sa(g)*c}),N})}return mr(mr({},y),{},{sectors:C,data:s})});var $0e=Math.ceil,L0e=Math.max;function V0e(t,e,r,n){for(var s=-1,i=L0e($0e((e-t)/(r||1)),0),o=Array(i);i--;)o[n?i:++s]=t,t+=r;return o}var F0e=V0e,B0e=p4,KI=1/0,U0e=17976931348623157e292;function z0e(t){if(!t)return t===0?t:0;if(t=B0e(t),t===KI||t===-KI){var e=t<0?-1:1;return e*U0e}return t===t?t:0}var X6=z0e,q0e=F0e,H0e=Gx,Fb=X6;function W0e(t){return function(e,r,n){return n&&typeof n!="number"&&H0e(e,r,n)&&(r=n=void 0),e=Fb(e),r===void 0?(r=e,e=0):r=Fb(r),n=n===void 0?e<r?1:-1:Fb(n),q0e(e,r,n,t)}}var G0e=W0e,K0e=G0e,Q0e=K0e(),Y0e=Q0e;const my=er(Y0e);function gm(t){"@babel/helpers - typeof";return gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gm(t)}function QI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function YI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QI(Object(r),!0).forEach(function(n){J6(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function J6(t,e,r){return e=X0e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X0e(t){var e=J0e(t,"string");return gm(e)=="symbol"?e:e+""}function J0e(t,e){if(gm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Z0e=["Webkit","Moz","O","ms"],eye=function(e,r){var n=e.replace(/(\w)/,function(i){return i.toUpperCase()}),s=Z0e.reduce(function(i,o){return YI(YI({},i),{},J6({},o+n,r))},{});return s[e]=r,s};function id(t){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},id(t)}function py(){return py=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},py.apply(this,arguments)}function XI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Bb(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XI(Object(r),!0).forEach(function(n){Aa(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,e$(n.key),n)}}function rye(t,e,r){return e&&JI(t.prototype,e),r&&JI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function nye(t,e,r){return e=gy(e),aye(t,Z6()?Reflect.construct(e,r||[],gy(t).constructor):e.apply(t,r))}function aye(t,e){if(e&&(id(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sye(t)}function sye(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Z6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Z6=function(){return!!t})()}function gy(t){return gy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gy(t)}function iye(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L1(t,e)}function L1(t,e){return L1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},L1(t,e)}function Aa(t,e,r){return e=e$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e$(t){var e=oye(t,"string");return id(e)=="symbol"?e:e+""}function oye(t,e){if(id(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(id(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lye=function(e){var r=e.data,n=e.startIndex,s=e.endIndex,i=e.x,o=e.width,l=e.travellerWidth;if(!r||!r.length)return{};var c=r.length,u=nf().domain(my(0,c)).range([i,i+o-l]),d=u.domain().map(function(h){return u(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(s),scale:u,scaleValues:d}},ZI=function(e){return e.changedTouches&&!!e.changedTouches.length},od=function(t){function e(r){var n;return tye(this,e),n=nye(this,e,[r]),Aa(n,"handleDrag",function(s){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(s):n.state.isSlideMoving&&n.handleSlideDrag(s)}),Aa(n,"handleTouchMove",function(s){s.changedTouches!=null&&s.changedTouches.length>0&&n.handleDrag(s.changedTouches[0])}),Aa(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var s=n.props,i=s.endIndex,o=s.onDragEnd,l=s.startIndex;o==null||o({endIndex:i,startIndex:l})}),n.detachDragEndListener()}),Aa(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Aa(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Aa(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Aa(n,"handleSlideDragStart",function(s){var i=ZI(s)?s.changedTouches[0]:s;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return iye(e,t),rye(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var s=n.startX,i=n.endX,o=this.state.scaleValues,l=this.props,c=l.gap,u=l.data,d=u.length-1,h=Math.min(s,i),f=Math.max(s,i),m=e.getIndexInRange(o,h),y=e.getIndexInRange(o,f);return{startIndex:m-m%c,endIndex:y===d?d:y-y%c}}},{key:"getTextOfTick",value:function(n){var s=this.props,i=s.data,o=s.tickFormatter,l=s.dataKey,c=on(i[n],l,n);return bt(o)?o(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var s=this.state,i=s.slideMoveStartX,o=s.startX,l=s.endX,c=this.props,u=c.x,d=c.width,h=c.travellerWidth,f=c.startIndex,m=c.endIndex,y=c.onChange,g=n.pageX-i;g>0?g=Math.min(g,u+d-h-l,u+d-h-o):g<0&&(g=Math.max(g,u-o,u-l));var x=this.getIndex({startX:o+g,endX:l+g});(x.startIndex!==f||x.endIndex!==m)&&y&&y(x),this.setState({startX:o+g,endX:l+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,s){var i=ZI(s)?s.changedTouches[0]:s;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var s=this.state,i=s.brushMoveStartX,o=s.movingTravellerId,l=s.endX,c=s.startX,u=this.state[o],d=this.props,h=d.x,f=d.width,m=d.travellerWidth,y=d.onChange,g=d.gap,x=d.data,b={startX:this.state.startX,endX:this.state.endX},v=n.pageX-i;v>0?v=Math.min(v,h+f-m-u):v<0&&(v=Math.max(v,h-u)),b[o]=u+v;var j=this.getIndex(b),S=j.startIndex,_=j.endIndex,C=function(){var w=x.length-1;return o==="startX"&&(l>c?S%g===0:_%g===0)||l<c&&_===w||o==="endX"&&(l>c?_%g===0:S%g===0)||l>c&&_===w};this.setState(Aa(Aa({},o,u+v),"brushMoveStartX",n.pageX),function(){y&&C()&&y(j)})}},{key:"handleTravellerMoveKeyboard",value:function(n,s){var i=this,o=this.state,l=o.scaleValues,c=o.startX,u=o.endX,d=this.state[s],h=l.indexOf(d);if(h!==-1){var f=h+n;if(!(f===-1||f>=l.length)){var m=l[f];s==="startX"&&m>=u||s==="endX"&&m<=c||this.setState(Aa({},s,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,s=n.x,i=n.y,o=n.width,l=n.height,c=n.fill,u=n.stroke;return ee.createElement("rect",{stroke:u,fill:c,x:s,y:i,width:o,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,s=n.x,i=n.y,o=n.width,l=n.height,c=n.data,u=n.children,d=n.padding,h=I.Children.only(u);return h?ee.cloneElement(h,{x:s,y:i,width:o,height:l,margin:d,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,s){var i,o,l=this,c=this.props,u=c.y,d=c.travellerWidth,h=c.height,f=c.traveller,m=c.ariaLabel,y=c.data,g=c.startIndex,x=c.endIndex,b=Math.max(n,this.props.x),v=Bb(Bb({},ft(this.props,!1)),{},{x:b,y:u,width:d,height:h}),j=m||"Min value: ".concat((i=y[g])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=y[x])===null||o===void 0?void 0:o.name);return ee.createElement(Ft,{tabIndex:0,role:"slider","aria-label":j,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[s],onTouchStart:this.travellerDragStartHandlers[s],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),l.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,s))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(f,v))}},{key:"renderSlide",value:function(n,s){var i=this.props,o=i.y,l=i.height,c=i.stroke,u=i.travellerWidth,d=Math.min(n,s)+u,h=Math.max(Math.abs(s-n)-u,0);return ee.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:d,y:o,width:h,height:l})}},{key:"renderText",value:function(){var n=this.props,s=n.startIndex,i=n.endIndex,o=n.y,l=n.height,c=n.travellerWidth,u=n.stroke,d=this.state,h=d.startX,f=d.endX,m=5,y={pointerEvents:"none",fill:u};return ee.createElement(Ft,{className:"recharts-brush-texts"},ee.createElement(uc,py({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,f)-m,y:o+l/2},y),this.getTextOfTick(s)),ee.createElement(uc,py({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,f)+c+m,y:o+l/2},y),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,s=n.data,i=n.className,o=n.children,l=n.x,c=n.y,u=n.width,d=n.height,h=n.alwaysShowText,f=this.state,m=f.startX,y=f.endX,g=f.isTextActive,x=f.isSlideMoving,b=f.isTravellerMoving,v=f.isTravellerFocused;if(!s||!s.length||!Me(l)||!Me(c)||!Me(u)||!Me(d)||u<=0||d<=0)return null;var j=At("recharts-brush",i),S=ee.Children.count(o)===1,_=eye("userSelect","none");return ee.createElement(Ft,{className:j,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),S&&this.renderPanorama(),this.renderSlide(m,y),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(y,"endX"),(g||x||b||v||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var s=n.x,i=n.y,o=n.width,l=n.height,c=n.stroke,u=Math.floor(i+l/2)-1;return ee.createElement(ee.Fragment,null,ee.createElement("rect",{x:s,y:i,width:o,height:l,fill:c,stroke:"none"}),ee.createElement("line",{x1:s+1,y1:u,x2:s+o-1,y2:u,fill:"none",stroke:"#fff"}),ee.createElement("line",{x1:s+1,y1:u+2,x2:s+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,s){var i;return ee.isValidElement(n)?i=ee.cloneElement(n,s):bt(n)?i=n(s):i=e.renderDefaultTraveller(s),i}},{key:"getDerivedStateFromProps",value:function(n,s){var i=n.data,o=n.width,l=n.x,c=n.travellerWidth,u=n.updateId,d=n.startIndex,h=n.endIndex;if(i!==s.prevData||u!==s.prevUpdateId)return Bb({prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:o},i&&i.length?lye({data:i,width:o,x:l,travellerWidth:c,startIndex:d,endIndex:h}):{scale:null,scaleValues:null});if(s.scale&&(o!==s.prevWidth||l!==s.prevX||c!==s.prevTravellerWidth)){s.scale.range([l,l+o-c]);var f=s.scale.domain().map(function(m){return s.scale(m)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:o,startX:s.scale(n.startIndex),endX:s.scale(n.endIndex),scaleValues:f}}return null}},{key:"getIndexInRange",value:function(n,s){for(var i=n.length,o=0,l=i-1;l-o>1;){var c=Math.floor((o+l)/2);n[c]>s?l=c:o=c}return s>=n[l]?l:o}}])}(I.PureComponent);Aa(od,"displayName","Brush");Aa(od,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var cye=PS;function uye(t,e){var r;return cye(t,function(n,s,i){return r=e(n,s,i),!r}),!!r}var dye=uye,hye=UR,fye=mi,mye=dye,pye=Ea,gye=Gx;function yye(t,e,r){var n=pye(t)?hye:mye;return r&&gye(t,e,r)&&(e=void 0),n(t,fye(e))}var xye=yye;const vye=er(xye);var oi=function(e,r){var n=e.alwaysShow,s=e.ifOverflow;return n&&(s="extendDomain"),s===r},ek=u4;function bye(t,e,r){e=="__proto__"&&ek?ek(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var wye=bye,jye=wye,Nye=l4,_ye=mi;function Sye(t,e){var r={};return e=_ye(e),Nye(t,function(n,s,i){jye(r,s,e(n,s,i))}),r}var Cye=Sye;const Eye=er(Cye);function Pye(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}var Tye=Pye,Aye=PS;function Iye(t,e){var r=!0;return Aye(t,function(n,s,i){return r=!!e(n,s,i),r}),r}var kye=Iye,Oye=Tye,Dye=kye,Mye=mi,Rye=Ea,$ye=Gx;function Lye(t,e,r){var n=Rye(t)?Oye:Dye;return r&&$ye(t,e,r)&&(e=void 0),n(t,Mye(e))}var Vye=Lye;const t$=er(Vye);var Fye=["x","y"];function ym(t){"@babel/helpers - typeof";return ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ym(t)}function V1(){return V1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},V1.apply(this,arguments)}function tk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function jh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tk(Object(r),!0).forEach(function(n){Bye(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Bye(t,e,r){return e=Uye(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uye(t){var e=zye(t,"string");return ym(e)=="symbol"?e:e+""}function zye(t,e){if(ym(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ym(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qye(t,e){if(t==null)return{};var r=Hye(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Hye(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Wye(t,e){var r=t.x,n=t.y,s=qye(t,Fye),i="".concat(r),o=parseInt(i,10),l="".concat(n),c=parseInt(l,10),u="".concat(e.height||s.height),d=parseInt(u,10),h="".concat(e.width||s.width),f=parseInt(h,10);return jh(jh(jh(jh(jh({},e),s),o?{x:o}:{}),c?{y:c}:{}),{},{height:d,width:f,name:e.name,radius:e.radius})}function rk(t){return ee.createElement(K6,V1({shapeType:"rectangle",propTransformer:Wye,activeClassName:"recharts-active-bar"},t))}var Gye=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,s){if(typeof e=="number")return e;var i=Me(n)||xX(n);return i?e(n,s):(i||hc(),r)}},Kye=["value","background"],r$;function ld(t){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ld(t)}function Qye(t,e){if(t==null)return{};var r=Yye(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Yye(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function yy(){return yy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yy.apply(this,arguments)}function nk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Xr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nk(Object(r),!0).forEach(function(n){ko(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ak(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a$(n.key),n)}}function Jye(t,e,r){return e&&ak(t.prototype,e),r&&ak(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zye(t,e,r){return e=xy(e),exe(t,n$()?Reflect.construct(e,r||[],xy(t).constructor):e.apply(t,r))}function exe(t,e){if(e&&(ld(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return txe(t)}function txe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n$(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n$=function(){return!!t})()}function xy(t){return xy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xy(t)}function rxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F1(t,e)}function F1(t,e){return F1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},F1(t,e)}function ko(t,e,r){return e=a$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a$(t){var e=nxe(t,"string");return ld(e)=="symbol"?e:e+""}function nxe(t,e){if(ld(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ld(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ms=function(t){function e(){var r;Xye(this,e);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return r=Zye(this,e,[].concat(s)),ko(r,"state",{isAnimationFinished:!1}),ko(r,"id",Vd("recharts-bar-")),ko(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),ko(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return rxe(e,t),Jye(e,[{key:"renderRectanglesStatically",value:function(n){var s=this,i=this.props,o=i.shape,l=i.dataKey,c=i.activeIndex,u=i.activeBar,d=ft(this.props,!1);return n&&n.map(function(h,f){var m=f===c,y=m?u:o,g=Xr(Xr(Xr({},d),h),{},{isActive:m,option:y,index:f,dataKey:l,onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd});return ee.createElement(Ft,yy({className:"recharts-bar-rectangle"},cc(s.props,h,f),{key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(f)}),ee.createElement(rk,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,s=this.props,i=s.data,o=s.layout,l=s.isAnimationActive,c=s.animationBegin,u=s.animationDuration,d=s.animationEasing,h=s.animationId,f=this.state.prevData;return ee.createElement(di,{begin:c,duration:u,isActive:l,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var y=m.t,g=i.map(function(x,b){var v=f&&f[b];if(v){var j=xa(v.x,x.x),S=xa(v.y,x.y),_=xa(v.width,x.width),C=xa(v.height,x.height);return Xr(Xr({},x),{},{x:j(y),y:S(y),width:_(y),height:C(y)})}if(o==="horizontal"){var N=xa(0,x.height),w=N(y);return Xr(Xr({},x),{},{y:x.y+x.height-w,height:w})}var E=xa(0,x.width),k=E(y);return Xr(Xr({},x),{},{width:k})});return ee.createElement(Ft,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,s=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&s&&s.length&&(!o||!ed(o,s))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(s)}},{key:"renderBackground",value:function(){var n=this,s=this.props,i=s.data,o=s.dataKey,l=s.activeIndex,c=ft(this.props.background,!1);return i.map(function(u,d){u.value;var h=u.background,f=Qye(u,Kye);if(!h)return null;var m=Xr(Xr(Xr(Xr(Xr({},f),{},{fill:"#eee"},h),c),cc(n.props,u,d)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:d,className:"recharts-bar-background-rectangle"});return ee.createElement(rk,yy({key:"background-bar-".concat(d),option:n.props.background,isActive:d===l},m))})}},{key:"renderErrorBar",value:function(n,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,l=i.xAxis,c=i.yAxis,u=i.layout,d=i.children,h=hs(d,av);if(!h)return null;var f=u==="vertical"?o[0].height/2:o[0].width/2,m=function(x,b){var v=Array.isArray(x.value)?x.value[1]:x.value;return{x:x.x,y:x.y,value:v,errorVal:on(x,b)}},y={clipPath:n?"url(#clipPath-".concat(s,")"):null};return ee.createElement(Ft,y,h.map(function(g){return ee.cloneElement(g,{key:"error-bar-".concat(s,"-").concat(g.props.dataKey),data:o,xAxis:l,yAxis:c,layout:u,offset:f,dataPointFormatter:m})}))}},{key:"render",value:function(){var n=this.props,s=n.hide,i=n.data,o=n.className,l=n.xAxis,c=n.yAxis,u=n.left,d=n.top,h=n.width,f=n.height,m=n.isAnimationActive,y=n.background,g=n.id;if(s||!i||!i.length)return null;var x=this.state.isAnimationFinished,b=At("recharts-bar",o),v=l&&l.allowDataOverflow,j=c&&c.allowDataOverflow,S=v||j,_=Pt(g)?this.id:g;return ee.createElement(Ft,{className:b},v||j?ee.createElement("defs",null,ee.createElement("clipPath",{id:"clipPath-".concat(_)},ee.createElement("rect",{x:v?u:u-h/2,y:j?d:d-f/2,width:v?h:h*2,height:j?f:f*2}))):null,ee.createElement(Ft,{className:"recharts-bar-rectangles",clipPath:S?"url(#clipPath-".concat(_,")"):null},y?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(S,_),(!m||x)&&Fi.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:s.curData}:n.data!==s.curData?{curData:n.data}:null}}])}(I.PureComponent);r$=Ms;ko(Ms,"displayName","Bar");ko(Ms,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!si.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});ko(Ms,"getComposedData",function(t){var e=t.props,r=t.item,n=t.barPosition,s=t.bandSize,i=t.xAxis,o=t.yAxis,l=t.xAxisTicks,c=t.yAxisTicks,u=t.stackedData,d=t.dataStartIndex,h=t.displayedData,f=t.offset,m=$he(n,r);if(!m)return null;var y=e.layout,g=r.type.defaultProps,x=g!==void 0?Xr(Xr({},g),r.props):r.props,b=x.dataKey,v=x.children,j=x.minPointSize,S=y==="horizontal"?o:i,_=u?S.scale.domain():null,C=qhe({numericAxis:S}),N=hs(v,Eo),w=h.map(function(E,k){var T,P,O,D,R,B;u?T=Lhe(u[d+k],_):(T=on(E,b),Array.isArray(T)||(T=[C,T]));var Y=Gye(j,r$.defaultProps.minPointSize)(T[1],k);if(y==="horizontal"){var W,L=[o.scale(T[0]),o.scale(T[1])],X=L[0],G=L[1];P=GA({axis:i,ticks:l,bandSize:s,offset:m.offset,entry:E,index:k}),O=(W=G??X)!==null&&W!==void 0?W:void 0,D=m.size;var K=X-G;if(R=Number.isNaN(K)?0:K,B={x:P,y:o.y,width:D,height:o.height},Math.abs(Y)>0&&Math.abs(R)<Math.abs(Y)){var q=sa(R||Y)*(Math.abs(Y)-Math.abs(R));O-=q,R+=q}}else{var ie=[i.scale(T[0]),i.scale(T[1])],ge=ie[0],be=ie[1];if(P=ge,O=GA({axis:o,ticks:c,bandSize:s,offset:m.offset,entry:E,index:k}),D=be-ge,R=m.size,B={x:i.x,y:O,width:i.width,height:R},Math.abs(Y)>0&&Math.abs(D)<Math.abs(Y)){var Ye=sa(D||Y)*(Math.abs(Y)-Math.abs(D));D+=Ye}}return Xr(Xr(Xr({},E),{},{x:P,y:O,width:D,height:R,value:u?T:T[1],payload:E,background:B},N&&N[k]&&N[k].props),{},{tooltipPayload:[C6(r,E)],tooltipPosition:{x:P+D/2,y:O+R/2}})});return Xr({data:w,layout:y},f)});function xm(t){"@babel/helpers - typeof";return xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xm(t)}function axe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s$(n.key),n)}}function sxe(t,e,r){return e&&sk(t.prototype,e),r&&sk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ik(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Ts(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ik(Object(r),!0).forEach(function(n){hv(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ik(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hv(t,e,r){return e=s$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s$(t){var e=ixe(t,"string");return xm(e)=="symbol"?e:e+""}function ixe(t,e){if(xm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var i$=function(e,r,n,s,i){var o=e.width,l=e.height,c=e.layout,u=e.children,d=Object.keys(r),h={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},f=!!ka(u,Ms);return d.reduce(function(m,y){var g=r[y],x=g.orientation,b=g.domain,v=g.padding,j=v===void 0?{}:v,S=g.mirror,_=g.reversed,C="".concat(x).concat(S?"Mirror":""),N,w,E,k,T;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var P=b[1]-b[0],O=1/0,D=g.categoricalDomain.sort(wX);if(D.forEach(function(ie,ge){ge>0&&(O=Math.min((ie||0)-(D[ge-1]||0),O))}),Number.isFinite(O)){var R=O/P,B=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(N=R*B/2),g.padding==="no-gap"){var Y=ia(e.barCategoryGap,R*B),W=R*B/2;N=W-Y-(W-Y)/B*Y}}}s==="xAxis"?w=[n.left+(j.left||0)+(N||0),n.left+n.width-(j.right||0)-(N||0)]:s==="yAxis"?w=c==="horizontal"?[n.top+n.height-(j.bottom||0),n.top+(j.top||0)]:[n.top+(j.top||0)+(N||0),n.top+n.height-(j.bottom||0)-(N||0)]:w=g.range,_&&(w=[w[1],w[0]]);var L=j6(g,i,f),X=L.scale,G=L.realScaleType;X.domain(b).range(w),N6(X);var K=_6(X,Ts(Ts({},g),{},{realScaleType:G}));s==="xAxis"?(T=x==="top"&&!S||x==="bottom"&&S,E=n.left,k=h[C]-T*g.height):s==="yAxis"&&(T=x==="left"&&!S||x==="right"&&S,E=h[C]-T*g.width,k=n.top);var q=Ts(Ts(Ts({},g),K),{},{realScaleType:G,x:E,y:k,scale:X,width:s==="xAxis"?n.width:g.width,height:s==="yAxis"?n.height:g.height});return q.bandSize=ry(q,K),!g.hide&&s==="xAxis"?h[C]+=(T?-1:1)*q.height:g.hide||(h[C]+=(T?-1:1)*q.width),Ts(Ts({},m),{},hv({},y,q))},{})},o$=function(e,r){var n=e.x,s=e.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(s,o),width:Math.abs(i-n),height:Math.abs(o-s)}},oxe=function(e){var r=e.x1,n=e.y1,s=e.x2,i=e.y2;return o$({x:r,y:n},{x:s,y:i})},l$=function(){function t(e){axe(this,t),this.scale=e}return sxe(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(s){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),s=n[0],i=n[n.length-1];return s<=i?r>=s&&r<=i:r>=i&&r<=s}}],[{key:"create",value:function(r){return new t(r)}}])}();hv(l$,"EPS",1e-4);var n2=function(e){var r=Object.keys(e).reduce(function(n,s){return Ts(Ts({},n),{},hv({},s,l$.create(e[s])))},{});return Ts(Ts({},r),{},{apply:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return Eye(s,function(c,u){return r[u].apply(c,{bandAware:o,position:l})})},isInRange:function(s){return t$(s,function(i,o){return r[o].isInRange(i)})}})};function lxe(t){return(t%180+180)%180}var cxe=function(e){var r=e.width,n=e.height,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=lxe(s),o=i*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},uxe=mi,dxe=Qm,hxe=Hx;function fxe(t){return function(e,r,n){var s=Object(e);if(!dxe(e)){var i=uxe(r);e=hxe(e),r=function(l){return i(s[l],l,s)}}var o=t(e,r,n);return o>-1?s[i?e[o]:o]:void 0}}var mxe=fxe,pxe=X6;function gxe(t){var e=pxe(t),r=e%1;return e===e?r?e-r:e:0}var yxe=gxe,xxe=r4,vxe=mi,bxe=yxe,wxe=Math.max;function jxe(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var s=r==null?0:bxe(r);return s<0&&(s=wxe(n+s,0)),xxe(t,vxe(e),s)}var Nxe=jxe,_xe=mxe,Sxe=Nxe,Cxe=_xe(Sxe),Exe=Cxe;const Pxe=er(Exe);var Txe=jY(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),a2=I.createContext(void 0),s2=I.createContext(void 0),c$=I.createContext(void 0),u$=I.createContext({}),d$=I.createContext(void 0),h$=I.createContext(0),f$=I.createContext(0),ok=function(e){var r=e.state,n=r.xAxisMap,s=r.yAxisMap,i=r.offset,o=e.clipPathId,l=e.children,c=e.width,u=e.height,d=Txe(i);return ee.createElement(a2.Provider,{value:n},ee.createElement(s2.Provider,{value:s},ee.createElement(u$.Provider,{value:i},ee.createElement(c$.Provider,{value:d},ee.createElement(d$.Provider,{value:o},ee.createElement(h$.Provider,{value:u},ee.createElement(f$.Provider,{value:c},l)))))))},Axe=function(){return I.useContext(d$)},m$=function(e){var r=I.useContext(a2);r==null&&hc();var n=r[e];return n==null&&hc(),n},Ixe=function(){var e=I.useContext(a2);return Co(e)},kxe=function(){var e=I.useContext(s2),r=Pxe(e,function(n){return t$(n.domain,Number.isFinite)});return r||Co(e)},p$=function(e){var r=I.useContext(s2);r==null&&hc();var n=r[e];return n==null&&hc(),n},Oxe=function(){var e=I.useContext(c$);return e},Dxe=function(){return I.useContext(u$)},i2=function(){return I.useContext(f$)},o2=function(){return I.useContext(h$)};function cd(t){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cd(t)}function Mxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rxe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y$(n.key),n)}}function $xe(t,e,r){return e&&Rxe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lxe(t,e,r){return e=vy(e),Vxe(t,g$()?Reflect.construct(e,r||[],vy(t).constructor):e.apply(t,r))}function Vxe(t,e){if(e&&(cd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fxe(t)}function Fxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g$(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(g$=function(){return!!t})()}function vy(t){return vy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vy(t)}function Bxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B1(t,e)}function B1(t,e){return B1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},B1(t,e)}function lk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function ck(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lk(Object(r),!0).forEach(function(n){l2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function l2(t,e,r){return e=y$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y$(t){var e=Uxe(t,"string");return cd(e)=="symbol"?e:e+""}function Uxe(t,e){if(cd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zxe(t,e){return Gxe(t)||Wxe(t,e)||Hxe(t,e)||qxe()}function qxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hxe(t,e){if(t){if(typeof t=="string")return uk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uk(t,e)}}function uk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Wxe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function Gxe(t){if(Array.isArray(t))return t}function U1(){return U1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},U1.apply(this,arguments)}var Kxe=function(e,r){var n;return ee.isValidElement(e)?n=ee.cloneElement(e,r):bt(e)?n=e(r):n=ee.createElement("line",U1({},r,{className:"recharts-reference-line-line"})),n},Qxe=function(e,r,n,s,i,o,l,c,u){var d=i.x,h=i.y,f=i.width,m=i.height;if(n){var y=u.y,g=e.y.apply(y,{position:o});if(oi(u,"discard")&&!e.y.isInRange(g))return null;var x=[{x:d+f,y:g},{x:d,y:g}];return c==="left"?x.reverse():x}if(r){var b=u.x,v=e.x.apply(b,{position:o});if(oi(u,"discard")&&!e.x.isInRange(v))return null;var j=[{x:v,y:h+m},{x:v,y:h}];return l==="top"?j.reverse():j}if(s){var S=u.segment,_=S.map(function(C){return e.apply(C,{position:o})});return oi(u,"discard")&&vye(_,function(C){return!e.isInRange(C)})?null:_}return null};function Yxe(t){var e=t.x,r=t.y,n=t.segment,s=t.xAxisId,i=t.yAxisId,o=t.shape,l=t.className,c=t.alwaysShow,u=Axe(),d=m$(s),h=p$(i),f=Oxe();if(!u||!f)return null;Ls(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=n2({x:d.scale,y:h.scale}),y=cn(e),g=cn(r),x=n&&n.length===2,b=Qxe(m,y,g,x,f,t.position,d.orientation,h.orientation,t);if(!b)return null;var v=zxe(b,2),j=v[0],S=j.x,_=j.y,C=v[1],N=C.x,w=C.y,E=oi(t,"hidden")?"url(#".concat(u,")"):void 0,k=ck(ck({clipPath:E},ft(t,!0)),{},{x1:S,y1:_,x2:N,y2:w});return ee.createElement(Ft,{className:At("recharts-reference-line",l)},Kxe(o,k),yn.renderCallByParent(t,oxe({x1:S,y1:_,x2:N,y2:w})))}var c2=function(t){function e(){return Mxe(this,e),Lxe(this,e,arguments)}return Bxe(e,t),$xe(e,[{key:"render",value:function(){return ee.createElement(Yxe,this.props)}}])}(ee.Component);l2(c2,"displayName","ReferenceLine");l2(c2,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function z1(){return z1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},z1.apply(this,arguments)}function ud(t){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ud(t)}function dk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function hk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dk(Object(r),!0).forEach(function(n){fv(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jxe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v$(n.key),n)}}function Zxe(t,e,r){return e&&Jxe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function eve(t,e,r){return e=by(e),tve(t,x$()?Reflect.construct(e,r||[],by(t).constructor):e.apply(t,r))}function tve(t,e){if(e&&(ud(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rve(t)}function rve(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x$(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(x$=function(){return!!t})()}function by(t){return by=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},by(t)}function nve(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&q1(t,e)}function q1(t,e){return q1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},q1(t,e)}function fv(t,e,r){return e=v$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v$(t){var e=ave(t,"string");return ud(e)=="symbol"?e:e+""}function ave(t,e){if(ud(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ud(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sve=function(e){var r=e.x,n=e.y,s=e.xAxis,i=e.yAxis,o=n2({x:s.scale,y:i.scale}),l=o.apply({x:r,y:n},{bandAware:!0});return oi(e,"discard")&&!o.isInRange(l)?null:l},mv=function(t){function e(){return Xxe(this,e),eve(this,e,arguments)}return nve(e,t),Zxe(e,[{key:"render",value:function(){var n=this.props,s=n.x,i=n.y,o=n.r,l=n.alwaysShow,c=n.clipPathId,u=cn(s),d=cn(i);if(Ls(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var h=sve(this.props);if(!h)return null;var f=h.x,m=h.y,y=this.props,g=y.shape,x=y.className,b=oi(this.props,"hidden")?"url(#".concat(c,")"):void 0,v=hk(hk({clipPath:b},ft(this.props,!0)),{},{cx:f,cy:m});return ee.createElement(Ft,{className:At("recharts-reference-dot",x)},e.renderDot(g,v),yn.renderCallByParent(this.props,{x:f-o,y:m-o,width:2*o,height:2*o}))}}])}(ee.Component);fv(mv,"displayName","ReferenceDot");fv(mv,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});fv(mv,"renderDot",function(t,e){var r;return ee.isValidElement(t)?r=ee.cloneElement(t,e):bt(t)?r=t(e):r=ee.createElement(sv,z1({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),r});function H1(){return H1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},H1.apply(this,arguments)}function dd(t){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dd(t)}function fk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function mk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fk(Object(r),!0).forEach(function(n){pv(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ive(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ove(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w$(n.key),n)}}function lve(t,e,r){return e&&ove(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function cve(t,e,r){return e=wy(e),uve(t,b$()?Reflect.construct(e,r||[],wy(t).constructor):e.apply(t,r))}function uve(t,e){if(e&&(dd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dve(t)}function dve(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b$(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(b$=function(){return!!t})()}function wy(t){return wy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wy(t)}function hve(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&W1(t,e)}function W1(t,e){return W1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},W1(t,e)}function pv(t,e,r){return e=w$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w$(t){var e=fve(t,"string");return dd(e)=="symbol"?e:e+""}function fve(t,e){if(dd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mve=function(e,r,n,s,i){var o=i.x1,l=i.x2,c=i.y1,u=i.y2,d=i.xAxis,h=i.yAxis;if(!d||!h)return null;var f=n2({x:d.scale,y:h.scale}),m={x:e?f.x.apply(o,{position:"start"}):f.x.rangeMin,y:n?f.y.apply(c,{position:"start"}):f.y.rangeMin},y={x:r?f.x.apply(l,{position:"end"}):f.x.rangeMax,y:s?f.y.apply(u,{position:"end"}):f.y.rangeMax};return oi(i,"discard")&&(!f.isInRange(m)||!f.isInRange(y))?null:o$(m,y)},gv=function(t){function e(){return ive(this,e),cve(this,e,arguments)}return hve(e,t),lve(e,[{key:"render",value:function(){var n=this.props,s=n.x1,i=n.x2,o=n.y1,l=n.y2,c=n.className,u=n.alwaysShow,d=n.clipPathId;Ls(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=cn(s),f=cn(i),m=cn(o),y=cn(l),g=this.props.shape;if(!h&&!f&&!m&&!y&&!g)return null;var x=mve(h,f,m,y,this.props);if(!x&&!g)return null;var b=oi(this.props,"hidden")?"url(#".concat(d,")"):void 0;return ee.createElement(Ft,{className:At("recharts-reference-area",c)},e.renderRect(g,mk(mk({clipPath:b},ft(this.props,!0)),x)),yn.renderCallByParent(this.props,x))}}])}(ee.Component);pv(gv,"displayName","ReferenceArea");pv(gv,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});pv(gv,"renderRect",function(t,e){var r;return ee.isValidElement(t)?r=ee.cloneElement(t,e):bt(t)?r=t(e):r=ee.createElement(r2,H1({},e,{className:"recharts-reference-area-rect"})),r});function j$(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],s=0;s<t.length;s+=e)n.push(t[s]);return n}function pve(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return cxe(n,r)}function gve(t,e,r){var n=r==="width",s=t.x,i=t.y,o=t.width,l=t.height;return e===1?{start:n?s:i,end:n?s+o:i+l}:{start:n?s+o:i+l,end:n?s:i}}function jy(t,e,r,n,s){if(t*e<t*n||t*e>t*s)return!1;var i=r();return t*(e-t*i/2-n)>=0&&t*(e+t*i/2-s)<=0}function yve(t,e){return j$(t,e+1)}function xve(t,e,r,n,s){for(var i=(n||[]).slice(),o=e.start,l=e.end,c=0,u=1,d=o,h=function(){var y=n==null?void 0:n[c];if(y===void 0)return{v:j$(n,u)};var g=c,x,b=function(){return x===void 0&&(x=r(y,g)),x},v=y.coordinate,j=c===0||jy(t,v,b,d,l);j||(c=0,d=o,u+=1),j&&(d=v+t*(b()/2+s),c+=u)},f;u<=i.length;)if(f=h(),f)return f.v;return[]}function vm(t){"@babel/helpers - typeof";return vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vm(t)}function pk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Hn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pk(Object(r),!0).forEach(function(n){vve(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vve(t,e,r){return e=bve(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bve(t){var e=wve(t,"string");return vm(e)=="symbol"?e:e+""}function wve(t,e){if(vm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jve(t,e,r,n,s){for(var i=(n||[]).slice(),o=i.length,l=e.start,c=e.end,u=function(f){var m=i[f],y,g=function(){return y===void 0&&(y=r(m,f)),y};if(f===o-1){var x=t*(m.coordinate+t*g()/2-c);i[f]=m=Hn(Hn({},m),{},{tickCoord:x>0?m.coordinate-x*t:m.coordinate})}else i[f]=m=Hn(Hn({},m),{},{tickCoord:m.coordinate});var b=jy(t,m.tickCoord,g,l,c);b&&(c=m.tickCoord-t*(g()/2+s),i[f]=Hn(Hn({},m),{},{isShow:!0}))},d=o-1;d>=0;d--)u(d);return i}function Nve(t,e,r,n,s,i){var o=(n||[]).slice(),l=o.length,c=e.start,u=e.end;if(i){var d=n[l-1],h=r(d,l-1),f=t*(d.coordinate+t*h/2-u);o[l-1]=d=Hn(Hn({},d),{},{tickCoord:f>0?d.coordinate-f*t:d.coordinate});var m=jy(t,d.tickCoord,function(){return h},c,u);m&&(u=d.tickCoord-t*(h/2+s),o[l-1]=Hn(Hn({},d),{},{isShow:!0}))}for(var y=i?l-1:l,g=function(v){var j=o[v],S,_=function(){return S===void 0&&(S=r(j,v)),S};if(v===0){var C=t*(j.coordinate-t*_()/2-c);o[v]=j=Hn(Hn({},j),{},{tickCoord:C<0?j.coordinate-C*t:j.coordinate})}else o[v]=j=Hn(Hn({},j),{},{tickCoord:j.coordinate});var N=jy(t,j.tickCoord,_,c,u);N&&(c=j.tickCoord+t*(_()/2+s),o[v]=Hn(Hn({},j),{},{isShow:!0}))},x=0;x<y;x++)g(x);return o}function u2(t,e,r){var n=t.tick,s=t.ticks,i=t.viewBox,o=t.minTickGap,l=t.orientation,c=t.interval,u=t.tickFormatter,d=t.unit,h=t.angle;if(!s||!s.length||!n)return[];if(Me(c)||si.isSsr)return yve(s,typeof c=="number"&&Me(c)?c:0);var f=[],m=l==="top"||l==="bottom"?"width":"height",y=d&&m==="width"?rf(d,{fontSize:e,letterSpacing:r}):{width:0,height:0},g=function(j,S){var _=bt(u)?u(j.value,S):j.value;return m==="width"?pve(rf(_,{fontSize:e,letterSpacing:r}),y,h):rf(_,{fontSize:e,letterSpacing:r})[m]},x=s.length>=2?sa(s[1].coordinate-s[0].coordinate):1,b=gve(i,x,m);return c==="equidistantPreserveStart"?xve(x,b,g,s,o):(c==="preserveStart"||c==="preserveStartEnd"?f=Nve(x,b,g,s,o,c==="preserveStartEnd"):f=jve(x,b,g,s,o),f.filter(function(v){return v.isShow}))}var _ve=["viewBox"],Sve=["viewBox"],Cve=["ticks"];function hd(t){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hd(t)}function iu(){return iu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},iu.apply(this,arguments)}function gk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function nn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gk(Object(r),!0).forEach(function(n){d2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ub(t,e){if(t==null)return{};var r=Eve(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Eve(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Pve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_$(n.key),n)}}function Tve(t,e,r){return e&&yk(t.prototype,e),r&&yk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ave(t,e,r){return e=Ny(e),Ive(t,N$()?Reflect.construct(e,r||[],Ny(t).constructor):e.apply(t,r))}function Ive(t,e){if(e&&(hd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kve(t)}function kve(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function N$(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(N$=function(){return!!t})()}function Ny(t){return Ny=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ny(t)}function Ove(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G1(t,e)}function G1(t,e){return G1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},G1(t,e)}function d2(t,e,r){return e=_$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _$(t){var e=Dve(t,"string");return hd(e)=="symbol"?e:e+""}function Dve(t,e){if(hd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Wd=function(t){function e(r){var n;return Pve(this,e),n=Ave(this,e,[r]),n.state={fontSize:"",letterSpacing:""},n}return Ove(e,t),Tve(e,[{key:"shouldComponentUpdate",value:function(n,s){var i=n.viewBox,o=Ub(n,_ve),l=this.props,c=l.viewBox,u=Ub(l,Sve);return!bu(i,c)||!bu(o,u)||!bu(s,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var s=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];s&&this.setState({fontSize:window.getComputedStyle(s).fontSize,letterSpacing:window.getComputedStyle(s).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var s=this.props,i=s.x,o=s.y,l=s.width,c=s.height,u=s.orientation,d=s.tickSize,h=s.mirror,f=s.tickMargin,m,y,g,x,b,v,j=h?-1:1,S=n.tickSize||d,_=Me(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":m=y=n.coordinate,x=o+ +!h*c,g=x-j*S,v=g-j*f,b=_;break;case"left":g=x=n.coordinate,y=i+ +!h*l,m=y-j*S,b=m-j*f,v=_;break;case"right":g=x=n.coordinate,y=i+ +h*l,m=y+j*S,b=m+j*f,v=_;break;default:m=y=n.coordinate,x=o+ +h*c,g=x+j*S,v=g+j*f,b=_;break}return{line:{x1:m,y1:g,x2:y,y2:x},tick:{x:b,y:v}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,s=n.orientation,i=n.mirror,o;switch(s){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,s=n.orientation,i=n.mirror,o="end";switch(s){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,s=n.x,i=n.y,o=n.width,l=n.height,c=n.orientation,u=n.mirror,d=n.axisLine,h=nn(nn(nn({},ft(this.props,!1)),ft(d,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var f=+(c==="top"&&!u||c==="bottom"&&u);h=nn(nn({},h),{},{x1:s,y1:i+f*l,x2:s+o,y2:i+f*l})}else{var m=+(c==="left"&&!u||c==="right"&&u);h=nn(nn({},h),{},{x1:s+m*o,y1:i,x2:s+m*o,y2:i+l})}return ee.createElement("line",iu({},h,{className:At("recharts-cartesian-axis-line",Fa(d,"className"))}))}},{key:"renderTicks",value:function(n,s,i){var o=this,l=this.props,c=l.tickLine,u=l.stroke,d=l.tick,h=l.tickFormatter,f=l.unit,m=u2(nn(nn({},this.props),{},{ticks:n}),s,i),y=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),x=ft(this.props,!1),b=ft(d,!1),v=nn(nn({},x),{},{fill:"none"},ft(c,!1)),j=m.map(function(S,_){var C=o.getTickLineCoord(S),N=C.line,w=C.tick,E=nn(nn(nn(nn({textAnchor:y,verticalAnchor:g},x),{},{stroke:"none",fill:u},b),w),{},{index:_,payload:S,visibleTicksCount:m.length,tickFormatter:h});return ee.createElement(Ft,iu({className:"recharts-cartesian-axis-tick",key:"tick-".concat(S.value,"-").concat(S.coordinate,"-").concat(S.tickCoord)},cc(o.props,S,_)),c&&ee.createElement("line",iu({},v,N,{className:At("recharts-cartesian-axis-tick-line",Fa(c,"className"))})),d&&e.renderTickItem(d,E,"".concat(bt(h)?h(S.value,_):S.value).concat(f||"")))});return ee.createElement("g",{className:"recharts-cartesian-axis-ticks"},j)}},{key:"render",value:function(){var n=this,s=this.props,i=s.axisLine,o=s.width,l=s.height,c=s.ticksGenerator,u=s.className,d=s.hide;if(d)return null;var h=this.props,f=h.ticks,m=Ub(h,Cve),y=f;return bt(c)&&(y=f&&f.length>0?c(this.props):c(m)),o<=0||l<=0||!y||!y.length?null:ee.createElement(Ft,{className:At("recharts-cartesian-axis",u),ref:function(x){n.layerReference=x}},i&&this.renderAxisLine(),this.renderTicks(y,this.state.fontSize,this.state.letterSpacing),yn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,s,i){var o,l=At(s.className,"recharts-cartesian-axis-tick-value");return ee.isValidElement(n)?o=ee.cloneElement(n,nn(nn({},s),{},{className:l})):bt(n)?o=n(nn(nn({},s),{},{className:l})):o=ee.createElement(uc,iu({},s,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(I.Component);d2(Wd,"displayName","CartesianAxis");d2(Wd,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Mve=["x1","y1","x2","y2","key"],Rve=["offset"];function fc(t){"@babel/helpers - typeof";return fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fc(t)}function xk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Qn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xk(Object(r),!0).forEach(function(n){$ve(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $ve(t,e,r){return e=Lve(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lve(t){var e=Vve(t,"string");return fc(e)=="symbol"?e:e+""}function Vve(t,e){if(fc(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $l(){return $l=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$l.apply(this,arguments)}function vk(t,e){if(t==null)return{};var r=Fve(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Fve(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var Bve=function(e){var r=e.fill;if(!r||r==="none")return null;var n=e.fillOpacity,s=e.x,i=e.y,o=e.width,l=e.height,c=e.ry;return ee.createElement("rect",{x:s,y:i,ry:c,width:o,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function S$(t,e){var r;if(ee.isValidElement(t))r=ee.cloneElement(t,e);else if(bt(t))r=t(e);else{var n=e.x1,s=e.y1,i=e.x2,o=e.y2,l=e.key,c=vk(e,Mve),u=ft(c,!1);u.offset;var d=vk(u,Rve);r=ee.createElement("line",$l({},d,{x1:n,y1:s,x2:i,y2:o,fill:"none",key:l}))}return r}function Uve(t){var e=t.x,r=t.width,n=t.horizontal,s=n===void 0?!0:n,i=t.horizontalPoints;if(!s||!i||!i.length)return null;var o=i.map(function(l,c){var u=Qn(Qn({},t),{},{x1:e,y1:l,x2:e+r,y2:l,key:"line-".concat(c),index:c});return S$(s,u)});return ee.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function zve(t){var e=t.y,r=t.height,n=t.vertical,s=n===void 0?!0:n,i=t.verticalPoints;if(!s||!i||!i.length)return null;var o=i.map(function(l,c){var u=Qn(Qn({},t),{},{x1:l,y1:e,x2:l,y2:e+r,key:"line-".concat(c),index:c});return S$(s,u)});return ee.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function qve(t){var e=t.horizontalFill,r=t.fillOpacity,n=t.x,s=t.y,i=t.width,o=t.height,l=t.horizontalPoints,c=t.horizontal,u=c===void 0?!0:c;if(!u||!e||!e.length)return null;var d=l.map(function(f){return Math.round(f+s-s)}).sort(function(f,m){return f-m});s!==d[0]&&d.unshift(0);var h=d.map(function(f,m){var y=!d[m+1],g=y?s+o-f:d[m+1]-f;if(g<=0)return null;var x=m%e.length;return ee.createElement("rect",{key:"react-".concat(m),y:f,x:n,height:g,width:i,stroke:"none",fill:e[x],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return ee.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function Hve(t){var e=t.vertical,r=e===void 0?!0:e,n=t.verticalFill,s=t.fillOpacity,i=t.x,o=t.y,l=t.width,c=t.height,u=t.verticalPoints;if(!r||!n||!n.length)return null;var d=u.map(function(f){return Math.round(f+i-i)}).sort(function(f,m){return f-m});i!==d[0]&&d.unshift(0);var h=d.map(function(f,m){var y=!d[m+1],g=y?i+l-f:d[m+1]-f;if(g<=0)return null;var x=m%n.length;return ee.createElement("rect",{key:"react-".concat(m),x:f,y:o,width:g,height:c,stroke:"none",fill:n[x],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return ee.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var Wve=function(e,r){var n=e.xAxis,s=e.width,i=e.height,o=e.offset;return w6(u2(Qn(Qn(Qn({},Wd.defaultProps),n),{},{ticks:Ii(n,!0),viewBox:{x:0,y:0,width:s,height:i}})),o.left,o.left+o.width,r)},Gve=function(e,r){var n=e.yAxis,s=e.width,i=e.height,o=e.offset;return w6(u2(Qn(Qn(Qn({},Wd.defaultProps),n),{},{ticks:Ii(n,!0),viewBox:{x:0,y:0,width:s,height:i}})),o.top,o.top+o.height,r)},Mc={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Vc(t){var e,r,n,s,i,o,l=i2(),c=o2(),u=Dxe(),d=Qn(Qn({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:Mc.stroke,fill:(r=t.fill)!==null&&r!==void 0?r:Mc.fill,horizontal:(n=t.horizontal)!==null&&n!==void 0?n:Mc.horizontal,horizontalFill:(s=t.horizontalFill)!==null&&s!==void 0?s:Mc.horizontalFill,vertical:(i=t.vertical)!==null&&i!==void 0?i:Mc.vertical,verticalFill:(o=t.verticalFill)!==null&&o!==void 0?o:Mc.verticalFill,x:Me(t.x)?t.x:u.left,y:Me(t.y)?t.y:u.top,width:Me(t.width)?t.width:u.width,height:Me(t.height)?t.height:u.height}),h=d.x,f=d.y,m=d.width,y=d.height,g=d.syncWithTicks,x=d.horizontalValues,b=d.verticalValues,v=Ixe(),j=kxe();if(!Me(m)||m<=0||!Me(y)||y<=0||!Me(h)||h!==+h||!Me(f)||f!==+f)return null;var S=d.verticalCoordinatesGenerator||Wve,_=d.horizontalCoordinatesGenerator||Gve,C=d.horizontalPoints,N=d.verticalPoints;if((!C||!C.length)&&bt(_)){var w=x&&x.length,E=_({yAxis:j?Qn(Qn({},j),{},{ticks:w?x:j.ticks}):void 0,width:l,height:c,offset:u},w?!0:g);Ls(Array.isArray(E),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(fc(E),"]")),Array.isArray(E)&&(C=E)}if((!N||!N.length)&&bt(S)){var k=b&&b.length,T=S({xAxis:v?Qn(Qn({},v),{},{ticks:k?b:v.ticks}):void 0,width:l,height:c,offset:u},k?!0:g);Ls(Array.isArray(T),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(fc(T),"]")),Array.isArray(T)&&(N=T)}return ee.createElement("g",{className:"recharts-cartesian-grid"},ee.createElement(Bve,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),ee.createElement(Uve,$l({},d,{offset:u,horizontalPoints:C,xAxis:v,yAxis:j})),ee.createElement(zve,$l({},d,{offset:u,verticalPoints:N,xAxis:v,yAxis:j})),ee.createElement(qve,$l({},d,{horizontalPoints:C})),ee.createElement(Hve,$l({},d,{verticalPoints:N})))}Vc.displayName="CartesianGrid";var Kve=["layout","type","stroke","connectNulls","isRange","ref"],Qve=["key"],C$;function fd(t){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fd(t)}function E$(t,e){if(t==null)return{};var r=Yve(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Yve(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Ll(){return Ll=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ll.apply(this,arguments)}function bk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function go(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bk(Object(r),!0).forEach(function(n){Xs(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T$(n.key),n)}}function Jve(t,e,r){return e&&wk(t.prototype,e),r&&wk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zve(t,e,r){return e=_y(e),ebe(t,P$()?Reflect.construct(e,r||[],_y(t).constructor):e.apply(t,r))}function ebe(t,e){if(e&&(fd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tbe(t)}function tbe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P$(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(P$=function(){return!!t})()}function _y(t){return _y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_y(t)}function rbe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&K1(t,e)}function K1(t,e){return K1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},K1(t,e)}function Xs(t,e,r){return e=T$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T$(t){var e=nbe(t,"string");return fd(e)=="symbol"?e:e+""}function nbe(t,e){if(fd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var li=function(t){function e(){var r;Xve(this,e);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return r=Zve(this,e,[].concat(s)),Xs(r,"state",{isAnimationFinished:!0}),Xs(r,"id",Vd("recharts-area-")),Xs(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),bt(o)&&o()}),Xs(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),bt(o)&&o()}),r}return rbe(e,t),Jve(e,[{key:"renderDots",value:function(n,s,i){var o=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(o&&!l)return null;var c=this.props,u=c.dot,d=c.points,h=c.dataKey,f=ft(this.props,!1),m=ft(u,!0),y=d.map(function(x,b){var v=go(go(go({key:"dot-".concat(b),r:3},f),m),{},{index:b,cx:x.x,cy:x.y,dataKey:h,value:x.value,payload:x.payload,points:d});return e.renderDotItem(u,v)}),g={clipPath:n?"url(#clipPath-".concat(s?"":"dots-").concat(i,")"):null};return ee.createElement(Ft,Ll({className:"recharts-area-dots"},g),y)}},{key:"renderHorizontalRect",value:function(n){var s=this.props,i=s.baseLine,o=s.points,l=s.strokeWidth,c=o[0].x,u=o[o.length-1].x,d=n*Math.abs(c-u),h=Io(o.map(function(f){return f.y||0}));return Me(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(Io(i.map(function(f){return f.y||0})),h)),Me(h)?ee.createElement("rect",{x:c<u?c:c-d,y:0,width:d,height:Math.floor(h+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var s=this.props,i=s.baseLine,o=s.points,l=s.strokeWidth,c=o[0].y,u=o[o.length-1].y,d=n*Math.abs(c-u),h=Io(o.map(function(f){return f.x||0}));return Me(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(Io(i.map(function(f){return f.x||0})),h)),Me(h)?ee.createElement("rect",{x:0,y:c<u?c:c-d,width:h+(l?parseInt("".concat(l),10):1),height:Math.floor(d)}):null}},{key:"renderClipRect",value:function(n){var s=this.props.layout;return s==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,s,i,o){var l=this.props,c=l.layout,u=l.type,d=l.stroke,h=l.connectNulls,f=l.isRange;l.ref;var m=E$(l,Kve);return ee.createElement(Ft,{clipPath:i?"url(#clipPath-".concat(o,")"):null},ee.createElement(_u,Ll({},ft(m,!0),{points:n,connectNulls:h,type:u,baseLine:s,layout:c,stroke:"none",className:"recharts-area-area"})),d!=="none"&&ee.createElement(_u,Ll({},ft(this.props,!1),{className:"recharts-area-curve",layout:c,type:u,connectNulls:h,fill:"none",points:n})),d!=="none"&&f&&ee.createElement(_u,Ll({},ft(this.props,!1),{className:"recharts-area-curve",layout:c,type:u,connectNulls:h,fill:"none",points:s})))}},{key:"renderAreaWithAnimation",value:function(n,s){var i=this,o=this.props,l=o.points,c=o.baseLine,u=o.isAnimationActive,d=o.animationBegin,h=o.animationDuration,f=o.animationEasing,m=o.animationId,y=this.state,g=y.prevPoints,x=y.prevBaseLine;return ee.createElement(di,{begin:d,duration:h,isActive:u,easing:f,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var v=b.t;if(g){var j=g.length/l.length,S=l.map(function(w,E){var k=Math.floor(E*j);if(g[k]){var T=g[k],P=xa(T.x,w.x),O=xa(T.y,w.y);return go(go({},w),{},{x:P(v),y:O(v)})}return w}),_;if(Me(c)&&typeof c=="number"){var C=xa(x,c);_=C(v)}else if(Pt(c)||Ld(c)){var N=xa(x,0);_=N(v)}else _=c.map(function(w,E){var k=Math.floor(E*j);if(x[k]){var T=x[k],P=xa(T.x,w.x),O=xa(T.y,w.y);return go(go({},w),{},{x:P(v),y:O(v)})}return w});return i.renderAreaStatically(S,_,n,s)}return ee.createElement(Ft,null,ee.createElement("defs",null,ee.createElement("clipPath",{id:"animationClipPath-".concat(s)},i.renderClipRect(v))),ee.createElement(Ft,{clipPath:"url(#animationClipPath-".concat(s,")")},i.renderAreaStatically(l,c,n,s)))})}},{key:"renderArea",value:function(n,s){var i=this.props,o=i.points,l=i.baseLine,c=i.isAnimationActive,u=this.state,d=u.prevPoints,h=u.prevBaseLine,f=u.totalLength;return c&&o&&o.length&&(!d&&f>0||!ed(d,o)||!ed(h,l))?this.renderAreaWithAnimation(n,s):this.renderAreaStatically(o,l,n,s)}},{key:"render",value:function(){var n,s=this.props,i=s.hide,o=s.dot,l=s.points,c=s.className,u=s.top,d=s.left,h=s.xAxis,f=s.yAxis,m=s.width,y=s.height,g=s.isAnimationActive,x=s.id;if(i||!l||!l.length)return null;var b=this.state.isAnimationFinished,v=l.length===1,j=At("recharts-area",c),S=h&&h.allowDataOverflow,_=f&&f.allowDataOverflow,C=S||_,N=Pt(x)?this.id:x,w=(n=ft(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},E=w.r,k=E===void 0?3:E,T=w.strokeWidth,P=T===void 0?2:T,O=AX(o)?o:{},D=O.clipDot,R=D===void 0?!0:D,B=k*2+P;return ee.createElement(Ft,{className:j},S||_?ee.createElement("defs",null,ee.createElement("clipPath",{id:"clipPath-".concat(N)},ee.createElement("rect",{x:S?d:d-m/2,y:_?u:u-y/2,width:S?m:m*2,height:_?y:y*2})),!R&&ee.createElement("clipPath",{id:"clipPath-dots-".concat(N)},ee.createElement("rect",{x:d-B/2,y:u-B/2,width:m+B,height:y+B}))):null,v?null:this.renderArea(C,N),(o||v)&&this.renderDots(C,R,N),(!g||b)&&Fi.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:s.curPoints,prevBaseLine:s.curBaseLine}:n.points!==s.curPoints||n.baseLine!==s.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(I.PureComponent);C$=li;Xs(li,"displayName","Area");Xs(li,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!si.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Xs(li,"getBaseValue",function(t,e,r,n){var s=t.layout,i=t.baseValue,o=e.props.baseValue,l=o??i;if(Me(l)&&typeof l=="number")return l;var c=s==="horizontal"?n:r,u=c.scale.domain();if(c.type==="number"){var d=Math.max(u[0],u[1]),h=Math.min(u[0],u[1]);return l==="dataMin"?h:l==="dataMax"||d<0?d:Math.max(Math.min(u[0],u[1]),0)}return l==="dataMin"?u[0]:l==="dataMax"?u[1]:u[0]});Xs(li,"getComposedData",function(t){var e=t.props,r=t.item,n=t.xAxis,s=t.yAxis,i=t.xAxisTicks,o=t.yAxisTicks,l=t.bandSize,c=t.dataKey,u=t.stackedData,d=t.dataStartIndex,h=t.displayedData,f=t.offset,m=e.layout,y=u&&u.length,g=C$.getBaseValue(e,r,n,s),x=m==="horizontal",b=!1,v=h.map(function(S,_){var C;y?C=u[d+_]:(C=on(S,c),Array.isArray(C)?b=!0:C=[g,C]);var N=C[1]==null||y&&on(S,c)==null;return x?{x:WA({axis:n,ticks:i,bandSize:l,entry:S,index:_}),y:N?null:s.scale(C[1]),value:C,payload:S}:{x:N?null:n.scale(C[1]),y:WA({axis:s,ticks:o,bandSize:l,entry:S,index:_}),value:C,payload:S}}),j;return y||b?j=v.map(function(S){var _=Array.isArray(S.value)?S.value[0]:null;return x?{x:S.x,y:_!=null&&S.y!=null?s.scale(_):null}:{x:_!=null?n.scale(_):null,y:S.y}}):j=x?s.scale(g):n.scale(g),go({points:v,baseLine:j,layout:m,isRange:b},f)});Xs(li,"renderDotItem",function(t,e){var r;if(ee.isValidElement(t))r=ee.cloneElement(t,e);else if(bt(t))r=t(e);else{var n=At("recharts-area-dot",typeof t!="boolean"?t.className:""),s=e.key,i=E$(e,Qve);r=ee.createElement(sv,Ll({},i,{key:s,className:n}))}return r});function md(t){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},md(t)}function abe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sbe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k$(n.key),n)}}function ibe(t,e,r){return e&&sbe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function obe(t,e,r){return e=Sy(e),lbe(t,A$()?Reflect.construct(e,r||[],Sy(t).constructor):e.apply(t,r))}function lbe(t,e){if(e&&(md(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cbe(t)}function cbe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A$(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(A$=function(){return!!t})()}function Sy(t){return Sy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sy(t)}function ube(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q1(t,e)}function Q1(t,e){return Q1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Q1(t,e)}function I$(t,e,r){return e=k$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k$(t){var e=dbe(t,"string");return md(e)=="symbol"?e:e+""}function dbe(t,e){if(md(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(md(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Y1(){return Y1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Y1.apply(this,arguments)}function hbe(t){var e=t.xAxisId,r=i2(),n=o2(),s=m$(e);return s==null?null:I.createElement(Wd,Y1({},s,{className:At("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return Ii(o,!0)}}))}var wi=function(t){function e(){return abe(this,e),obe(this,e,arguments)}return ube(e,t),ibe(e,[{key:"render",value:function(){return I.createElement(hbe,this.props)}}])}(I.Component);I$(wi,"displayName","XAxis");I$(wi,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function pd(t){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pd(t)}function fbe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mbe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,M$(n.key),n)}}function pbe(t,e,r){return e&&mbe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function gbe(t,e,r){return e=Cy(e),ybe(t,O$()?Reflect.construct(e,r||[],Cy(t).constructor):e.apply(t,r))}function ybe(t,e){if(e&&(pd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xbe(t)}function xbe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O$(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(O$=function(){return!!t})()}function Cy(t){return Cy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cy(t)}function vbe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X1(t,e)}function X1(t,e){return X1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},X1(t,e)}function D$(t,e,r){return e=M$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M$(t){var e=bbe(t,"string");return pd(e)=="symbol"?e:e+""}function bbe(t,e){if(pd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(pd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function J1(){return J1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},J1.apply(this,arguments)}var wbe=function(e){var r=e.yAxisId,n=i2(),s=o2(),i=p$(r);return i==null?null:I.createElement(Wd,J1({},i,{className:At("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:s},ticksGenerator:function(l){return Ii(l,!0)}}))},ji=function(t){function e(){return fbe(this,e),gbe(this,e,arguments)}return vbe(e,t),pbe(e,[{key:"render",value:function(){return I.createElement(wbe,this.props)}}])}(I.Component);D$(ji,"displayName","YAxis");D$(ji,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function jk(t){return Sbe(t)||_be(t)||Nbe(t)||jbe()}function jbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nbe(t,e){if(t){if(typeof t=="string")return Z1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z1(t,e)}}function _be(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Sbe(t){if(Array.isArray(t))return Z1(t)}function Z1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var eN=function(e,r,n,s,i){var o=hs(e,c2),l=hs(e,mv),c=[].concat(jk(o),jk(l)),u=hs(e,gv),d="".concat(s,"Id"),h=s[0],f=r;if(c.length&&(f=c.reduce(function(g,x){if(x.props[d]===n&&oi(x.props,"extendDomain")&&Me(x.props[h])){var b=x.props[h];return[Math.min(g[0],b),Math.max(g[1],b)]}return g},f)),u.length){var m="".concat(h,"1"),y="".concat(h,"2");f=u.reduce(function(g,x){if(x.props[d]===n&&oi(x.props,"extendDomain")&&Me(x.props[m])&&Me(x.props[y])){var b=x.props[m],v=x.props[y];return[Math.min(g[0],b,v),Math.max(g[1],b,v)]}return g},f)}return i&&i.length&&(f=i.reduce(function(g,x){return Me(x)?[Math.min(g[0],x),Math.max(g[1],x)]:g},f)),f},R$={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,h,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new s(d,h||c,f),y=r?r+u:u;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],m]:c._events[y].push(m):(c._events[y]=m,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)e.call(d,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,m=h.length,y=new Array(m);f<m;f++)y[f]=h[f].fn;return y},l.prototype.listenerCount=function(u){var d=r?r+u:u,h=this._events[d];return h?h.fn?1:h.length:0},l.prototype.emit=function(u,d,h,f,m,y){var g=r?r+u:u;if(!this._events[g])return!1;var x=this._events[g],b=arguments.length,v,j;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),b){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,d),!0;case 3:return x.fn.call(x.context,d,h),!0;case 4:return x.fn.call(x.context,d,h,f),!0;case 5:return x.fn.call(x.context,d,h,f,m),!0;case 6:return x.fn.call(x.context,d,h,f,m,y),!0}for(j=1,v=new Array(b-1);j<b;j++)v[j-1]=arguments[j];x.fn.apply(x.context,v)}else{var S=x.length,_;for(j=0;j<S;j++)switch(x[j].once&&this.removeListener(u,x[j].fn,void 0,!0),b){case 1:x[j].fn.call(x[j].context);break;case 2:x[j].fn.call(x[j].context,d);break;case 3:x[j].fn.call(x[j].context,d,h);break;case 4:x[j].fn.call(x[j].context,d,h,f);break;default:if(!v)for(_=1,v=new Array(b-1);_<b;_++)v[_-1]=arguments[_];x[j].fn.apply(x[j].context,v)}}return!0},l.prototype.on=function(u,d,h){return i(this,u,d,h,!1)},l.prototype.once=function(u,d,h){return i(this,u,d,h,!0)},l.prototype.removeListener=function(u,d,h,f){var m=r?r+u:u;if(!this._events[m])return this;if(!d)return o(this,m),this;var y=this._events[m];if(y.fn)y.fn===d&&(!f||y.once)&&(!h||y.context===h)&&o(this,m);else{for(var g=0,x=[],b=y.length;g<b;g++)(y[g].fn!==d||f&&!y[g].once||h&&y[g].context!==h)&&x.push(y[g]);x.length?this._events[m]=x.length===1?x[0]:x:o(this,m)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(R$);var Cbe=R$.exports;const Ebe=er(Cbe);var zb=new Ebe,qb="recharts.syncMouseEvents";function bm(t){"@babel/helpers - typeof";return bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bm(t)}function Pbe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tbe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$$(n.key),n)}}function Abe(t,e,r){return e&&Tbe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hb(t,e,r){return e=$$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $$(t){var e=Ibe(t,"string");return bm(e)=="symbol"?e:e+""}function Ibe(t,e){if(bm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(bm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var kbe=function(){function t(){Pbe(this,t),Hb(this,"activeIndex",0),Hb(this,"coordinateList",[]),Hb(this,"layout","horizontal")}return Abe(t,[{key:"setDetails",value:function(r){var n,s=r.coordinateList,i=s===void 0?null:s,o=r.container,l=o===void 0?null:o,c=r.layout,u=c===void 0?null:c,d=r.offset,h=d===void 0?null:d,f=r.mouseHandlerCallback,m=f===void 0?null:f;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=u??this.layout,this.offset=h??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var s=this.container.getBoundingClientRect(),i=s.x,o=s.y,l=s.height,c=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,h=i+c+u,f=o+this.offset.top+l/2+d;this.mouseHandlerCallback({pageX:h,pageY:f})}}}])}();function Obe(t,e,r){if(r==="number"&&e===!0&&Array.isArray(t)){var n=t==null?void 0:t[0],s=t==null?void 0:t[1];if(n&&s&&Me(n)&&Me(s))return!0}return!1}function Dbe(t,e,r,n){var s=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-s:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-s,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function L$(t){var e=t.cx,r=t.cy,n=t.radius,s=t.startAngle,i=t.endAngle,o=xr(e,r,n,s),l=xr(e,r,n,i);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:s,endAngle:i}}function Mbe(t,e,r){var n,s,i,o;if(t==="horizontal")n=e.x,i=n,s=r.top,o=r.top+r.height;else if(t==="vertical")s=e.y,o=s,n=r.left,i=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var l=e.cx,c=e.cy,u=e.innerRadius,d=e.outerRadius,h=e.angle,f=xr(l,c,u,h),m=xr(l,c,d,h);n=f.x,s=f.y,i=m.x,o=m.y}else return L$(e);return[{x:n,y:s},{x:i,y:o}]}function wm(t){"@babel/helpers - typeof";return wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wm(t)}function Nk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Zp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Nk(Object(r),!0).forEach(function(n){Rbe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Nk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Rbe(t,e,r){return e=$be(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $be(t){var e=Lbe(t,"string");return wm(e)=="symbol"?e:e+""}function Lbe(t,e){if(wm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vbe(t){var e,r,n=t.element,s=t.tooltipEventType,i=t.isActive,o=t.activeCoordinate,l=t.activePayload,c=t.offset,u=t.activeTooltipIndex,d=t.tooltipAxisBandSize,h=t.layout,f=t.chartName,m=(e=n.props.cursor)!==null&&e!==void 0?e:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!m||!i||!o||f!=="ScatterChart"&&s!=="axis")return null;var y,g=_u;if(f==="ScatterChart")y=o,g=oge;else if(f==="BarChart")y=Dbe(h,o,c,d),g=r2;else if(h==="radial"){var x=L$(o),b=x.cx,v=x.cy,j=x.radius,S=x.startAngle,_=x.endAngle;y={cx:b,cy:v,startAngle:S,endAngle:_,innerRadius:j,outerRadius:j},g=k6}else y={points:Mbe(h,o,c)},g=_u;var C=Zp(Zp(Zp(Zp({stroke:"#ccc",pointerEvents:"none"},c),y),ft(m,!1)),{},{payload:l,payloadIndex:u,className:At("recharts-tooltip-cursor",m.className)});return I.isValidElement(m)?I.cloneElement(m,C):I.createElement(g,C)}var Fbe=["item"],Bbe=["children","className","width","height","style","compact","title","desc"];function gd(t){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gd(t)}function ou(){return ou=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ou.apply(this,arguments)}function _k(t,e){return qbe(t)||zbe(t,e)||F$(t,e)||Ube()}function Ube(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zbe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function qbe(t){if(Array.isArray(t))return t}function Sk(t,e){if(t==null)return{};var r=Hbe(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Hbe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Wbe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gbe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B$(n.key),n)}}function Kbe(t,e,r){return e&&Gbe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qbe(t,e,r){return e=Ey(e),Ybe(t,V$()?Reflect.construct(e,r||[],Ey(t).constructor):e.apply(t,r))}function Ybe(t,e){if(e&&(gd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xbe(t)}function Xbe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function V$(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(V$=function(){return!!t})()}function Ey(t){return Ey=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ey(t)}function Jbe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tN(t,e)}function tN(t,e){return tN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},tN(t,e)}function yd(t){return twe(t)||ewe(t)||F$(t)||Zbe()}function Zbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F$(t,e){if(t){if(typeof t=="string")return rN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rN(t,e)}}function ewe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function twe(t){if(Array.isArray(t))return rN(t)}function rN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ck(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function ve(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ck(Object(r),!0).forEach(function(n){vt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ck(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vt(t,e,r){return e=B$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B$(t){var e=rwe(t,"string");return gd(e)=="symbol"?e:e+""}function rwe(t,e){if(gd(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nwe={xAxis:["bottom","top"],yAxis:["left","right"]},awe={width:"100%",height:"100%"},U$={x:0,y:0};function eg(t){return t}var swe=function(e,r){return r==="horizontal"?e.x:r==="vertical"?e.y:r==="centric"?e.angle:e.radius},iwe=function(e,r,n,s){var i=r.find(function(d){return d&&d.index===n});if(i){if(e==="horizontal")return{x:i.coordinate,y:s.y};if(e==="vertical")return{x:s.x,y:i.coordinate};if(e==="centric"){var o=i.coordinate,l=s.radius;return ve(ve(ve({},s),xr(s.cx,s.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,u=s.angle;return ve(ve(ve({},s),xr(s.cx,s.cy,c,u)),{},{angle:u,radius:c})}return U$},yv=function(e,r){var n=r.graphicalItems,s=r.dataStartIndex,i=r.dataEndIndex,o=(n??[]).reduce(function(l,c){var u=c.props.data;return u&&u.length?[].concat(yd(l),yd(u)):l},[]);return o.length>0?o:e&&e.length&&Me(s)&&Me(i)?e.slice(s,i+1):[]};function z$(t){return t==="number"?[0,"auto"]:void 0}var nN=function(e,r,n,s){var i=e.graphicalItems,o=e.tooltipAxis,l=yv(r,e);return n<0||!i||!i.length||n>=l.length?null:i.reduce(function(c,u){var d,h=(d=u.props.data)!==null&&d!==void 0?d:r;h&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(h=h.slice(e.dataStartIndex,e.dataEndIndex+1));var f;if(o.dataKey&&!o.allowDuplicatedCategory){var m=h===void 0?l:h;f=P0(m,o.dataKey,s)}else f=h&&h[n]||l[n];return f?[].concat(yd(c),[C6(u,f)]):c},[])},Ek=function(e,r,n,s){var i=s||{x:e.chartX,y:e.chartY},o=swe(i,n),l=e.orderedTooltipTicks,c=e.tooltipAxis,u=e.tooltipTicks,d=Ihe(o,l,u,c);if(d>=0&&u){var h=u[d]&&u[d].value,f=nN(e,r,d,h),m=iwe(n,l,d,i);return{activeTooltipIndex:d,activeLabel:h,activePayload:f,activeCoordinate:m}}return null},owe=function(e,r){var n=r.axes,s=r.graphicalItems,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=e.layout,h=e.children,f=e.stackOffset,m=b6(d,i);return n.reduce(function(y,g){var x,b=g.type.defaultProps!==void 0?ve(ve({},g.type.defaultProps),g.props):g.props,v=b.type,j=b.dataKey,S=b.allowDataOverflow,_=b.allowDuplicatedCategory,C=b.scale,N=b.ticks,w=b.includeHidden,E=b[o];if(y[E])return y;var k=yv(e.data,{graphicalItems:s.filter(function(K){var q,ie=o in K.props?K.props[o]:(q=K.type.defaultProps)===null||q===void 0?void 0:q[o];return ie===E}),dataStartIndex:c,dataEndIndex:u}),T=k.length,P,O,D;Obe(b.domain,S,v)&&(P=x1(b.domain,null,S),m&&(v==="number"||C!=="auto")&&(D=af(k,j,"category")));var R=z$(v);if(!P||P.length===0){var B,Y=(B=b.domain)!==null&&B!==void 0?B:R;if(j){if(P=af(k,j,v),v==="category"&&m){var W=bX(P);_&&W?(O=P,P=my(0,T)):_||(P=YA(Y,P,g).reduce(function(K,q){return K.indexOf(q)>=0?K:[].concat(yd(K),[q])},[]))}else if(v==="category")_?P=P.filter(function(K){return K!==""&&!Pt(K)}):P=YA(Y,P,g).reduce(function(K,q){return K.indexOf(q)>=0||q===""||Pt(q)?K:[].concat(yd(K),[q])},[]);else if(v==="number"){var L=Rhe(k,s.filter(function(K){var q,ie,ge=o in K.props?K.props[o]:(q=K.type.defaultProps)===null||q===void 0?void 0:q[o],be="hide"in K.props?K.props.hide:(ie=K.type.defaultProps)===null||ie===void 0?void 0:ie.hide;return ge===E&&(w||!be)}),j,i,d);L&&(P=L)}m&&(v==="number"||C!=="auto")&&(D=af(k,j,"category"))}else m?P=my(0,T):l&&l[E]&&l[E].hasStack&&v==="number"?P=f==="expand"?[0,1]:S6(l[E].stackGroups,c,u):P=v6(k,s.filter(function(K){var q=o in K.props?K.props[o]:K.type.defaultProps[o],ie="hide"in K.props?K.props.hide:K.type.defaultProps.hide;return q===E&&(w||!ie)}),v,d,!0);if(v==="number")P=eN(h,P,E,i,N),Y&&(P=x1(Y,P,S));else if(v==="category"&&Y){var X=Y,G=P.every(function(K){return X.indexOf(K)>=0});G&&(P=X)}}return ve(ve({},y),{},vt({},E,ve(ve({},b),{},{axisType:i,domain:P,categoricalDomain:D,duplicateDomain:O,originalDomain:(x=b.domain)!==null&&x!==void 0?x:R,isCategorical:m,layout:d})))},{})},lwe=function(e,r){var n=r.graphicalItems,s=r.Axis,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=e.layout,h=e.children,f=yv(e.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),m=f.length,y=b6(d,i),g=-1;return n.reduce(function(x,b){var v=b.type.defaultProps!==void 0?ve(ve({},b.type.defaultProps),b.props):b.props,j=v[o],S=z$("number");if(!x[j]){g++;var _;return y?_=my(0,m):l&&l[j]&&l[j].hasStack?(_=S6(l[j].stackGroups,c,u),_=eN(h,_,j,i)):(_=x1(S,v6(f,n.filter(function(C){var N,w,E=o in C.props?C.props[o]:(N=C.type.defaultProps)===null||N===void 0?void 0:N[o],k="hide"in C.props?C.props.hide:(w=C.type.defaultProps)===null||w===void 0?void 0:w.hide;return E===j&&!k}),"number",d),s.defaultProps.allowDataOverflow),_=eN(h,_,j,i)),ve(ve({},x),{},vt({},j,ve(ve({axisType:i},s.defaultProps),{},{hide:!0,orientation:Fa(nwe,"".concat(i,".").concat(g%2),null),domain:_,originalDomain:S,isCategorical:y,layout:d})))}return x},{})},cwe=function(e,r){var n=r.axisType,s=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=e.children,h="".concat(s,"Id"),f=hs(d,i),m={};return f&&f.length?m=owe(e,{axes:f,graphicalItems:o,axisType:s,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:u}):o&&o.length&&(m=lwe(e,{Axis:i,graphicalItems:o,axisType:s,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:u})),m},uwe=function(e){var r=Co(e),n=Ii(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:TS(n,function(s){return s.coordinate}),tooltipAxis:r,tooltipAxisBandSize:ry(r,n)}},Pk=function(e){var r=e.children,n=e.defaultShowTooltip,s=ka(r,od),i=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),s&&s.props&&(s.props.startIndex>=0&&(i=s.props.startIndex),s.props.endIndex>=0&&(o=s.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},dwe=function(e){return!e||!e.length?!1:e.some(function(r){var n=Li(r&&r.type);return n&&n.indexOf("Bar")>=0})},Tk=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},hwe=function(e,r){var n=e.props,s=e.graphicalItems,i=e.xAxisMap,o=i===void 0?{}:i,l=e.yAxisMap,c=l===void 0?{}:l,u=n.width,d=n.height,h=n.children,f=n.margin||{},m=ka(h,od),y=ka(h,wu),g=Object.keys(c).reduce(function(_,C){var N=c[C],w=N.orientation;return!N.mirror&&!N.hide?ve(ve({},_),{},vt({},w,_[w]+N.width)):_},{left:f.left||0,right:f.right||0}),x=Object.keys(o).reduce(function(_,C){var N=o[C],w=N.orientation;return!N.mirror&&!N.hide?ve(ve({},_),{},vt({},w,Fa(_,"".concat(w))+N.height)):_},{top:f.top||0,bottom:f.bottom||0}),b=ve(ve({},x),g),v=b.bottom;m&&(b.bottom+=m.props.height||od.defaultProps.height),y&&r&&(b=Dhe(b,s,n,r));var j=u-b.left-b.right,S=d-b.top-b.bottom;return ve(ve({brushBottom:v},b),{},{width:Math.max(j,0),height:Math.max(S,0)})},fwe=function(e,r){if(r==="xAxis")return e[r].width;if(r==="yAxis")return e[r].height},h2=function(e){var r=e.chartName,n=e.GraphicalChild,s=e.defaultTooltipEventType,i=s===void 0?"axis":s,o=e.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=e.axisComponents,u=e.legendContent,d=e.formatAxisMap,h=e.defaultProps,f=function(b,v){var j=v.graphicalItems,S=v.stackGroups,_=v.offset,C=v.updateId,N=v.dataStartIndex,w=v.dataEndIndex,E=b.barSize,k=b.layout,T=b.barGap,P=b.barCategoryGap,O=b.maxBarSize,D=Tk(k),R=D.numericAxisName,B=D.cateAxisName,Y=dwe(j),W=[];return j.forEach(function(L,X){var G=yv(b.data,{graphicalItems:[L],dataStartIndex:N,dataEndIndex:w}),K=L.type.defaultProps!==void 0?ve(ve({},L.type.defaultProps),L.props):L.props,q=K.dataKey,ie=K.maxBarSize,ge=K["".concat(R,"Id")],be=K["".concat(B,"Id")],Ye={},ze=c.reduce(function(Ce,ke){var ue=v["".concat(ke.axisType,"Map")],se=K["".concat(ke.axisType,"Id")];ue&&ue[se]||ke.axisType==="zAxis"||hc();var We=ue[se];return ve(ve({},Ce),{},vt(vt({},ke.axisType,We),"".concat(ke.axisType,"Ticks"),Ii(We)))},Ye),U=ze[B],Q=ze["".concat(B,"Ticks")],re=S&&S[ge]&&S[ge].hasStack&&Hhe(L,S[ge].stackGroups),te=Li(L.type).indexOf("Bar")>=0,pe=ry(U,Q),xe=[],he=Y&&khe({barSize:E,stackGroups:S,totalSize:fwe(ze,B)});if(te){var Le,qe,De=Pt(ie)?O:ie,ne=(Le=(qe=ry(U,Q,!0))!==null&&qe!==void 0?qe:De)!==null&&Le!==void 0?Le:0;xe=Ohe({barGap:T,barCategoryGap:P,bandSize:ne!==pe?ne:pe,sizeList:he[be],maxBarSize:De}),ne!==pe&&(xe=xe.map(function(Ce){return ve(ve({},Ce),{},{position:ve(ve({},Ce.position),{},{offset:Ce.position.offset-ne/2})})}))}var oe=L&&L.type&&L.type.getComposedData;oe&&W.push({props:ve(ve({},oe(ve(ve({},ze),{},{displayedData:G,props:b,dataKey:q,item:L,bandSize:pe,barPosition:xe,offset:_,stackedData:re,layout:k,dataStartIndex:N,dataEndIndex:w}))),{},vt(vt(vt({key:L.key||"item-".concat(X)},R,ze[R]),B,ze[B]),"animationId",C)),childIndex:OX(L,b.children),item:L})}),W},m=function(b,v){var j=b.props,S=b.dataStartIndex,_=b.dataEndIndex,C=b.updateId;if(!zP({props:j}))return null;var N=j.children,w=j.layout,E=j.stackOffset,k=j.data,T=j.reverseStackOrder,P=Tk(w),O=P.numericAxisName,D=P.cateAxisName,R=hs(N,n),B=zhe(k,R,"".concat(O,"Id"),"".concat(D,"Id"),E,T),Y=c.reduce(function(K,q){var ie="".concat(q.axisType,"Map");return ve(ve({},K),{},vt({},ie,cwe(j,ve(ve({},q),{},{graphicalItems:R,stackGroups:q.axisType===O&&B,dataStartIndex:S,dataEndIndex:_}))))},{}),W=hwe(ve(ve({},Y),{},{props:j,graphicalItems:R}),v==null?void 0:v.legendBBox);Object.keys(Y).forEach(function(K){Y[K]=d(j,Y[K],W,K.replace("Map",""),r)});var L=Y["".concat(D,"Map")],X=uwe(L),G=f(j,ve(ve({},Y),{},{dataStartIndex:S,dataEndIndex:_,updateId:C,graphicalItems:R,stackGroups:B,offset:W}));return ve(ve({formattedGraphicalItems:G,graphicalItems:R,offset:W,stackGroups:B},X),Y)},y=function(x){function b(v){var j,S,_;return Wbe(this,b),_=Qbe(this,b,[v]),vt(_,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),vt(_,"accessibilityManager",new kbe),vt(_,"handleLegendBBoxUpdate",function(C){if(C){var N=_.state,w=N.dataStartIndex,E=N.dataEndIndex,k=N.updateId;_.setState(ve({legendBBox:C},m({props:_.props,dataStartIndex:w,dataEndIndex:E,updateId:k},ve(ve({},_.state),{},{legendBBox:C}))))}}),vt(_,"handleReceiveSyncEvent",function(C,N,w){if(_.props.syncId===C){if(w===_.eventEmitterSymbol&&typeof _.props.syncMethod!="function")return;_.applySyncEvent(N)}}),vt(_,"handleBrushChange",function(C){var N=C.startIndex,w=C.endIndex;if(N!==_.state.dataStartIndex||w!==_.state.dataEndIndex){var E=_.state.updateId;_.setState(function(){return ve({dataStartIndex:N,dataEndIndex:w},m({props:_.props,dataStartIndex:N,dataEndIndex:w,updateId:E},_.state))}),_.triggerSyncEvent({dataStartIndex:N,dataEndIndex:w})}}),vt(_,"handleMouseEnter",function(C){var N=_.getMouseInfo(C);if(N){var w=ve(ve({},N),{},{isTooltipActive:!0});_.setState(w),_.triggerSyncEvent(w);var E=_.props.onMouseEnter;bt(E)&&E(w,C)}}),vt(_,"triggeredAfterMouseMove",function(C){var N=_.getMouseInfo(C),w=N?ve(ve({},N),{},{isTooltipActive:!0}):{isTooltipActive:!1};_.setState(w),_.triggerSyncEvent(w);var E=_.props.onMouseMove;bt(E)&&E(w,C)}),vt(_,"handleItemMouseEnter",function(C){_.setState(function(){return{isTooltipActive:!0,activeItem:C,activePayload:C.tooltipPayload,activeCoordinate:C.tooltipPosition||{x:C.cx,y:C.cy}}})}),vt(_,"handleItemMouseLeave",function(){_.setState(function(){return{isTooltipActive:!1}})}),vt(_,"handleMouseMove",function(C){C.persist(),_.throttleTriggeredAfterMouseMove(C)}),vt(_,"handleMouseLeave",function(C){_.throttleTriggeredAfterMouseMove.cancel();var N={isTooltipActive:!1};_.setState(N),_.triggerSyncEvent(N);var w=_.props.onMouseLeave;bt(w)&&w(N,C)}),vt(_,"handleOuterEvent",function(C){var N=kX(C),w=Fa(_.props,"".concat(N));if(N&&bt(w)){var E,k;/.*touch.*/i.test(N)?k=_.getMouseInfo(C.changedTouches[0]):k=_.getMouseInfo(C),w((E=k)!==null&&E!==void 0?E:{},C)}}),vt(_,"handleClick",function(C){var N=_.getMouseInfo(C);if(N){var w=ve(ve({},N),{},{isTooltipActive:!0});_.setState(w),_.triggerSyncEvent(w);var E=_.props.onClick;bt(E)&&E(w,C)}}),vt(_,"handleMouseDown",function(C){var N=_.props.onMouseDown;if(bt(N)){var w=_.getMouseInfo(C);N(w,C)}}),vt(_,"handleMouseUp",function(C){var N=_.props.onMouseUp;if(bt(N)){var w=_.getMouseInfo(C);N(w,C)}}),vt(_,"handleTouchMove",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.throttleTriggeredAfterMouseMove(C.changedTouches[0])}),vt(_,"handleTouchStart",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.handleMouseDown(C.changedTouches[0])}),vt(_,"handleTouchEnd",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.handleMouseUp(C.changedTouches[0])}),vt(_,"handleDoubleClick",function(C){var N=_.props.onDoubleClick;if(bt(N)){var w=_.getMouseInfo(C);N(w,C)}}),vt(_,"handleContextMenu",function(C){var N=_.props.onContextMenu;if(bt(N)){var w=_.getMouseInfo(C);N(w,C)}}),vt(_,"triggerSyncEvent",function(C){_.props.syncId!==void 0&&zb.emit(qb,_.props.syncId,C,_.eventEmitterSymbol)}),vt(_,"applySyncEvent",function(C){var N=_.props,w=N.layout,E=N.syncMethod,k=_.state.updateId,T=C.dataStartIndex,P=C.dataEndIndex;if(C.dataStartIndex!==void 0||C.dataEndIndex!==void 0)_.setState(ve({dataStartIndex:T,dataEndIndex:P},m({props:_.props,dataStartIndex:T,dataEndIndex:P,updateId:k},_.state)));else if(C.activeTooltipIndex!==void 0){var O=C.chartX,D=C.chartY,R=C.activeTooltipIndex,B=_.state,Y=B.offset,W=B.tooltipTicks;if(!Y)return;if(typeof E=="function")R=E(W,C);else if(E==="value"){R=-1;for(var L=0;L<W.length;L++)if(W[L].value===C.activeLabel){R=L;break}}var X=ve(ve({},Y),{},{x:Y.left,y:Y.top}),G=Math.min(O,X.x+X.width),K=Math.min(D,X.y+X.height),q=W[R]&&W[R].value,ie=nN(_.state,_.props.data,R),ge=W[R]?{x:w==="horizontal"?W[R].coordinate:G,y:w==="horizontal"?K:W[R].coordinate}:U$;_.setState(ve(ve({},C),{},{activeLabel:q,activeCoordinate:ge,activePayload:ie,activeTooltipIndex:R}))}else _.setState(C)}),vt(_,"renderCursor",function(C){var N,w=_.state,E=w.isTooltipActive,k=w.activeCoordinate,T=w.activePayload,P=w.offset,O=w.activeTooltipIndex,D=w.tooltipAxisBandSize,R=_.getTooltipEventType(),B=(N=C.props.active)!==null&&N!==void 0?N:E,Y=_.props.layout,W=C.key||"_recharts-cursor";return ee.createElement(Vbe,{key:W,activeCoordinate:k,activePayload:T,activeTooltipIndex:O,chartName:r,element:C,isActive:B,layout:Y,offset:P,tooltipAxisBandSize:D,tooltipEventType:R})}),vt(_,"renderPolarAxis",function(C,N,w){var E=Fa(C,"type.axisType"),k=Fa(_.state,"".concat(E,"Map")),T=C.type.defaultProps,P=T!==void 0?ve(ve({},T),C.props):C.props,O=k&&k[P["".concat(E,"Id")]];return I.cloneElement(C,ve(ve({},O),{},{className:At(E,O.className),key:C.key||"".concat(N,"-").concat(w),ticks:Ii(O,!0)}))}),vt(_,"renderPolarGrid",function(C){var N=C.props,w=N.radialLines,E=N.polarAngles,k=N.polarRadius,T=_.state,P=T.radiusAxisMap,O=T.angleAxisMap,D=Co(P),R=Co(O),B=R.cx,Y=R.cy,W=R.innerRadius,L=R.outerRadius;return I.cloneElement(C,{polarAngles:Array.isArray(E)?E:Ii(R,!0).map(function(X){return X.coordinate}),polarRadius:Array.isArray(k)?k:Ii(D,!0).map(function(X){return X.coordinate}),cx:B,cy:Y,innerRadius:W,outerRadius:L,key:C.key||"polar-grid",radialLines:w})}),vt(_,"renderLegend",function(){var C=_.state.formattedGraphicalItems,N=_.props,w=N.children,E=N.width,k=N.height,T=_.props.margin||{},P=E-(T.left||0)-(T.right||0),O=y6({children:w,formattedGraphicalItems:C,legendWidth:P,legendContent:u});if(!O)return null;var D=O.item,R=Sk(O,Fbe);return I.cloneElement(D,ve(ve({},R),{},{chartWidth:E,chartHeight:k,margin:T,onBBoxUpdate:_.handleLegendBBoxUpdate}))}),vt(_,"renderTooltip",function(){var C,N=_.props,w=N.children,E=N.accessibilityLayer,k=ka(w,Dn);if(!k)return null;var T=_.state,P=T.isTooltipActive,O=T.activeCoordinate,D=T.activePayload,R=T.activeLabel,B=T.offset,Y=(C=k.props.active)!==null&&C!==void 0?C:P;return I.cloneElement(k,{viewBox:ve(ve({},B),{},{x:B.left,y:B.top}),active:Y,label:R,payload:Y?D:[],coordinate:O,accessibilityLayer:E})}),vt(_,"renderBrush",function(C){var N=_.props,w=N.margin,E=N.data,k=_.state,T=k.offset,P=k.dataStartIndex,O=k.dataEndIndex,D=k.updateId;return I.cloneElement(C,{key:C.key||"_recharts-brush",onChange:Qp(_.handleBrushChange,C.props.onChange),data:E,x:Me(C.props.x)?C.props.x:T.left,y:Me(C.props.y)?C.props.y:T.top+T.height+T.brushBottom-(w.bottom||0),width:Me(C.props.width)?C.props.width:T.width,startIndex:P,endIndex:O,updateId:"brush-".concat(D)})}),vt(_,"renderReferenceElement",function(C,N,w){if(!C)return null;var E=_,k=E.clipPathId,T=_.state,P=T.xAxisMap,O=T.yAxisMap,D=T.offset,R=C.type.defaultProps||{},B=C.props,Y=B.xAxisId,W=Y===void 0?R.xAxisId:Y,L=B.yAxisId,X=L===void 0?R.yAxisId:L;return I.cloneElement(C,{key:C.key||"".concat(N,"-").concat(w),xAxis:P[W],yAxis:O[X],viewBox:{x:D.left,y:D.top,width:D.width,height:D.height},clipPathId:k})}),vt(_,"renderActivePoints",function(C){var N=C.item,w=C.activePoint,E=C.basePoint,k=C.childIndex,T=C.isRange,P=[],O=N.props.key,D=N.item.type.defaultProps!==void 0?ve(ve({},N.item.type.defaultProps),N.item.props):N.item.props,R=D.activeDot,B=D.dataKey,Y=ve(ve({index:k,dataKey:B,cx:w.x,cy:w.y,r:4,fill:t2(N.item),strokeWidth:2,stroke:"#fff",payload:w.payload,value:w.value},ft(R,!1)),T0(R));return P.push(b.renderActiveDot(R,Y,"".concat(O,"-activePoint-").concat(k))),E?P.push(b.renderActiveDot(R,ve(ve({},Y),{},{cx:E.x,cy:E.y}),"".concat(O,"-basePoint-").concat(k))):T&&P.push(null),P}),vt(_,"renderGraphicChild",function(C,N,w){var E=_.filterFormatItem(C,N,w);if(!E)return null;var k=_.getTooltipEventType(),T=_.state,P=T.isTooltipActive,O=T.tooltipAxis,D=T.activeTooltipIndex,R=T.activeLabel,B=_.props.children,Y=ka(B,Dn),W=E.props,L=W.points,X=W.isRange,G=W.baseLine,K=E.item.type.defaultProps!==void 0?ve(ve({},E.item.type.defaultProps),E.item.props):E.item.props,q=K.activeDot,ie=K.hide,ge=K.activeBar,be=K.activeShape,Ye=!!(!ie&&P&&Y&&(q||ge||be)),ze={};k!=="axis"&&Y&&Y.props.trigger==="click"?ze={onClick:Qp(_.handleItemMouseEnter,C.props.onClick)}:k!=="axis"&&(ze={onMouseLeave:Qp(_.handleItemMouseLeave,C.props.onMouseLeave),onMouseEnter:Qp(_.handleItemMouseEnter,C.props.onMouseEnter)});var U=I.cloneElement(C,ve(ve({},E.props),ze));function Q(ke){return typeof O.dataKey=="function"?O.dataKey(ke.payload):null}if(Ye)if(D>=0){var re,te;if(O.dataKey&&!O.allowDuplicatedCategory){var pe=typeof O.dataKey=="function"?Q:"payload.".concat(O.dataKey.toString());re=P0(L,pe,R),te=X&&G&&P0(G,pe,R)}else re=L==null?void 0:L[D],te=X&&G&&G[D];if(be||ge){var xe=C.props.activeIndex!==void 0?C.props.activeIndex:D;return[I.cloneElement(C,ve(ve(ve({},E.props),ze),{},{activeIndex:xe})),null,null]}if(!Pt(re))return[U].concat(yd(_.renderActivePoints({item:E,activePoint:re,basePoint:te,childIndex:D,isRange:X})))}else{var he,Le=(he=_.getItemByXY(_.state.activeCoordinate))!==null&&he!==void 0?he:{graphicalItem:U},qe=Le.graphicalItem,De=qe.item,ne=De===void 0?C:De,oe=qe.childIndex,Ce=ve(ve(ve({},E.props),ze),{},{activeIndex:oe});return[I.cloneElement(ne,Ce),null,null]}return X?[U,null,null]:[U,null]}),vt(_,"renderCustomized",function(C,N,w){return I.cloneElement(C,ve(ve({key:"recharts-customized-".concat(w)},_.props),_.state))}),vt(_,"renderMap",{CartesianGrid:{handler:eg,once:!0},ReferenceArea:{handler:_.renderReferenceElement},ReferenceLine:{handler:eg},ReferenceDot:{handler:_.renderReferenceElement},XAxis:{handler:eg},YAxis:{handler:eg},Brush:{handler:_.renderBrush,once:!0},Bar:{handler:_.renderGraphicChild},Line:{handler:_.renderGraphicChild},Area:{handler:_.renderGraphicChild},Radar:{handler:_.renderGraphicChild},RadialBar:{handler:_.renderGraphicChild},Scatter:{handler:_.renderGraphicChild},Pie:{handler:_.renderGraphicChild},Funnel:{handler:_.renderGraphicChild},Tooltip:{handler:_.renderCursor,once:!0},PolarGrid:{handler:_.renderPolarGrid,once:!0},PolarAngleAxis:{handler:_.renderPolarAxis},PolarRadiusAxis:{handler:_.renderPolarAxis},Customized:{handler:_.renderCustomized}}),_.clipPathId="".concat((j=v.id)!==null&&j!==void 0?j:Vd("recharts"),"-clip"),_.throttleTriggeredAfterMouseMove=g4(_.triggeredAfterMouseMove,(S=v.throttleDelay)!==null&&S!==void 0?S:1e3/60),_.state={},_}return Jbe(b,x),Kbe(b,[{key:"componentDidMount",value:function(){var j,S;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(j=this.props.margin.left)!==null&&j!==void 0?j:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var j=this.props,S=j.children,_=j.data,C=j.height,N=j.layout,w=ka(S,Dn);if(w){var E=w.props.defaultIndex;if(!(typeof E!="number"||E<0||E>this.state.tooltipTicks.length-1)){var k=this.state.tooltipTicks[E]&&this.state.tooltipTicks[E].value,T=nN(this.state,_,E,k),P=this.state.tooltipTicks[E].coordinate,O=(this.state.offset.top+C)/2,D=N==="horizontal",R=D?{x:P,y:O}:{y:P,x:O},B=this.state.formattedGraphicalItems.find(function(W){var L=W.item;return L.type.name==="Scatter"});B&&(R=ve(ve({},R),B.props.points[E].tooltipPosition),T=B.props.points[E].tooltipPayload);var Y={activeTooltipIndex:E,isTooltipActive:!0,activeLabel:k,activePayload:T,activeCoordinate:R};this.setState(Y),this.renderCursor(w),this.accessibilityManager.setIndex(E)}}}},{key:"getSnapshotBeforeUpdate",value:function(j,S){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==S.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==j.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==j.margin){var _,C;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0}})}return null}},{key:"componentDidUpdate",value:function(j){Oj([ka(j.children,Dn)],[ka(this.props.children,Dn)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var j=ka(this.props.children,Dn);if(j&&typeof j.props.shared=="boolean"){var S=j.props.shared?"axis":"item";return l.indexOf(S)>=0?S:i}return i}},{key:"getMouseInfo",value:function(j){if(!this.container)return null;var S=this.container,_=S.getBoundingClientRect(),C=sle(_),N={chartX:Math.round(j.pageX-C.left),chartY:Math.round(j.pageY-C.top)},w=_.width/S.offsetWidth||1,E=this.inRange(N.chartX,N.chartY,w);if(!E)return null;var k=this.state,T=k.xAxisMap,P=k.yAxisMap,O=this.getTooltipEventType(),D=Ek(this.state,this.props.data,this.props.layout,E);if(O!=="axis"&&T&&P){var R=Co(T).scale,B=Co(P).scale,Y=R&&R.invert?R.invert(N.chartX):null,W=B&&B.invert?B.invert(N.chartY):null;return ve(ve({},N),{},{xValue:Y,yValue:W},D)}return D?ve(ve({},N),D):null}},{key:"inRange",value:function(j,S){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=this.props.layout,N=j/_,w=S/_;if(C==="horizontal"||C==="vertical"){var E=this.state.offset,k=N>=E.left&&N<=E.left+E.width&&w>=E.top&&w<=E.top+E.height;return k?{x:N,y:w}:null}var T=this.state,P=T.angleAxisMap,O=T.radiusAxisMap;if(P&&O){var D=Co(P);return ZA({x:N,y:w},D)}return null}},{key:"parseEventsOfWrapper",value:function(){var j=this.props.children,S=this.getTooltipEventType(),_=ka(j,Dn),C={};_&&S==="axis"&&(_.props.trigger==="click"?C={onClick:this.handleClick}:C={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var N=T0(this.props,this.handleOuterEvent);return ve(ve({},N),C)}},{key:"addListener",value:function(){zb.on(qb,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){zb.removeListener(qb,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(j,S,_){for(var C=this.state.formattedGraphicalItems,N=0,w=C.length;N<w;N++){var E=C[N];if(E.item===j||E.props.key===j.key||S===Li(E.item.type)&&_===E.childIndex)return E}return null}},{key:"renderClipPath",value:function(){var j=this.clipPathId,S=this.state.offset,_=S.left,C=S.top,N=S.height,w=S.width;return ee.createElement("defs",null,ee.createElement("clipPath",{id:j},ee.createElement("rect",{x:_,y:C,height:N,width:w})))}},{key:"getXScales",value:function(){var j=this.state.xAxisMap;return j?Object.entries(j).reduce(function(S,_){var C=_k(_,2),N=C[0],w=C[1];return ve(ve({},S),{},vt({},N,w.scale))},{}):null}},{key:"getYScales",value:function(){var j=this.state.yAxisMap;return j?Object.entries(j).reduce(function(S,_){var C=_k(_,2),N=C[0],w=C[1];return ve(ve({},S),{},vt({},N,w.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(j){var S;return(S=this.state.xAxisMap)===null||S===void 0||(S=S[j])===null||S===void 0?void 0:S.scale}},{key:"getYScaleByAxisId",value:function(j){var S;return(S=this.state.yAxisMap)===null||S===void 0||(S=S[j])===null||S===void 0?void 0:S.scale}},{key:"getItemByXY",value:function(j){var S=this.state,_=S.formattedGraphicalItems,C=S.activeItem;if(_&&_.length)for(var N=0,w=_.length;N<w;N++){var E=_[N],k=E.props,T=E.item,P=T.type.defaultProps!==void 0?ve(ve({},T.type.defaultProps),T.props):T.props,O=Li(T.type);if(O==="Bar"){var D=(k.data||[]).find(function(W){return Bpe(j,W)});if(D)return{graphicalItem:E,payload:D}}else if(O==="RadialBar"){var R=(k.data||[]).find(function(W){return ZA(j,W)});if(R)return{graphicalItem:E,payload:R}}else if(uv(E,C)||dv(E,C)||pm(E,C)){var B=T0e({graphicalItem:E,activeTooltipItem:C,itemData:P.data}),Y=P.activeIndex===void 0?B:P.activeIndex;return{graphicalItem:ve(ve({},E),{},{childIndex:Y}),payload:pm(E,C)?P.data[B]:E.props.data[B]}}}return null}},{key:"render",value:function(){var j=this;if(!zP(this))return null;var S=this.props,_=S.children,C=S.className,N=S.width,w=S.height,E=S.style,k=S.compact,T=S.title,P=S.desc,O=Sk(S,Bbe),D=ft(O,!1);if(k)return ee.createElement(ok,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ee.createElement(Mj,ou({},D,{width:N,height:w,title:T,desc:P}),this.renderClipPath(),HP(_,this.renderMap)));if(this.props.accessibilityLayer){var R,B;D.tabIndex=(R=this.props.tabIndex)!==null&&R!==void 0?R:0,D.role=(B=this.props.role)!==null&&B!==void 0?B:"application",D.onKeyDown=function(W){j.accessibilityManager.keyboardEvent(W)},D.onFocus=function(){j.accessibilityManager.focus()}}var Y=this.parseEventsOfWrapper();return ee.createElement(ok,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ee.createElement("div",ou({className:At("recharts-wrapper",C),style:ve({position:"relative",cursor:"default",width:N,height:w},E)},Y,{ref:function(L){j.container=L}}),ee.createElement(Mj,ou({},D,{width:N,height:w,title:T,desc:P,style:awe}),this.renderClipPath(),HP(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(I.Component);vt(y,"displayName",r),vt(y,"defaultProps",ve({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),vt(y,"getDerivedStateFromProps",function(x,b){var v=x.dataKey,j=x.data,S=x.children,_=x.width,C=x.height,N=x.layout,w=x.stackOffset,E=x.margin,k=b.dataStartIndex,T=b.dataEndIndex;if(b.updateId===void 0){var P=Pk(x);return ve(ve(ve({},P),{},{updateId:0},m(ve(ve({props:x},P),{},{updateId:0}),b)),{},{prevDataKey:v,prevData:j,prevWidth:_,prevHeight:C,prevLayout:N,prevStackOffset:w,prevMargin:E,prevChildren:S})}if(v!==b.prevDataKey||j!==b.prevData||_!==b.prevWidth||C!==b.prevHeight||N!==b.prevLayout||w!==b.prevStackOffset||!bu(E,b.prevMargin)){var O=Pk(x),D={chartX:b.chartX,chartY:b.chartY,isTooltipActive:b.isTooltipActive},R=ve(ve({},Ek(b,j,N)),{},{updateId:b.updateId+1}),B=ve(ve(ve({},O),D),R);return ve(ve(ve({},B),m(ve({props:x},B),b)),{},{prevDataKey:v,prevData:j,prevWidth:_,prevHeight:C,prevLayout:N,prevStackOffset:w,prevMargin:E,prevChildren:S})}if(!Oj(S,b.prevChildren)){var Y,W,L,X,G=ka(S,od),K=G&&(Y=(W=G.props)===null||W===void 0?void 0:W.startIndex)!==null&&Y!==void 0?Y:k,q=G&&(L=(X=G.props)===null||X===void 0?void 0:X.endIndex)!==null&&L!==void 0?L:T,ie=K!==k||q!==T,ge=!Pt(j),be=ge&&!ie?b.updateId:b.updateId+1;return ve(ve({updateId:be},m(ve(ve({props:x},b),{},{updateId:be,dataStartIndex:K,dataEndIndex:q}),b)),{},{prevChildren:S,dataStartIndex:K,dataEndIndex:q})}return null}),vt(y,"renderActiveDot",function(x,b,v){var j;return I.isValidElement(x)?j=I.cloneElement(x,b):bt(x)?j=x(b):j=ee.createElement(sv,b),ee.createElement(Ft,{className:"recharts-active-dot",key:v},j)});var g=I.forwardRef(function(b,v){return ee.createElement(y,ou({},b,{ref:v}))});return g.displayName=y.displayName,g},tg=h2({chartName:"BarChart",GraphicalChild:Ms,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:wi},{axisType:"yAxis",AxisComp:ji}],formatAxisMap:i$}),Wb=h2({chartName:"PieChart",GraphicalChild:Vs,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:cv},{axisType:"radiusAxis",AxisComp:ov}],formatAxisMap:tfe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),mwe=h2({chartName:"AreaChart",GraphicalChild:li,axisComponents:[{axisType:"xAxis",AxisComp:wi},{axisType:"yAxis",AxisComp:ji}],formatAxisMap:i$});function pwe(){const t=Xt(ro),[e,r]=ee.useState("custom"),[n,s]=ee.useState(()=>({startDate:(()=>{const D=new Date;return D.setDate(1),D.toISOString().slice(0,10)})(),endDate:new Date().toISOString().slice(0,10)})),{totalSales:i,totalProfit:o,totalCost:l,totalDiscounts:c,averageTransaction:u,profitMargin:d,transactionCount:h,loading:f,error:m,refetch:y,filteredSales:g,periodComparison:x}=YM({dateFilter:e,customDateRange:n}),[b,v]=ee.useState(!1),j=(D,R)=>{let B={...n,[D]:R};if(B.startDate&&B.endDate){const Y=new Date(B.startDate);if((new Date(B.endDate).getTime()-Y.getTime())/(1e3*60*60*24)>62){v(!0);return}}s(B)},S=ee.useMemo(()=>{if(!g)return t.map(R=>({name:R.name.length>15?R.name.substring(0,15)+"...":R.name,fullName:R.name,reference:R.referencia||"",stock:R.stock,sold:0})).filter(R=>R.stock>0).sort((R,B)=>B.stock-R.stock).slice(0,8);const D={};return g.forEach(R=>{R.items&&Array.isArray(R.items)&&R.items.forEach(B=>{const Y=B.productName||B.name||"",W=B.quantity||1;D[Y]=(D[Y]||0)+W})}),t.map(R=>({name:R.name.length>15?R.name.substring(0,15)+"...":R.name,fullName:R.name,reference:R.referencia||"",stock:R.stock,sold:D[R.name]||0})).filter(R=>R.stock>0).sort((R,B)=>{const Y=R.stock/Math.max(R.sold,1);return B.stock/Math.max(B.sold,1)-Y}).slice(0,8)},[t,g]),_=ee.useMemo(()=>{if(!g||g.length===0)return[];const D={};return g.forEach(R=>{R.items&&Array.isArray(R.items)&&R.items.forEach(B=>{const Y=B.productName||B.name||"Producto Desconocido",W=B.quantity||1;D[Y]||(D[Y]={name:Y.length>15?Y.substring(0,15)+"...":Y,fullName:Y,sold:0}),D[Y].sold+=W})}),Object.values(D).filter(R=>R.sold>0).sort((R,B)=>B.sold-R.sold).slice(0,8)},[g]),C=ee.useMemo(()=>{const D={};return t.forEach(R=>{const B=R.category;D[B]||(D[B]={name:B,products:0,inventoryValue:0,potentialRevenue:0,potentialProfit:0}),D[B].products+=1,D[B].inventoryValue+=R.stock*R.purchasePrice,D[B].potentialRevenue+=R.stock*R.salePrice,D[B].potentialProfit+=R.stock*(R.salePrice-R.purchasePrice)}),Object.values(D)},[t]),N=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#F97316"],w=ee.useMemo(()=>{const D=Array.from({length:24},(R,B)=>({hour:B,count:0}));return!g||g.length===0||g.forEach(R=>{if(R.createdAt){let B;if(typeof R.createdAt=="object"&&R.createdAt!==null&&"seconds"in R.createdAt?B=new Date(R.createdAt.seconds*1e3):B=new Date(R.createdAt),!isNaN(B.getTime())){const Y=B.getHours();D[Y].count++}}}),D},[g]),E=ee.useMemo(()=>{if(!g||g.length===0)return[];const D={};return g.forEach(R=>{if(R.paymentMethods&&Array.isArray(R.paymentMethods))R.paymentMethods.forEach(B=>{const Y=B.method||"Desconocido";D[Y]||(D[Y]={value:0,count:0,profit:0}),D[Y].value+=B.amount||0,D[Y].count+=1;const W=(R.totalProfit||0)*((B.amount||0)/(R.total||1));D[Y].profit+=W});else{const B=R.paymentMethod||"Efectivo";D[B]||(D[B]={value:0,count:0,profit:0}),D[B].value+=R.total||0,D[B].count+=1,D[B].profit+=R.totalProfit||0}}),Object.entries(D).map(([R,B])=>({name:R,value:Math.round(B.value),count:B.count,profit:Math.round(B.profit)})).filter(R=>R.value>0)},[g]),k=ee.useMemo(()=>{if(!g||g.length===0)return[];const D={};return g.forEach(R=>{if(R.customerId&&R.customerName){const B=R.customerId;D[B]||(D[B]={name:R.customerName,totalPurchases:0,totalProfit:0,transactionCount:0,customerId:R.customerId}),D[B].totalPurchases+=R.total||0,D[B].totalProfit+=R.totalProfit||0,D[B].transactionCount+=1}}),Object.values(D).filter(R=>R.totalPurchases>0).sort((R,B)=>B.totalPurchases-R.totalPurchases).slice(0,8)},[g]),T=ee.useMemo(()=>{if(!g||g.length===0)return[];const D={};return g.forEach(R=>{if(R.createdAt){let B;if(typeof R.createdAt=="object"&&R.createdAt!==null&&"seconds"in R.createdAt?B=new Date(R.createdAt.seconds*1e3):B=new Date(R.createdAt),!isNaN(B.getTime())){const Y=B.toLocaleDateString("es-ES",{month:"short",day:"numeric"});D[Y]||(D[Y]={revenue:0,cost:0,profit:0,transactions:0}),D[Y].revenue+=R.total||0,D[Y].cost+=R.totalCost||0,D[Y].profit+=R.totalProfit||0,D[Y].transactions+=1}}}),Object.entries(D).map(([R,B])=>({date:R,...B})).sort((R,B)=>{const Y=new Date(R.date+", "+new Date().getFullYear()),W=new Date(B.date+", "+new Date().getFullYear());return Y.getTime()-W.getTime()})},[g]),P=ee.useMemo(()=>{if(!g||g.length===0)return{};const D={};return g.forEach(R=>{if(R.createdAt){let B;if(typeof R.createdAt=="object"&&R.createdAt!==null&&"seconds"in R.createdAt?B=new Date(R.createdAt.seconds*1e3):B=new Date(R.createdAt),!isNaN(B.getTime())){const Y=B.toISOString().slice(0,10);D[Y]||(D[Y]={revenue:0,cost:0,profit:0,transactions:0}),D[Y].revenue+=R.total||0,D[Y].cost+=R.totalCost||0,D[Y].profit+=R.totalProfit||0,D[Y].transactions+=1}}}),D},[g]),O=ee.useMemo(()=>{if(!x)return[];const D=x.growth.salesGrowth,R=x.growth.profitGrowth;return[{metric:"Ventas Totales",current:x.current.totalSales,previous:x.previous.totalSales,growth:D,unit:"$",description:D>=0?"Vend ms que antes":"Vend menos que antes",icon:D>=0?"":""},{metric:"Ganancias",current:x.current.totalProfit,previous:x.previous.totalProfit,growth:R,unit:"$",description:R>=0?"Gan ms que antes":"Gan menos que antes",icon:R>=0?"":""}]},[x]);return a.jsxs(a.Fragment,{children:[b&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-sm text-center border border-gray-200",children:[a.jsx("h2",{className:"text-lg font-semibold text-red-600 mb-2",children:"Rango de fechas invlido"}),a.jsx("p",{className:"text-gray-700 mb-4",children:"El rango mximo permitido es de 2 meses (62 das)."}),a.jsx("button",{className:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded",onClick:()=>v(!1),children:"Cerrar"})]})}),a.jsxs("div",{className:"space-y-6 overflow-visible",children:[a.jsx("div",{className:"mb-4 pt-4",children:a.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reportes y Anlisis Financiero"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Anlisis detallado de rentabilidad y rendimiento de tu tienda"})]})})}),a.jsxs("div",{className:"flex flex-wrap gap-4 items-center mb-2",children:[a.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Desde:",a.jsx("input",{type:"date",className:"ml-2 border rounded px-2 py-1",value:n.startDate,max:n.endDate,onChange:D=>j("startDate",D.target.value)})]}),a.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Hasta:",a.jsx("input",{type:"date",className:"ml-2 border rounded px-2 py-1",value:n.endDate,min:n.startDate,max:new Date().toISOString().slice(0,10),onChange:D=>j("endDate",D.target.value)})]}),a.jsx("span",{className:"text-xs text-gray-500",children:"(Mximo 2 meses)"})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-emerald-500/10 hover:-translate-y-0.5 hover:border-emerald-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-emerald-50 rounded flex items-center justify-center group-hover:bg-emerald-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(Wt,{className:"w-3 h-3 text-emerald-600 group-hover:text-emerald-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Ingresos Totales"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-emerald-900 transition-colors duration-300",children:V(i)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-red-500/10 hover:-translate-y-0.5 hover:border-red-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-red-50 rounded flex items-center justify-center group-hover:bg-red-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ga,{className:"w-3 h-3 text-red-600 group-hover:text-red-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Costos Totales"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-red-900 transition-colors duration-300",children:V(l)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-green-500/10 hover:-translate-y-0.5 hover:border-green-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-green-50 rounded flex items-center justify-center group-hover:bg-green-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(ds,{className:"w-3 h-3 text-green-600 group-hover:text-green-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Ganancia Total"}),a.jsx("p",{className:"text-base font-bold text-slate-900 group-hover:text-green-900 transition-colors duration-300",children:V(o)})]})}),a.jsx("div",{className:"group relative bg-white rounded-lg shadow-lg border border-gray-300 p-2 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-0.5 hover:border-blue-300 transition-all duration-300 ease-out",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-5 h-5 mx-auto mb-1 bg-blue-50 rounded flex items-center justify-center group-hover:bg-blue-100 group-hover:scale-110 transition-all duration-300",children:a.jsx(qM,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"})}),a.jsx("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide mb-0.5 group-hover:text-slate-700 transition-colors duration-300",children:"Margen Promedio"}),a.jsxs("p",{className:"text-base font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:[d.toFixed(1),"%"]})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 md:p-6 shadow-sm border border-gray-100",children:[a.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 flex items-center flex-wrap",children:[a.jsx(SP,{className:"h-5 w-5 mr-2 text-blue-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:"Anlisis de Ventas del Perodo"})]}),a.jsx("p",{className:"text-xs text-gray-500 mb-2 ml-7",children:"Ventas reales agrupadas por da en el perodo seleccionado."}),T.length>0?a.jsx(po,{width:"100%",height:300,children:a.jsxs(mwe,{data:T,children:[a.jsx(Vc,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(wi,{dataKey:"date",tick:{fontSize:12},stroke:"#6b7280"}),a.jsx(ji,{tick:{fontSize:12},stroke:"#6b7280",tickFormatter:D=>V(D)}),a.jsx(Dn,{formatter:(D,R)=>[R==="transactions"?D:V(D),R==="revenue"?"Ingresos":R==="cost"?"Costos":R==="profit"?"Ganancia":"Transacciones"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),a.jsx(li,{type:"monotone",dataKey:"revenue",stackId:"1",stroke:"#3B82F6",fill:"#3B82F6",fillOpacity:.6}),a.jsx(li,{type:"monotone",dataKey:"cost",stackId:"2",stroke:"#EF4444",fill:"#EF4444",fillOpacity:.6}),a.jsx(li,{type:"monotone",dataKey:"profit",stackId:"3",stroke:"#10B981",fill:"#10B981",fillOpacity:.8})]})}):a.jsx("div",{className:"h-300 flex items-center justify-center text-gray-500",children:a.jsxs("div",{className:"text-center",children:[a.jsx(SP,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No hay datos de ventas disponibles"})]})})]}),x&&a.jsxs("div",{className:"bg-white rounded-xl p-4 md:p-6 shadow-sm border border-gray-100",children:[a.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 flex items-center flex-wrap",children:[a.jsx(ds,{className:"h-5 w-5 mr-2 text-green-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:"Cmo voy este mes?"})]}),a.jsx("p",{className:"text-xs text-gray-500 mb-4 ml-7",children:"Comparacin del mes actual vs el mes anterior - Estoy mejorando?"}),O.length>0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:O.map(D=>a.jsxs("div",{className:`rounded-xl p-6 border-2 ${D.growth>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("span",{className:"text-2xl mr-3",children:D.icon}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold text-gray-800",children:D.metric}),a.jsx("p",{className:`text-sm font-medium ${D.growth>=0?"text-green-700":"text-red-700"}`,children:D.description})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"bg-white rounded-lg p-3",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Este mes:"}),a.jsx("span",{className:"text-lg font-bold text-blue-600",children:V(D.current)})]})}),a.jsx("div",{className:"bg-white rounded-lg p-3",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Mes anterior:"}),a.jsx("span",{className:"text-lg font-semibold text-gray-700",children:V(D.previous)})]})}),a.jsxs("div",{className:"text-center pt-2",children:[a.jsxs("span",{className:`text-xl font-bold ${D.growth>=0?"text-green-600":"text-red-600"}`,children:[D.growth>=0?"+":"",D.growth.toFixed(1),"%"]}),a.jsx("div",{className:"text-xs text-gray-600 mt-1",children:D.growth>=0?"de crecimiento":"de disminucin"})]})]})]},D.metric))}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"text-center text-lg font-semibold text-gray-700 mb-4",children:"Resumen Visual"}),a.jsx(po,{width:"100%",height:250,children:a.jsxs(tg,{data:O,margin:{top:20,right:30,left:20,bottom:5},children:[a.jsx(Vc,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),a.jsx(wi,{dataKey:"metric",tick:{fontSize:14,fontWeight:"bold"},stroke:"#374151"}),a.jsx(ji,{tick:{fontSize:12},stroke:"#6b7280",tickFormatter:D=>V(D)}),a.jsx(Dn,{formatter:(D,R)=>{const B=R==="current"?"Este mes":"Mes anterior";return[V(D),B]},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),a.jsx(Ms,{dataKey:"current",fill:"#10B981",name:"current",radius:[4,4,0,0]}),a.jsx(Ms,{dataKey:"previous",fill:"#9CA3AF",name:"previous",radius:[4,4,0,0]})]})})]})]}):a.jsx("div",{className:"h-300 flex items-center justify-center text-gray-500",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ds,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No hay datos suficientes para comparar perodos"})]})})]}),a.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-2 gap-4 md:gap-6 overflow-visible",children:[a.jsxs("div",{className:"bg-white rounded-xl p-2 sm:p-4 md:p-6 shadow-sm border border-gray-100 w-full min-w-0 overflow-visible relative",children:[a.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 flex items-center flex-wrap",children:[a.jsx(_l,{className:"h-5 w-5 mr-2 text-blue-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:"Productos Ms Vendidos (proporcin)"})]}),_.length>0?a.jsx("div",{className:"w-full h-64 sm:h-72 md:h-80 relative z-10",children:a.jsx(po,{width:"100%",height:"100%",children:a.jsxs(Wb,{children:[a.jsx(Vs,{data:_,dataKey:"sold",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:!1,labelLine:!1,children:_.map((D,R)=>a.jsx(Eo,{fill:N[R%N.length]},`cell-${R}`))}),a.jsx(Dn,{formatter:(D,R)=>[`${sr(D)} unidades`,R],contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}})]})})}):a.jsx("div",{className:"h-300 flex items-center justify-center text-gray-500",children:a.jsxs("div",{className:"text-center",children:[a.jsx(_l,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No hay datos de ventas disponibles"})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-2 sm:p-4 md:p-6 shadow-sm border border-gray-100 w-full min-w-0 overflow-visible relative",children:[a.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 flex items-center flex-wrap",children:[a.jsx(_l,{className:"h-5 w-5 mr-2 text-purple-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:"Rentabilidad por Categora del Inventario Actual"})]}),C.length>0?a.jsx(po,{width:"100%",height:300,children:a.jsxs(Wb,{children:[a.jsx(Vs,{data:C,cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",dataKey:"potentialProfit",label:({name:D,percent:R})=>`${D} ${(R*100).toFixed(0)}%`,labelLine:!1,children:C.map((D,R)=>a.jsx(Eo,{fill:N[R%N.length]},`cell-${R}`))}),a.jsx(Dn,{formatter:D=>[V(D),"Ganancia Potencial"],contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}})]})}):a.jsx("div",{className:"h-300 flex items-center justify-center text-gray-500",children:a.jsxs("div",{className:"text-center",children:[a.jsx(_l,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No hay productos disponibles"})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 md:p-6 shadow-sm border border-gray-100 w-full min-w-0",children:[a.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 flex items-center flex-wrap",children:[a.jsx(_l,{className:"h-5 w-5 mr-2 text-orange-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:"Ganancia por Mtodo de Pago"})]}),E.length>0?a.jsx(po,{width:"100%",height:300,children:a.jsxs(Wb,{children:[a.jsx(Vs,{data:E,cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",dataKey:"profit",label:({name:D,percent:R})=>`${D} ${(R*100).toFixed(0)}%`,labelLine:!1,children:E.map((D,R)=>a.jsx(Eo,{fill:N[R%N.length]},`cell-${R}`))}),a.jsx(Dn,{formatter:D=>[V(D),"Ganancia"],contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}})]})}):a.jsx("div",{className:"h-300 flex items-center justify-center text-gray-500",children:a.jsxs("div",{className:"text-center",children:[a.jsx(_l,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No hay datos de pago disponibles"})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 md:p-6 shadow-sm border border-gray-100 mt-6 w-full col-span-2",children:[a.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 flex items-center flex-wrap",children:[a.jsx(ga,{className:"h-5 w-5 mr-2 text-[#90c5e7] flex-shrink-0"}),a.jsx("span",{className:"break-words",children:"Productos con Mayor Inventario Inmovilizado"})]}),a.jsx("p",{className:"text-xs text-gray-500 mb-2 ml-7",children:"Productos con mucho stock y pocas ventas en el periodo seleccionado. Solo se muestran los 8 principales."}),S.length>0?a.jsx(po,{width:"100%",height:600,children:a.jsxs(tg,{data:[...S].sort((D,R)=>R.stock-D.stock),layout:"horizontal",reverseStackOrder:!0,children:[a.jsx(Vc,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(wi,{dataKey:"name",type:"category",tick:({x:D,y:R,payload:B})=>{const Y=S[B.index],W=(Y==null?void 0:Y.fullName)||"",L=(Y==null?void 0:Y.reference)||"";if(!W)return a.jsx("g",{});let X=[];return W.length>22?X=W.match(/.{1,22}/g)||[W]:X=[W],L&&X.push(`Ref: ${L}`),a.jsx("g",{children:X.map((G,K)=>a.jsx("text",{x:D,y:R+10+K*15,fontSize:13,fill:K===X.length-1&&L?"#6366F1":"#374151",textAnchor:"middle",children:G},K))})},stroke:"#6b7280",interval:0,angle:0,height:110,label:{value:"Producto",position:"insideBottom",offset:-5}}),a.jsx(ji,{dataKey:"stock",type:"number",tick:{fontSize:12},stroke:"#6b7280",label:{value:"Stock",angle:-90,position:"insideLeft",offset:0},allowDecimals:!1}),a.jsx(Dn,{formatter:(D,R,B)=>{const Y=S[B.payload.index],W=(Y==null?void 0:Y.fullName)||"",L=(Y==null?void 0:Y.reference)||"";return[`${D} unidades`,L?`${W} (Ref: ${L})`:W]}}),a.jsx(Ms,{dataKey:"stock",fill:"#EC4899",radius:[4,4,0,0],children:S.map((D,R)=>a.jsx(Eo,{fill:N[R%N.length]},`cell-${R}`))})]})}):a.jsx("div",{className:"h-300 flex items-center justify-center text-gray-500",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ga,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No hay productos inmovilizados"})]})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 md:p-6 shadow-sm border border-gray-100 mt-6",children:[a.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 flex items-center flex-wrap",children:[a.jsx(ga,{className:"h-5 w-5 mr-2 text-indigo-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:"Ventas por Intervalo Horario"})]}),a.jsx("p",{className:"text-xs text-gray-500 mb-2 ml-7",children:"Distribucin real de ventas por hora del da en el perodo seleccionado."}),a.jsx(po,{width:"100%",height:400,children:a.jsxs(tg,{data:w,layout:"horizontal",children:[a.jsx(Vc,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(wi,{dataKey:"hour",type:"category",tick:{fontSize:12},stroke:"#6b7280",interval:0,angle:0,height:40,label:{value:"Hora",position:"insideBottom",offset:-5}}),a.jsx(ji,{dataKey:"count",type:"number",tick:{fontSize:12},stroke:"#6b7280",label:{value:"Ventas",angle:-90,position:"insideLeft",offset:0},allowDecimals:!1}),a.jsx(Dn,{formatter:D=>`${D} ventas`,labelFormatter:D=>`${D}:00`}),a.jsx(Ms,{dataKey:"count",fill:"#6366F1",radius:[4,4,0,0]})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 md:p-6 shadow-sm border border-gray-100",children:[a.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 flex items-center flex-wrap",children:[a.jsx(ga,{className:"h-5 w-5 mr-2 text-emerald-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:"Top 8 Clientes que Ms Compraron"})]}),a.jsx("p",{className:"text-xs text-gray-500 mb-4 ml-7",children:"Clientes con mayor monto total de compras en el perodo seleccionado"}),k.length>0?a.jsxs(a.Fragment,{children:[a.jsx(po,{width:"100%",height:400,children:a.jsxs(tg,{data:k,children:[a.jsx(Vc,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(wi,{dataKey:"name",tick:{fontSize:12},stroke:"#6b7280",angle:-45,textAnchor:"end",height:80,interval:0}),a.jsx(ji,{tick:{fontSize:12},stroke:"#6b7280",tickFormatter:D=>V(D)}),a.jsx(Dn,{formatter:(D,R)=>R==="totalPurchases"?[V(D),"Total Compras"]:R==="totalProfit"?[V(D),"Ganancia Generada"]:[D,R],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),a.jsx(Ms,{dataKey:"totalPurchases",fill:"#10B981",radius:[4,4,0,0],children:k.map((D,R)=>a.jsx(Eo,{fill:N[R%N.length]},`cell-${R}`))})]})}),a.jsx("div",{className:"mt-6 overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Posicin"}),a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Cliente"}),a.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Total Compras"}),a.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Ganancia Generada"}),a.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Transacciones"}),a.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Promedio por Compra"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:k.map((D,R)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsx("div",{className:"flex items-center",children:a.jsx("span",{className:`inline-flex items-center justify-center w-8 h-8 rounded-full text-white text-sm font-bold ${R===0?"bg-yellow-500":R===1?"bg-gray-400":R===2?"bg-orange-600":"bg-blue-500"}`,children:R+1})})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("div",{className:"font-medium text-gray-900",children:D.name})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("div",{className:"font-bold text-green-600",children:V(D.totalPurchases)})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("div",{className:"font-semibold text-emerald-600",children:V(D.totalProfit)})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:D.transactionCount})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("div",{className:"text-gray-600",children:V(D.totalPurchases/D.transactionCount)})})]},D.customerId||R))})]})})]}):a.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ga,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No hay datos de clientes disponibles"}),a.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Las ventas sin cliente asociado no se incluyen en este reporte"})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 md:p-6 shadow-sm border border-gray-100",children:[a.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 flex items-center flex-wrap",children:[a.jsx(ga,{className:"h-5 w-5 mr-2 text-blue-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:"Resumen de Rentabilidad del Perodo"})]}),Object.keys(P).length===0?a.jsx("p",{className:"text-gray-500 text-center py-8",children:"No hay datos de ventas para mostrar"}):a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Ventas reales agrupadas por da (mximo ltimos 8 das con ventas)."}),a.jsx("div",{className:"space-y-3",children:Object.entries(P).sort(([D],[R])=>new Date(R).getTime()-new Date(D).getTime()).slice(0,8).map(([D,R])=>{const B=R.revenue>0?R.profit/R.revenue*100:0;return a.jsxs("div",{className:"flex justify-between items-center p-4 bg-blue-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:new Date(D).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"short",day:"numeric"})}),a.jsxs("div",{className:"text-sm text-gray-500",children:[R.transactions," transacciones  Margen: ",B.toFixed(1),"%"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-lg font-bold text-blue-800",children:V(R.revenue)}),a.jsxs("div",{className:"text-sm text-green-600",children:["+",V(R.profit)," ganancia"]}),a.jsxs("div",{className:"text-xs text-red-600",children:[V(R.cost)," costo"]})]})]},D)})})]})]})]})]})}function gwe(){const{appUser:t}=ma(),{showSuccess:e,showError:r,showConfirm:n}=hi(),[s,i]=I.useState([]),[o,l]=I.useState(!0),[c,u]=I.useState(!1),[d,h]=I.useState(""),[f,m]=I.useState(!1),[y,g]=I.useState(!1),[x,b]=I.useState(null),[v,j]=I.useState(null),[S,_]=I.useState(!1),[C,N]=I.useState({email:"",password:"",displayName:"",role:"employee"});if((t==null?void 0:t.role)!=="admin")return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx(EP,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Acceso Denegado"}),a.jsx("p",{className:"text-gray-600",children:"Solo los administradores pueden gestionar usuarios."})]})});const w=async()=>{try{l(!0);const q=yt(Pe,"users"),ge=(await Kt(q)).docs.map(be=>({...be.data(),uid:be.data().uid||be.id}));ge.sort((be,Ye)=>new Date(Ye.createdAt).getTime()-new Date(be.createdAt).getTime()),i(ge)}catch(q){console.error("Error loading users:",q),r("Error","Error al cargar usuarios")}finally{l(!1)}};I.useEffect(()=>{w()},[]);const E=async q=>{if(q.preventDefault(),!f)try{m(!0);const ie=d_({apiKey:"AIzaSyC2qH28cydE9OKg_9cERvQ3IBRReXHPNLo",authDomain:"finanzas-personales-60d5c.firebaseapp.com",projectId:"finanzas-personales-60d5c",storageBucket:"finanzas-personales-60d5c.firebasestorage.app",messagingSenderId:"1010030707667",appId:"1:1010030707667:web:0a82f7da2be72de30ae526"},"Secondary"),ge=l5(ie),be=await X3(ge,C.email,C.password),Ye=C.displayName.trim()||C.email.split("@")[0].charAt(0).toUpperCase()+C.email.split("@")[0].slice(1),ze={email:C.email,displayName:Ye,role:C.role,permissions:tu[C.role],isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),lastLoginAt:new Date().toISOString()};await zm(ht(Pe,"users",be.user.uid),{...ze,uid:be.user.uid}),await ge.signOut(),await dU(ie),e("xito","Usuario creado exitosamente"),u(!1),N({email:"",password:"",displayName:"",role:"employee"}),w()}catch(ie){console.error("Error creating user:",ie),ie.code==="auth/email-already-in-use"?r("Error","Este email ya est registrado"):ie.code==="auth/weak-password"?r("Error","La contrasea debe tener al menos 6 caracteres"):r("Error","Error al crear usuario: "+ie.message)}finally{m(!1)}},k=async(q,ie)=>{try{const ge=ht(Pe,"users",q.uid);if(q.role==="admin"&&ie==="employee"){const be={...tu[ie]};await ja(ge,{role:ie,permissions:be,updatedAt:new Date().toISOString()}),e("xito",'Usuario cambiado a empleado. Usa "Editar Permisos" para personalizar accesos.'),w();return}await ja(ge,{role:ie,permissions:tu[ie],updatedAt:new Date().toISOString()}),e("xito",`Usuario ${ie==="admin"?"convertido a administrador":"cambiado a empleado"}`),w()}catch(ge){console.error("Error updating user role:",ge),r("Error","Error al actualizar rol del usuario")}},T=async q=>{try{const ie=ht(Pe,"users",q.uid);await ja(ie,{isActive:!q.isActive,updatedAt:new Date().toISOString()}),e("xito",`Usuario ${q.isActive?"desactivado":"activado"}`),w()}catch(ie){console.error("Error updating user status:",ie),r("Error","Error al cambiar estado del usuario")}},P=async q=>{if(q.uid===(t==null?void 0:t.uid)){r("Error","No puedes eliminar tu propia cuenta");return}n(`Ests seguro de que quieres eliminar al usuario ${q.displayName}?`,"Esta accin no se puede deshacer.",async()=>{try{await to(ht(Pe,"users",q.uid)),e("xito","Usuario eliminado exitosamente"),w()}catch(ie){console.error("Error deleting user:",ie),r("Error","Error al eliminar usuario")}})},O=q=>{b(q),j({...q.permissions}),g(!0)},D=async()=>{if(!(!x||!v))try{_(!0);const q=ht(Pe,"users",x.uid);await ja(q,{permissions:v,updatedAt:new Date().toISOString()}),e("xito","Permisos actualizados exitosamente"),g(!1),b(null),j(null),w()}catch(q){console.error("Error updating permissions:",q),r("Error","Error al actualizar permisos")}finally{_(!1)}},R=q=>{v&&j({...v,[q]:!v[q]})},B=q=>({dashboard:"Panel de Control",inventory:"Inventario",purchases:"Compras",sales:"Ventas",salesHistory:"Gestin de Ventas",technicalServiceHistory:"Historial de Servicios Tcnicos",technicalServiceCenter:"Centro de Servicios Tcnicos",purchasesHistory:"Gestin de Compras",layaway:"Plan Separe",technicalService:"Servicio Tcnico",customers:"Clientes",categories:"Categoras",reports:"Reportes",userManagement:"Gestin de Usuarios",myDailySales:"Mis Ventas del Da"})[q]||q,Y=q=>({dashboard:"Ver estadsticas generales y resumen del sistema",inventory:"Gestionar productos, stock y modificar inventario",purchases:"Registrar compras a proveedores y gestionar entradas",sales:"Realizar ventas y procesar transacciones",salesHistory:"Ver historial completo de ventas realizadas",technicalServiceHistory:"Ver historial completo de servicios tcnicos realizados",technicalServiceCenter:"Gestionar centro de servicios tcnicos y reparaciones",purchasesHistory:"Ver historial completo de compras realizadas",layaway:"Gestionar el sistema de apartados y plan separe",technicalService:"Crear y gestionar servicios tcnicos y reparaciones",customers:"Gestionar informacin de clientes",categories:"Ver y gestionar categoras de productos",reports:"Acceder a reportes detallados y analytics",userManagement:"Gestionar usuarios, roles y permisos del sistema",myDailySales:"Ver mis ventas realizadas en el da actual"})[q]||"Sin descripcin disponible",W=()=>{g(!1),b(null),j(null)},L=s.filter(q=>(q.displayName||"").toLowerCase().includes(d.toLowerCase())||q.email.toLowerCase().includes(d.toLowerCase())),X=q=>q==="admin"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800",G=q=>q==="admin"?"Administrador":"Empleado",K=q=>{if(q.role==="admin")return!1;const ie=tu.employee;return Object.keys(ie).some(ge=>{const be=ge;return q.permissions[be]!==ie[be]})};return o?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestin de Usuarios"}),a.jsx("p",{className:"text-gray-600",children:"Administra usuarios, roles y permisos"})]}),a.jsxs("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[a.jsx(wn,{className:"h-5 w-5"}),a.jsx("span",{children:"Crear Usuario"})]})]}),a.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-100",children:a.jsxs("div",{className:"relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),a.jsx("input",{type:"text",placeholder:"Buscar usuarios por nombre o email...",value:d,onChange:q=>h(q.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:a.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Usuarios (",L.length,")"]})}),a.jsx("div",{className:"divide-y divide-gray-200",children:L.map(q=>a.jsx("div",{className:"p-4 hover:bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:a.jsx(Rr,{className:"h-6 w-6 text-gray-600"})})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900",children:q.displayName}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${X(q.role)}`,children:G(q.role)}),K(q)&&a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:"Permisos Personalizados"}),!q.isActive&&a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Inactivo"})]}),a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[a.jsx(C0,{className:"h-4 w-4"}),a.jsx("span",{children:q.email})]}),a.jsxs("p",{className:"text-xs text-gray-400",children:["Creado: ",new Date(q.createdAt).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[q.uid!==(t==null?void 0:t.uid)&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>k(q,q.role==="admin"?"employee":"admin"),className:`px-3 py-1 rounded text-xs font-medium transition-colors ${q.role==="admin"?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-purple-100 text-purple-700 hover:bg-purple-200"}`,title:q.role==="admin"?"Cambiar a empleado":"Cambiar a administrador",children:q.role==="admin"?"Cambiar a Empleado":"Cambiar a Admin"}),q.role==="employee"&&a.jsx("button",{onClick:()=>O(q),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded transition-colors",title:"Editar permisos",children:a.jsx(EP,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>T(q),className:`p-2 rounded transition-colors ${q.isActive?"text-red-600 hover:bg-red-50":"text-green-600 hover:bg-green-50"}`,title:q.isActive?"Desactivar usuario":"Activar usuario",children:q.isActive?a.jsx(HW,{className:"h-4 w-4"}):a.jsx(UW,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>P(q),className:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Eliminar usuario",children:a.jsx(rs,{className:"h-4 w-4"})})]}),q.uid===(t==null?void 0:t.uid)&&a.jsx("span",{className:"text-xs text-gray-500 px-3 py-1",children:"Tu cuenta"})]})]})},q.uid))}),L.length===0&&a.jsx("div",{className:"p-8 text-center text-gray-500",children:"No se encontraron usuarios"})]}),c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Crear Nuevo Usuario"}),a.jsxs("form",{onSubmit:E,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",required:!0,value:C.email,onChange:q=>N({...C,email:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"usuario@ejemplo.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea"}),a.jsx("input",{type:"password",required:!0,minLength:6,value:C.password,onChange:q=>N({...C,password:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Mnimo 6 caracteres"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo (opcional)"}),a.jsx("input",{type:"text",value:C.displayName,onChange:q=>N({...C,displayName:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Si no se especifica, se usar el email"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),a.jsxs("select",{value:C.role,onChange:q=>N({...C,role:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"employee",children:"Empleado"}),a.jsx("option",{value:"admin",children:"Administrador"})]})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancelar"}),a.jsx("button",{type:"submit",disabled:f,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:f?"Creando...":"Crear Usuario"})]})]})]})}),y&&x&&v&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Editar Permisos"}),a.jsxs("p",{className:"text-sm text-gray-600",children:[x.displayName," (",x.email,")"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>{const q=Object.keys(v).reduce((ie,ge)=>(ie[ge]=!0,ie),{});j(q)},className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",children:"Habilitar Todo"}),a.jsx("button",{onClick:()=>{const q=Object.keys(v).reduce((ie,ge)=>(ie[ge]=!1,ie),{});j(q)},className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:"Deshabilitar Todo"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.keys(v).map(q=>{const ie=q,ge=v[ie];return a.jsx("div",{className:`border rounded-lg p-4 transition-colors ${ge?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900",children:B(ie)}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Y(ie)})]}),a.jsx("button",{onClick:()=>R(ie),className:`w-12 h-6 rounded-full transition-colors relative ${ge?"bg-green-500":"bg-gray-300"}`,children:a.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform absolute top-0.5 ${ge?"translate-x-6":"translate-x-0.5"}`})})]})},q)})})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{onClick:W,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancelar"}),a.jsx("button",{onClick:D,disabled:S,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:S?"Guardando...":"Guardar Permisos"})]})]})})]})}function ywe(){const{user:t}=ma(),[e,r]=I.useState([]),[n,s]=I.useState(!1),[i,o]=I.useState(null),[l,c]=I.useState({name:""}),[u,d]=I.useState(!1),[h,f]=I.useState(null);I.useEffect(()=>{const b=Bt(yt(Pe,Ke.TECHNICIANS),dr("createdAt","desc")),v=ua(b,j=>{const S=j.docs.map(_=>({id:_.id,..._.data()}));r(S)});return()=>v()},[]);const m=()=>{c({name:""}),o(null),s(!1)},y=async b=>{if(b.preventDefault(),!!l.name.trim()){d(!0);try{const v=new Date().toISOString();i?await ja(ht(Pe,Ke.TECHNICIANS,i.id),{name:l.name.trim(),updatedAt:v}):await qm(yt(Pe,Ke.TECHNICIANS),{name:l.name.trim(),isActive:!0,createdAt:v,updatedAt:v,createdBy:(t==null?void 0:t.uid)||null}),m()}catch(v){console.error("Error saving technician:",v)}finally{d(!1)}}},g=b=>{o(b),c({name:b.name}),s(!0)},x=async b=>{if(h!==b){f(b);return}try{await to(ht(Pe,Ke.TECHNICIANS,b)),f(null)}catch(v){console.error("Error deleting technician:",v)}};return a.jsx("div",{className:"max-w-6xl mx-auto p-6",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[a.jsx("div",{className:"border-b border-gray-200 p-6",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestin de Tcnicos"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Administra el equipo tcnico de la empresa"})]}),a.jsxs("button",{onClick:()=>s(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(wn,{className:"h-5 w-5 mr-2"}),"Nuevo Tcnico"]})]})}),n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-90vh overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:i?"Editar Tcnico":"Nuevo Tcnico"}),a.jsx("button",{onClick:m,className:"text-gray-400 hover:text-gray-600",children:a.jsx(ct,{className:"h-6 w-6"})})]}),a.jsxs("form",{onSubmit:y,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),a.jsx("input",{type:"text",value:l.name,onChange:b=>c(v=>({...v,name:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"Nombre del tcnico"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs("button",{type:"submit",disabled:u,className:"flex-1 flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[a.jsx(FW,{className:"h-4 w-4 mr-2"}),u?"Guardando...":"Guardar"]}),a.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancelar"})]})]})]})})}),a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6 mb-6",children:a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Rr,{className:"h-8 w-8 text-blue-600"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Total de Tcnicos"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.length})]})]})})}),e.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Rr,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay tcnicos registrados"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Comienza agregando tu primer tcnico"}),a.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(wn,{className:"h-5 w-5 mr-2"}),"Agregar Tcnico"]})]}):a.jsx("div",{className:"space-y-4",children:e.map(b=>a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsx("div",{className:"flex-1",children:a.jsx("div",{className:"flex items-center gap-2 mb-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:b.name})})}),a.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[a.jsx("button",{onClick:()=>g(b),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",title:"Editar tcnico",children:a.jsx(Hu,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>x(b.id),className:`p-2 rounded-lg transition-colors ${h===b.id?"bg-red-100 text-red-700":"text-red-600 hover:bg-red-100"}`,title:h===b.id?"Confirmar eliminacin":"Eliminar tcnico",children:a.jsx(rs,{className:"h-4 w-4"})})]})]})},b.id))}),h&&a.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("p",{className:"text-red-800 text-sm",children:"Haz clic nuevamente en el botn de eliminar para confirmar la eliminacin del tcnico."})})]})]})})}function xwe(){ma();const{showNotification:t}=hi(),[e,r]=I.useState("pending"),[n,s]=I.useState([]),[i,o]=I.useState([]),[l,c]=I.useState([]),[u,d]=I.useState(""),h=new Date().toISOString().split("T")[0],f=new Date(Date.now()-6*30*24*60*60*1e3).toISOString().split("T")[0],[m,y]=I.useState(h),[g,x]=I.useState(h),[b,v]=I.useState(""),[j,S]=I.useState(new Set),[_,C]=I.useState(!1),[N,w]=I.useState(""),[E,k]=I.useState(!1);I.useEffect(()=>{const L=Bt(yt(Pe,Ke.TECHNICIANS),dr("createdAt","desc")),X=ua(L,G=>{const K=G.docs.map(q=>({id:q.id,...q.data()}));s(K)});return()=>X()},[]),I.useEffect(()=>{const L=Bt(yt(Pe,Ke.TECHNICAL_SERVICES),or("status","==","completed")),X=ua(L,G=>{let K=G.docs.map(q=>({id:q.id,...q.data()}));K.sort((q,ie)=>{const ge=q.completedAt?new Date(q.completedAt).getTime():0;return(ie.completedAt?new Date(ie.completedAt).getTime():0)-ge}),o(K)});return()=>X()},[]),I.useEffect(()=>{const L=Bt(yt(Pe,Ke.TECHNICIAN_LIQUIDATIONS),dr("createdAt","desc")),X=ua(L,G=>{const K=G.docs.map(q=>({id:q.id,...q.data()}));c(K)});return()=>X()},[]);const T=I.useMemo(()=>i.filter(L=>!L.technicianId||L.liquidationId?!1:L.serviceCost!==void 0?L.serviceCost>0:L.laborCost&&L.laborCost>0),[i]);I.useEffect(()=>{const L=new Set(T.map(G=>G.id)),X=new Set(j);for(const G of X)L.has(G)||X.delete(G);X.size!==j.size&&S(X)},[T,j]);const P=I.useMemo(()=>T.filter(L=>{var q,ie;const X=!u||L.technicianId===u;let G=!0;if(m||g){const ge=L.completedAt?new Date(L.completedAt).toISOString().split("T")[0]:null;ge?(m&&ge<m&&(G=!1),g&&ge>g&&(G=!1)):G=!1}const K=!b||L.customerName.toLowerCase().includes(b.toLowerCase())||((q=L.deviceBrandModel)==null?void 0:q.toLowerCase().includes(b.toLowerCase()))||((ie=L.technicianName)==null?void 0:ie.toLowerCase().includes(b.toLowerCase()));return X&&G&&K}),[T,u,m,g,b]),O=I.useMemo(()=>l.filter(L=>{const X=!u||L.technicianId===u;let G=!0;if(m||g){const q=new Date(L.createdAt).toISOString().split("T")[0];m&&q<m&&(G=!1),g&&q>g&&(G=!1)}const K=!b||L.technicianName.toLowerCase().includes(b.toLowerCase());return X&&G&&K}),[l,u,m,g,b]),D=I.useMemo(()=>{const X=Array.from(j).map(G=>T.find(K=>K.id===G)).filter(Boolean).reduce((G,K)=>{var Ye;if(!K.technicianId)return G;G[K.technicianId]||(G[K.technicianId]={technicianId:K.technicianId,technicianName:K.technicianName||"Tcnico Desconocido",services:[],totalLaborCost:0,totalTechnicianShare:0});const q=((Ye=K.items)==null?void 0:Ye.reduce((ze,U)=>ze+U.totalCost,0))||0,ie=K.serviceCost||0,ge=K.laborCost||(q===0?ie:Math.max(0,ie-q)),be=K.technicianShare||ge*.5;return G[K.technicianId].services.push(K),G[K.technicianId].totalLaborCost+=ge,G[K.technicianId].totalTechnicianShare+=be,G},{});return Object.values(X)},[j,T]);I.useEffect(()=>{_&&D.length===0&&C(!1)},[_,D.length]);const R=L=>{const X=new Set(j);X.has(L)?X.delete(L):X.add(L),S(X)},B=()=>{j.size===P.length?S(new Set):S(new Set(P.map(L=>L.id)))},Y=async()=>{if(D.length===0){t("Selecciona al menos un servicio para liquidar","warning");return}k(!0);try{const L=new Date().toISOString();for(const X of D){const G={technicianId:X.technicianId,technicianName:X.technicianName,services:X.services.map(q=>{var ze;const ie=((ze=q.items)==null?void 0:ze.reduce((U,Q)=>U+Q.totalCost,0))||0,ge=q.serviceCost||0,be=q.laborCost||(ie===0?ge:Math.max(0,ge-ie)),Ye=q.technicianShare||be*.5;return{serviceId:q.id,serviceCost:ge,partsCost:ie,laborCost:be,technicianShare:Ye,customerName:q.customerName,deviceBrandModel:q.deviceBrandModel,completedAt:q.completedAt||L}}),totalLaborCost:X.totalLaborCost,totalTechnicianShare:X.totalTechnicianShare,status:"completed",createdAt:L,notes:N},K=await qm(yt(Pe,Ke.TECHNICIAN_LIQUIDATIONS),G);for(const q of X.services)await ja(ht(Pe,Ke.TECHNICAL_SERVICES,q.id),{liquidationId:K.id,liquidatedAt:L})}t("Liquidaciones creadas exitosamente","success"),S(new Set),w(""),C(!1)}catch(L){console.error("Error creating liquidations:",L),t("Error al crear las liquidaciones","error")}finally{k(!1)}},W=L=>new Date(L).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return a.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-300",children:[a.jsx("div",{className:"border-b border-gray-200 p-6",children:a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Liquidacin de Tcnicos"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona los pagos de mano de obra para tcnicos"})]})})}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex",children:[a.jsx("button",{onClick:()=>r("pending"),className:`py-4 px-6 text-sm font-medium border-b-2 transition-colors ${e==="pending"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx($i,{className:"h-4 w-4 mr-2"}),"Servicios Pendientes (",P.length,")"]})}),a.jsx("button",{onClick:()=>r("history"),className:`py-4 px-6 text-sm font-medium border-b-2 transition-colors ${e==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(ai,{className:"h-4 w-4 mr-2"}),"Historial de Liquidaciones (",O.length,")"]})})]})}),a.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tcnico"}),a.jsxs("select",{value:u,onChange:L=>d(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Todos los tcnicos"}),n.map(L=>a.jsx("option",{value:L.id,children:L.name},L.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Desde"}),a.jsx("input",{type:"date",value:m,min:f,max:h,onChange:L=>y(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hasta"}),a.jsx("input",{type:"date",value:g,min:f,max:h,onChange:L=>x(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buscar"}),a.jsxs("div",{className:"relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Cliente, tcnico, dispositivo...",value:b,onChange:L=>v(L.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[a.jsx("button",{onClick:()=>{y(h),x(h)},className:`px-3 py-1 text-xs rounded-md transition-colors ${m===h&&g===h?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Hoy"}),a.jsx("button",{onClick:()=>{const L=new Date(Date.now()-864e5).toISOString().split("T")[0];y(L),x(L)},className:"px-3 py-1 text-xs rounded-md bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors",children:"Ayer"}),a.jsx("button",{onClick:()=>{const L=new Date(Date.now()-6048e5).toISOString().split("T")[0];y(L),x(h)},className:"px-3 py-1 text-xs rounded-md bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors",children:"ltima semana"}),a.jsx("button",{onClick:()=>{const L=new Date(Date.now()-2592e6).toISOString().split("T")[0];y(L),x(h)},className:"px-3 py-1 text-xs rounded-md bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors",children:"ltimo mes"})]})]}),a.jsx("div",{className:"p-6",children:e==="pending"?a.jsxs("div",{children:[P.length>0&&a.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:B,className:"text-sm text-blue-600 hover:text-blue-800",children:j.size===P.length?"Deseleccionar todo":"Seleccionar todo"}),j.size>0&&a.jsxs("span",{className:"text-sm text-gray-600",children:[j.size," servicio",j.size!==1?"s":""," seleccionado",j.size!==1?"s":""]})]}),j.size>0&&!_&&a.jsxs("button",{onClick:()=>C(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx(Wt,{className:"h-4 w-4 mr-2"}),"Crear Liquidacin (",j.size,")"]})]}),P.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx($i,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay servicios pendientes"}),a.jsx("p",{className:"text-gray-600",children:"Los servicios completados con tcnico asignado aparecern aqu"})]}):a.jsx("div",{className:"space-y-2",children:P.map(L=>a.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-sm transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",checked:j.has(L.id),onChange:()=>R(L.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-4 items-center",children:[a.jsxs("div",{className:"col-span-3",children:[a.jsx("h3",{className:"font-bold text-gray-900",children:L.customerName}),a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded",children:"Completado"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("div",{className:"text-sm text-gray-900",children:L.technicianName}),a.jsx("div",{className:"text-xs text-gray-500",children:L.deviceBrandModel})]}),a.jsx("div",{className:"col-span-2",children:a.jsx("div",{className:"text-sm text-gray-600",children:L.completedAt?W(L.completedAt):"Fecha no disponible"})}),a.jsxs("div",{className:"col-span-1 text-center",children:[a.jsx("div",{className:"font-bold text-blue-600",children:V(L.serviceCost||0)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Servicio"})]}),a.jsx("div",{className:"col-span-1 text-center",children:(()=>{var G;const X=((G=L.items)==null?void 0:G.reduce((K,q)=>K+q.totalCost,0))||0;return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"font-medium text-gray-600",children:V(X)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Repuestos"})]})})()}),a.jsx("div",{className:"col-span-1 text-center",children:(()=>{var q;const X=((q=L.items)==null?void 0:q.reduce((ie,ge)=>ie+ge.totalCost,0))||0,G=L.serviceCost||0,K=L.laborCost||(X===0?G:Math.max(0,G-X));return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"font-medium text-blue-600",children:V(K)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Mano de Obra"})]})})()}),a.jsx("div",{className:"col-span-2 text-center",children:(()=>{var ie;const X=((ie=L.items)==null?void 0:ie.reduce((ge,be)=>ge+be.totalCost,0))||0,G=L.serviceCost||0,K=L.laborCost||(X===0?G:Math.max(0,G-X)),q=L.technicianShare||K*.5;return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"font-bold text-green-600 text-lg",children:V(q)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Para Tcnico"})]})})()})]})]}),L.items&&L.items.length>0&&a.jsxs("details",{className:"mt-3",children:[a.jsxs("summary",{className:"cursor-pointer text-sm text-gray-600 hover:text-gray-800",children:["Ver repuestos usados (",L.items.length,")"]}),a.jsx("div",{className:"mt-2 bg-gray-50 rounded p-3",children:L.items.map((X,G)=>a.jsxs("div",{className:"flex justify-between text-sm py-1",children:[a.jsxs("span",{children:[X.partName||X.name," (x",X.quantity,")"]}),a.jsx("span",{className:"font-medium",children:V(X.totalCost)})]},G))})]})]},L.id))})]}):a.jsx("div",{children:O.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(ai,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay liquidaciones"}),a.jsx("p",{className:"text-gray-600",children:"Las liquidaciones creadas aparecern aqu"})]}):a.jsx("div",{className:"space-y-2",children:O.map(L=>a.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-sm transition-shadow",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-gray-900",children:L.technicianName}),a.jsx("div",{className:"text-sm text-gray-500",children:W(L.createdAt)})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-6 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600",children:L.services.length}),a.jsx("div",{className:"text-xs text-gray-500",children:"Servicios"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-purple-600",children:V(L.totalLaborCost)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Mano de Obra"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-green-600 text-lg",children:V(L.totalTechnicianShare)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Para Tcnico"})]})]})]})}),L.notes&&a.jsxs("div",{className:"mt-3 p-2 bg-gray-50 rounded text-sm text-gray-600",children:[a.jsx("strong",{children:"Notas:"})," ",L.notes]}),a.jsxs("details",{className:"mt-3",children:[a.jsxs("summary",{className:"cursor-pointer text-sm text-gray-600 hover:text-gray-800",children:["Ver servicios incluidos (",L.services.length,")"]}),a.jsx("div",{className:"mt-2 bg-gray-50 rounded p-3",children:L.services.map((X,G)=>a.jsxs("div",{className:"flex justify-between text-sm py-1",children:[a.jsxs("span",{children:[X.customerName," - ",X.deviceBrandModel]}),a.jsx("span",{className:"font-medium text-green-600",children:V(X.technicianShare)})]},G))})]})]},L.id))})})})]}),_&&D.length>0&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-90vh overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Crear Liquidaciones"}),a.jsx("div",{className:"space-y-4",children:D.map(L=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:L.technicianName}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3 text-sm",children:[a.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[a.jsx("span",{className:"text-blue-900 font-medium",children:"Servicios: "}),a.jsx("span",{className:"text-blue-700",children:L.services.length})]}),a.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[a.jsx("span",{className:"text-green-900 font-medium",children:"Total Mano de Obra: "}),a.jsx("span",{className:"text-green-700",children:V(L.totalLaborCost)})]}),a.jsxs("div",{className:"bg-yellow-50 p-2 rounded",children:[a.jsx("span",{className:"text-yellow-900 font-medium",children:"A Pagar: "}),a.jsx("span",{className:"text-yellow-700",children:V(L.totalTechnicianShare)})]})]}),a.jsx("div",{className:"text-xs text-gray-600",children:a.jsxs("details",{children:[a.jsxs("summary",{className:"cursor-pointer hover:text-gray-800",children:["Ver servicios (",L.services.length,")"]}),a.jsx("div",{className:"mt-2 space-y-1 max-h-32 overflow-y-auto",children:L.services.map(X=>a.jsxs("div",{className:"flex justify-between items-center p-1 bg-gray-50 rounded",children:[a.jsxs("span",{children:[X.customerName," - ",X.deviceBrandModel]}),a.jsx("span",{className:"font-medium",children:V(X.technicianShare||0)})]},X.id))})]})})]},L.technicianId))}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas (opcional)"}),a.jsx("textarea",{value:N,onChange:L=>w(L.target.value),rows:3,placeholder:"Notas adicionales sobre esta liquidacin",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"flex gap-3 mt-6",children:[a.jsxs("button",{onClick:Y,disabled:E,className:"flex-1 flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[a.jsx(Wt,{className:"h-4 w-4 mr-2"}),E?"Creando...":"Crear Liquidaciones"]}),a.jsx("button",{onClick:()=>C(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancelar"})]})]})})})]})}function vwe(){const{appUser:t}=ma(),[e,r]=I.useState([]);I.useEffect(()=>{if(!(t!=null&&t.uid))return;console.log(" Iniciando suscripcin optimizada a ventas del da");const E=Xo.subscribeTodaySalesBySalesperson(t.uid,k=>{console.log(" Ventas del da actualizadas:",k.length),r(k)});return()=>{console.log(" Cerrando suscripcin a ventas del da"),E()}},[t==null?void 0:t.uid]);const[n,s]=I.useState(null),[i,o]=I.useState(!1),[l,c]=I.useState(""),[u,d]=I.useState("all"),[h,f]=I.useState(""),[m,y]=I.useState(""),g=e,x=I.useMemo(()=>g.filter(E=>!(l&&!(E.customerName||"Cliente General").toLowerCase().includes(l.toLowerCase())||u!=="all"&&!(Array.isArray(E.paymentMethods)?E.paymentMethods.some(T=>T.method===u):E.paymentMethod===u)||h&&(E.finalTotal||E.total||0)<parseFloat(h)||m&&(E.finalTotal||E.total||0)>parseFloat(m))),[g,l,u,h,m]),b=I.useMemo(()=>{const E=new Set;return g.forEach(k=>{Array.isArray(k.paymentMethods)&&k.paymentMethods.length>0?k.paymentMethods.forEach(T=>E.add(T.method)):k.paymentMethod&&E.add(k.paymentMethod)}),Array.from(E)},[g]),v=I.useMemo(()=>{const E=g.length,k=g.reduce((L,X)=>L+(X.finalTotal||X.total||0),0),T=g.reduce((L,X)=>!X.items||!Array.isArray(X.items)?L:L+X.items.reduce((G,K)=>G+K.quantity,0),0),P={};g.forEach(L=>{const X=L.finalTotal||L.total||0;if(Array.isArray(L.paymentMethods)&&L.paymentMethods.length>0)L.paymentMethods.forEach(G=>{const K=G.method||"efectivo";P[K]=(P[K]||0)+G.amount});else{const G=L.paymentMethod||"efectivo";P[G]=(P[G]||0)+X}});let O=0,D=0,R=0,B=0;const Y=g.reduce((L,X)=>{const G=X.type||"regular";return L[G]=(L[G]||0)+1,L},{});console.log(" Tipos de ventas del da:",Y);const W=g.filter(L=>L.isLayaway);return console.log(" Ventas con isLayaway:",W.length),W.length>0&&W.forEach(L=>{console.log("  - ID:",L.id.substring(0,8),"Type:",L.type,"isLayaway:",L.isLayaway,"Total:",L.total)}),g.forEach(L=>{const X=L.finalTotal||L.total||0;if(L.type==="technical_service_payment"){R+=X;return}if(L.type==="layaway_payment"||L.isLayaway&&L.type!=="layaway_delivery"){console.log(" Abono plan separe encontrado:",{id:L.id.substring(0,8),amount:X,type:L.type,isLayaway:L.isLayaway}),B+=X;return}if(L.type!=="layaway_delivery"&&(L.type==="regular"||!L.type)&&L.items&&Array.isArray(L.items)&&L.items.length>0&&(L.items.forEach(G=>{const K=G.totalRevenue;G.category&&G.category.toLowerCase().includes("celular")?O+=K:D+=K}),L.discount>0)){const G=L.subtotal;if(G>0){const K=L.discount/G;O-=L.items.filter(q=>q.category&&q.category.toLowerCase().includes("celular")).reduce((q,ie)=>q+ie.totalRevenue,0)*K,D-=L.items.filter(q=>!q.category||!q.category.toLowerCase().includes("celular")).reduce((q,ie)=>q+ie.totalRevenue,0)*K}}}),{totalSales:E,totalRevenue:k,totalItems:T,paymentMethods:P,breakdown:{cellphones:O,otherProducts:D,technicalServices:R,layawayPayments:B,percentages:{cellphones:k>0?O/k*100:0,otherProducts:k>0?D/k*100:0,technicalServices:k>0?R/k*100:0,layawayPayments:k>0?B/k*100:0}}}},[g]),j=E=>{s(E),o(!0)},S=()=>{o(!1),s(null)},_=()=>{c(""),d("all"),f(""),y("")},C=l||u!=="all"||h||m,N=E=>{switch(E){case"efectivo":return{name:"Efectivo",icon:Zh,color:"text-green-600",bgColor:"bg-green-100"};case"transferencia":return{name:"Transferencia",icon:Sl,color:"text-blue-600",bgColor:"bg-blue-100"};case"tarjeta":return{name:"Tarjeta",icon:ef,color:"text-purple-600",bgColor:"bg-purple-100"};case"crdito":case"credit":return{name:"Crdito",icon:$i,color:"text-orange-600",bgColor:"bg-orange-100"};default:return{name:E,icon:Wt,color:"text-gray-600",bgColor:"bg-gray-100"}}},w=E=>{if(E.type==="technical_service_payment")return{label:"Servicio Tcnico",icon:"",bgColor:"bg-green-100",textColor:"text-green-700",borderColor:"border-green-200"};if(E.type==="layaway_payment")return{label:"Plan Separe",icon:"",bgColor:"bg-amber-100",textColor:"text-amber-700",borderColor:"border-amber-200"};if(E.type==="layaway_delivery")return{label:"Entrega Separe",icon:"",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-200"};const k=E.items.some(P=>P.category&&P.category.toLowerCase().includes("celular")),T=E.items.some(P=>!P.category||!P.category.toLowerCase().includes("celular"));return k&&T?{label:"Mixta",icon:"",bgColor:"bg-indigo-100",textColor:"text-indigo-700",borderColor:"border-indigo-200"}:k?{label:"Celulares",icon:"",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-200"}:{label:"Otros Productos",icon:"",bgColor:"bg-purple-100",textColor:"text-purple-700",borderColor:"border-purple-200"}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mis Ventas del Da"}),a.jsxs("p",{className:"text-gray-600 mt-1",children:["Ventas realizadas por ",(t==null?void 0:t.displayName)||(t==null?void 0:t.email)," el ",new Date().toLocaleDateString("es-CO")]})]}),a.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[a.jsx(Rr,{className:"h-6 w-6"}),a.jsx(Xn,{className:"h-6 w-6"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:a.jsx(Pi,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ventas Realizadas"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.totalSales})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:a.jsx(Wt,{className:"h-6 w-6 text-green-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Vendido"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:V(v.totalRevenue)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:a.jsx(Pi,{className:"h-6 w-6 text-purple-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Productos Vendidos"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.totalItems})]})]})})]}),v.totalRevenue>0&&a.jsxs("div",{className:"bg-gray-50 rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Desglose de Ingresos (Cuadre de Caja)"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Segregacin de ventas por tipo de producto y servicio"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-2xl",children:""}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Celulares"})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-100 px-2 py-1 rounded-full",children:[v.breakdown.percentages.cellphones.toFixed(0),"%"]})]}),a.jsx("p",{className:"text-2xl font-bold text-blue-700",children:V(v.breakdown.cellphones)})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-2xl",children:""}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Otros productos"})]}),a.jsxs("span",{className:"text-xs font-semibold text-purple-600 bg-purple-100 px-2 py-1 rounded-full",children:[v.breakdown.percentages.otherProducts.toFixed(0),"%"]})]}),a.jsx("p",{className:"text-2xl font-bold text-purple-700",children:V(v.breakdown.otherProducts)})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-2xl",children:""}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Servicios tcnicos"})]}),a.jsxs("span",{className:"text-xs font-semibold text-green-600 bg-green-100 px-2 py-1 rounded-full",children:[v.breakdown.percentages.technicalServices.toFixed(0),"%"]})]}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:V(v.breakdown.technicalServices)})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-2xl",children:""}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Plan Separe"})]}),a.jsxs("span",{className:"text-xs font-semibold text-amber-600 bg-amber-100 px-2 py-1 rounded-full",children:[v.breakdown.percentages.layawayPayments.toFixed(0),"%"]})]}),a.jsx("p",{className:"text-2xl font-bold text-amber-700",children:V(v.breakdown.layawayPayments)})]})]})]}),Object.keys(v.paymentMethods).length>0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Ventas por Mtodo de Pago"})}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(v.paymentMethods).map(([E,k])=>{const T=N(E),P=T.icon;return a.jsxs("div",{className:"flex items-center p-4 rounded-lg border border-gray-200",children:[a.jsx("div",{className:`p-2 rounded-full ${T.bgColor}`,children:a.jsx(P,{className:`h-5 w-5 ${T.color}`})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:T.name}),a.jsx("p",{className:"text-lg font-bold text-gray-900",children:V(k)})]})]},E)})})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Detalle de Ventas"}),C&&a.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full",children:[x.length," de ",g.length]})]}),C&&a.jsxs("button",{onClick:_,className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx(ct,{className:"h-4 w-4"}),a.jsx("span",{children:"Limpiar Filtros"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar cliente...",value:l,onChange:E=>c(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(S0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"}),a.jsxs("select",{value:u,onChange:E=>d(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white",children:[a.jsx("option",{value:"all",children:"Todos los mtodos"}),b.map(E=>a.jsx("option",{value:E,children:E==="efectivo"?"Efectivo":E==="transferencia"?"Transferencia":E==="tarjeta"?"Tarjeta":E==="crdito"?"Crdito":E},E))]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Wt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"number",placeholder:"Monto mnimo",value:h,onChange:E=>f(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Wt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"number",placeholder:"Monto mximo",value:m,onChange:E=>y(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:g.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(Pi,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay ventas registradas"}),a.jsx("p",{className:"text-gray-600",children:"An no tienes ventas registradas para el da de hoy."})]}):x.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(S0,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron ventas"}),a.jsx("p",{className:"text-gray-600",children:"No hay ventas que coincidan con los filtros aplicados."}),a.jsx("button",{onClick:_,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Limpiar Filtros"})]}):a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID Venta"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hora"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Productos"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mtodo de Pago"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(E=>{const k=w(E);return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-xs font-mono text-gray-500",children:E.id.substring(0,8)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(E.createdAt).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border ${k.bgColor} ${k.textColor} ${k.borderColor}`,children:[a.jsx("span",{className:"mr-1",children:k.icon}),k.label]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:E.customerName||"Cliente General"}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[E.items.reduce((T,P)=>T+P.quantity,0)," productos"]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:V(E.finalTotal||E.total||0)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"flex flex-wrap gap-1",children:Array.isArray(E.paymentMethods)?E.paymentMethods.map((T,P)=>a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:T.method==="efectivo"?"Efectivo":T.method==="transferencia"?"Transferencia":T.method==="tarjeta"?"Tarjeta":T.method==="crdito"?"Crdito":T.method},P)):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:E.paymentMethod==="efectivo"?"Efectivo":E.paymentMethod==="transferencia"?"Transferencia":E.paymentMethod==="tarjeta"?"Tarjeta":E.paymentMethod==="crdito"?"Crdito":E.paymentMethod})})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("button",{onClick:()=>j(E),className:"text-blue-600 hover:text-blue-900 flex items-center space-x-1",children:[a.jsx(Pi,{className:"h-4 w-4"}),a.jsx("span",{children:"Ver Factura"})]})})]},E.id)})})]})})]}),i&&n&&a.jsx(sS,{sale:n,onClose:S})]})}function bwe(){const{permissionHelpers:t}=ma(),[e,r]=I.useState([]),[n,s]=I.useState(!0),[i,o]=I.useState(""),[l,c]=I.useState("all"),[u,d]=I.useState("all"),[h,f]=I.useState(""),[m,y]=I.useState("");if(!(t!=null&&t.hasPermission("courtesies")))return a.jsx("div",{className:"flex items-center justify-center h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ur,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Sin acceso"}),a.jsx("p",{className:"text-gray-600",children:"No tienes permisos para ver el historial de cortesas"})]})});I.useEffect(()=>{g()},[]);const g=async()=>{try{s(!0);const C=await Nx.getAll();r(C)}catch(C){console.error("Error loading courtesies:",C)}finally{s(!1)}},x=I.useMemo(()=>{const C=new Set(e.map(N=>N.salesPersonName).filter(Boolean));return Array.from(C)},[e]),b=I.useMemo(()=>{const C=new Set(e.map(N=>{var w;return(w=N.item)==null?void 0:w.productName}).filter(Boolean));return Array.from(C)},[e]),v=I.useMemo(()=>e.filter(C=>{var N;if(i&&!(C.customerName||"").toLowerCase().includes(i.toLowerCase())||l!=="all"&&C.salesPersonName!==l||u!=="all"&&((N=C.item)==null?void 0:N.productName)!==u)return!1;if(h||m){const w=new Date(C.createdAt).toISOString().split("T")[0];if(h&&w<h||m&&w>m)return!1}return!0}),[e,i,l,u,h,m]),j=I.useMemo(()=>{const C=v.length,N=v.reduce((k,T)=>{var P;return k+(((P=T.item)==null?void 0:P.totalValue)||0)},0),w=v.reduce((k,T)=>{var P;return k+(((P=T.item)==null?void 0:P.totalCost)||0)},0),E=v.reduce((k,T)=>{var P;return k+(((P=T.item)==null?void 0:P.quantity)||0)},0);return{totalCourtesies:C,totalValue:N,totalCost:w,totalQuantity:E}},[v]),S=i||l!=="all"||u!=="all"||h||m,_=()=>{o(""),c("all"),d("all"),f(""),y("")};return n?a.jsx("div",{className:"flex items-center justify-center h-screen",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-600"})}):a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-3",children:[a.jsx(ur,{className:"h-8 w-8 text-cyan-600"}),a.jsx("span",{children:"Historial de Cortesas"})]}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Registro completo de productos regalados a clientes"})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-cyan-100 rounded-full",children:a.jsx(ur,{className:"h-6 w-6 text-cyan-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Cortesas"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.totalCourtesies})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:a.jsx(ea,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Productos Regalados"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.totalQuantity})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:a.jsx(Wt,{className:"h-6 w-6 text-green-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Valor Total"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:V(j.totalValue)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:a.jsx(BW,{className:"h-6 w-6 text-red-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Costo Real"}),a.jsx("p",{className:"text-2xl font-bold text-red-600",children:V(j.totalCost)})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[a.jsx(S0,{className:"h-5 w-5"}),a.jsx("span",{children:"Filtros"})]}),S&&a.jsx("button",{onClick:_,className:"text-sm text-gray-600 hover:text-gray-900 underline",children:"Limpiar filtros"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar cliente...",value:i,onChange:C=>o(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),a.jsxs("select",{value:l,onChange:C=>c(C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[a.jsx("option",{value:"all",children:"Todos los vendedores"}),x.map(C=>a.jsx("option",{value:C,children:C},C))]}),a.jsxs("select",{value:u,onChange:C=>d(C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[a.jsx("option",{value:"all",children:"Todos los productos"}),b.map(C=>a.jsx("option",{value:C,children:C},C))]}),a.jsx("input",{type:"date",value:h,onChange:C=>f(C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"}),a.jsx("input",{type:"date",value:m,onChange:C=>y(C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Cortesas Registradas (",v.length,")"]})}),a.jsx("div",{className:"overflow-x-auto",children:v.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(ur,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay cortesas registradas"}),a.jsx("p",{className:"text-gray-600",children:S?"No se encontraron cortesas con los filtros aplicados":"An no se han registrado cortesas"})]}):a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Producto"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cantidad"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Costo"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendedor"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Motivo"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(C=>{var N,w,E,k,T;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(C.createdAt).toLocaleDateString("es-CO")}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C.customerName||"N/A"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((N=C.item)==null?void 0:N.productName)||"N/A"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((w=C.item)==null?void 0:w.quantity)||0}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-cyan-600",children:V(((E=C.item)==null?void 0:E.totalValue)||0)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-red-600",children:V(((k=C.item)==null?void 0:k.totalCost)||0)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C.salesPersonName||"N/A"}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:((T=C.item)==null?void 0:T.reason)||C.reason||"-"})]},C.id)})})]})})]})]})}function wwe(){const t=Xt(kd),[e,r]=I.useState([]),[n,s]=I.useState(!1),i=(o,l=5)=>{const c=new Date;c.setHours(0,0,0,0);const u=c.getFullYear(),d=[];return o.forEach(h=>{if(h.birthDate)try{const f=h.birthDate.split("-");if(f.length!==3)return;const m=parseInt(f[1],10)-1,y=parseInt(f[2],10);let g=new Date(u,m,y);g.setHours(0,0,0,0),g<c&&(g=new Date(u+1,m,y),g.setHours(0,0,0,0));const x=g.getTime()-c.getTime(),b=Math.floor(x/(1e3*60*60*24));if(console.log(`Cliente: ${h.name}, Fecha nacimiento: ${h.birthDate}, Das hasta cumpleaos: ${b}`),b>=0&&b<=l){const v=g.toLocaleDateString("es-CO",{day:"numeric",month:"long"});d.push({customer:h,daysUntilBirthday:b,birthdayDate:v})}}catch(f){console.warn(`Error parsing birth date for customer ${h.name}:`,f)}}),d.sort((h,f)=>h.daysUntilBirthday-f.daysUntilBirthday)};return I.useEffect(()=>{if(t&&t.length>0){const o=i(t,5);r(o),s(!0)}else r([]),t!==void 0&&s(!0)},[t]),{upcomingBirthdays:e,hasUpcomingBirthdays:e.length>0,birthdayCount:e.length,isLoaded:n}}function jwe({onDismiss:t}){const{upcomingBirthdays:e,hasUpcomingBirthdays:r,birthdayCount:n,isLoaded:s}=wwe(),[i,o]=I.useState(!1),[l,c]=I.useState(!1);I.useEffect(()=>{if(s)if(r){const m=setTimeout(()=>{o(!0)},500);return()=>clearTimeout(m)}else t&&t()},[s,r,t]);const u=()=>{o(!1),t==null||t()},d=()=>{const m=e.filter(x=>x.daysUntilBirthday===0).length,y=e.filter(x=>x.daysUntilBirthday===1).length,g=n-m-y;return console.log("Debug cumpleaos:",{birthdayCount:n,todayCount:m,tomorrowCount:y,laterCount:g,upcomingBirthdays:e.map(x=>({name:x.customer.name,days:x.daysUntilBirthday}))}),m>0?m===n?`${m} cliente${m>1?"s":""} cumple${m===1?"":"n"} aos hoy`:`${m} cliente${m>1?"s":""} cumple${m===1?"":"n"} aos hoy (+${n-m} ms)`:y>0?y===n?`${y} cliente${y>1?"s":""} cumple${y===1?"":"n"} aos maana`:`${y} cliente${y>1?"s":""} cumple${y===1?"":"n"} aos maana (+${n-y} ms)`:`${n} cliente${n>1?"s":""} cumple${n===1?"":"n"} aos pronto`},h=e.reduce((m,y)=>{const g=y.daysUntilBirthday;return m[g]||(m[g]=[]),m[g].push(y),m},{}),f=m=>m===0?"Hoy":m===1?"Maana":`En ${m} das`;return!r||!i?null:a.jsx("div",{className:"fixed top-4 right-4 z-50 animate-slide-in-right",children:a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-[#90c5e7] text-white px-4 py-3 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-xl hover:scale-105 flex items-center space-x-3 min-w-[280px]",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:[a.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[a.jsx(ur,{className:"h-5 w-5 animate-bounce"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-sm",children:d()}),a.jsx("p",{className:"text-xs opacity-90",children:"Pasa el cursor para ver detalles"})]})]}),a.jsx("button",{onClick:u,className:"p-1 hover:bg-white/20 rounded-full transition-colors",title:"Cerrar notificacin",children:a.jsx(ct,{className:"h-4 w-4"})})]}),l&&a.jsxs("div",{className:"absolute top-full right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 p-4 z-10 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ur,{className:"h-5 w-5 text-purple-500"}),a.jsx("h3",{className:"font-semibold text-gray-800",children:"Prximos Cumpleaos"})]}),n>5&&a.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full font-medium",children:[n," total"]})]}),a.jsx("div",{className:"space-y-3 max-h-72 overflow-y-auto",children:Object.entries(h).sort(([m],[y])=>Number(m)-Number(y)).map(([m,y])=>a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700",children:f(Number(m))}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",y.length," cliente",y.length>1?"s":"",")"]})]}),a.jsxs("div",{className:"space-y-1 ml-2",children:[y.slice(0,8).map(g=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm truncate",children:g.customer.name}),a.jsx("p",{className:"text-xs text-gray-600",children:g.birthdayDate})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[g.daysUntilBirthday===0&&a.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full font-medium",children:"Hoy"}),g.daysUntilBirthday===1&&a.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full font-medium",children:"Maana"}),g.daysUntilBirthday>1&&a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:[g.daysUntilBirthday,"d"]})]})]},g.customer.id)),y.length>8&&a.jsx("div",{className:"p-2 bg-gray-100 rounded-md text-center",children:a.jsxs("p",{className:"text-xs text-gray-600",children:["+",y.length-8," ms en este da"]})})]})]},m))}),a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-xs text-gray-500",children:" Considera enviar felicitaciones"}),n>10&&a.jsx("p",{className:"text-xs font-medium text-purple-600",children:"Temporada alta de cumpleaos! "})]})})]})]})})}function Nwe(){const[t,e]=I.useState("dashboard"),{showBirthdayNotification:r,dismissBirthdayNotification:n}=ma(),[s,i]=I.useState(!1);dG(t),I.useEffect(()=>{r&&i(!0)},[r]);const o=()=>{i(!1),n()},l=()=>{switch(t){case"inventory":return a.jsx(Pn,{permission:"inventory",children:a.jsx(lG,{})});case"categories":return a.jsx(Pn,{permission:"categories",children:a.jsx(uG,{})});case"purchases":return a.jsx(Pn,{permission:"purchases",children:a.jsx(hG,{})});case"sales":return a.jsx(Pn,{permission:"sales",children:a.jsx(gG,{})});case"sales-history":return a.jsx(Pn,{permission:"salesHistory",children:a.jsx(jG,{})});case"my-daily-sales":return a.jsx(Pn,{permission:"myDailySales",children:a.jsx(vwe,{})});case"purchases-history":return a.jsx(Pn,{permission:"purchasesHistory",children:a.jsx(EG,{})});case"customers":return a.jsx(Pn,{permission:"customers",children:a.jsx(OG,{})});case"courtesies":return a.jsx(Pn,{permission:"courtesies",children:a.jsx(bwe,{})});case"layaway":return a.jsx(Pn,{permission:"layaway",children:a.jsx($G,{})});case"technical-service":return a.jsx(Pn,{permission:"technicalService",children:a.jsx(VG,{})});case"technical-service-center":return a.jsx(Pn,{permission:"technicalServiceCenter",children:a.jsx(NG,{})});case"reports":return a.jsx(Pn,{permission:"reports",children:a.jsx(pwe,{})});case"user-management":return a.jsx(Pn,{permission:"userManagement",children:a.jsx(gwe,{})});case"technician-management":return a.jsx(Pn,{permission:"technicianManagement",children:a.jsx(ywe,{})});case"technician-liquidation":return a.jsx(Pn,{permission:"technicianLiquidation",children:a.jsx(xwe,{})});default:return a.jsx(Pn,{permission:"dashboard",children:a.jsx(iG,{})})}};return a.jsxs(a.Fragment,{children:[a.jsx(tG,{currentView:t,onViewChange:e,children:l()}),s&&a.jsx(jwe,{onDismiss:o})]})}function _we(){return a.jsx(VV,{store:p3,children:a.jsx(GD,{loading:a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#90c5e7] mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Inicializando aplicacin..."})]})}),persistor:VB,children:a.jsx(CW,{children:a.jsx(JW,{children:a.jsx(PW,{children:a.jsx(YW,{children:a.jsx(Nwe,{})})})})})})})}UD(document.getElementById("root")).render(a.jsx(I.StrictMode,{children:a.jsx(_we,{})}));
